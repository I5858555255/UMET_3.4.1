(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[324],{324:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return y}});var i=function(){var t=this,e=t._self._c;return e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"销售数据",tips:"请事先在“成本管理”维护好成本，否则部分计算不准确",isShowBottomBorder:""},slot:"title",scopedSlots:t._u([{key:"rightBtn",fn:function(){return[e("div",{staticClass:"title-right"},[e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("统计类型：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.changeDataType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[e("el-option",{key:"0",attrs:{label:"销售数据",value:"0"}}),e("el-option",{key:"1",attrs:{label:"近30天销售(按SKU)",value:"1"}}),e("el-option",{key:"2",attrs:{label:"近30天销售(按SKC)",value:"2"}})],1)],1),e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("店铺：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.beforeGetList},model:{value:t.mallId,callback:function(e){t.mallId=e},expression:"mallId"}},t._l(t.$store.state.mallList,(function(t){return e("el-option",{key:t.mallId,attrs:{label:t.mallName,value:t.mallId}})})),1)],1)]),e("ai-dialog",{attrs:{title:"导出SKU历史销量",visible:t.downloadSkuSaleNumberDlg,"close-on-click-modal":!1,width:"790px","append-to-body":"",customFooter:""},on:{"update:visible":function(e){t.downloadSkuSaleNumberDlg=e},close:t.handleClose}},[e("el-form",{ref:"skuDownloadForm",staticClass:"ai-form",attrs:{model:t.skuDownloadForm,"label-width":"160px"}},[e("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"日期范围",prop:"date",rules:[{required:!0,message:"请选择时间范围",trigger:"blur"}]}},[e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.skuDownloadForm.date,callback:function(e){t.$set(t.skuDownloadForm,"date",e)},expression:"skuDownloadForm.date"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.downloadSkuSaleNumberDlg=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.toDownloadSkuSaleNumber}},[t._v("确定")])],1)],1)]},proxy:!0}])}),"0"===t.type?e("template",{slot:"content"},[e("div",{staticClass:"top"},[e("div",{staticClass:"item"},[e("h2",[t._v("今日销量/销售额")]),e("p",[t._v(t._s(t.todayTotal)+"/"+t._s(t.todayMoney))])]),e("div",{staticClass:"item"},[e("h2",[t._v("今日利润/利润率")]),e("p",[t._v(t._s(t.profitMoney)+"/"+t._s(t.profitPercent))])]),e("div",{staticClass:"item"},[e("h2",[t._v("可用库存总量(件)")]),e("p",[t._v(t._s(t.inventoryTotal))])]),e("div",{staticClass:"item"},[e("h2",[t._v("可用库存总额")]),e("p",[t._v(t._s(t.inventoryMoney))])]),e("div",{staticClass:"item"},[e("h2",[e("span",[t._v("在途库存总量(件)"),e("el-tooltip",{attrs:{effect:"dark",content:"包括暂不可用库存以及已发货库存",placement:"right"}},[e("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px","vertical-align":"middle"}})])],1)]),e("p",[t._v(t._s(t.inroadTotal))])]),e("div",{staticClass:"item"},[e("h2",[e("span",[t._v("在途库存总额"),e("el-tooltip",{attrs:{effect:"dark",content:"(暂不可用库存+已发货库存)*申报价格",placement:"right"}},[e("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px","vertical-align":"middle"}})])],1)]),e("p",[t._v(t._s(t.inroadTotalMoney))])])]),e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:t._u([{key:"right",fn:function(){return[e("div",{staticClass:"search-item",staticStyle:{width:"160px"}},[e("el-checkbox",{model:{value:t.showTodaySale,callback:function(e){t.showTodaySale=e},expression:"showTodaySale"}},[t._v("只显示今日有销量")])],1),"0"===t.type?e("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.downloadSaleData}},[t._v("导出数据")]):t._e(),e("json-excel",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{data:t.skuSaleNumberList,fields:t.skuSaleNumberFields,"before-generate":t.startSkuSaleNumberDownload,name:"SKU历史销量.xls",worksheet:"SKU历史销量"}},[e("el-button",{attrs:{type:"primary",id:"downloadSkuSaleNumber"}})],1),e("el-button",{attrs:{type:"primary",disabled:!t.mallId},on:{click:t.toDownload}},[t._v("导出SKU历史销量")])]},proxy:!0}],null,!1,3888808201)},[e("ai-table",{ref:"table0",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.filteredData,height:"700","col-configs":t.colConfigs,total:t.filteredData.length},on:{getList:()=>{}}})],1)],1):t._e(),"1"===t.type?e("template",{slot:"content"},[e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:t._u([{key:"right",fn:function(){return["1"===t.type?e("json-excel",{attrs:{data:t.last30DaySkuList,fields:t.last30DaysSkuJsonFields,"before-generate":t.startDownload,name:"近30天销售数据_按SKU.xls",worksheet:"近30天销售统计_按SKU"}},[e("el-button",{attrs:{type:"primary"}},[t._v("导出数据")])],1):t._e()]},proxy:!0}],null,!1,4153836005)},[e("ai-table",{ref:"table1",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.last30DaySkuList,height:"700","col-configs":t.col30DaysSkuConfigs,total:t.last30DaySkuList.length},on:{getList:()=>{}}})],1)],1):t._e(),"2"===t.type?e("template",{slot:"content"},[e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:t._u([{key:"right",fn:function(){return["2"===t.type?e("json-excel",{attrs:{data:t.last30DaySkcList,fields:t.last30DaysSkcJsonFields,"before-generate":t.startDownload,name:"近30天销售数据_按SKC.xls",worksheet:"近30天销售统计_按SKC"}},[e("el-button",{attrs:{type:"primary"}},[t._v("导出数据")])],1):t._e()]},proxy:!0}],null,!1,1544191142)},[e("ai-table",{ref:"table2",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.last30DaySkcList,height:"700","col-configs":t.col30DaysSkcConfigs,total:t.last30DaySkcList.length},on:{getList:()=>{}}})],1)],1):t._e()],2)},l=[],o=(a(44114),a(98992),a(54520),a(81454),a(14603),a(47566),a(98721),a(95353)),s=a(73236),r=a(39325),n=a(31981),d=a(31052),u=a(3959),p=a(4213),c={name:"ExportSaleData",data(){return{list:[],last30DaySkcList:[],last30DaySkuList:[],mallId:"",mallName:"",type:"0",isLoading:!1,pageSize:50,currentPage:1,todayTotal:0,todayMoney:0,profitMoney:0,profitPercent:0,inventoryTotal:0,inventoryMoney:0,inroadTotal:0,inroadTotalMoney:0,costList:[],startDate:"",endDate:"",skuIds:[],skuSaleNumberFields:{},skuSaleNumberList:[],downloadSkuSaleNumberDlg:!1,skuDownloadForm:{date:""},showTodaySale:!1}},computed:{...(0,o.aH)(["mallList"]),filteredData(){const t=this.list.filter((t=>!this.showTodaySale||t.todaySaleVolume>0));return t},colConfigs(){return[{prop:"productName",label:"商品名称","show-overflow-tooltip":!0,width:"280px",align:"left",fixed:"left"},{prop:"mallName",label:"店铺名称","show-overflow-tooltip":!0,width:"120px",align:"left",fixed:"left"},{prop:"mark",label:"评分","show-overflow-tooltip":!0,width:"80px",align:"left"},{prop:"hotTag",label:"是否热销","show-overflow-tooltip":!0,width:"80px",align:"left"},{prop:"productId",label:"SPU",width:"120px",align:"center"},{prop:"productSkcId",label:"SKC",width:"120px",align:"center"},{prop:"productSkuId",label:"SKU ID",width:"120px",align:"center"},{prop:"className",label:"SKU属性",align:"center"},{prop:"skuExtCode",label:"SKU货号",width:"120px",align:"center"},{prop:"todaySaleVolume",label:"今日销量",width:"120px",align:"center",sortable:!0,"sort-method":(t,e)=>t.todaySaleVolume-e.todaySaleVolume},{prop:"lastSevenDaysSaleVolume",label:"近7天",width:"120px",align:"center",sortable:!0,"sort-method":(t,e)=>t.lastSevenDaysSaleVolume-e.lastSevenDaysSaleVolume},{prop:"lastThirtyDaysSaleVolume",label:"近30天",width:"120px",align:"center",sortable:!0,"sort-method":(t,e)=>t.lastThirtyDaysSaleVolume-e.lastThirtyDaysSaleVolume},{prop:"saleMoney",label:"销售额",width:"120px",align:"center"},{prop:"profitMoney",label:"利润",width:"120px",align:"center",sortable:!0,"sort-method":(t,e)=>t.profitMoney-e.profitMoney},{prop:"profitPercent",label:"利润率(%)",width:"120px",align:"center"},{prop:"onSalesDurationOffline",label:"加入站点时长",width:"160px",align:"center"},{prop:"isVerifyPrice",label:"开款核价状态",width:"160px",align:"center",format:t=>t?"核价通过":"核价未通过 / 无法备货"},{prop:"supplierPrice",label:"申报价格(CNY)",width:"160px",align:"center",format:t=>t/100,fixed:"right"},{prop:"warehouseInventoryNum",label:"仓内可用库存",width:"160px",align:"center",sortable:!0,"sort-method":(t,e)=>t.warehouseInventoryNum-e.warehouseInventoryNum},{prop:"productTotalPrice",label:"可用库存货值(CNY)",width:"180px",align:"center",fixed:"right",sortable:!0,"sort-method":(t,e)=>t.productTotalPrice-e.productTotalPrice},{prop:"purchaseConfig",label:"备货逻辑",align:"center",width:"120px",fixed:"right",sortable:!0,"sort-method":(t,e)=>t.purchaseConfig>e.purchaseConfig?1:t.purchaseConfig==e.purchaseConfig?0:-1}]},col30DaysSkcConfigs(){let t=[{prop:"productName",label:"商品名称","show-overflow-tooltip":!0,width:"300px",align:"left",fixed:"left"},{prop:"mallName",label:"店铺名称","show-overflow-tooltip":!0,width:"120px",align:"left",fixed:"left"},{prop:"productId",label:"SPU",width:"120px",align:"center",fixed:"left"},{prop:"productSkcId",label:"SKC",width:"120px",align:"center",fixed:"left"},{prop:"skcExtCode",label:"SKC货号",width:"120px",align:"center",fixed:"left"}],e=new Date;e.setDate(e.getDate());for(let a=0;a<30;a++){e.setDate(e.getDate()-1);let a=(0,n.Y)(e);t.push({prop:a,label:a,width:"100px",align:"center",sortable:!0,"sort-method":(t,e)=>t>e?1:t==e?0:-1})}return t},last30DaysSkcJsonFields(){let t={"商品名称":"productName","店铺名称":"mallName",SPU:"productId",SKC:"productSkcId","SKC货号":"skcExtCode","图片链接":"productSkcPicture"},e=new Date;e.setDate(e.getDate());for(let a=0;a<30;a++){e.setDate(e.getDate()-1);let a=(0,n.Y)(e);t[a]=a}return t},col30DaysSkuConfigs(){let t=[{prop:"productName",label:"商品名称","show-overflow-tooltip":!0,width:"300px",align:"left",fixed:"left"},{prop:"mallName",label:"店铺名称","show-overflow-tooltip":!0,width:"120px",align:"left",fixed:"left"},{prop:"productId",label:"SPU",width:"120px",align:"center",fixed:"left"},{prop:"productSkcId",label:"SKC",width:"120px",align:"center",fixed:"left"},{prop:"skcExtCode",label:"SKC货号",width:"120px",align:"center",fixed:"left"},{prop:"supplierPrice",label:"申报价格",width:"120px",align:"center",fixed:"left"},{prop:"productSkuId",label:"SKU ID",width:"120px",align:"center",fixed:"left"},{prop:"skuExtCode",label:"SKU货号",width:"120px",align:"center",fixed:"left"}],e=new Date;e.setDate(e.getDate());for(let a=0;a<30;a++){e.setDate(e.getDate()-1);let a=(0,n.Y)(e);t.push({prop:a,label:a,width:"100px",align:"center",sortable:!0,"sort-method":(t,e)=>t>e?1:t==e?0:-1})}return t},last30DaysSkuJsonFields(){let t={"商品名称":"productName","店铺名称":"mallName",SPU:"productId",SKC:"productSkcId","SKC货号":"skcExtCode","SKU ID":"productSkuId","SKU货号":"skuExtCode","申报价格":"supplierPrice","图片链接":"productSkcPicture"},e=new Date;e.setDate(e.getDate());for(let a=0;a<30;a++){e.setDate(e.getDate()-1);let a=(0,n.Y)(e);t[a]=a}return t}},components:{JsonExcel:r.A},created(){let t=new Date;t.setDate(t.getDate()-30),this.startDate=(0,n.Y)(t),t.setDate(t.getDate()+29),this.endDate=(0,n.Y)(t)},methods:{changeDataType(){this.$nextTick((()=>{this.$refs["table"+this.type].doLayout()}))},async beforeGetList(){if(this.list=[],this.currentPage=1,this.todayMoney=0,this.todayTotal=0,this.profitMoney=0,this.profitPercent=0,this.inventoryMoney=0,this.inventoryTotal=0,this.inroadTotalMoney=0,this.inroadTotal=0,!this.mallId)return void d.Message.error("请先选择店铺");let t=this.mallList.filter((t=>t.mallId==this.mallId));this.mallName=t[0].mallName,this.isLoading=!0,this.$userCheck(this.mallId).then((async()=>{this.last30DaySkcList=[],await this.getSkuCostList(),await this.getList()})).catch((t=>{this.mallId="",console.log(t),this.isLoading=!1}))},async getSkuCostList(){let t=await this.$http.post("/api/skuCost/listAll",null,{params:{mallId:this.mallId}});0==t.code&&(this.costList=t.data)},async getList(){let t=await(0,s.w4)({url:"marvel-mms/cn/api/kiana/venom/sales/management/listWarehouse",needMallId:!0,anti:!0,mallId:this.mallId,data:{pageNo:this.currentPage,pageSize:this.pageSize,isLack:0,priceAdjustRecentDays:7}});if(1e6==t.errorCode){for(let e=0;e<t.result.subOrderList.length;e++){let a=t.result.subOrderList[e],i={};i.productName=a.productName,i.category=a.category,i.productId=a.productId,i.productSkcId=a.productSkcId,i.skcExtCode=a.skcExtCode,i.purchaseConfig=a.purchaseConfig,i.productSkcPicture=a.productSkcPicture,i.mark=a.mark.toFixed(1),i.hotTag=a.hotTag?"是":"否",i.mallName=this.mallName,this.last30DaySkcList.push({productName:a.productName,mallName:this.mallName,productId:a.productId,productSkcId:a.productSkcId,skcExtCode:a.skcExtCode,productSkcPicture:a.productSkcPicture}),0==a.onSalesDurationOffline?i.onSalesDurationOffline="-天":i.onSalesDurationOffline=a.onSalesDurationOffline+"天";for(let t=0;t<a.skuQuantityDetailList.length;t++){let e=0,l=0,o=0,s=0;a.skuQuantityDetailList[t].warehouseInfoList.map((t=>{e+=t.inventoryNumInfo.warehouseInventoryNum,l+=t.inventoryNumInfo.waitOnShelfNum,o+=t.inventoryNumInfo.waitReceiveNum,s+=t.todaySaleVolume}));let r=this.getCostPrice(a.skuQuantityDetailList[t].productSkuId),n=Math.round(s*a.skuQuantityDetailList[t].supplierPrice)/100,d=Math.round(s*(a.skuQuantityDetailList[t].supplierPrice/100-r)*100)/100,u=Math.round(d/n*1e4)/100;a.skuQuantityDetailList[t].todaySaleVolume=s,i={...i,...a.skuQuantityDetailList[t],saleMoney:n,profitMoney:d,profitPercent:u,productTotalPrice:(a.skuQuantityDetailList[t].supplierPrice/100*e).toFixed(2),inroadTotalPrice:(a.skuQuantityDetailList[t].supplierPrice/100*(l+o)).toFixed(2),warehouseInventoryNum:e},this.todayTotal+=s,this.profitMoney+=s*(a.skuQuantityDetailList[t].supplierPrice/100-r),this.todayMoney+=a.skuQuantityDetailList[t].supplierPrice/100*s,this.inventoryTotal+=e,this.inventoryMoney+=a.skuQuantityDetailList[t].supplierPrice/100*e,this.inroadTotal+=l+o,this.inroadTotalMoney+=a.skuQuantityDetailList[t].supplierPrice/100*(l+o),this.adviceProduceNum=a.skuQuantityDetailList[t].adviceProduceNum||"-",this.availableProduceNum=a.skuQuantityDetailList[t].availableProduceNum||"-",this.list.push(i)}}this.pageSize==t.result.subOrderList.length?(this.currentPage++,this.$sleepSync(200),await this.getList()):(this.profitMoney=Math.round(100*this.profitMoney)/100,this.todayMoney=Math.round(100*this.todayMoney)/100,this.profitPercent=Math.round(this.profitMoney/this.todayMoney*1e4)/100+"%",this.inventoryMoney=Math.round(100*this.inventoryMoney)/100,this.inroadTotalMoney=Math.round(100*this.inroadTotalMoney)/100,this.last30DaySkcList=this.last30DaySkcList.map((t=>{let e=new Date;e.setDate(e.getDate()-31);for(let a=0;a<30;a++){e.setDate(e.getDate()+1);let a=(0,n.Y)(e);t[a]=0}return t})),this.last30DaySkuList=this.list.map((t=>{let e={productName:t.productName,mallName:this.mallName,productId:t.productId,productSkcId:t.productSkcId,productSkuId:t.productSkuId,skuExtCode:t.skuExtCode,skcExtCode:t.skcExtCode,productSkcPicture:t.productSkcPicture,supplierPrice:this.getSupplierPrice(t.productSkuId)},a=new Date;a.setDate(a.getDate()-31);for(let i=0;i<30;i++){a.setDate(a.getDate()+1);let t=(0,n.Y)(a);e[t]=0}return e})),this.skuIds=this.list.map((t=>t.productSkuId)),await this.getSkuDetailList(0),this.isLoading=!1,d.Message.success("销售数据加载完成，可进行导出"))}else this.$sleepSync(200),await this.getList()},async getSkuDetailList(t){let e=[],a=100*t,i=0;for(;a<this.skuIds.length;a++)if(e.push(this.skuIds[a]),i++,100==i)break;if(0==e.length)return;let l=await(0,s.w4)({url:"oms/bg/venom/api/supplier/sales/management/querySkuSalesNumber",needMallId:!0,mallId:this.mallId,data:{productSkuIds:e,startDate:this.startDate,endDate:this.endDate}});if(1e6==l.errorCode){for(let t=0;t<l.result.length;t++)for(let e=0;e<this.last30DaySkuList.length;e++)if(this.last30DaySkuList[e].productSkuId==l.result[t].prodSkuId){this.last30DaySkuList[e][l.result[t].date]=l.result[t].salesNumber;for(let a=0;a<this.last30DaySkcList.length;a++)if(this.last30DaySkcList[a].productSkcId==this.last30DaySkuList[e].productSkcId){this.last30DaySkcList[a][l.result[t].date]=this.last30DaySkcList[a][l.result[t].date]+l.result[t].salesNumber;break}break}await this.getSkuDetailList(t+1)}else this.$sleepSync(200),await this.getSkuDetailList(t)},startDownload(){this.$http.post("/api/malluser/info").then((t=>{if(0==t.code&&(this.$store.commit("setUserInfo",t.data),1!=t.data.flag))return d.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0)}))},toDownload(){this.downloadSkuSaleNumberDlg=!0},startSkuSaleNumberDownload(){},handleClose(){this.downloadSkuSaleNumberDlg=!1},async toDownloadSkuSaleNumber(){if(this.downloadSkuSaleNumberDlg=!1,this.isLoading=!0,!this.skuDownloadForm.date)return void d.Message.error("请选择时间");let t=(0,n.Y)(this.skuDownloadForm.date[0]),e=(0,n.Y)(this.skuDownloadForm.date[1]),a={};a={SKC:"skc",SKU:"sku","SKU货号":"skuExtCode","申报价格":"supplierPrice"};let i=new Date(this.skuDownloadForm.date[0]),l=new Date(this.skuDownloadForm.date[1]);for(;i.getTime()<=l.getTime();){let t=(0,n.Y)(l);a[t]=t,l.setDate(l.getDate()-1)}this.skuSaleNumberFields=a;let o=this.list.filter((t=>"-天"!=t.onSalesDurationOffline)),r=[];o.map((t=>{r.push(t.productSkuId)})),this.skuSaleNumberList=[],this.list.map((t=>{if("-天"!=t.onSalesDurationOffline){let e={sku:t.productSkuId,skc:t.productSkcId,skuExtCode:t.skuExtCode,supplierPrice:this.getSupplierPrice(t.productSkuId)};for(i=new Date(this.skuDownloadForm.date[0]),l=new Date(this.skuDownloadForm.date[1]);i.getTime()<=l.getTime();){let t=(0,n.Y)(l);e[t]=0,l.setDate(l.getDate()-1)}this.skuSaleNumberList.push(e)}}));let u=[],p=100;for(let n=0;n<r.length;n++)if(u.push(r[n]),u.length%p==0||n+1==r.length){let a=await(0,s.w4)({url:"oms/bg/venom/api/supplier/sales/management/querySkuSalesNumber",needMallId:!0,mallId:this.mallId,data:{productSkuIds:u,startDate:t,endDate:e}});if(!a.success){this.isLoading=!1,d.Message.error("获取SKU历史销量数据失败");break}a.result.map((t=>{for(let e=0;e<this.skuSaleNumberList.length;e++)if(this.skuSaleNumberList[e].sku==t.prodSkuId){this.skuSaleNumberList[e][t.date]=t.salesNumber;break}})),n+1==r.length&&(document.getElementById("downloadSkuSaleNumber").click(),this.isLoading=!1),u=[]}},getSupplierPrice(t){for(let e=0;e<this.list.length;e++)if(this.list[e].productSkuId==t)return this.list[e].supplierPrice/100;return 0},getCostPrice(t){for(let e=0;e<this.costList.length;e++)if(this.costList[e].sku==t)return this.costList[e].costPrice;return 0},async downloadSaleData(){let t=await this.$http.post("/api/malluser/info");if(0==t.code&&(this.$store.commit("setUserInfo",t.data),1!=t.data.flag))return d.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0);const e=[["商品名称","SPU","SKC","SKU ID","SKU属性","SKU货号","加入站点时长","图片链接","申报价格(CNY)","开款核价状态","缺货数量","建议备货量","可售天数","库存可售天数","仓内库存可售天数","近7日用户加购数量","用户累计加购数量","已订阅待提醒到货","销售数据 - 今日","销售数据 - 近7天","销售数据 - 近30天","销售数据 - 今日销售额","销售数据 - 利润","销售数据 - 利润率","库存数据 - 仓内可用库存","库存数据 - 仓内暂不可用库存","库存数据 - 已发货库存","库存数据 - 已下单待发货库存","库存数据 - 待审核备货库存","VMI备货单数 - 待发货","VMI备货单数 - 在途单数","VMI备货单数 - 发货延迟","VMI备货单数 - 到货延迟","非VMI备货单数 - 待发货","非VMI备货单数 - 在途单数","非VMI备货单数 - 发货延迟","非VMI备货单数 - 到货延迟","备货逻辑","可用库存货值(CNY)","在途库存货值(CNY)","店铺名称","评分","是否热销","生产建议信息 - 建议生产数","生产建议信息 - 剩余件数","类目"]];this.list.map((t=>{e.push([t.productName,t.productId,t.productSkcId,t.productSkuId,t.className,t.skuExtCode,t.onSalesDurationOffline,t.productSkcPicture,t.supplierPrice/100,t.isVerifyPrice?"核价通过":"核价未通过 / 无法备货",t.lackQuantity,t.adviceQuantity,t.availableSaleDays,t.availableSaleDaysFromInventory,t.warehouseAvailableSaleDays,t.inCartNumber7d,t.inCardNumber,t.nomsgSubsCntCntSth,t.todaySaleVolume,t.lastSevenDaysSaleVolume,t.lastThirtyDaysSaleVolume,t.saleMoney,t.profitMoney,t.profitPercent,t.inventoryNumInfo?.warehouseInventoryNum,t.inventoryNumInfo?.waitOnShelfNum,t.inventoryNumInfo?.waitReceiveNum,t.inventoryNumInfo?.waitDeliveryInventoryNum,t.inventoryNumInfo?.waitApproveInventoryNum,t.vmiOrderInfo?.waitDeliveryNum,t.vmiOrderInfo?.transportationNum,t.vmiOrderInfo?.deliveryDelayNum,t.vmiOrderInfo?.arrivalDelayNum,t.notVmiOrderInfo?.waitDeliveryNum,t.notVmiOrderInfo?.transportationNum,t.notVmiOrderInfo?.deliveryDelayNum,t.notVmiOrderInfo?.arrivalDelayNum,t.purchaseConfig,t.productTotalPrice,t.inroadTotalPrice,t.mallName,t.mark,t.hotTag,t.adviceProduceNum,t.availableProduceNum,t.category])}));const a=u.Wp.aoa_to_sheet(e),i=u.Wp.book_new();u.Wp.book_append_sheet(i,a,"Sheet1");const l=u.M9(i,{bookType:"xlsx",type:"array"}),o=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),s=window.URL.createObjectURL(o);(0,p.saveAs)(o,"销售数据.xlsx"),window.URL.revokeObjectURL(s)}}},h=c,m=(a(38889),a(81656)),f=(0,m.A)(h,i,l,!1,null,"4c836780",null),y=f.exports},15523:function(t,e,a){"use strict";a.r(e);var i=a(31601),l=a.n(i),o=a(76314),s=a.n(o),r=s()(l());r.push([t.id,".list .title-right[data-v-4c836780]{display:flex;align-items:center}.list .title-right>div[data-v-4c836780]:first-child{margin-right:20px}.list[data-v-4c836780].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}.list .top[data-v-4c836780]{display:flex;justify-content:space-between;margin-bottom:24px}.list .top .item[data-v-4c836780]{flex:1;margin-right:20px;padding:16px 24px;background:#fff;box-shadow:0 4px 6px -2px rgba(15,15,21,.15);border-radius:4px}.list .top .item[data-v-4c836780]:last-child{margin-right:0}.list .top .item[data-v-4c836780]:first-of-type{color:#26f}.list .top .item[data-v-4c836780]:nth-of-type(2){color:#f8b426}.list .top .item[data-v-4c836780]:nth-of-type(3){color:#21aa99}.list .top .item[data-v-4c836780]:nth-of-type(4){color:#f46}.list .top .item[data-v-4c836780]:nth-of-type(5){color:#11a265}.list .top .item h2[data-v-4c836780]{margin-bottom:30px;font-size:16px;color:#999}.list .top .item p[data-v-4c836780]{font-weight:600;font-size:28px}.like[data-v-4c836780]{cursor:pointer;font-size:25px;display:inline-block}",""]),e["default"]=r},38889:function(t,e,a){var i=a(15523);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);var l=a(99548).A;l("4d1ced8d",i,!0,{sourceMap:!1,shadowMode:!1})}}]);