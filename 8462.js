(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[8462],{58462:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"海外仓商品",isShowBottomBorder:""},slot:"title"}),e("template",{slot:"content"},[e("div",{staticClass:"content"},[e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("div",{staticClass:"search-item"},[e("label",[t._v("海外仓：")]),e("ai-select",{attrs:{selectList:t.$dict.getDict("semi_warehouse"),size:"small"},model:{value:t.search.warehouseId,callback:function(e){t.$set(t.search,"warehouseId",e)},expression:"search.warehouseId"}})],1),e("div",{staticClass:"search-item"},[e("label",{staticStyle:{width:"90px"}},[t._v("SKU：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入SKU"},model:{value:t.search.sku,callback:function(e){t.$set(t.search,"sku",e)},expression:"search.sku"}})],1),e("div",{staticClass:"search-item"},[e("label",{staticStyle:{width:"120px"}},[t._v("产品名称英文：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入产品名称英文"},model:{value:t.search.productTitleEn,callback:function(e){t.$set(t.search,"productTitleEn",e)},expression:"search.productTitleEn"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("产品名称：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入产品名称"},model:{value:t.search.productTitle,callback:function(e){t.$set(t.search,"productTitle",e)},expression:"search.productTitle"}})],1)]},proxy:!0}])}),e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(e){t.productList=[],t.isLoading=!0,t.pageNo=1,t.syncProduct()}}},[t._v("同步商品")])]},proxy:!0},{key:"right",fn:function(){return[e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(e){return t.toLoad()}}},[t._v("查询")])]},proxy:!0}])}),e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"}},[e("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:t.tableData,"col-configs":t.colConfigs,total:t.total,current:t.search.current,size:t.search.size,height:"700"},on:{"update:current":function(e){return t.$set(t.search,"current",e)},"update:size":function(e){return t.$set(t.search,"size",e)},getList:()=>{}}})],1)],1)])],2)],1)},i=[],r=(a(44114),a(31052)),o=a(73236),l={name:"WarehouseProduct",data(){return{search:{current:1,size:20,sku:null,productTitleEn:null,productTitle:null,warehouseId:null},colConfigs:[{prop:"warehouseId",label:"海外仓",align:"left",format:t=>this.$dict.getLabel("semi_warehouse",t)},{prop:"productId",label:"产品ID",align:"left"},{prop:"sku",label:"SKU",align:"left"},{prop:"productTitleEn",label:"产品名称英文",align:"left"},{prop:"productTitle",label:"产品名称",align:"left"},{prop:"declaredValue",label:"申报价值(美元)",align:"left"},{prop:"createTime",label:"创建时间",align:"left"}],isLoading:!1,tableData:[],currentIndex:0,total:0,pageNo:1,pageSize:100,productList:[]}},created(){this.$dict.load("semi_warehouse"),this.toLoad()},methods:{toLoad(){this.tableData=[],this.load()},load(){this.$http.post("/api/semi/semiWarehouseProduct/page",null,{params:{...this.search}}).then((t=>{this.tableData=t.data.records,this.total=t.data.total}))},async syncProduct(){if(!this.search.warehouseId)return r.Message.error("请选择海外仓"),void(this.isLoading=!1);"XinCang"==this.search.warehouseId?await this.asyncXc(o.tA):"XinCang_New"==this.search.warehouseId?await this.asyncXc(o.fp):"zhengcang"==this.search.warehouseId&&await this.asyncZhengcang()},async asyncXc(t){let e=await t({url:`/product/Product/list/page/${this.pageNo}/pageSize/${this.pageSize}`,method:"POST",isFormData:!0,data:{}});if(1==e.state){for(let t=0;t<e.data.length;t++){let a=e.data[t];this.productList.push({warehouseId:this.search.warehouseId,productId:a.product_id,productTitleEn:a.product_declared_name,productTitle:a.product_declared_name_zh,declaredValue:a.product_declared_value,sku:a.product_barcode,createTime:a.product_add_time})}if(this.pageNo*this.pageSize<e.total)this.pageSize++,await this.syncProduct();else{let t=await this.$http.post("/api/semi/semiWarehouseProduct/addBatch",this.productList);0==t.code&&(this.isLoading=!1,r.Message.success("海外仓商品同步成功"),this.toLoad())}}},async asyncZhengcang(){let t=await(0,o.nM)({url:"gateway/woms/product/pageList",method:"POST",data:{current:this.pageNo,size:this.pageSize,approveStatus:"2",orderType:"sku",rangeType:"productWeight",categoryIdList:[],multiKeyword:""}});if(200==t.code){for(let e=0;e<t.data.records.length;e++){let a=t.data.records[e];this.productList.push({warehouseId:this.search.warehouseId,productId:a.id,productTitleEn:a.productName,productTitle:a.productName,declaredValue:"",sku:a.sku,createTime:a.createTime})}if(this.pageNo*this.pageSize<t.data.total)this.pageSize++,await this.syncProduct();else{let t=await this.$http.post("/api/semi/semiWarehouseProduct/addBatch",this.productList);0==t.code&&(this.isLoading=!1,r.Message.success("海外仓商品同步成功"),this.toLoad())}}}}},c=l,d=(a(99666),a(81656)),n=(0,d.A)(c,s,i,!1,null,"380cec73",null),u=n.exports},51816:function(t,e,a){"use strict";a.r(e);var s=a(31601),i=a.n(s),r=a(76314),o=a.n(r),l=o()(i());l.push([t.id,".list .title-right[data-v-380cec73]{display:flex;align-items:center}.list .title-right>div[data-v-380cec73]:first-child{margin-right:20px}.list[data-v-380cec73].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),e["default"]=l},99666:function(t,e,a){var s=a(51816);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);var i=a(99548).A;i("14137856",s,!0,{sourceMap:!1,shadowMode:!1})}}]);