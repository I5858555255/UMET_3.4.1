(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[4977],{24977:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return _}});var s=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[e("keep-alive",{attrs:{include:["List"]}},[e(t.component,{ref:"component",tag:"component",attrs:{params:t.params},on:{change:t.onChange}})],1)],1)],1)},l=[],i=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中"}},[e("ai-title",{attrs:{slot:"title",title:"平台商品",isShowBottomBorder:""},slot:"title",scopedSlots:t._u([{key:"rightBtn",fn:function(){return[e("div",{staticClass:"title-right"},[e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("店铺：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.search.mallId,callback:function(e){t.$set(t.search,"mallId",e)},expression:"search.mallId"}},t._l(t.mallList,(function(t){return e("el-option",{key:t.mallId,attrs:{label:t.mallName,value:t.mallId}})})),1)],1)])]},proxy:!0}])}),e("template",{slot:"content"},[e("div",{staticClass:"content"},[e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("div",{staticClass:"search-item"},[e("label",[t._v("产品名称：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入产品名称"},model:{value:t.search.productName,callback:function(e){t.$set(t.search,"productName",e)},expression:"search.productName"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("站点名称：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入站点名称"},model:{value:t.search.siteName,callback:function(e){t.$set(t.search,"siteName",e)},expression:"search.siteName"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("SKC：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入SKC ID"},model:{value:t.search.skc,callback:function(e){t.$set(t.search,"skc",e)},expression:"search.skc"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("SKC属性：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入SKC属性"},model:{value:t.search.skcCode,callback:function(e){t.$set(t.search,"skcCode",e)},expression:"search.skcCode"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("SKU：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入SKU"},model:{value:t.search.sku,callback:function(e){t.$set(t.search,"sku",e)},expression:"search.sku"}})],1),e("div",{staticClass:"search-item"},[e("label",[t._v("SKU属性：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入SKU属性"},model:{value:t.search.skuCode,callback:function(e){t.$set(t.search,"skuCode",e)},expression:"search.skuCode"}})],1)]},proxy:!0}])}),e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(e){t.productList=[],t.isLoading=!0,t.page=1,t.syncProduct()}}},[t._v("同步商品")])]},proxy:!0},{key:"right",fn:function(){return[e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(e){return t.getList()}}},[t._v("查询")])]},proxy:!0}])}),e("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:t.tableData,"col-configs":t.colConfigs,total:t.total,current:t.search.current,size:t.search.size},on:{"selection-change":t.onChooseChange,"update:current":function(e){return t.$set(t.search,"current",e)},"update:size":function(e){return t.$set(t.search,"size",e)},getList:t.getList}},[e("el-table-column",{attrs:{slot:"options",label:"操作",width:"240px","show-overflow-tooltip":"",align:"center",fixed:"right"},slot:"options",scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("div",{staticClass:"table-options"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.toDetail(a.sku)}}},[t._v("关联海外仓商品")])],1)]}}])})],1)],1)])],2)],1)},o=[],r=(a(44114),a(98992),a(54520),a(81454),a(73236)),n=a(31981),c=a(31052),u={name:"List",data(){return{search:{current:1,size:20,skc:null,skcCode:null,sku:null,skuCode:null,productName:null,siteName:null,mallId:null},colConfigs:[{prop:"productName",label:"商品名称",align:"left"},{prop:"mallName",label:"店铺名称",align:"left"},{prop:"siteName",label:"站点名称",align:"left"},{prop:"skc",label:"SKC",align:"left"},{prop:"skcCode",label:"SKC属性",align:"left"},{prop:"sku",label:"SKU",align:"left"},{prop:"skuCode",label:"SKU属性",align:"left"},{prop:"createTime",label:"创建时间",width:"180px",fixed:"right"}],tableData:[],total:0,isDlgShow:!1,page:1,pageSize:100,isLoading:!1,productList:[],mallName:null}},computed:{mallList(){const t=this.$store.state.mallList.filter((t=>t.isSemiManagedMall));return t}},created(){},methods:{getList(){if(!this.search.mallId)return void c.Message.error("请选择店铺");let t=this.mallList.filter((t=>t.mallId==this.search.mallId));this.mallName=t[0].mallName,this.$http.post("/api/semi/semiProduct/page",null,{params:{...this.search}}).then((t=>{this.tableData=t.data.records,this.total=t.data.total}))},onChooseChange(t){this.selectRows=t},async syncProduct(){if(!this.search.mallId)return c.Message.error("请选择店铺"),void(this.isLoading=!1);let t=await(0,r.w4)({url:"bg-visage-mms/product/skc/pageQuery",needMallId:!0,mallId:this.search.mallId,data:{page:this.page,pageSize:this.pageSize,skcTopStatus:100}});if(1e6==t.errorCode){for(let e=0;e<t.result.pageItems.length;e++){let a=t.result.pageItems[e],s=a.productSemiManaged.bindSites.map((t=>t.siteName)).join(",");for(let t=0;t<a.productSkuSummaries.length;t++)this.productList.push({mallId:this.search.mallId,mallName:this.mallName,siteName:s,platformType:"0",productName:a.productName,picUrl:a.mainImageUrl,skc:a.productSkcId,skcCode:a.extCode,sku:a.productSkuSummaries[t].productSkuId,skuCode:a.productSkuSummaries[t].extCode,createTime:(0,n.z)(a.createdAt)})}if(this.pageSize==t.result.pageItems.length)this.page++,await this.syncProduct();else{let t=await this.$http.post("/api/semi/semiProduct/addBatch",this.productList);0==t.code&&(this.isLoading=!1,c.Message.success("商品同步成功"),this.getList())}}},toDetail(t){this.$emit("change",{type:"Detail",params:{id:t||""}})}}},d=u,p=a(81656),m=(0,p.A)(d,i,o,!1,null,"31e36174",null),h=m.exports,f=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{staticClass:"list"},[e("ai-title",{attrs:{slot:"title",title:"商品明细",isShowBottomBorder:"",isShowBack:""},on:{onBackClick:function(e){return t.cancel(!1)}},slot:"title"}),e("template",{slot:"content"},[e("div",{staticClass:"content"},[e("el-descriptions",{attrs:{title:"商品信息",labelStyle:"width: 160px; font-weight: bold",column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"商品名称",span:"2"}},[t._v(t._s(t.obj?.productName))]),e("el-descriptions-item",{attrs:{label:"店铺名称"}},[t._v(t._s(t.obj?.mallName))]),e("el-descriptions-item",{attrs:{label:"站点名称"}},[t._v(t._s(t.obj?.siteName))]),e("el-descriptions-item",{attrs:{label:"SKC"}},[t._v(t._s(t.obj?.skc))]),e("el-descriptions-item",{attrs:{label:"SKC货号"}},[t._v(t._s(t.obj?.skcCode))]),e("el-descriptions-item",{attrs:{label:"SKU"}},[t._v(t._s(t.obj?.sku))]),e("el-descriptions-item",{attrs:{label:"SKU货号"}},[t._v(t._s(t.obj?.skuCode))])],1)],1),e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"绑定海外仓商品"},scopedSlots:t._u([{key:"right",fn:function(){return[e("el-button",{attrs:{type:"primary"},on:{click:t.toAdd}},[t._v("添加")])]},proxy:!0},{key:"content",fn:function(){return[e("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:t.tableData,"col-configs":t.colConfigs,total:t.total,isShowPagination:!1,height:"400"},on:{getList:t.getList}},[e("el-table-column",{attrs:{slot:"options",width:"110px",label:"操作",align:"center"},slot:"options",scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("div",{staticClass:"table-options"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.remove(a.id)}}},[t._v("删除")])],1)]}}])})],1)]},proxy:!0}])})],1)],2),e("AiDialog",{attrs:{title:"添加海外仓商品",visible:t.isDlgShow,"close-on-click-modal":!1,customFooter:"",height:"500px",width:"700px"},on:{"update:visible":function(e){t.isDlgShow=e}}},[e("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"180px"}},[e("el-form-item",{attrs:{prop:"warehouseId",label:"海外仓：",rules:[{required:!0,message:"请选择海外仓",trigger:"blur"}]}},[e("ai-select",{attrs:{selectList:t.$dict.getDict("semi_warehouse"),size:"small"},on:{change:t.onWarehouseIdChange},model:{value:t.form.warehouseId,callback:function(e){t.$set(t.form,"warehouseId",e)},expression:"form.warehouseId"}})],1),e("el-form-item",{attrs:{prop:"productId",label:"海外仓产品：",rules:[{required:!0,message:"请选择海外仓产品",trigger:"blur"}]}},[e("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"small"},model:{value:t.form.productId,callback:function(e){t.$set(t.form,"productId",e)},expression:"form.productId"}},t._l(t.productList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{prop:"num",label:"数量：",rules:[{required:!0,message:"请输入数量",trigger:"blur"}]}},[e("el-input",{attrs:{size:"small",placeholder:"请输入数量"},model:{value:t.form.num,callback:function(e){t.$set(t.form,"num",e)},expression:"form.num"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isDlgShow=!1}}},[t._v("关 闭")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)],1)},g=[],b={name:"Detail",props:["params"],data(){return{search:{current:1,size:20},form:{warehouseId:null,productId:null,num:1},tableData:[],colConfigs:[{prop:"warehouseId",label:"海外仓名称",align:"left",format:t=>this.$dict.getLabel("semi_warehouse",t)},{prop:"skuName",label:"SKU名称",align:"left"},{prop:"productTitleEn",label:"产品名称英文",align:"left"},{prop:"productTitle",label:"产品名称",align:"left"},{prop:"declaredValue",label:"申报价值",align:"left"},{prop:"num",label:"数量",align:"left"},{prop:"createTime",label:"创建时间",align:"left"}],total:0,isDlgShow:!1,obj:null,productList:[]}},created(){this.$dict.load("semi_warehouse"),this.getDetail(),this.getList()},methods:{getDetail(){this.$http.post(`/api/semi/semiProduct/detail?sku=${this.params.id}`).then((t=>{0===t.code&&(this.obj={...t.data})}))},getList(){this.$http.post("/api/semi/semiProductDetail/page",null,{params:{...this.search,sku:this.params.id}}).then((t=>{this.tableData=t.data.records,this.total=t.data.total}))},cancel(t){this.$emit("change",{type:"List",isRefresh:!!t})},onWarehouseIdChange(t){this.productList=[],t&&this.$http.post("/api/semi/semiWarehouseProduct/list",null,{params:{warehouseId:t}}).then((t=>{0==t.code&&t.data.map((t=>{this.productList.push({value:t.id,label:t.sku+"("+t.productTitleEn+" - "+t.productTitle+")"})}))}))},toAdd(){this.isDlgShow=!0,this.form.productId=null,this.form.warehouseId=null,this.form.num=1},confirm(){this.$refs.form.validate((t=>{t&&this.$http.post("/api/semi/semiProductDetail/add",{...this.form,sku:this.params.id}).then((t=>{0===t.code&&(this.isDlgShow=!1,this.getList())}))}))},remove(t){this.$http.post(`/api/semi/semiProductDetail/del?id=${t}`).then((t=>{0===t.code&&this.getList()}))}}},v=b,k=(a(12748),(0,p.A)(v,f,g,!1,null,"27a726f5",null)),S=k.exports,C={name:"SemiProduct",label:"商品管理",components:{List:h,Detail:S},data(){return{component:"List",params:{}}},methods:{onChange(t){"Detail"===t.type&&(this.component="Detail",this.params=t.params),"List"===t.type&&(this.component="List",this.params=t.params,this.$nextTick((()=>{t.isRefresh&&setTimeout((()=>{this.$refs.component.getList()}),600)})))}}},w=C,x=(0,p.A)(w,s,l,!1,null,"07f35c4c",null),_=x.exports},46074:function(t,e,a){"use strict";a.r(e);var s=a(31601),l=a.n(s),i=a(76314),o=a.n(i),r=o()(l());r.push([t.id,'.productDetail[data-v-27a726f5] .el-dialog{height:78vh;overflow:auto}.time[data-v-27a726f5]{font-size:13px;color:#999}.bottom[data-v-27a726f5]{margin-top:13px;line-height:12px}.button[data-v-27a726f5]{padding:0;float:right}.image[data-v-27a726f5]{width:100%;display:block}.clearfix[data-v-27a726f5]:after,.clearfix[data-v-27a726f5]:before{display:table;content:""}.clearfix[data-v-27a726f5]:after{clear:both}.el-dropdown-link[data-v-27a726f5]{cursor:pointer;color:#409eff}.el-icon-arrow-down[data-v-27a726f5]{font-size:12px}',""]),e["default"]=r},12748:function(t,e,a){var s=a(46074);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);var l=a(99548).A;l("4936ff5a",s,!0,{sourceMap:!1,shadowMode:!1})}}]);