function matchSheinDomain(e){const t=/https:\/\/([\da-z\.-]+)\.shein\.com\/([\S.-]+)-p-([\S.-]+)/;return t.test(e)}function init(){if(window.location.href.startsWith("https://www.aliexpress.com/item/")){const e=document.createElement("div");e.innerText="下载图片";const t={position:"fixed",right:"10px",top:"60px",zIndex:9999,padding:"8px",background:"#409EFF",color:"#fff",borderRadius:"8px",cursor:"pointer"};for(const n in t)e.style[n]=t[n];e.addEventListener("click",(async()=>{let e=window.runParams.data,t=e.productInfoComponent.idStr;for(var n=[],i=[],o=document.querySelectorAll("#product-description img"),a=0;a<o.length;a++)n.push({type:0,index:a+1,src:o[a].src});for(var r=0;r<e.imageComponent.imagePathList.length;r++)n.push({type:1,index:r+1,src:e.imageComponent.imagePathList[r]});var d=document.querySelector("video");d&&n.push({type:2,index:1,src:d.src});for(var s=new JSZip,l=s.folder("轮播图"),p=s.folder("详情图"),g=s.folder("视频"),c=0;c<n.length;c++){let e=n[c].type,o=n[c].index;if(2==e){let a=new XMLHttpRequest;a.open("GET",n[c].src,!0),a.responseType="blob",a.onload=r=>{if(i.push({type:e,index:o,data:a.response}),i.length===n.length&&i.length>0){for(let e=0;e<i.length;e++)"0"==i[e].type?p.file(`详情图${i[e].index}.png`,i[e].data,{base64:!0}):"1"==i[e].type?l.file(`轮播图${i[e].index}.png`,i[e].data,{base64:!0}):"2"==i[e].type&&g.file("视频.mp4",i[e].data,{Blob:!0});s.generateAsync({type:"blob"}).then((function(e){saveAs(e,"aliexpress_"+t+".zip")}))}},a.send()}else{let a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){let r=document.createElement("canvas");r.width=a.width,r.height=a.height;let d=r.getContext("2d");d.drawImage(a,0,0,a.width,a.height);let c=r.toDataURL();if(r.toDataURL("image/png"),i.push({type:e,index:o,data:c.substring(22)}),i.length===n.length&&i.length>0){for(let e=0;e<i.length;e++)"0"==i[e].type?p.file(`详情图${i[e].index}.png`,i[e].data,{base64:!0}):"1"==i[e].type?l.file(`轮播图${i[e].index}.png`,i[e].data,{base64:!0}):"2"==i[e].type&&g.file("视频.mp4",i[e].data,{Blob:!0});s.generateAsync({type:"blob"}).then((function(e){saveAs(e,"aliexpress_"+t+".zip")}))}},a.src=n[c].src}}})),document.body.appendChild(e)}else if(window.location.href.startsWith("https://www.amazon.com/")){var e=document.getElementById("ATFCriticalFeaturesDataContainer").innerHTML;e=e.substring(e.indexOf("jQuery.parseJSON(")),e=e.substring(e.indexOf("(")),e=e.substring(2,e.indexOf("');"));let t=JSON.parse(e),n=t.colorImages;if(n){const e=document.createElement("div");e.innerText="下载图片";const t={position:"fixed",right:"10px",top:"60px",zIndex:9999,padding:"8px",background:"#409EFF",color:"#fff",borderRadius:"8px",cursor:"pointer"};for(const n in t)e.style[n]=t[n];e.addEventListener("click",(async()=>{var e=[],t=[],i=new JSZip,o=i.folder("轮播图"),a=i.folder("详情图");for(let l in n){let t=o.folder(l),i=n[l],a=0;for(let n in i){let o=i[n];o.hiRes&&e.push({type:1,index:++a,src:o.hiRes,folder:t})}}for(var r=document.querySelectorAll("div.aplus-v2 img"),d=0;d<r.length;d++)(r[d].getAttribute("data-src")||r[d].src)&&e.push({type:0,index:d+1,src:r[d].getAttribute("data-src")||r[d].src,folder:a});for(var s=0;s<e.length;s++){let n=e[s].type,o=e[s].index,a=e[s].folder,r=new Image;r.setAttribute("crossOrigin","anonymous"),r.onload=function(){let d=document.createElement("canvas");d.width=r.width,d.height=r.height;let s=d.getContext("2d");s.drawImage(r,0,0,r.width,r.height);let l=d.toDataURL();if(d.toDataURL("image/png"),t.push({type:n,index:o,folder:a,data:l.substring(22)}),t.length===e.length&&t.length>0){for(let e=0;e<t.length;e++)"0"==t[e].type?t[e].folder.file(`详情图${t[e].index}.png`,t[e].data,{base64:!0}):"1"==t[e].type&&t[e].folder.file(`轮播图${t[e].index}.png`,t[e].data,{base64:!0});i.generateAsync({type:"blob"}).then((function(e){saveAs(e,"amazon.zip")}))}},r.src=e[s].src}})),document.body.appendChild(e)}}else if(matchSheinDomain(window.location.href)){const e=document.createElement("div");e.innerText="下载图片";const t={position:"fixed",right:"10px",top:"60px",zIndex:9999,padding:"8px",background:"#409EFF",color:"#fff",borderRadius:"8px",cursor:"pointer"};for(const n in t)e.style[n]=t[n];e.addEventListener("click",(async()=>{var e=[],t=[];let n=1,i=1;e.push({type:0,index:n++,src:window.gbRawData.productIntroData.goods_imgs.main_image.origin_image});for(var o=window.gbRawData.productIntroData.goods_imgs.detail_image,a=0;a<o.length;a++)o[a].isMoreDetail?e.push({type:1,index:i++,src:o[a].origin_image}):e.push({type:0,index:n++,src:o[a].origin_image});document.querySelector("video");window.gbRawData.productIntroData.goods_imgs.video_url&&e.push({type:2,index:1,src:window.gbRawData.productIntroData.goods_imgs.video_url});for(var r=new JSZip,d=r.folder("轮播图"),s=r.folder("详情图"),l=r.folder("视频"),p=0;p<e.length;p++){let n=e[p].type,i=e[p].index;if(2==n){let o=new XMLHttpRequest;o.open("GET",e[p].src,!0),o.responseType="blob",o.onload=a=>{if(t.push({type:n,index:i,data:o.response}),t.length===e.length&&t.length>0){for(let e=0;e<t.length;e++)"0"==t[e].type?s.file(`详情图${t[e].index}.png`,t[e].data,{base64:!0}):"1"==t[e].type?d.file(`轮播图${t[e].index}.png`,t[e].data,{base64:!0}):"2"==t[e].type&&l.file("视频.mp4",t[e].data,{Blob:!0});r.generateAsync({type:"blob"}).then((function(e){saveAs(e,"shein_"+id+".zip")}))}},o.send()}else{let o=new Image;o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let a=document.createElement("canvas");a.width=o.width,a.height=o.height;let p=a.getContext("2d");p.drawImage(o,0,0,o.width,o.height);let g=a.toDataURL();if(a.toDataURL("image/png"),t.push({type:n,index:i,data:g.substring(22)}),t.length===e.length&&t.length>0){for(let e=0;e<t.length;e++)"0"==t[e].type?s.file(`详情图${t[e].index}.png`,t[e].data,{base64:!0}):"1"==t[e].type?d.file(`轮播图${t[e].index}.png`,t[e].data,{base64:!0}):"2"==t[e].type&&l.file("视频.mp4",t[e].data,{Blob:!0});r.generateAsync({type:"blob"}).then((function(e){saveAs(e,"shein_"+id+".zip")}))}},o.src=e[p].src}}})),document.body.appendChild(e)}}init();