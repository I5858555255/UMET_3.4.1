(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[1099],{71099:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"发货单列表",isShowBottomBorder:""},slot:"title"}),t("template",{slot:"content"},[t("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"发货单列表"}},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:e.orderList,"col-configs":e.colConfigs,height:"700"},on:{getList:()=>{}}},[t("el-table-column",{attrs:{slot:"options",label:"操作",width:"120px","show-overflow-tooltip":"",align:"center",fixed:"right"},slot:"options",scopedSlots:e._u([{key:"default",fn:function({row:o}){return[t("div",{staticClass:"table-options"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.downloadLabelInfo(o)}}},[e._v("下载标签信息")])],1)]}}])})],1)],1)],1)],2)},a=[],r=(o(44114),o(81454),o(14603),o(47566),o(98721),o(73236)),l=(o(31052),o(3959)),s=o(4213),n={name:"ReturnRecordShein",data(){return{isLoading:!1,storeCode:"",colConfigs:[{prop:"sellerDeliveryNo",label:"发货单号",align:"left"},{prop:"orderTypeName",label:"类型",align:"left"},{prop:"deliveryAmountAll",label:"送货总数",align:"left"},{prop:"expressName",label:"物流公司名称",align:"left"},{prop:"takeParcelStatusName",label:"状态"},{prop:"deliveryTime",label:"发货时间"}],reqData:{page:1,billStatusList:[],deliveryTimeEnd:null,deliveryTimeStart:null,deliveryTypeList:[],exportIds:[],expressCodeList:[],expressStatusList:[],orderTypeList:[],sellerDeliveryNoList:[],sellerOrderNoList:[],perPage:30},labelInfoList:[],orderList:[],sellerDeliveryNo:null}},mounted(){this.getStoreCode(),this.getList()},methods:{async getList(){this.isLoading=!0,this.reqData.page=1,this.tableData=[],this.orderList=[],await this.getOrderList(),this.isLoading=!1},async getOrderList(){let e=await(0,r.Rh)({url:"pfmp/delivery/list",method:"POST",data:this.reqData});if("0"==e.code)for(let t=0;t<e.info.data.length;t++){let o=e.info.data[t],i={id:o.id,sellerDeliveryNo:o.sellerDeliveryNo,orderTypeName:o.orderTypeName,deliveryAmountAll:o.deliveryAmountAll,expressName:o.expressName,takeParcelStatusName:o.takeParcelStatusName,deliveryTime:o.deliveryTime};this.orderList.push(i)}else 100004!=e.code&&20302!=e.code||this.$store.commit("setSheinAlertShow",!0)},async getStoreCode(){let e=await(0,r.Rh)({url:"sso-prefix/auth/getUser?uuid="+Date.now(),method:"GET"});"0"==e.code&&"OK"==e.msg?(this.storeCode=e.info.merchantCode,this.getSheinLabelList()):100004!=e.code&&20302!=e.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},getSheinLabelList(){this.$http.post("/api/sheinLabel/listAll",null,{params:{mallId:this.storeCode}}).then((e=>{0==e.code&&(this.labelInfoList=e.data)}))},async downloadLabelInfo(e){this.sellerDeliveryNo=e.sellerDeliveryNo;let t=await(0,r.Rh)({url:`pfmp/delivery/detail?id=${e.id}`,method:"GET"});if("0"==t.code&&"OK"==t.msg){let e=[];for(let a=0;a<t.info.orderList.length;a++){let o=t.info.orderList[a];for(let i=0;i<o.detail.length;i++)e.push({orderNo:o.sellerOrderNo,printNumber:o.detail[i].orderQuantity,skuCode:o.detail[i].skuCode,supplierId:t.info.sellerId,supplierCode:o.supplierCode,subSuffixZh:o.detail[i].subSuffixZh,skc:o.skcName})}let o=[];e.map((e=>{o.push({orderNo:e.orderNo,printNumber:e.printNumber,skuCode:e.skuCode,supplierId:e.supplierId})}));let i=await(0,r.Rh)({url:"pfmp/order/printOrderBarCode",method:"POST",data:{printList:o,type:3}});if("0"==i.code&&"OK"==i.msg){let t=i.info.sucessList;for(let i=0;i<t.length;i++)for(let o=0;o<e.length;o++)if(t[i].skuCode==e[o].skuCode&&t[i].orderNo==e[o].orderNo){t[i].skc=e[o].skc,t[i].printNumber=e[o].printNumber,t[i].subSuffixZh=e[o].subSuffixZh,t[i].supplierCode=e[o].supplierCode;break}const o=[["文件名","数量","SKC","SKU","型号","额定电压","额定电流","生产日期","保质期","SKC货号","产品编码","订单号","属性集","模板名称"]];for(let e=0;e<t.length;e++)for(let o=0;o<this.labelInfoList.length;o++)if(t[e].skc==this.labelInfoList[o].skc){t[e].model=this.labelInfoList[o].model,t[e].ratedVoltage=this.labelInfoList[o].ratedVoltage,t[e].ratedCurrent=this.labelInfoList[o].ratedCurrent,t[e].productDate=this.labelInfoList[o].productDate,t[e].warranty=this.labelInfoList[o].warranty,t[e].templateName=this.labelInfoList[o].templateName;break}t.map((e=>{o.push([e.skc+"_"+e.orderNo+"_"+e.skuCode,e.printNumber,e.skc,e.skuCode,e.model,e.ratedVoltage,e.ratedCurrent,e.productDate,e.warranty,e.supplierCode,e.barcode,e.orderNo,e.subSuffixZh,e.templateName])}));const a=l.Wp.aoa_to_sheet(o),r=l.Wp.book_new();l.Wp.book_append_sheet(r,a,"Sheet1");const n=l.M9(r,{bookType:"xlsx",type:"array"}),d=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),p=window.URL.createObjectURL(d);(0,s.saveAs)(d,this.sellerDeliveryNo+".xlsx"),window.URL.revokeObjectURL(p)}}}}},d=n,p=(o(453),o(81656)),c=(0,p.A)(d,i,a,!1,null,"43bcd74a",null),u=c.exports},56415:function(e,t,o){"use strict";o.r(t);var i=o(31601),a=o.n(i),r=o(76314),l=o.n(r),s=l()(a());s.push([e.id,".list .title-right[data-v-43bcd74a]{display:flex;align-items:center}.list .title-right>div[data-v-43bcd74a]:first-child{margin-right:20px}.list[data-v-43bcd74a].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),t["default"]=s},4213:function(e,t,o){var i,a,r;(function(o,l){a=[],i=l,r="function"===typeof i?i.apply(t,a):i,void 0===r||(e.exports=r)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,o){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){n(i.response,t,o)},i.onerror=function(){console.error("could not download file")},i.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,s=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,o){var s=l.URL||l.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin===location.origin?r(n):a(n.href)?i(e,t,o):r(n,n.target="_blank")):(n.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(n.href)}),4e4),setTimeout((function(){r(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,l){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,l),o);else if(a(e))i(e,o,l);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){r(s)}))}}:function(e,t,o,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,o);var r="application/octet-stream"===e.type,n=/constructor/i.test(l.HTMLElement)||l.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||r&&n||s)&&"undefined"!=typeof FileReader){var p=new FileReader;p.onloadend=function(){var e=p.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},p.readAsDataURL(e)}else{var c=l.URL||l.webkitURL,u=c.createObjectURL(e);a?a.location=u:location.href=u,a=null,setTimeout((function(){c.revokeObjectURL(u)}),4e4)}});l.saveAs=n.saveAs=n,e.exports=n}))},453:function(e,t,o){var i=o(56415);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var a=o(99548).A;a("0dd9377c",i,!0,{sourceMap:!1,shadowMode:!1})}}]);