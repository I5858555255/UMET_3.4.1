"use strict";(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[1756],{31756:function(n,e,r){r.d(e,{Ay:function(){return Ge}});var t=r(85471),i=r(95353),o=function(n){var e=n.name,r=n.attachment,t=n.info;this.name=e,this.attachment=r,this.info=t};t["default"].use(i.Ay);var s=new i.Ay.Store({state:{resourceIdOfActiveFrame:"",history:[],isGloballyReadonly:!1},getters:{},mutations:{addEvent:function(n,e){var r=e.name,t=e.attachment,i=e.info;n.history.push(new o({name:r,attachment:t,info:i}))},delLastEvent:function(n){n.history.pop()}},actions:{popEvent:function(n){var e=n.state,r=n.commit,t=e.history[e.history.length-1];return t&&r("delLastEvent"),t}},modules:{}}),a={PIC:"PIC",VIDEO:"VIDEO",FILE:"FILE",HTML:"HTML"},l=32,d=150,c=12,A="请输入文字",h='"Microsoft YaHei"',u=.02,p=16,f=function(n){var e=n.id;this.id=e},m={uuidv4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var e=16*Math.random()|0;return("x"==n?e:3&e|8).toString(16)}))}},g=function(n){function e(e){var r=e.parentId;void 0===r&&(r=null);var t=e.top;void 0===t&&(t=0);var i=e.left;void 0===i&&(i=0);var o=e.width;void 0===o&&(o=0);var s=e.height;void 0===s&&(s=0);var a=e.orderNo;void 0===a&&(a=1);var l=e.isFolded;void 0===l&&(l=!1);var d=e.isReadonly;void 0===d&&(d=!1);var c=e.extra;void 0===c&&(c={});var A=e.calcCellSize;void 0===A&&(A=async function(){});var h=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["parentId","top","left","width","height","orderNo","isFolded","isReadonly","extra","calcCellSize"]);h.id||(h.id=m.uuidv4()),n.call(this,h),this.children=[],this.parentNode=null,this.parentId=r,this.top=t,this.left=i,this.width=o,this.height=s,this.orderNo=a,this.isFolded=l,this.isReadonly=d,this.extra=c,this._calcCellSize=A}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var r={topPadding:{configurable:!0},bottomPadding:{configurable:!0},lrPadding:{configurable:!0},borderWidth:{configurable:!0}};return r.topPadding.get=function(){return 0},r.bottomPadding.get=function(){return 0},r.lrPadding.get=function(){return 0},r.borderWidth.get=function(){return 3},e.prototype.calcCellSize=async function(n){return await this._calcCellSize(n)},Object.defineProperties(e.prototype,r),e}(f),v=function(n){function e(e){var r=e.levelNo,t=e.siblingNo,i=e.descendantMaxOccupiedPx,o=e.isSelfHeightBigger;void 0===o&&(o=!1);var s=e.selfHeightBiggerSize,a=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["levelNo","siblingNo","descendantMaxOccupiedPx","isSelfHeightBigger","selfHeightBiggerSize"]);n.call(this,a),this.levelNo=r,this.siblingNo=t,this.descendantMaxOccupiedPx=i,this.isSelfHeightBigger=o,this.selfHeightBiggerSize=s}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(g),b=function(n){function e(e){var r=e.node1,t=e.node2,i=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["node1","node2"]);n.call(this,i),this.node1=r,this.node2=t}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(f),C={arrayToTree:function(n,e,r,t,i,o){var s,a,l;void 0===e&&(e="parentId"),void 0===r&&(r="children"),void 0===t&&(t="id"),void 0===o&&(o=!1);var d=[],c={};for(var A of n){i&&i(A);var h=A[t],u=A[e];c[h]||(c[h]=((s={})[r]=[],s)),c[h]=Object.assign({},A,((a={})[r]=c[h][r],a));var p=c[h];if(null==u||""===u){if(d.push(p),!o&&d.length>1)throw new Error("不能多于一个根节点")}else c[u]||(c[u]=((l={})[r]=[],l)),c[u][r].push(p)}return{tree:d,map:c}},recurveTree:function n(e,r,t,i){for(var o of(void 0===e&&(e=[]),void 0===t&&(t="children"),void 0===i&&(i=null),e))r(o,i),o[t]&&o[t].length&&n(o[t],r,t,o)},loopEveryLevelOfTree:function(n,e,r,t){if(void 0===n&&(n=[]),void 0===e&&(e="children"),n)for(var i=n.slice(),o=0;;){o++;var s=i.length;if(0===s)break;for(;s--;){var a=i.shift();r(o,a);var l=!0;if(t&&(l=!0===t(o,a)),l&&a[e]&&a[e].length)for(var d=0;d<a[e].length;d++)i.push(a[e][d])}}}},w=24,x=4;function k(n){var e,r,t,i,o,s=n.node;return n.isHorizontal?(t=(o=w)+100,i=s.height+2*l,e=s.width-o,r=-l):(o=x,t=s.width+c,i=o+100,e=-c/2,r=s.height-o),{zoneWidth:t,zoneHeight:i,zoneMinX:s.left+e,zoneMinY:s.top+r}}var E={calcNodesPos:function(n){var e=n.flatNodes,r=n.isHorizontal;void 0===r&&(r=!0);var t=C.arrayToTree(e,"parentId","children","id",(function(n){n.isVisible=!0,n.allSubsCount=0}),!1),i=t.tree,o=t.map;C.recurveTree(i,(function(n){n.children&&n.children.length>1&&n.children.sort((function(n,e){return n.orderNo-e.orderNo}));for(var e=0;e<n.children.length;e++)n.children[e].orderNo=e+1}));var s=0,a={};C.loopEveryLevelOfTree(i,"children",(function(n,e){n>s&&(s=n),a[n]||(a[n]=[]),a[n].push(e)}));for(var l=s;l>0;l--){var d=a[l];for(var A of d)A.parentId&&(o[A.parentId].allSubsCount+=A.allSubsCount+1)}var h=0,u={};C.loopEveryLevelOfTree(i,"children",(function(n,r){n>h&&(h=n),r.levelNo=n,u[n]||(u[n]=[]),u[n].push(r),r.isFolded&&(C.recurveTree(r.children,(function(n){var r=e.find((function(e){return e.id===n.id}));r&&(r.isVisible=!1)})),r.children=[])}));for(var p=h;p>0;p--){var f=u[p];for(var m of f)if(m.children&&0!==m.children.length){var g=0;m.children.forEach((function(n){g+=n.descendantMaxOccupiedPx})),g+=c*(m.children.length-1),r?m.height<=g?m.descendantMaxOccupiedPx=g:(m.descendantMaxOccupiedPx=m.height,m.isSelfHeightBigger=!0,m.selfHeightBiggerSize=m.height-g):m.width<=g?m.descendantMaxOccupiedPx=g:(m.descendantMaxOccupiedPx=m.width,m.isSelfHeightBigger=!0,m.selfHeightBiggerSize=m.width-g)}else m.descendantMaxOccupiedPx=r?m.height:m.width}C.recurveTree(i,(function(n,e){var t,i;n.parentNode=e,r?(t=e?e.left+e.width+48:0,n.left=t):(i=e?e.top+e.height+48:0,n.top=i)}));for(var v=1;v<=h;v++){var w=u[v],x=new Map;for(var k of w){var E=k.parentNode?k.parentNode.id:"ROOT_NODES";x.has(E)||x.set(E,[]),x.get(E).push(k)}for(var[y,S]of x){var B=0;if(r)for(var N of S){var M=void 0;N.parentNode?(M=N.parentNode.isSelfHeightBigger?N.descendantMaxOccupiedPx/2-N.height/2+N.parentNode.selfHeightBiggerSize/2+B:N.descendantMaxOccupiedPx/2-N.height/2+B,M+=N.parentNode.top+N.parentNode.height/2-N.parentNode.descendantMaxOccupiedPx/2):M=N.descendantMaxOccupiedPx/2-N.height/2+B,N.top=M,B+=c+N.descendantMaxOccupiedPx}else for(var I of S){var D=void 0;I.parentNode?(D=I.parentNode.isSelfHeightBigger?I.descendantMaxOccupiedPx/2-I.width/2+I.parentNode.selfHeightBiggerSize/2+B:I.descendantMaxOccupiedPx/2-I.width/2+B,D+=I.parentNode.left+I.parentNode.width/2-I.parentNode.descendantMaxOccupiedPx/2):D=I.descendantMaxOccupiedPx/2-I.width/2+B,I.left=D,B+=c+I.descendantMaxOccupiedPx}}}var L=[];return C.recurveTree(i,(function(n,r){if(r){var t=new b({node1:r,node2:n});L.push(t)}var i=e.find((function(e){return e.id===n.id})),o=n.top,s=n.left,a=n.levelNo,l=n.siblingNo,d=n.descendantMaxOccupiedPx,c=n.allSubsCount,A=n.orderNo;i.top=o,i.left=s,i.levelNo=a,i.siblingNo=l,i.descendantMaxOccupiedPx=d,i.allSubsCount=c,i.orderNo=A})),{links:L,tree:i}},calcNodesScope:function(n){var e,r=n.tree,t=n.nodeId,i=n.isHorizontal;void 0===i&&(i=!0),C.recurveTree(r,(function(n){t?t===n.id&&(e=n):n.parentId||(e=n)}));var o=[],s=[],a=[],l=[],d=[];e&&C.recurveTree([e],(function(n){o.push(n.left),s.push(n.top);var e=n.left+n.width,r=n.top+n.height;n.isFolded&&i&&(e+=32),n.isFolded&&!i&&(r+=32),a.push(e),l.push(r),d.push(n)}));var c=1/0,A=1/0,h=0,u=0;return o.forEach((function(n){c>n&&(c=n)})),s.forEach((function(n){A>n&&(A=n)})),a.forEach((function(n){h<n&&(h=n)})),l.forEach((function(n){u<n&&(u=n)})),{minX:c,minY:A,maxX:h,maxY:u,nodes:d}},calcNodesOffspringDropAllowZones:function(n){var e=n.flatNodes,r=n.isHorizontal;for(var t of e){var i=k({node:t,isHorizontal:r}),o=i.zoneWidth,s=i.zoneHeight,a=i.relativeLeft,l=i.relativeTop,d=i.zoneMinX,c=i.zoneMinY;t.dropZoneRelativeLeft=a,t.dropZoneRelativeTop=l,t.dropZoneWidth=o,t.dropZoneHeight=s,t.dropZoneMinX=d,t.dropZoneMinY=c}},calcNodeDropAllowZone:k,calcSiblingDropAllowZoneBetween2Nodes:function(n){var e,r,t,i,o,s=n.node1,a=n.node2;return n.isHorizontal?(o=w,e=s.width-o,i=s.top+s.height,r=a.top-i,t=s.left):(o=x,r=s.height-o,t=s.left+s.width,e=a.left-t,i=s.top),{zoneWidth:e,zoneHeight:r,zoneMinX:t,zoneMinY:i}},calcFirstSiblingDropAllowZone:function(n){var e,r,t,i,o,s=n.firstNode;return n.isHorizontal?(o=w,e=s.width-o,r=100,t=s.left,i=s.top-r):(o=x,e=100,r=s.height-o,t=s.left-e,i=s.top),{zoneWidth:e,zoneHeight:r,zoneMinX:t,zoneMinY:i}},calcLastSiblingDropAllowZone:function(n){var e,r,t,i,o,s=n.lastNode;return n.isHorizontal?(o=w,e=s.width-o,r=100,t=s.left,i=s.top+s.height):(o=x,e=100,r=s.height-o,t=s.left+s.width,i=s.top),{zoneWidth:e,zoneHeight:r,zoneMinX:t,zoneMinY:i}},calcNodeOrder:function(n){var e=n.node,r=n.tree,t=-1;if(C.recurveTree(r,(function(n,r){n.id===e.id&&(t=r.children.findIndex((function(n){return n.id===e.id})))})),t>-1)return t+1;throw new Error("在树型节点数据中找不到子节点")},calcNodeChildrenCount:function(n){var e=n.node,r=n.tree,t=-1;if(C.recurveTree(r,(function(n){n.id===e.id&&(t=n.children.length)})),t>-1)return t;throw new Error("在树型节点数据中找不到目标节点")},findNodeFromTree:function(n,e){var r;return C.recurveTree(e,(function(e){e.id===n&&(r=e)})),r},findFamilyNodesByParentId:function(n,e){var r;C.recurveTree(e,(function(e){e.id===n&&(r=e)}));var t=[];return r&&(t.push(r),C.recurveTree(r.children,(function(n){t.push(n)}))),t},fontStyleToPureCss:function(n){void 0===n&&(n={});var e={};return n.bold&&(e["font-weight"]="bold"),n.italic&&(e["font-style"]="italic"),n.underline&&(e["text-decoration"]="underline"),n.color&&(e["background-color"]=n.color),e},findAllVisibleNodesAtScope:function(n){n.startX,n.startY,n.endX,n.endY},findAllAncestors:function(n,e){for(var r=[],t=e.parentId;t;){var i=n.find((function(n){return n.id===t}));i&&(r.push(i),t=i.parentId)}return r}},y={pxSize:function(n){var e=n.text,r=n.fontFamily,t=n.fontSize,i=n.fontStyle,o=n.maxContentWidth;void 0===o&&(o="300px");var s=document.createElement("div");s.style.width=o;var a=document.createElement("span");a.style.fontFamily=r,a.style.fontSize=t;var l=E.fontStyleToPureCss(i);for(var d in l)if(Object.hasOwnProperty.call(l,d)){var c=l[d];a.style[d]=c}a.innerHTML=e;var A=document.createElement("div");A.style.display="inline-block",A.style.width="1px",A.style.height="0px",s.style.height="0px",s.style.overflow="hidden",s.appendChild(a),s.appendChild(A),window.document.body.appendChild(s);var h=a.getBoundingClientRect(),u=h.width,p=h.height;return window.document.body.removeChild(s),{textWidth:u,textHeight:p}}},S=function(n){function e(e){var r=e.type,t=e.mimeType,i=e.url;void 0===i&&(i="");var o=e.title,s=e.size,l=e.htmlContent,d=e.icon,c=e.contentWidth,A=e.contentHeight,h=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["type","mimeType","url","title","size","htmlContent","icon","contentWidth","contentHeight"]);h.id||(h.id=m.uuidv4()),n.call(this,h),this.type=r,this.url=i,this.title=o,this.size=s,this.htmlContent=l,this.contentWidth=c||0,this.contentHeight=A||0,this.type!==a.VIDEO||t||(this.mimeType="video/mp4"),d&&(this.icon=d)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(f),B=function(n){var e=n.bold;void 0===e&&(e=!1);var r=n.italic;void 0===r&&(r=!1);var t=n.underline;void 0===t&&(t=!1);var i=n.color;void 0===i&&(i=""),this.bold=e,this.italic=r,this.underline=t,this.color=i},N=function(n){function e(e){var r=e.title;void 0===r&&(r="");var t=e.titleWidth,i=e.titleHeight,o=e.fontSize;void 0===o&&(o=14);var s=e.fontFamily;void 0===s&&(s=h);var a=e.fontStyle;void 0===a&&(a=new B({}));var l=e.allSubsCount;void 0===l&&(l=0);var d=e.resources;void 0===d&&(d=[]);var c=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["title","titleWidth","titleHeight","fontSize","fontFamily","fontStyle","allSubsCount","resources"]);n.call(this,c),this.title=r,this.titleWidth=t||0,this.titleHeight=i||0,this.fontSize=o,this.fontFamily=s,this.fontStyle=new B(Object.assign({},a)),this.allSubsCount=l,this.resources=this._handleResource(d),this.isVisible=!0,this.dropZoneMinX=0,this.dropZoneMinY=0,this.dropZoneRelativeLeft=0,this.dropZoneRelativeTop=0,this.dropZoneWidth=0,this.dropZoneHeight=0}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var r={font:{configurable:!0},topPadding:{configurable:!0},bottomPadding:{configurable:!0},lrPadding:{configurable:!0},borderWidth:{configurable:!0}};return r.font.get=function(){return this.fontSize+"px "+this.fontFamily},r.topPadding.get=function(){return this._hasResources(),0},r.bottomPadding.get=function(){return this._hasResources()?8:0},r.lrPadding.get=function(){return this._hasResources()?8:16},r.borderWidth.get=function(){return this._hasResources(),3},e.prototype._handleResource=function(n){var e=[];for(var r of n)r instanceof S?e.push(r):e.push(new S(r));return e},e.prototype._hasResources=function(){return!!this.resources.length},e.prototype.calcCellSize=async function(){var n=this;return new Promise((function(e,r){var t;t=n.title?n.title:n._hasResources()?"":A;var i=y.pxSize({text:t,fontFamily:n.fontFamily,fontSize:n.fontSize+"px",fontStyle:n.fontStyle,maxContentWidth:"300px"}),o=i.textWidth,s=i.textHeight;if(n.titleWidth=o,n.titleHeight=s<=l?l:s,n._hasResources()){var c=n.titleHeight+2*n.borderWidth+n.topPadding+n.bottomPadding;if(1===n.resources.length){var h=n.resources[0];switch(h.type){case a.PIC:if(h.contentWidth||h.contentHeight)h.contentWidth&&h.contentHeight?(n.height=h.contentHeight+c,n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e()):e();else{var u=new Image;u.src=h.url,u.onload=function(){var r,t,i=u.naturalWidth/u.naturalHeight;i>=1?r=(t=200)/i:t=(r=200)*i,h.contentWidth=t,h.contentHeight=r,n.height=r+c,n.titleWidth>t?n.width=n.titleWidth+2*n.borderWidth+2*n.lrPadding:n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e()},u.onerror=function(n){r(n)}}break;case a.VIDEO:var p;h.contentWidth||h.contentHeight?h.contentWidth&&h.contentHeight?(n.height=h.contentHeight+c,n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e()):e():(p=440/3,h.contentHeight=p,h.contentWidth=220,n.height=p+c,n.titleWidth>220?n.width=n.titleWidth+2*n.borderWidth+2*n.lrPadding:n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e());break;case a.FILE:h.contentWidth||h.contentHeight?h.contentWidth&&h.contentHeight?(n.height=h.contentHeight+c,n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e()):e():(h.contentHeight=60,h.contentWidth=220,n.height=60+c,n.titleWidth>220?n.width=n.titleWidth+2*n.borderWidth+2*n.lrPadding:n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e());break;case a.HTML:var f;h.contentWidth||h.contentHeight?h.contentWidth&&h.contentHeight?(n.height=h.contentHeight+c,n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e()):e():(f=440/3,h.contentHeight=f,h.contentWidth=220,n.height=f+c,n.titleWidth>220?n.width=n.titleWidth+2*n.borderWidth+2*n.lrPadding:n.width=h.contentWidth+2*n.borderWidth+2*n.lrPadding,e());break;default:e()}}else{var m,g=Math.ceil(n.resources.length/3);m=g>1?3:n.resources.length,n.width=2*n.borderWidth+2*n.lrPadding+d*m+8*(m-1),n.height=c+d*g+8*(g-1),e()}}else n.width=n.titleWidth+2*n.borderWidth+2*n.lrPadding,n.height=n.titleHeight+2*n.borderWidth+n.topPadding+n.bottomPadding,e()}))},Object.defineProperties(e.prototype,r),e}(v),M=function(n){function e(e){var r=e.width;void 0===r&&(r=100);var t=e.height;void 0===t&&(t=32);var i=e.redefineSubCount;void 0===i&&(i=0);var o=function(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&-1===e.indexOf(t)&&(r[t]=n[t]);return r}(e,["width","height","redefineSubCount"]);n.call(this,Object.assign({},{width:r,height:t},o)),this.redefineSubCount=i}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(v),I={selectLocalFiles:async function(n){var e=n.fileAccept;void 0===e&&(e="*");var r=n.multiple;return void 0===r&&(r=!1),new Promise((function(n){var t=document.createElement("input");t.type="file",t.multiple=r,t.accept=e,t.addEventListener("change",(function(e){var r=e.target.files;n(r)})),t.click()}))},fileToImgDataUrl:async function(n){return new Promise((function(e){var r=new FileReader;r.onload=function(){e(r.result)},r.readAsDataURL(n)}))},fileToObjUrl:function(n){return URL.createObjectURL(n)},formatFileSize:function(n,e,r){var t;for(void 0===e&&(e=2),void 0===r&&(r=["B","KB","MB","GB","TB"]);(t=r.shift())&&n>=1024;)n/=1024;return("B"===t?n:n.toFixed(e))+t}},D={easeLinear:function(n,e,r,t){return r*n/t+e},easeInOutQuad:function(n,e,r,t){return(n/=t/2)<1?r/2*n*n+e:-r/2*(--n*(n-2)-1)+e}},L={props:{moreBtns:{type:Array,default:function(){return["DELETE"]}}}};function F(n,e,r,t,i,o,s,a,l,d){"boolean"!=typeof s&&(l=a,a=s,s=!1);var c,A="function"==typeof r?r.options:r;if(n&&n.render&&(A.render=n.render,A.staticRenderFns=n.staticRenderFns,A._compiled=!0,i&&(A.functional=!0)),t&&(A._scopeId=t),o?(c=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),e&&e.call(this,l(n)),n&&n._registeredComponents&&n._registeredComponents.add(o)},A._ssrRegister=c):e&&(c=s?function(n){e.call(this,d(n,this.$root.$options.shadowRoot))}:function(n){e.call(this,a(n))}),c)if(A.functional){var h=A.render;A.render=function(n,e){return c.call(e),h(n,e)}}else{var u=A.beforeCreate;A.beforeCreate=u?[].concat(u,c):[c]}return r}var _,z="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function T(n){return function(n,e){return function(n,e){var r=z?e.media||"default":n,t=R[r]||(R[r]={ids:new Set,styles:[]});if(!t.ids.has(n)){t.ids.add(n);var i=e.source;if(e.map&&(i+="\n/*# sourceURL="+e.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),t.element||(t.element=document.createElement("style"),t.element.type="text/css",e.media&&t.element.setAttribute("media",e.media),void 0===_&&(_=document.head||document.getElementsByTagName("head")[0]),_.appendChild(t.element)),"styleSheet"in t.element)t.styles.push(i),t.element.styleSheet.cssText=t.styles.filter(Boolean).join("\n");else{var o=t.ids.size-1,s=document.createTextNode(i),a=t.element.childNodes;a[o]&&t.element.removeChild(a[o]),a.length?t.element.insertBefore(s,a[o]):t.element.appendChild(s)}}}(n,e)}}var R={},P=L,O=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"more"},[r("div",{staticClass:"row",on:{click:function(e){return n.$emit("delete")}}},[r("span",{staticClass:"content"},[n._v("删除")])])])};O._withStripped=!0;var H=F({render:O,staticRenderFns:[]},(function(n){n&&n("data-v-05247722_0",{source:".more[data-v-05247722] {\n  position: absolute;\n  bottom: 30px;\n  left: 50%;\n  width: 100px;\n  border: 1px solid #dddddd;\n  transform: translateX(-50%);\n  background-color: #fff;\n  color: #666666;\n  border-radius: 4px;\n  z-index: 1999;\n}\n.more .row[data-v-05247722] {\n  box-sizing: border-box;\n  height: 32px;\n  padding: 0 12px;\n}\n.more .row[data-v-05247722]:hover {\n  background-color: #eeeeee;\n}\n\n/*# sourceMappingURL=More.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\NodeOperation\\More.vue","More.vue"],names:[],mappings:"AA+BA;EACA,kBAAA;EACA,YAAA;EACA,SAAA;EAEA,YAAA;EAEA,yBAAA;EACA,2BAAA;EACA,sBAAA;EACA,cAAA;EACA,kBAAA;EACA,aAAA;AChCA;ADkCA;EACA,sBAAA;EACA,YAAA;EACA,eAAA;AChCA;ADkCA;EACA,yBAAA;AChCA;;AAEA,mCAAmC",file:"More.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-12-29 14:31:12\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-21 10:29:02\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="more">\r\n    <div class="row" @click="$emit(\'delete\')">\r\n      <span class="content">删除</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n// import NormalNode from "../../../../entities/NormalNode.js";\r\n// import CustomizedNode from "../../../../entities/CustomizedNode.js";\r\n\r\nexport default {\r\n  props: {\r\n    moreBtns: {\r\n      type: Array,\r\n      default: () => ["DELETE"],\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.more {\r\n  position: absolute;\r\n  bottom: 30px;\r\n  left: 50%;\r\n\r\n  width: 100px;\r\n  // height: 100px;\r\n  border: 1px solid $grey-color-light2;\r\n  transform: translateX(-50%);\r\n  background-color: #fff;\r\n  color: $grey-color-dark;\r\n  border-radius: 4px;\r\n  z-index: 1999;\r\n\r\n  .row {\r\n    box-sizing: border-box;\r\n    height: 32px;\r\n    padding: 0 12px;\r\n\r\n    &:hover {\r\n      background-color: $grey-color-light;\r\n    }\r\n  }\r\n}\r\n</style>',".more {\n  position: absolute;\n  bottom: 30px;\n  left: 50%;\n  width: 100px;\n  border: 1px solid #dddddd;\n  transform: translateX(-50%);\n  background-color: #fff;\n  color: #666666;\n  border-radius: 4px;\n  z-index: 1999;\n}\n.more .row {\n  box-sizing: border-box;\n  height: 32px;\n  padding: 0 12px;\n}\n.more .row:hover {\n  background-color: #eeeeee;\n}\n\n/*# sourceMappingURL=More.vue.map */"]},media:void 0})}),P,"data-v-05247722",!1,void 0,!1,T,void 0,void 0),W={props:{tipsContent:{type:String,required:!0},translateX:{type:String,default:"-50%"}},data:function(){return{fontSize:12}},computed:{tipsContentLength:function(){return this.tipsContent.length}}},V=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"tips",style:{"font-size":n.fontSize+"px",width:n.fontSize*n.tipsContentLength+"px",transform:"translateX("+n.translateX+")"}},[r("span",{staticClass:"content"},[n._v(n._s(n.tipsContent))])])};V._withStripped=!0;var $=F({render:V,staticRenderFns:[]},(function(n){n&&n("data-v-bac3a316_0",{source:".tips[data-v-bac3a316] {\n  position: absolute;\n  box-sizing: content-box;\n  height: 12px;\n  line-height: 12px;\n  background-color: #2b2f36;\n  bottom: 30px;\n  left: 50%;\n  color: #fff;\n  padding: 6px;\n  overflow: hidden;\n  border-radius: 4px;\n  z-index: 2000;\n}\n\n/*# sourceMappingURL=Tips.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Common\\Tips.vue","Tips.vue"],names:[],mappings:"AAuCA;EAIA,kBAAA;EACA,uBAAA;EACA,YALA;EAMA,iBANA;EAOA,yBANA;EAOA,YAAA;EACA,SAAA;EAEA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,kBAAA;EAEA,aAAA;AC3CA;;AAEA,mCAAmC",file:"Tips.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-12-29 11:53:20\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-01-09 09:32:44\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    class="tips"\r\n    :style="{\r\n      \'font-size\': fontSize + \'px\',\r\n      width: fontSize * tipsContentLength + \'px\',\r\n      transform: `translateX(${translateX})`,\r\n    }"\r\n  >\r\n    <span class="content">{{ tipsContent }}</span>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    tipsContent: { type: String, required: true },\r\n    translateX: { type: String, default: "-50%" },\r\n  },\r\n  data() {\r\n    return {\r\n      fontSize: 12,\r\n    };\r\n  },\r\n  computed: {\r\n    tipsContentLength: function () {\r\n      return this.tipsContent.length;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.tips {\r\n  $tips-height: 12px;\r\n  $main-bg-color: #2b2f36;\r\n\r\n  position: absolute;\r\n  box-sizing: content-box;\r\n  height: $tips-height;\r\n  line-height: $tips-height;\r\n  background-color: $main-bg-color;\r\n  bottom: 30px;\r\n  left: 50%;\r\n  // transform: translateX(-50%);\r\n  color: #fff;\r\n  padding: 6px;\r\n  overflow: hidden;\r\n  border-radius: 4px;\r\n\r\n  z-index: 2000;\r\n}\r\n</style>',".tips {\n  position: absolute;\n  box-sizing: content-box;\n  height: 12px;\n  line-height: 12px;\n  background-color: #2b2f36;\n  bottom: 30px;\n  left: 50%;\n  color: #fff;\n  padding: 6px;\n  overflow: hidden;\n  border-radius: 4px;\n  z-index: 2000;\n}\n\n/*# sourceMappingURL=Tips.vue.map */"]},media:void 0})}),W,"data-v-bac3a316",!1,void 0,!1,T,void 0,void 0),Y={components:{Tips:$},props:{isAvalible:{type:Boolean,default:!1},isTipsAvalible:{type:Boolean,default:!0},imgSrc:{type:String,required:!0},btnName:{type:String,required:!0},hoverTips:{type:String,required:!0},imgStyle:{type:Object,default:function(){}}},data:function(){return{isHovering:!1}},methods:{onBtnClick:function(){this.$emit("btn-click",this.btnName)},onBtnMouseEnter:function(){this.isHovering=!0},onBtnMouseLeave:function(){this.isHovering=!1}}},U=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.isAvalible?r("div",{staticClass:"btn",on:{click:function(e){return e.stopPropagation(),n.onBtnClick.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),n.onBtnMouseEnter.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),n.onBtnMouseLeave.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",style:n.imgStyle,attrs:{src:n.imgSrc}}),n._v(" "),n.isTipsAvalible&&n.isHovering?r("Tips",{attrs:{tipsContent:n.hoverTips}}):n._e(),n._v(" "),n._t("default")],2):n._e()};U._withStripped=!0;var G=F({render:U,staticRenderFns:[]},(function(n){n&&n("data-v-30ae1e9e_0",{source:".btn[data-v-30ae1e9e] {\n  position: relative;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  color: #fff;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn[data-v-30ae1e9e]:hover {\n  background-color: #555d6b;\n  border-radius: 4px;\n}\n.btn .btn-img[data-v-30ae1e9e] {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Btn.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\NodeOperation\\Btn.vue","Btn.vue"],names:[],mappings:"AAuDA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,WAAA;EACA,iBAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;ACtDA;ADwDA;EACA,yBAAA;EACA,kBAAA;ACtDA;ADyDA;EACA,WAAA;EACA,YAAA;ACvDA;;AAEA,kCAAkC",file:"Btn.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-08 14:54:16\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-23 12:07:09\r\n * @Description: 请输入\r\n--\x3e\r\n \r\n<template>\r\n  <div\r\n    v-if="isAvalible"\r\n    class="btn"\r\n    @click.stop="onBtnClick"\r\n    @mouseenter.stop="onBtnMouseEnter"\r\n    @mouseleave.stop="onBtnMouseLeave"\r\n  >\r\n    <img class="btn-img" :src="imgSrc" :style="imgStyle" />\r\n    <Tips v-if="isTipsAvalible && isHovering" :tipsContent="hoverTips" />\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Tips from "../../Common/Tips.vue";\r\n\r\nexport default {\r\n  components: { Tips },\r\n  props: {\r\n    isAvalible: { type: Boolean, default: false },\r\n    isTipsAvalible: { type: Boolean, default: true },\r\n    imgSrc: { type: String, required: true },\r\n    btnName: { type: String, required: true },\r\n    hoverTips: { type: String, required: true },\r\n    imgStyle: { type: Object, default: () => {} },\r\n  },\r\n  data() {\r\n    return {\r\n      isHovering: false,\r\n    };\r\n  },\r\n  methods: {\r\n    onBtnClick() {\r\n      this.$emit("btn-click", this.btnName);\r\n    },\r\n    onBtnMouseEnter() {\r\n      this.isHovering = true;\r\n    },\r\n    onBtnMouseLeave() {\r\n      this.isHovering = false;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../../scss/_variables.scss";\r\n\r\n.btn {\r\n  position: relative;\r\n  width: 24px;\r\n  height: 24px;\r\n  cursor: pointer;\r\n  color: #fff;\r\n  user-select: none;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  &:hover {\r\n    background-color: $btn-second-bg-color;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .btn-img {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>',".btn {\n  position: relative;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  color: #fff;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn:hover {\n  background-color: #555d6b;\n  border-radius: 4px;\n}\n.btn .btn-img {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Btn.vue.map */"]},media:void 0})}),Y,"data-v-30ae1e9e",!1,void 0,!1,T,void 0,void 0),j={components:{Tips:$},props:{btnName:{type:String,required:!0},hoverTips:{type:String,required:!0},color:{type:String}},data:function(){return{isHovering:!1}},methods:{onBtnClick:function(){this.$emit("btn-click",this.btnName)},onBtnMouseEnter:function(){this.isHovering=!0},onBtnMouseLeave:function(){this.isHovering=!1}}},X=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"btn-color",on:{click:function(e){return e.stopPropagation(),n.onBtnClick.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),n.onBtnMouseEnter.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),n.onBtnMouseLeave.apply(null,arguments)}}},[r("div",{staticClass:"btn-core",style:{"background-color":n.color}}),n._v(" "),n.isHovering?r("Tips",{attrs:{tipsContent:n.hoverTips}}):n._e()],1)};X._withStripped=!0;var Q={components:{Btn:G,BtnColor:F({render:X,staticRenderFns:[]},(function(n){n&&n("data-v-3f22ed18_0",{source:".btn-color[data-v-3f22ed18] {\n  position: relative;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-color .btn-core[data-v-3f22ed18] {\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n}\n.btn-color[data-v-3f22ed18]:hover {\n  background-color: #555d6b;\n  border-radius: 4px;\n}\n.btn-color .btn-img[data-v-3f22ed18] {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=BtnColor.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\NodeOperation\\BtnColor.vue","BtnColor.vue"],names:[],mappings:"AA0CA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;ACzCA;AD2CA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;ACzCA;AD4CA;EACA,yBAAA;EACA,kBAAA;AC1CA;AD6CA;EACA,WAAA;EACA,YAAA;AC3CA;;AAEA,uCAAuC",file:"BtnColor.vue",sourcesContent:['<template>\r\n  <div\r\n    class="btn-color"\r\n    @click.stop="onBtnClick"\r\n    @mouseenter.stop="onBtnMouseEnter"\r\n    @mouseleave.stop="onBtnMouseLeave"\r\n  >\r\n    <div class="btn-core" :style="{ \'background-color\': color }"></div>\r\n    <Tips v-if="isHovering" :tipsContent="hoverTips" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport Tips from "../../Common/Tips.vue";\r\n\r\nexport default {\r\n  components: { Tips },\r\n  props: {\r\n    btnName: { type: String, required: true },\r\n    hoverTips: { type: String, required: true },\r\n    color: { type: String },\r\n  },\r\n  data() {\r\n    return {\r\n      isHovering: false,\r\n    };\r\n  },\r\n  methods: {\r\n    onBtnClick() {\r\n      this.$emit("btn-click", this.btnName);\r\n    },\r\n    onBtnMouseEnter() {\r\n      this.isHovering = true;\r\n    },\r\n    onBtnMouseLeave() {\r\n      this.isHovering = false;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../../scss/_variables.scss";\r\n\r\n.btn-color {\r\n  position: relative;\r\n  width: 24px;\r\n  height: 24px;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .btn-core {\r\n    width: 16px;\r\n    height: 16px;\r\n    border-radius: 50%;\r\n  }\r\n\r\n  &:hover {\r\n    background-color: $btn-second-bg-color;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .btn-img {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>',".btn-color {\n  position: relative;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-color .btn-core {\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n}\n.btn-color:hover {\n  background-color: #555d6b;\n  border-radius: 4px;\n}\n.btn-color .btn-img {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=BtnColor.vue.map */"]},media:void 0})}),j,"data-v-3f22ed18",!1,void 0,!1,T,void 0,void 0)},props:{},data:function(){return{btnsImg:{BOLD:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAb5JREFUWEfNlz1oFEEYhp+nFkEEQRBBrLRSsFArDVraWNils1HEwiqFhdqoWBkLERE7G1trNZUoCEowghBIsPQHC9H2k5E7GGV35wZ29/LBwR3zzbzPvbPzzp3MuZyzPlsXICJOVrjzC1hXf1TM+dva6sAE4GXlgpvAKnBNfT/L3L4Bcs0r6t0SxJAASfuU+qILogZgBbjRstguYD9wAdiX9XwDFtQPbRBVAOpCydKIeAscyfouqg/GBFgCbmeC99VLYwKcAZ5lgitdzg2xBeeBRxnAVfXmmA48Bc5lgp0noVcHIuIycC8TXwOOqz97caDjBOwG9gDbs553wKL6sa8cKJ3A6fhv4I7alhn/rFOzBbMCpL50J9xSH5Ym1QCkJEyvptoBpNvz8H+D10tOVAGUkrDhIUw8p9XnvTyEJYAk0nCNP1ZTNjRWrw5MFSLiM7B38vmTemBsgNfA0amo2vpFh3LgO7BzArCqHhrNgYhISZgScVpP1MVBASJiG3Aw/fhIIVRzFGu2oJQpTeNv1GNdE4cE+AKcVV/NA2AZWFY3SraVHDhRWiAb/wqkm29NTe9nqq3712wm/B6a5u7AH2Vw0yE01ri2AAAAAElFTkSuQmCC",ERASER:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAiRJREFUWEftlz1rVEEUht/nh1gLgo0INhbaxELEyhSKgoiIEgUttFAwgtjYCGqTwkb8wETQwiYEo1iksFARrP0N/oFXTpgLk7t378zsFkHwwjZ3Z3meOTPznlm0yw+7zNe/L2D7hKSLkg5KWgGWW6o6VwVsn5L0RtI1Sb8lnQ04sFgrMbNABj8NvOqAtkOoWmImgQx+Dnjen22LRLNABr8APJtW6lqJJoEMfglYKa1zjUS1QAZfAp6W4LV7okogg18HHtXCaySKAhn8JvCwFV6SGBXI4LeBB7PCM4n1FFZr3buSwKakT8C9eeHxe9t3JR0BjhYFbO9LKRdj3wF35pGwvV/Sa0nLwOqoQAaPgfGJdPsA3JpFwvaBBP/ej+mJJcjhXemzd+vAjRYJ24cS/OtQjxgS+CzpY3/dM4lN4GqNhO3DkqJPbE1rUDsEbO+VtAHsGQJkEl+Ay2MStmOjvZQUY6d2x6EK/JF0DNgqSMSs4h4w8dheSPCo5GhrHhKIo3JF0gLwoyAR63o+H2P7uKQXkmK/FO8FgzmQzmtcNs5USHwDti8itk+mmceJKcK37w0j7TQqUSvxU9LbNPP3tfBRgSy5aiUiuNZa4EWBJBHhEyWeWI5eYMU1rDmyi92wJ7EI/ErvuqhenQVc7AX9vWG7q8RS+u5JxPQ88Kol6B2xSMCuKd0HHtck4tiYfhLGzm/6Y9EoEJ1wxz6p2gONkKbh/wX+AopFBjD2PD4mAAAAAElFTkSuQmCC",ITALIC:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAaRJREFUWEfFls8rBVEUx7/flaWNXsqPkL29nYUkLymS5C2QJPb+BXslKWxIEvUSCxs29vaSF0qys7T5aup63V7ezNx7x323pqaZM+fzmXPuNIdo8WKL+fAWkNQHIDmyVo1krVlQiMCzg0D/fwgcNgh0Axg0oDsLmFRgsXABO6GkcQDXv9dI5q5s7sC0RkvaBrBhYqokp7I2Rl02b2CGwBOAARMzQbJejaz8wRWQVAZw6VP+5JkiBHYArBmBC5LTWW9t3y9CwP4cx0jeRBOQNAmg6lv+4BZI2gWwagTOSM66vH0RAi8Aegy0TPIqmoCkUQB2v9tIfscU2AOwYoAnJOdd4UEtkPQGoMtAZ0ieRxOQNAzg3gK2k/yKKbAPYMkAj0hWfODeLZD0DqDTQBdIHkcTkDQE4MEClkh+xhSwf72nJOd84V4tkPQBoGSgyyQPoglISkauRwvYS/I1psAWgE0DdJp8mkk6/Y4lJZutwyRbJ5nMAkErVeCP2f/Woo1Y56mzf5phlkAhs3+IQOPs3yxX6uzvLRDU3JwPO23CnDmdwlou8AMD5YYhC+0BEAAAAABJRU5ErkJggg==",UNDERLINE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAX1JREFUWEftlr8uBUEUxn/fA0hQaERCg+BKKFDS8Ag0JAoJlY5WS6ciUUhoeAQat0RB4l/QuIloFEg8wJFN9iaTve7uzJV1mz3JNjPnO+c338xmRjQ51OT+1AUws0kXTlI5BNZXnwZwBlQhypKmAgG89AVA4UDhQOFA4UDhQJoDm8BafAF9SmoPvIw+gLZYsyVp/Td9GsAscOSIhiXd+kCYWQm4cXLnJB2HAgwBbsNdSSueADvAspNbknQXBBAlm9kFMOYIByU9pEGY2QBw7+RcShqvp0l9kpnZPHCQEE9IisBqwsyiRueJiQVJhw0BxC6cANOJAhvAO/AWj3cCHUA07sappJk0x7wepWb2BPT67L+T8yypL0vjBRA7Ef0Ve0BLRtFvYKneqU9qvQFiiC5gFRgBRoHWuOAXcAVcA9uSXrNWXp0PAkgWNbP+aEzSo2/DPznQaJOgQ2hm3UD05REVSRW3cM0WmNlLzgA9WQD7OQMspgLk4XvQGfhvgB+KBOohabIaNwAAAABJRU5ErkJggg=="},colorList:[{colorValue:"#ECA79E",colorTip:"红色高亮"},{colorValue:"#FEFA97",colorTip:"黄色高亮"},{colorValue:"#C6E895",colorTip:"绿色高亮"},{colorValue:"#A7E4DF",colorTip:"青色高亮"},{colorValue:"#A6D4FE",colorTip:"蓝色高亮"},{colorValue:"#CAB1F4",colorTip:"紫色高亮"},{colorValue:"#D9D9D9",colorTip:"灰色高亮"}]}},methods:{onBtnClick:function(n){switch(n){case"BOLD":this.$emit("btn-bold-click");break;case"ITALIC":this.$emit("btn-italic-click");break;case"UNDERLINE":this.$emit("btn-underline-click");break;case"ERASER":this.$emit("btn-eraser-click");break;default:this.colorList.map((function(n){return n.colorValue})).includes(n)&&this.$emit("btn-bgcolor-click",n)}}}},Z=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"font-operation",on:{mouseenter:function(n){n.stopPropagation()},mouseleave:function(n){n.stopPropagation()}}},[r("Btn",{attrs:{isAvalible:!0,imgSrc:n.btnsImg.BOLD,btnName:"BOLD",hoverTips:"粗体",imgStyle:{width:"16px",height:"16px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),r("Btn",{attrs:{isAvalible:!0,imgSrc:n.btnsImg.ITALIC,btnName:"ITALIC",hoverTips:"斜体",imgStyle:{width:"15px",height:"15px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),r("Btn",{attrs:{isAvalible:!0,imgSrc:n.btnsImg.UNDERLINE,btnName:"UNDERLINE",hoverTips:"下划线",imgStyle:{width:"15px",height:"15px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),n._l(n.colorList,(function(e){return[r("BtnColor",{key:e.colorValue,attrs:{btnName:e.colorValue,hoverTips:e.colorTip,color:e.colorValue},on:{"btn-click":n.onBtnClick}})]})),n._v(" "),r("Btn",{attrs:{isAvalible:!0,imgSrc:n.btnsImg.ERASER,btnName:"ERASER",hoverTips:"清除样式",imgStyle:{width:"16px",height:"16px"}},on:{"btn-click":n.onBtnClick}})],2)};Z._withStripped=!0;var J=["FONT_STYLE"],K=["ADD_PIC","ADD_VIDEO","ADD_FILE","ADD_SIBLING"],q=["DELETE"],nn={components:{More:H,Btn:G,FontOperation:F({render:Z,staticRenderFns:[]},(function(n){n&&n("data-v-6d605640_0",{source:".font-operation[data-v-6d605640] {\n  position: absolute;\n  bottom: 30px;\n  left: 50%;\n  transform: translateX(-50%);\n  box-sizing: border-box;\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  background-color: #2b2f36;\n  border-radius: 8px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  z-index: 1300;\n}\n\n/*# sourceMappingURL=FontOperation.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\NodeOperation\\FontOperation.vue","FontOperation.vue"],names:[],mappings:"AA2IA;EAGA,kBAAA;EACA,YAAA;EACA,SAAA;EACA,2BAAA;EAEA,sBAAA;EACA,YARA;EASA,iBATA;EAUA,eAAA;EACA,yBAAA;EACA,kBAAA;EACA,aAAA;EACA,2BAAA;EACA,mBAAA;EACA,aAAA;AC7IA;;AAEA,4CAA4C",file:"FontOperation.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-20 16:39:01\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-23 14:32:39\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="font-operation" @mouseenter.stop @mouseleave.stop>\r\n    <Btn\r\n      :isAvalible="true"\r\n      :imgSrc="btnsImg.BOLD"\r\n      :btnName="\'BOLD\'"\r\n      :hoverTips="\'粗体\'"\r\n      :imgStyle="{ width: \'16px\', height: \'16px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <Btn\r\n      :isAvalible="true"\r\n      :imgSrc="btnsImg.ITALIC"\r\n      :btnName="\'ITALIC\'"\r\n      :hoverTips="\'斜体\'"\r\n      :imgStyle="{ width: \'15px\', height: \'15px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <Btn\r\n      :isAvalible="true"\r\n      :imgSrc="btnsImg.UNDERLINE"\r\n      :btnName="\'UNDERLINE\'"\r\n      :hoverTips="\'下划线\'"\r\n      :imgStyle="{ width: \'15px\', height: \'15px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <template v-for="color in colorList">\r\n      <BtnColor\r\n        :key="color.colorValue"\r\n        :btnName="color.colorValue"\r\n        :hoverTips="color.colorTip"\r\n        :color="color.colorValue"\r\n        @btn-click="onBtnClick"\r\n      />\r\n    </template>\r\n\r\n    <Btn\r\n      :isAvalible="true"\r\n      :imgSrc="btnsImg.ERASER"\r\n      :btnName="\'ERASER\'"\r\n      :hoverTips="\'清除样式\'"\r\n      :imgStyle="{ width: \'16px\', height: \'16px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n  </div>\r\n</template>\r\n<script>\r\nimport Btn from "./Btn.vue";\r\nimport BtnColor from "./BtnColor.vue";\r\n\r\nimport BOLD from "../../../../assets/icons/NodeOperation/FontOperation/bold.png";\r\nimport ITALIC from "../../../../assets/icons/NodeOperation/FontOperation/italic.png";\r\nimport UNDERLINE from "../../../../assets/icons/NodeOperation/FontOperation/underline.png";\r\nimport ERASER from "../../../../assets/icons/NodeOperation/FontOperation/eraser.png";\r\n\r\nexport default {\r\n  components: { Btn, BtnColor },\r\n  props: {},\r\n  data() {\r\n    return {\r\n      btnsImg: {\r\n        BOLD,\r\n        ERASER,\r\n        ITALIC,\r\n        UNDERLINE,\r\n      },\r\n      colorList: [\r\n        {\r\n          colorValue: "#ECA79E",\r\n          colorTip: "红色高亮",\r\n        },\r\n        {\r\n          colorValue: "#FEFA97",\r\n          colorTip: "黄色高亮",\r\n        },\r\n        {\r\n          colorValue: "#C6E895",\r\n          colorTip: "绿色高亮",\r\n        },\r\n        {\r\n          colorValue: "#A7E4DF",\r\n          colorTip: "青色高亮",\r\n        },\r\n        {\r\n          colorValue: "#A6D4FE",\r\n          colorTip: "蓝色高亮",\r\n        },\r\n        {\r\n          colorValue: "#CAB1F4",\r\n          colorTip: "紫色高亮",\r\n        },\r\n        {\r\n          colorValue: "#D9D9D9",\r\n          colorTip: "灰色高亮",\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    onBtnClick(btnName) {\r\n      switch (btnName) {\r\n        case "BOLD": {\r\n          this.$emit("btn-bold-click");\r\n          break;\r\n        }\r\n        case "ITALIC": {\r\n          this.$emit("btn-italic-click");\r\n          break;\r\n        }\r\n        case "UNDERLINE": {\r\n          this.$emit("btn-underline-click");\r\n          break;\r\n        }\r\n        case "ERASER": {\r\n          this.$emit("btn-eraser-click");\r\n          break;\r\n        }\r\n        default: {\r\n          if (this.colorList.map((c) => c.colorValue).includes(btnName)) {\r\n            this.$emit("btn-bgcolor-click", btnName);\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../../scss/_variables.scss";\r\n\r\n.font-operation {\r\n  $btns-height: 32px;\r\n\r\n  position: absolute;\r\n  bottom: 30px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n\r\n  box-sizing: border-box;\r\n  height: $btns-height;\r\n  line-height: $btns-height;\r\n  padding: 0 12px;\r\n  background-color: $btn-main-bg-color;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  z-index: 1300;\r\n}\r\n</style>',".font-operation {\n  position: absolute;\n  bottom: 30px;\n  left: 50%;\n  transform: translateX(-50%);\n  box-sizing: border-box;\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  background-color: #2b2f36;\n  border-radius: 8px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  z-index: 1300;\n}\n\n/*# sourceMappingURL=FontOperation.vue.map */"]},media:void 0})}),Q,"data-v-6d605640",!1,void 0,!1,T,void 0,void 0)},props:{btns:{type:Array,default:function(){return J.concat(K,q)}}},data:function(){return{btnsImg:{FONT_STYLE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAhJJREFUWEftlk+ITmEUxp/fxmJYms1IFshmhJStvxELNc1iLMhiiI0SabKxsZmkxEqUJBY0SYmmjMaeopENNcmCBWWhGQuLR68+0zju/d577/dNKfMuv/Pn+X3nvOe8FzU4tl0QNg7srZuOugG2k8jjkrilwGydnE0AknjZPx0BLiwYgO0eSTNtBD4CKxYS4ISkKxmBLcDzqhC1WmD7naQ1meS3gUNdB7C9XtJUxcRLgB9VfCtXwHYqfWrB3AGwvU/SoyA2DNzoNkCc/afAriRSsBemgA1dA7A9IOl+SDgAPGgBXJN0NNg3Aa9yEJVaYLto9nuA7y2ArZKeBbHLwMmOAWyvlPQhJLoFHJ7/m+3PkpbHO9INgDOS4nYbAu4FgIuSTgfBg8CddhDZFhTM/jdJq4CvAWCPpPEgNgnsaAxge5ukyZAg9nq+Oa3htcG/H3hTBtG2AravSjqW62PGPgqcrQ1ge5mkVO5OzxegtwnAEUnXO1VvxR8A7hblKm2B7QlJO0PQsKTpDNRxSUPB5yGwvzKA7Y2SXsaAtPtzFbG9WdKLAr91wNu/chYltD0qaSTYLgGncgDJbvu1pP7gex44VxXgfZr14NwHfKoIkLbkzeA7DazOAtgelDQWHJ8Au6uI//Yp+XIeBP541LI9rSPaxHcR4N+pQMnDo6LZL7pgZTui5DJuB349anMVWAT4byvwE7cu7CHtvEZrAAAAAElFTkSuQmCC",ADD_PIC:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAASlJREFUWEftltsNgkAURGcqEStRK1ErUSsRK1Er0U7GDNk1Kz5IYJGf3YQfCHfmnvsAYuLDifVRDBQChcBXApKUcUT3JA+f4nUZuADwNeRsHIPkto+Br87bwSRVvkfynj6TdBvVgKQlgCOAxgCALck6mhjVQMi6yRDACcAagA3NI4l/GWiyDjTOKYV/GLCgCbjLdwDcdOMSkLSJdZZk0X3SeO741Wg9IMkZu87PCQnoFwCuJF/GNmsJEnF3uVG/jKkkT8M9XTrZDITgFo0NF9EbvyfA4ibjk9IZvgeSOrczjia8fLwHXHuP4pNOFgK/ggRzkUxT/0BrSXKey0DVXrFdHwcvKb+TxUCX2K/nQw0M0U7frft8DV3XWSYHb/shxi2/ZIVAITA5gQf85wUw5auerQAAAABJRU5ErkJggg==",ADD_VIDEO:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAYVJREFUWEftl70uhEEUhp+XRsEFaN2BuAEqCa1IlGoV0ZAIG/HTqLUqkahFVLZ1BRqFQi2ESFZzZGRGZtfmy3x/+22xW5+d9znnPWfmfKLhnxrWZwQwHBUws3tgvuZ+aEta6NX4rYCZWc3iv8dL+lfxLoB+AVWAhQQHAmBm+8AB0AFOJLUGDRDb2ZE0EQOY2SawBTy5nqjcgp5+6gIA7oDFYKuzJBeAn5Z3X9qHfv2RZYGPvwGWQ1PmBQjl/QaOnb8pTerBZ4BTSeexJUUBPoApwFVhRdJLCkiIqQJgFjgClvyh25LOUiFKA0S9swMcAuPAtaTVFIgqAfb8zI8Bt5JCRTI5SgMAc64Jo5Fak3SVkn189RcZwzAFn8Ak4EQ3JL2milcF8OWFL1KEzewSmAZaktplLHDP9huwK+kxRbzPa9sOT39uC1IFe+Oi6/lPvNBNWBbAZWxmbvFxL+azpPVcN2EVAJkbUeMLSdEMU/+XtRE1u5SmZlBH3HB8F9SRWeqZowr8ANTwFDDCmXuiAAAAAElFTkSuQmCC",ADD_FILE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAACR1JREFUeF7t3T/MXmMcxvHfPRKTxSqhCwkDkZq0m0QUoY2YDQaDxVJLO9RikIrBaGv8SfypxdRamkgYNLH4Eytm5lueeItW3/ec5/ucc+7ze+6vRAzO9dznXNf5eMXbV0v4hw3YwKENFLuxARs4vAGB+HbYwBENCMTXwwYE4jtgA6wBv4Kw3kx10oBAOhnax2QNCIT1ZqqTBgTSydA+JmtAIKw3U500IJBOhvYxWQMCYb2Z6qSBVQGptd4bEQ9ExGOd9L/UY16LiO9KKb8tdeC+nLMKILXWuyPi/Yh4el+KXelzXIyIi6WUX1Z6f6u7reZAaq33RMSvq2tmf2/o94h4tZTy0f4+4nRPtgYgH0bE6ekeyU8a2cAZkQw31RRIrfX5iPh4+Da9YqYGRDJQbGsgFyLi7Ezj+7HjGhDJET21BvJFRDw1bkevmrEBkRxSbmsgVyLixIzD+9HjGxDJbboSyPgXqIcrRXLLygLp4bXf7hlF8p++BLLdy9PL1SI5WFogvbzy2z+nSCJCINu/OD0lukcikJ5ed/asXSPJCuQ82zpl6gnwn8K/j4gHJ3zabpFkBXKylHJ1whdgtR9VayXfK9r8A+QFkew+q0B273DWT9gByOYXgW7+9CvJDgsJZIfylohSIKWUc7XWzQ+fiWSHoQSyQ3lLRHcBsrk/key2kkB262/29K5ARLLbRALZrb/Z01MAEQmfSSC8u0WSUwERCZtLIKy3xVJTAhHJ9rMJZPvOFk1MDUQk280nkO36WvzqOYCIZPyMAhnfVZMr5wIiknFzCmRcT82umhOISIZnFchwR02vmBuISI6eVyBNX//hw5cAIpLDdxDI8Dva9IqlgIjk9jMLpOnrP3z4kkBE8v89BDL8jja9YmkgIrl5boE0ff2HD28BRCT/7iKQ4Xe06RWtgIjk79kF0vT1Hz4cAjlXSpnk5/Z7/3kSgQy/o02vaA2k968kAmn6+g8fvgYgPSMRyPA72vSKtQDpFYlAmr7+w4evCUiPSAQy/I42vWJtQHpDIpCmr//w4WsE0hMSgQy/o02vWCuQXpAIpOnrP3z4moH0gEQgw+9o0yvWDmTfkQik6es/fHgGIDMiOV5K+Xq4pfmuEMh83U7yyVmAzITkUinlpUmKhB8iEFjcUrFMQGZC8mQp5cul+r71HIG0an7kudmAzIDk/Ob/VD+yrskvE8jklU77gRmBTIzkcinl1LStjv80gYzvqsmVWYFMiORqKeVkk/L9eZBWtY8/NzOQiZAIZPzr8s+V/h6FR5e2+Xf2r0Cvc0behb8dnEDAKgIBpSWNCAQMJxBQWtKIQMBwAgGlJY0IBAwnEFBa0ohAwHACAaUljQgEDNcTkLcj4jXQ0b5EBAKW7AnImYj4AHS0LxGBgCV7AnIsIn4AHe1LRCBgyW6AHHw3+lJEvAh62oeIQMCKXQE5QPJnRNwJusoeEQhYsEcgj0fENdBV9ohAwILdATn4KnJHRLwTES+DzrJGBAKW6xLIjZ5qracjYvMV5fjBX0GFaSICAVN1DQT01TxSaz0REVfAjQgElCYQUFrLiEBA+/CHgTYnCQT03TIiENC+QEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBwwkElJY0IhAwnEBAaUkjAgHDCQSUljQiEDCcQEBpSSMCAcMJBJSWNCIQMJxAQGlJIwIBw+0A5Dw4LkukZrlRcJ/nQOZqKeUkyE0SKZN8CvyQHYDAE40lbEAgCUfzlpdrQCDLde1JCRsQSMLRvOXlGhDIcl17UsIGBJJwNG95uQYEslzXnpSwga6BfBYRpxKO5i0v18DnpZRnljvu5pNafx/kbERcaPXwnpuigTdKKW+2utPWQJ6NiE9aPbznpmjguVLKp63utCmQzUPXWr+JiEdaFeC5q27g21LKoy3vcA1A7o+IH1uW4NmrbeBYKeWnlnfXHMjBV5G7IuKtiHilZRmevZoG3ouI10spf7S+o1UAuVFCrfW+iHgoIh5uXUzD8/f5V/MO1Xo9Iq6XUn4eunCpv78qIEs9tOfYwNgGBDK2Ka/rsgGBdDm7Dz22AYGMbcrrumxAIF3O7kOPbUAgY5vyui4bEEiXs/vQYxsQyNimvK7LBgTS5ew+9NgGBDK2Ka/rsgGBdDm7Dz22AYGMbcrrumzgL3LiBDLIiesaAAAAAElFTkSuQmCC",ADD_SIBLING:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAASVJREFUWEftV9sNgzAMPG/QUTpCmawwQUcq3aCjdINURglC4DyOR6ES/sV2zmfncAQ7m+x8Po4DwDl3i7EhIq1+S/mwTIacPQM++dNI1IpI5QHcAdTsYYZ/lQLQVetNWbEADH1YPJozDUArHjBiAahFpGFPds4pw3kAAEJyDTABAHixAABoC7MAxnl/OgOKUK3rfUAyGsLobSEYaSZDGIKt3hOJadeJEJ0AWAYGV4uhf6oDc2dgSwBvANeCsoJfX1UsJilEBgO7A+gFKMXCli34DwAFM5J0OYVoMQN+CNlOrPcz2vIWqA58Ckq7eMHq9saMxReSowmR4lEZVhZy9vC+pYuqvZLlTinQdyZF/G/IZFHfuY+V6ErGAljqf5y34dJK5sZ/AUCw6iGL9FL0AAAAAElFTkSuQmCC",MORE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAKdJREFUWEftljEKAjEURN+UHmIrxdojrIWtnlXbLfQI1oKNHkKwGREiSIiL1SbFT5lh/p+8hCSi8lDl/kSAIBAEgkAQaJuA7TnwlHQvvRljuu0ZsEm+QdKjVOMnAdtHoE+mk6T1d4ExPTU/A8vkuQCrUohiANsdcMsSLyRd33N/6Ftgn/l3kg45hTYDpFXW24IPpqqHcKqfUtv3wBQUgkAQCAJBIAi8AJO5XCFsovVGAAAAAElFTkSuQmCC"},isMoreListVisible:!1,isFontStyleDetailVisible:!1}},computed:{isMoreBtnAvailable:function(){return this.btns.some((function(n){return q.includes(n)}))},moreBtns:function(){return this.btns.filter((function(n){return q.includes(n)}))},isSplit1Avalible:function(){return!(!this.btns.some((function(n){return J.includes(n)}))||!this.btns.some((function(n){return K.includes(n)})))},isSplit2Avalible:function(){return!(!this.btns.some((function(n){return K.includes(n)}))||!this.btns.some((function(n){return q.includes(n)})))}},methods:{onBtnClick:function(n){switch(n){case"FONT_STYLE":this.isFontStyleDetailVisible=!this.isFontStyleDetailVisible,this.isMoreListVisible=!1;break;case"ADD_PIC":this.isMoreListVisible=!1,this.isFontStyleDetailVisible=!1,this.$emit("btn-insert-img-click");break;case"ADD_VIDEO":this.isMoreListVisible=!1,this.isFontStyleDetailVisible=!1,this.$emit("btn-insert-video-click");break;case"ADD_FILE":this.isMoreListVisible=!1,this.isFontStyleDetailVisible=!1,this.$emit("btn-insert-file-click");break;case"ADD_SIBLING":this.isMoreListVisible=!1,this.isFontStyleDetailVisible=!1,this.$emit("btn-add-sibling-click");break;case"MORE":this.isMoreListVisible=!this.isMoreListVisible,this.isFontStyleDetailVisible=!1;break;case"DELETE":this.isMoreListVisible=!1,this.isFontStyleDetailVisible=!1,this.$emit("btn-del-node-click")}}}},en=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"node-operation",on:{dblclick:function(n){n.stopPropagation()}}},[r("Btn",{attrs:{isAvalible:n.btns.includes("FONT_STYLE"),isTipsAvalible:!n.isFontStyleDetailVisible,imgSrc:n.btnsImg.FONT_STYLE,btnName:"FONT_STYLE",hoverTips:"字体样式",imgStyle:{width:"14px",height:"14px"}},on:{"btn-click":n.onBtnClick}},[n.isFontStyleDetailVisible?r("FontOperation",{on:{"btn-bold-click":function(e){return n.$emit("btn-bold-click")},"btn-italic-click":function(e){return n.$emit("btn-italic-click")},"btn-underline-click":function(e){return n.$emit("btn-underline-click")},"btn-eraser-click":function(e){return n.$emit("btn-eraser-click")},"btn-bgcolor-click":function(e){return n.$emit("btn-bgcolor-click",e)}}}):n._e()],1),n._v(" "),n.isSplit1Avalible?r("div",{staticClass:"split"},[r("div",{staticClass:"line"})]):n._e(),n._v(" "),r("Btn",{attrs:{isAvalible:n.btns.includes("ADD_PIC"),imgSrc:n.btnsImg.ADD_PIC,btnName:"ADD_PIC",hoverTips:"插入图片"},on:{"btn-click":n.onBtnClick}}),n._v(" "),r("Btn",{attrs:{isAvalible:n.btns.includes("ADD_VIDEO"),imgSrc:n.btnsImg.ADD_VIDEO,btnName:"ADD_VIDEO",hoverTips:"插入视频",imgStyle:{width:"18px",height:"18px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),r("Btn",{attrs:{isAvalible:n.btns.includes("ADD_FILE"),imgSrc:n.btnsImg.ADD_FILE,btnName:"ADD_FILE",hoverTips:"插入文件",imgStyle:{width:"16px",height:"16px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),r("Btn",{attrs:{isAvalible:n.btns.includes("ADD_SIBLING"),imgSrc:n.btnsImg.ADD_SIBLING,btnName:"ADD_SIBLING",hoverTips:"插入同级节点",imgStyle:{width:"16px",height:"16px"}},on:{"btn-click":n.onBtnClick}}),n._v(" "),n.isSplit2Avalible?r("div",{staticClass:"split"},[r("div",{staticClass:"line"})]):n._e(),n._v(" "),r("Btn",{attrs:{isAvalible:n.isMoreBtnAvailable,isTipsAvalible:!n.isMoreListVisible,imgSrc:n.btnsImg.MORE,btnName:"MORE",hoverTips:"更多",imgStyle:{width:"16px",height:"16px"}},on:{"btn-click":n.onBtnClick}},[n.isMoreListVisible?r("More",{attrs:{moreBtns:n.moreBtns},on:{delete:function(e){return n.onBtnClick("DELETE")}}}):n._e()],1)],1)};en._withStripped=!0;var rn=F({render:en,staticRenderFns:[]},(function(n){n&&n("data-v-ad4ecc54_0",{source:".node-operation[data-v-ad4ecc54] {\n  box-sizing: border-box;\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  background-color: #2b2f36;\n  border-radius: 8px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  z-index: 1300;\n}\n.node-operation .split[data-v-ad4ecc54] {\n  width: 9px;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.node-operation .split .line[data-v-ad4ecc54] {\n  width: 1px;\n  height: 70%;\n  background-color: #555d6b;\n}\n\n/*# sourceMappingURL=NodeOperation.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\NodeOperation.vue","NodeOperation.vue"],names:[],mappings:"AA4MA;EAGA,sBAAA;EACA,YAHA;EAIA,iBAJA;EAKA,eAAA;EACA,yBAAA;EACA,kBAAA;EACA,aAAA;EACA,2BAAA;EACA,mBAAA;EACA,aAAA;AC7MA;AD+MA;EACA,UAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;AC7MA;AD+MA;EACA,UAAA;EACA,WAAA;EACA,yBAAA;AC7MA;;AAEA,4CAA4C",file:"NodeOperation.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-19 14:54:23\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-27 15:27:31\r\n * @Description: 节点的操作按钮 bar\r\n--\x3e\r\n\r\n<template>\r\n  \x3c!-- 双击事件会触发节点组件的标题编辑功能，要禁用掉 --\x3e\r\n  <div class="node-operation" @dblclick.stop>\r\n    <Btn\r\n      :isAvalible="btns.includes(\'FONT_STYLE\')"\r\n      :isTipsAvalible="!isFontStyleDetailVisible"\r\n      :imgSrc="btnsImg.FONT_STYLE"\r\n      :btnName="\'FONT_STYLE\'"\r\n      :hoverTips="\'字体样式\'"\r\n      :imgStyle="{ width: \'14px\', height: \'14px\' }"\r\n      @btn-click="onBtnClick"\r\n    >\r\n      <FontOperation\r\n        v-if="isFontStyleDetailVisible"\r\n        @btn-bold-click="$emit(\'btn-bold-click\')"\r\n        @btn-italic-click="$emit(\'btn-italic-click\')"\r\n        @btn-underline-click="$emit(\'btn-underline-click\')"\r\n        @btn-eraser-click="$emit(\'btn-eraser-click\')"\r\n        @btn-bgcolor-click="$emit(\'btn-bgcolor-click\', $event)"\r\n      />\r\n    </Btn>\r\n    <div class="split" v-if="isSplit1Avalible">\r\n      <div class="line"></div>\r\n    </div>\r\n    <Btn\r\n      :isAvalible="btns.includes(\'ADD_PIC\')"\r\n      :imgSrc="btnsImg.ADD_PIC"\r\n      :btnName="\'ADD_PIC\'"\r\n      :hoverTips="\'插入图片\'"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <Btn\r\n      :isAvalible="btns.includes(\'ADD_VIDEO\')"\r\n      :imgSrc="btnsImg.ADD_VIDEO"\r\n      :btnName="\'ADD_VIDEO\'"\r\n      :hoverTips="\'插入视频\'"\r\n      :imgStyle="{ width: \'18px\', height: \'18px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <Btn\r\n      :isAvalible="btns.includes(\'ADD_FILE\')"\r\n      :imgSrc="btnsImg.ADD_FILE"\r\n      :btnName="\'ADD_FILE\'"\r\n      :hoverTips="\'插入文件\'"\r\n      :imgStyle="{ width: \'16px\', height: \'16px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <Btn\r\n      :isAvalible="btns.includes(\'ADD_SIBLING\')"\r\n      :imgSrc="btnsImg.ADD_SIBLING"\r\n      :btnName="\'ADD_SIBLING\'"\r\n      :hoverTips="\'插入同级节点\'"\r\n      :imgStyle="{ width: \'16px\', height: \'16px\' }"\r\n      @btn-click="onBtnClick"\r\n    />\r\n    <div class="split" v-if="isSplit2Avalible">\r\n      <div class="line"></div>\r\n    </div>\r\n    <Btn\r\n      :isAvalible="isMoreBtnAvailable"\r\n      :isTipsAvalible="!isMoreListVisible"\r\n      :imgSrc="btnsImg.MORE"\r\n      :btnName="\'MORE\'"\r\n      :hoverTips="\'更多\'"\r\n      :imgStyle="{ width: \'16px\', height: \'16px\' }"\r\n      @btn-click="onBtnClick"\r\n    >\r\n      <More\r\n        v-if="isMoreListVisible"\r\n        :moreBtns="moreBtns"\r\n        @delete="onBtnClick(\'DELETE\')"\r\n      />\r\n    </Btn>\r\n  </div>\r\n</template>\r\n<script>\r\n// import Tips from "../Common/Tips.vue";\r\nimport More from "./NodeOperation/More.vue";\r\nimport Btn from "./NodeOperation/Btn.vue";\r\nimport FontOperation from "./NodeOperation/FontOperation.vue";\r\n\r\n// import NormalNode from "../../../entities/NormalNode.js";\r\n// import CustomizedNode from "../../../entities/CustomizedNode.js";\r\n\r\nimport ADD_PIC from "../../../assets/icons/NodeOperation/pic.png";\r\nimport FONT_STYLE from "../../../assets/icons/NodeOperation/font-style.png";\r\nimport ADD_VIDEO from "../../../assets/icons/NodeOperation/video.png";\r\nimport ADD_SIBLING from "../../../assets/icons/NodeOperation/sibling.png";\r\nimport ADD_FILE from "../../../assets/icons/NodeOperation/file.png";\r\nimport MORE from "../../../assets/icons/NodeOperation/more.png";\r\n\r\nconst NORMAL_BTNS1 = ["FONT_STYLE"];\r\nconst NORMAL_BTNS2 = ["ADD_PIC", "ADD_VIDEO", "ADD_FILE", "ADD_SIBLING"];\r\nconst MORE_BTNS = ["DELETE"];\r\n\r\nexport default {\r\n  components: { More, Btn, FontOperation },\r\n  props: {\r\n    btns: {\r\n      type: Array,\r\n      default: () => [...NORMAL_BTNS1, ...NORMAL_BTNS2, ...MORE_BTNS],\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      btnsImg: {\r\n        FONT_STYLE,\r\n        ADD_PIC,\r\n        ADD_VIDEO,\r\n        ADD_FILE,\r\n        ADD_SIBLING,\r\n        MORE,\r\n      },\r\n      isMoreListVisible: false,\r\n      isFontStyleDetailVisible: false,\r\n    };\r\n  },\r\n  computed: {\r\n    // ”更多“按钮是否可用\r\n    isMoreBtnAvailable: function () {\r\n      return this.btns.some((b) => MORE_BTNS.includes(b));\r\n    },\r\n    // ”更多“按钮的上拉列表里的按钮有哪些\r\n    moreBtns: function () {\r\n      return this.btns.filter((b) => MORE_BTNS.includes(b));\r\n    },\r\n    isSplit1Avalible: function () {\r\n      if (\r\n        this.btns.some((b) => NORMAL_BTNS1.includes(b)) &&\r\n        this.btns.some((b) => NORMAL_BTNS2.includes(b))\r\n      ) {\r\n        return true;\r\n      } else return false;\r\n    },\r\n    isSplit2Avalible: function () {\r\n      if (\r\n        this.btns.some((b) => NORMAL_BTNS2.includes(b)) &&\r\n        this.btns.some((b) => MORE_BTNS.includes(b))\r\n      ) {\r\n        return true;\r\n      } else return false;\r\n    },\r\n  },\r\n  methods: {\r\n    onBtnClick(btnName) {\r\n      switch (btnName) {\r\n        case "FONT_STYLE": {\r\n          this.isFontStyleDetailVisible = !this.isFontStyleDetailVisible;\r\n          this.isMoreListVisible = false;\r\n          break;\r\n        }\r\n        case "ADD_PIC": {\r\n          this.isMoreListVisible = false;\r\n          this.isFontStyleDetailVisible = false;\r\n          this.$emit("btn-insert-img-click");\r\n          break;\r\n        }\r\n        case "ADD_VIDEO": {\r\n          this.isMoreListVisible = false;\r\n          this.isFontStyleDetailVisible = false;\r\n          this.$emit("btn-insert-video-click");\r\n          break;\r\n        }\r\n        case "ADD_FILE": {\r\n          this.isMoreListVisible = false;\r\n          this.isFontStyleDetailVisible = false;\r\n          this.$emit("btn-insert-file-click");\r\n          break;\r\n        }\r\n        case "ADD_SIBLING": {\r\n          this.isMoreListVisible = false;\r\n          this.isFontStyleDetailVisible = false;\r\n          this.$emit("btn-add-sibling-click");\r\n          break;\r\n        }\r\n        case "MORE": {\r\n          this.isMoreListVisible = !this.isMoreListVisible;\r\n          this.isFontStyleDetailVisible = false;\r\n          break;\r\n        }\r\n        case "DELETE": {\r\n          this.isMoreListVisible = false;\r\n          this.isFontStyleDetailVisible = false;\r\n          this.$emit("btn-del-node-click");\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n\r\n.node-operation {\r\n  $btns-height: 32px;\r\n\r\n  box-sizing: border-box;\r\n  height: $btns-height;\r\n  line-height: $btns-height;\r\n  padding: 0 12px;\r\n  background-color: $btn-main-bg-color;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  z-index: 1300;\r\n\r\n  .split {\r\n    width: 9px;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n\r\n    .line {\r\n      width: 1px;\r\n      height: 70%;\r\n      background-color: $btn-second-bg-color;\r\n    }\r\n  }\r\n}\r\n</style>',".node-operation {\n  box-sizing: border-box;\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  background-color: #2b2f36;\n  border-radius: 8px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  z-index: 1300;\n}\n.node-operation .split {\n  width: 9px;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.node-operation .split .line {\n  width: 1px;\n  height: 70%;\n  background-color: #555d6b;\n}\n\n/*# sourceMappingURL=NodeOperation.vue.map */"]},media:void 0})}),nn,"data-v-ad4ecc54",!1,void 0,!1,T,void 0,void 0),tn={props:{isRootNode:{type:Boolean,default:!1},title:{type:String,required:!0},isEditing:{type:Boolean,default:!1},font:{type:String,required:!0},fontStyle:{type:Object,default:function(){}},blankNodeTip:{type:String,required:!0}},data:function(){return{titleEditing:this.title}},computed:{},watch:{isEditing:function(n){var e=this;n&&(this.titleEditing=this.title,this.$nextTick((function(){e.$refs["title-input"].select()})))}},methods:{onTitleEditInput:function(n){this.$emit("title-editing",n)},onInputKeyupEnter:function(){this.$emit("enter-press",this.titleEditing)},onDbClick:function(){this.isEditing||this.$emit("dbclick-to-edit")}}},on=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"text-core",class:{root:n.isRootNode},style:{font:n.font},on:{dblclick:n.onDbClick}},[n.isEditing?[r("input",{directives:[{name:"model",rawName:"v-model",value:n.titleEditing,expression:"titleEditing"}],ref:"title-input",staticClass:"node-title-input title",attrs:{type:"text"},domProps:{value:n.titleEditing},on:{input:[function(e){e.target.composing||(n.titleEditing=e.target.value)},function(e){return n.onTitleEditInput(e.target.value)}],keyup:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"enter",13,e.key,"Enter")?null:n.onInputKeyupEnter.apply(null,arguments)}}})]:[n.title?[r("span",{staticClass:"title",style:Object.assign({},n.fontStyle)},[n._v(n._s(n.title))])]:[r("span",{staticClass:"title-tip"},[n._v(n._s(n.blankNodeTip))])]]],2)};on._withStripped=!0;var sn=F({render:on,staticRenderFns:[]},(function(n){n&&n("data-v-d5790808_0",{source:".text-core[data-v-d5790808] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n.text-core .node-title-input[data-v-d5790808] {\n  width: 100%;\n  height: 100%;\n  border: none;\n  padding: 0;\n  outline: none;\n  background-color: #eeeeee;\n}\n.text-core .title[data-v-d5790808] {\n  font-size: 14px;\n}\n.text-core .title-tip[data-v-d5790808] {\n  color: #aaaaaa;\n}\n.text-core.root .title-tip[data-v-d5790808] {\n  color: #88c5fa;\n}\n.text-core.root .node-title-input[data-v-d5790808] {\n  color: #fff;\n  background-color: #0089ff;\n}\n\n/*# sourceMappingURL=TextCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\TextCore.vue","TextCore.vue"],names:[],mappings:"AA+EA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,2BAAA;EACA,mBAAA;AC9EA;ADgFA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,UAAA;EACA,aAAA;EACA,yBAAA;AC9EA;ADiFA;EACA,eAAA;AC/EA;ADkFA;EACA,cAAA;AChFA;ADoFA;EACA,cAAA;AClFA;ADoFA;EACA,WAAA;EACA,yBAAA;AClFA;;AAEA,uCAAuC",file:"TextCore.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-22 17:54:18\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:21:02\r\n * @Description: 文字节点的内容组件\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    class="text-core"\r\n    :class="{ root: isRootNode }"\r\n    :style="{ font: font }"\r\n    @dblclick="onDbClick"\r\n  >\r\n    <template v-if="isEditing">\r\n      <input\r\n        class="node-title-input title"\r\n        type="text"\r\n        ref="title-input"\r\n        v-model="titleEditing"\r\n        @input="onTitleEditInput($event.target.value)"\r\n        @keyup.enter="onInputKeyupEnter"\r\n      />\r\n    </template>\r\n    <template v-else>\r\n      <template v-if="title">\r\n        <span class="title" :style="{ ...fontStyle }">{{ title }}</span>\r\n      </template>\r\n      <template v-else>\r\n        <span class="title-tip">{{ blankNodeTip }}</span>\r\n      </template>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    isRootNode: { type: Boolean, default: false }, // 是不是根节点\r\n    title: { type: String, required: true }, // 标题\r\n    isEditing: { type: Boolean, default: false }, // 当前是否正在编辑标题\r\n    font: { type: String, required: true }, // 字体\r\n    fontStyle: { type: Object, default: () => {} }, // 文字相关样式\r\n    blankNodeTip: { type: String, required: true }, // 标题为空时的提示文字\r\n  },\r\n  data() {\r\n    return {\r\n      titleEditing: this.title, // 用于编辑节点标题\r\n    };\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    isEditing: function (nv /* , ov */) {\r\n      if (nv) {\r\n        this.titleEditing = this.title;\r\n        this.$nextTick(() => {\r\n          this.$refs["title-input"].select(); // 选中全部待编辑文字\r\n        });\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onTitleEditInput(newValue) {\r\n      this.$emit("title-editing", newValue);\r\n    },\r\n    onInputKeyupEnter() {\r\n      this.$emit("enter-press", this.titleEditing);\r\n    },\r\n    onDbClick() {\r\n      if (!this.isEditing) {\r\n        this.$emit("dbclick-to-edit");\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n\r\n.text-core {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n\r\n  .node-title-input {\r\n    width: 100%;\r\n    height: 100%;\r\n    border: none;\r\n    padding: 0;\r\n    outline: none;\r\n    background-color: $grey-color-light;\r\n  }\r\n\r\n  .title {\r\n    font-size: 14px;\r\n  }\r\n\r\n  .title-tip {\r\n    color: $grey-color-normal;\r\n  }\r\n\r\n  &.root {\r\n    .title-tip {\r\n      color: $main-color-light-more;\r\n    }\r\n    .node-title-input {\r\n      color: $white;\r\n      background-color: $main-color-normal;\r\n    }\r\n  }\r\n}\r\n</style>',".text-core {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n.text-core .node-title-input {\n  width: 100%;\n  height: 100%;\n  border: none;\n  padding: 0;\n  outline: none;\n  background-color: #eeeeee;\n}\n.text-core .title {\n  font-size: 14px;\n}\n.text-core .title-tip {\n  color: #aaaaaa;\n}\n.text-core.root .title-tip {\n  color: #88c5fa;\n}\n.text-core.root .node-title-input {\n  color: #fff;\n  background-color: #0089ff;\n}\n\n/*# sourceMappingURL=TextCore.vue.map */"]},media:void 0})}),tn,"data-v-d5790808",!1,void 0,!1,T,void 0,void 0),an={props:{isVisible:{type:Boolean,default:!1}},computed:{isGloballyReadonly:function(){return s.state.isGloballyReadonly}},methods:{onDragDotMouseDown:function(n){var e=this.$refs.frame;this.$emit("drag-dot-mousedown",n,e)}}},ln=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.isVisible?r("div",{ref:"frame",staticClass:"pic-flexible-frame"},[n.isGloballyReadonly?n._e():r("div",{ref:"dot",staticClass:"drag-dot",on:{mousedown:function(e){return e.stopPropagation(),n.onDragDotMouseDown.apply(null,arguments)}}})]):n._e()};ln._withStripped=!0;var dn=F({render:ln,staticRenderFns:[]},(function(n){n&&n("data-v-7a002282_0",{source:".pic-flexible-frame[data-v-7a002282] {\n  z-index: 200;\n  box-sizing: border-box;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  border: 2px solid #39a3ff;\n  pointer-events: none;\n}\n.pic-flexible-frame .drag-dot[data-v-7a002282] {\n  box-sizing: border-box;\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  right: -5px;\n  bottom: -5px;\n  background-color: #0089ff;\n  border: 1px solid #fff;\n  border-radius: 50%;\n  box-shadow: 0px 0px 3px 0px #000;\n  cursor: nwse-resize;\n  pointer-events: all;\n}\n\n/*# sourceMappingURL=PicFlexibleFrame.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\PicFlexibleFrame.vue","PicFlexibleFrame.vue"],names:[],mappings:"AA0CA;EAEA,YAAA;EAEA,sBAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EAGA,MAAA;EACA,OAAA;EACA,yBAAA;EACA,oBAAA;AC7CA;AD+CA;EAGA,sBAAA;EACA,kBAAA;EACA,WAJA;EAKA,YALA;EAMA,WAAA;EACA,YAAA;EACA,yBAAA;EACA,sBAAA;EACA,kBAAA;EAEA,gCAAA;EACA,mBAAA;EACA,mBAAA;AChDA;;AAEA,+CAA+C",file:"PicFlexibleFrame.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-30 23:45:12\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-01 14:26:34\r\n * @Description: 可拖拉缩放(图片)的框\r\n--\x3e\r\n\r\n<template>\r\n  <div class="pic-flexible-frame" ref="frame" v-if="isVisible">\r\n    <div\r\n      v-if="!isGloballyReadonly"\r\n      class="drag-dot"\r\n      ref="dot"\r\n      @mousedown.stop="onDragDotMouseDown"\r\n    ></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../../../store";\r\nexport default {\r\n  props: {\r\n    isVisible: { type: Boolean, default: false },\r\n  },\r\n  computed: {\r\n    isGloballyReadonly: function () {\r\n      return myStore.state.isGloballyReadonly;\r\n    },\r\n  },\r\n  methods: {\r\n    onDragDotMouseDown(event) {\r\n      const refFrame = this.$refs["frame"];\r\n      // const refDot = this.$refs["dot"];\r\n      this.$emit("drag-dot-mousedown", event, refFrame);\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n@import "../../../scss/_variables.scss";\r\n\r\n.pic-flexible-frame {\r\n  $border-width: 2px;\r\n  z-index: 200;\r\n\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  // top: -$border-width;\r\n  // left: -$border-width;\r\n  top: 0;\r\n  left: 0;\r\n  border: $border-width solid $main-color-light;\r\n  pointer-events: none; // 穿透过去，才能让图片有鼠标样式并被点击得到\r\n\r\n  .drag-dot {\r\n    $dot-size: 10px;\r\n\r\n    box-sizing: border-box;\r\n    position: absolute;\r\n    width: $dot-size;\r\n    height: $dot-size;\r\n    right: math.div(-$dot-size, 2);\r\n    bottom: math.div(-$dot-size, 2);\r\n    background-color: $main-color-normal;\r\n    border: 1px solid $white;\r\n    border-radius: 50%;\r\n\r\n    box-shadow: 0px 0px 3px 0px $black;\r\n    cursor: nwse-resize;\r\n    pointer-events: all;\r\n  }\r\n}\r\n</style>',".pic-flexible-frame {\n  z-index: 200;\n  box-sizing: border-box;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  border: 2px solid #39a3ff;\n  pointer-events: none;\n}\n.pic-flexible-frame .drag-dot {\n  box-sizing: border-box;\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  right: -5px;\n  bottom: -5px;\n  background-color: #0089ff;\n  border: 1px solid #fff;\n  border-radius: 50%;\n  box-shadow: 0px 0px 3px 0px #000;\n  cursor: nwse-resize;\n  pointer-events: all;\n}\n\n/*# sourceMappingURL=PicFlexibleFrame.vue.map */"]},media:void 0})}),an,"data-v-7a002282",!1,void 0,!1,T,void 0,void 0),cn={props:{hasSibling:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!0},isLast:{type:Boolean,default:!0}},data:function(){return{PIC_MORE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAItJREFUWEft1rENhDAQBMDdYoje7oEmqOdFQjMUAT3ckRHSBNGRECAEr4+wkNbpyfJqLGtNFF4sfD4UQAISkIAEJHArkFL6kmz2smrNrD8WV865iYiO5Argdg5gATC6e3tVfL8CDADqfdPs7tUpgEfE5585ycnM0usClL2Cpz4qeoYSkIAEJCCB4gIb7P1YIebn6mcAAAAASUVORK5CYII=",PIC_DELETE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAALFJREFUWEftltENgCAMBR/rGNdxHnUe1zGuo2kiCSFUHkbsT/3E0l6uRQkwfoJxfTiAG2g1MANYKoMr71d2uN8CaBCy/guABn5+CcDoZk2rVp5aMACY7gpRLVtQ4tI9G4CjtJmZgWiCiU1rUO1gkjpAycAOQPoaz7vEyLyMSQ+6tiBPXoJ0ADfQ1YD5KWA+yV0NOICJAaZoHlO9HTF/w/Re0Aqh3gNiIgagtWhTvAO4gQvq8FEh2SuKqQAAAABJRU5ErkJggg==",PIC_FORWARD:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAZlJREFUWEfV179LVlEYwPGPu4Rz0j9QuDUlQk0N0aBSRkYNRUMFLVFgbpHk4KI2NBSCFAQOIYq1VFC0aFs/oC1qaapoqkkeOELkj/d9z7m3i3d6l8v3cw/vPc+5XRq+uhru29WAHuzFh5JVzF2BfVhGH47gZS4iB7AHSxjAEwzmxuO+HMAijuM5hvDzfwLmcQZrKf6lJN7pCszgCj7iJN6VxjsB3MI44olP4U0V8XYBN3AH3zGKlari7QAuYxZ/cBaPq4y3ApzDXAqex4Oq4zsBhrGQglcxXUd8O8BRPE3Bm5ioK74V4DBe1BhcTfvIp43GvzvhfrxvEhDtbvxKiHj3b9cI2nYW9OJrCl/DVF2InYbRgb+229iC79aBaDUN+/E6hS/gftWIVoDoHUvzP37HVvyoSkQ7gOidxkP8TsMoDiKVXO0CInYp/Q/iADKCZ1UIOgFEbyy9lt9wAq9KEZ0CojeJ6/iMmBlvSxA5gOjdw8V0OjqEH7mIXED04mwQR7ODJatQAghEzI5GPkxyV3zTfaUrUAxpHLAOtiE/IX3fHQQAAAAASUVORK5CYII=",PIC_BACKWARD:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAZxJREFUWEfd1z9IVlEYx/GPi02FEITQUG1aDUUQ0RRUW/gPGqtVrSWIKFwKIoioqchR0cXS/swFjTm5iC1Cubc11BoPPIKKr/e1++dFz3KXy/l+z3Oe+zvndunw6Oow374QOIdV/P6fapatwEmsYBmD+LlbibICh7CI/nxexp/dSJQVCNZZLOAEvuBq0wLBu5gSvfiI4XYlqqjAOivKP48ezOJGOxJVCgTvWkocwCTGiiSqFgjedbxN8DM82EmiDoHg3cJUgu/gdSuJugSCN4o3CR7Cp+0k6hQI3l28THAk5tJWiboFgjeBJwk+gl8bJbYKHMdXxLOuEYG1tj55JwRO4XsrgTpW/RBPc+KbmNlpC6oWuI1XOWmEUoTTplFnE8Zqp5N2Dy+a/Azju59DNx7hcZNBFIdSwA/jOe43GcXn8xw4lik4XtRUVfZAH97hdHZ69EDhqErgaB7DF/ABI4XkfKEKgYN4jyv4nJfTv00KBDyuYN8Svinri0TKVuBSnh1xLR/YmPFF4Cqj+Ax+dOrHpN2Ftnyv7BbsfYF/PKU5IZehbDIAAAAASUVORK5CYII=",isBtnListVisible:!1}},methods:{onBtnMoreClick:function(){this.isBtnListVisible=!this.isBtnListVisible},onBtnDeleteClick:function(){this.$emit("delete-click")},onBtnForwardClick:function(){this.$emit("forward-click")},onBtnBackwardClick:function(){this.$emit("backward-click")}}},An=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"btn-more-list"},[r("div",{staticClass:"btn-more",style:{"background-image":"url("+n.PIC_MORE+")"},on:{click:function(e){return e.stopPropagation(),n.onBtnMoreClick.apply(null,arguments)}}}),n._v(" "),n.isBtnListVisible?r("div",{staticClass:"btn-list"},[r("div",{staticClass:"btn delete",on:{click:function(e){return e.stopPropagation(),n.onBtnDeleteClick.apply(null,arguments)}}},[r("div",{staticClass:"icon",style:{"background-image":"url("+n.PIC_DELETE+")"}}),n._v(" "),n._m(0)]),n._v(" "),n.hasSibling&&!n.isFirst?r("div",{staticClass:"btn forward",on:{click:function(e){return e.stopPropagation(),n.onBtnForwardClick.apply(null,arguments)}}},[r("div",{staticClass:"icon",style:{"background-image":"url("+n.PIC_FORWARD+")"}}),n._v(" "),n._m(1)]):n._e(),n._v(" "),n.hasSibling&&!n.isLast?r("div",{staticClass:"btn backward",on:{click:function(e){return e.stopPropagation(),n.onBtnBackwardClick.apply(null,arguments)}}},[r("div",{staticClass:"icon",style:{"background-image":"url("+n.PIC_BACKWARD+")"}}),n._v(" "),n._m(2)]):n._e()]):n._e()])};An._withStripped=!0;var hn=F({render:An,staticRenderFns:[function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"text"},[r("span",[n._v("删除")])])},function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"text"},[r("span",[n._v("前移")])])},function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"text"},[r("span",[n._v("后移")])])}]},(function(n){n&&n("data-v-2dfd0f94_0",{source:".btn-more-list[data-v-2dfd0f94] {\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  z-index: 300;\n}\n.btn-more-list .btn-more[data-v-2dfd0f94] {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border: 1px solid #aaaaaa;\n  background-color: #fff;\n  cursor: pointer;\n  border-radius: 4px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.btn-more-list .btn-list[data-v-2dfd0f94] {\n  width: 80px;\n  position: absolute;\n  top: 28px;\n  right: 0px;\n  background-color: #fff;\n  border-radius: 4px;\n  border: 1px solid #eeeeee;\n}\n.btn-more-list .btn-list .btn[data-v-2dfd0f94] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 32px;\n  line-height: 32px;\n  cursor: pointer;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n.btn-more-list .btn-list .btn .icon[data-v-2dfd0f94] {\n  width: 32px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n.btn-more-list .btn-list .btn[data-v-2dfd0f94]:hover {\n  background-color: #dddddd;\n}\n.btn-more-list .btn-list .btn.delete .icon[data-v-2dfd0f94] {\n  background-size: 24px 24px;\n}\n.btn-more-list .btn-list .btn.forward .icon[data-v-2dfd0f94] {\n  background-size: 16.8px 16.8px;\n}\n.btn-more-list .btn-list .btn.backward .icon[data-v-2dfd0f94] {\n  background-size: 16.8px 16.8px;\n}\n\n/*# sourceMappingURL=BtnMoreList.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\Core\\Card\\BtnMoreList.vue","BtnMoreList.vue"],names:[],mappings:"AAgGA;EACA,WAHA;EAIA,YAJA;EAKA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,YAAA;AC/FA;ADiGA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;EACA,4BAAA;EACA,wBAAA;AC/FA;ADkGA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,sBAAA;EACA,kBAAA;EACA,yBAAA;AChGA;ADmGA;EACA,sBAAA;EACA,WAAA;EACA,YAJA;EAKA,iBALA;EAOA,eAAA;EACA,aAAA;EACA,2BAAA;EACA,mBAAA;AClGA;ADoGA;EACA,WAbA;EAcA,YAdA;EAeA,4BAAA;EACA,kCAAA;AClGA;ADqGA;EACA,yBAAA;ACnGA;ADuGA;EACA,0BAAA;ACrGA;ADyGA;EACA,8BAAA;ACvGA;AD2GA;EACA,8BAAA;ACzGA;;AAEA,0CAA0C",file:"BtnMoreList.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-16 14:43:12\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-16 15:36:20\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="btn-more-list">\r\n    <div\r\n      class="btn-more"\r\n      :style="{ \'background-image\': `url(${PIC_MORE})` }"\r\n      @click.stop="onBtnMoreClick"\r\n    ></div>\r\n    <div class="btn-list" v-if="isBtnListVisible">\r\n      <div class="btn delete" @click.stop="onBtnDeleteClick">\r\n        <div\r\n          class="icon"\r\n          :style="{ \'background-image\': `url(${PIC_DELETE})` }"\r\n        ></div>\r\n        <div class="text">\r\n          <span>删除</span>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class="btn forward"\r\n        v-if="hasSibling && !isFirst"\r\n        @click.stop="onBtnForwardClick"\r\n      >\r\n        <div\r\n          class="icon"\r\n          :style="{ \'background-image\': `url(${PIC_FORWARD})` }"\r\n        ></div>\r\n        <div class="text">\r\n          <span>前移</span>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class="btn backward"\r\n        v-if="hasSibling && !isLast"\r\n        @click.stop="onBtnBackwardClick"\r\n      >\r\n        <div\r\n          class="icon"\r\n          :style="{ \'background-image\': `url(${PIC_BACKWARD})` }"\r\n        ></div>\r\n        <div class="text">\r\n          <span>后移</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport PIC_MORE from "../../../../../assets/icons/MediaFrame/more.png";\r\nimport PIC_DELETE from "../../../../../assets/icons/MediaFrame/delete.png";\r\nimport PIC_FORWARD from "../../../../../assets/icons/MediaFrame/forward.png";\r\nimport PIC_BACKWARD from "../../../../../assets/icons/MediaFrame/backward.png";\r\n\r\nexport default {\r\n  props: {\r\n    hasSibling: { type: Boolean, default: false }, // 单资源还是多资源\r\n    isFirst: { type: Boolean, default: true }, // 是否第一位\r\n    isLast: { type: Boolean, default: true }, // 是否最后一位\r\n  },\r\n  data() {\r\n    return {\r\n      PIC_MORE,\r\n      PIC_DELETE,\r\n      PIC_FORWARD,\r\n      PIC_BACKWARD,\r\n\r\n      isBtnListVisible: false, // 下拉框是否可见\r\n    };\r\n  },\r\n  methods: {\r\n    onBtnMoreClick() {\r\n      this.isBtnListVisible = !this.isBtnListVisible;\r\n    },\r\n    onBtnDeleteClick() {\r\n      this.$emit("delete-click");\r\n    },\r\n    onBtnForwardClick() {\r\n      this.$emit("forward-click");\r\n    },\r\n    onBtnBackwardClick() {\r\n      this.$emit("backward-click");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n$btn-more-size: 24px;\r\n\r\n.btn-more-list {\r\n  width: $btn-more-size;\r\n  height: $btn-more-size;\r\n  position: absolute;\r\n  top: 4px;\r\n  right: 4px;\r\n  z-index: 300;\r\n\r\n  .btn-more {\r\n    width: 100%;\r\n    height: 100%;\r\n    box-sizing: border-box;\r\n    border: 1px solid $grey-color-normal;\r\n    background-color: $white;\r\n    cursor: pointer;\r\n    border-radius: 4px;\r\n    background-repeat: no-repeat;\r\n    background-size: contain;\r\n  }\r\n\r\n  .btn-list {\r\n    width: 80px;\r\n    position: absolute;\r\n    top: $btn-more-size + 4px;\r\n    right: 0px;\r\n    background-color: $white;\r\n    border-radius: 4px;\r\n    border: 1px solid $grey-color-light;\r\n\r\n    $btn-height: 32px;\r\n    .btn {\r\n      box-sizing: border-box;\r\n      width: 100%;\r\n      height: $btn-height;\r\n      line-height: $btn-height;\r\n      // padding: 0 8px 0 $btn-more-size + 4px;\r\n      cursor: pointer;\r\n      display: flex;\r\n      justify-content: flex-start;\r\n      align-items: center;\r\n\r\n      .icon {\r\n        width: $btn-height;\r\n        height: $btn-height;\r\n        background-repeat: no-repeat;\r\n        background-position: center center;\r\n      }\r\n\r\n      &:hover {\r\n        background-color: $grey-color-light2;\r\n      }\r\n\r\n      &.delete {\r\n        .icon {\r\n          background-size: $btn-more-size $btn-more-size;\r\n        }\r\n      }\r\n      &.forward {\r\n        .icon {\r\n          background-size: $btn-more-size * 0.7 $btn-more-size * 0.7;\r\n        }\r\n      }\r\n      &.backward {\r\n        .icon {\r\n          background-size: $btn-more-size * 0.7 $btn-more-size * 0.7;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>',".btn-more-list {\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  z-index: 300;\n}\n.btn-more-list .btn-more {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border: 1px solid #aaaaaa;\n  background-color: #fff;\n  cursor: pointer;\n  border-radius: 4px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.btn-more-list .btn-list {\n  width: 80px;\n  position: absolute;\n  top: 28px;\n  right: 0px;\n  background-color: #fff;\n  border-radius: 4px;\n  border: 1px solid #eeeeee;\n}\n.btn-more-list .btn-list .btn {\n  box-sizing: border-box;\n  width: 100%;\n  height: 32px;\n  line-height: 32px;\n  cursor: pointer;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n.btn-more-list .btn-list .btn .icon {\n  width: 32px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n.btn-more-list .btn-list .btn:hover {\n  background-color: #dddddd;\n}\n.btn-more-list .btn-list .btn.delete .icon {\n  background-size: 24px 24px;\n}\n.btn-more-list .btn-list .btn.forward .icon {\n  background-size: 16.8px 16.8px;\n}\n.btn-more-list .btn-list .btn.backward .icon {\n  background-size: 16.8px 16.8px;\n}\n\n/*# sourceMappingURL=BtnMoreList.vue.map */"]},media:void 0})}),cn,"data-v-2dfd0f94",!1,void 0,!1,T,void 0,void 0),un={components:{BtnMoreList:hn},props:{hasSibling:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!0},isLast:{type:Boolean,default:!0},resource:{type:Object,required:!0},isPicPreviewAllow:{type:Boolean,default:!1},isBtnMoreVisible:{type:Boolean,default:!1}},data:function(){return{}},computed:{isGloballyReadonly:function(){return s.state.isGloballyReadonly}},watch:{isBtnMoreVisible:function(n){n||(this.isBtnListVisible=!1)}},methods:{onImgClick:function(){this.isPicPreviewAllow&&this.$emit("img-click",this.resource)},onBtnDeleteClick:function(){this.$emit("delete-click",this.resource)},onBtnForwardClick:function(){this.$emit("forward-click",this.resource)},onBtnBackwardClick:function(){this.$emit("backward-click",this.resource)}}},pn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"img-card"},[!n.isGloballyReadonly&&n.isBtnMoreVisible?r("BtnMoreList",{attrs:{hasSibling:n.hasSibling,isFirst:n.isFirst,isLast:n.isLast},on:{"delete-click":n.onBtnDeleteClick,"forward-click":n.onBtnForwardClick,"backward-click":n.onBtnBackwardClick}}):n._e(),n._v(" "),r("img",{staticClass:"img",class:{"allow-preview":n.isPicPreviewAllow},style:{objectFit:n.hasSibling?"cover":"fill"},attrs:{src:n.resource.url,draggable:"false"},on:{click:n.onImgClick}})],1)};pn._withStripped=!0;var fn=F({render:pn,staticRenderFns:[]},(function(n){n&&n("data-v-1502f7ae_0",{source:".img-card[data-v-1502f7ae] {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.img-card .img[data-v-1502f7ae] {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.img-card .img.allow-preview[data-v-1502f7ae] {\n  cursor: zoom-in;\n}\n\n/*# sourceMappingURL=ImgCard.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\Core\\ImgCard.vue","ImgCard.vue"],names:[],mappings:"AAkFA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,gBAAA;ACjFA;ADmFA;EAEA,WAAA;EACA,YAAA;EACA,YAAA;EACA,kBAAA;AClFA;ADoFA;EACA,eAAA;AClFA;;AAEA,sCAAsC",file:"ImgCard.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-18 17:32:16\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:21:34\r\n * @Description: 图片框\r\n--\x3e\r\n\r\n<template>\r\n  <div class="img-card">\r\n    <BtnMoreList\r\n      v-if="!isGloballyReadonly && isBtnMoreVisible"\r\n      :hasSibling="hasSibling"\r\n      :isFirst="isFirst"\r\n      :isLast="isLast"\r\n      @delete-click="onBtnDeleteClick"\r\n      @forward-click="onBtnForwardClick"\r\n      @backward-click="onBtnBackwardClick"\r\n    />\r\n\r\n    <img\r\n      class="img"\r\n      :class="{ \'allow-preview\': isPicPreviewAllow }"\r\n      :style="{ objectFit: hasSibling ? \'cover\' : \'fill\' }"\r\n      :src="resource.url"\r\n      draggable="false"\r\n      @click="onImgClick"\r\n    />\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../../../../store";\r\nimport BtnMoreList from "./Card/BtnMoreList.vue";\r\n\r\nexport default {\r\n  components: { BtnMoreList },\r\n  props: {\r\n    hasSibling: { type: Boolean, default: false }, // 单图片资源还是多资源\r\n    isFirst: { type: Boolean, default: true }, // 是否第一幅图片\r\n    isLast: { type: Boolean, default: true }, // 是否最后一幅图片\r\n    resource: { type: Object, required: true }, // 资源对象\r\n    isPicPreviewAllow: { type: Boolean, default: false }, // 当前图片是否处于可预览状态\r\n    isBtnMoreVisible: { type: Boolean, default: false }, // “更多”操作按钮是否显示\r\n  },\r\n  data() {\r\n    return {};\r\n  },\r\n  computed: {\r\n    isGloballyReadonly: function () {\r\n      return myStore.state.isGloballyReadonly;\r\n    },\r\n  },\r\n  watch: {\r\n    isBtnMoreVisible: function (v /* , ov */) {\r\n      if (!v) {\r\n        // 如果不再显示按钮\r\n        this.isBtnListVisible = false;\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    // 预览图片\r\n    onImgClick() {\r\n      if (this.isPicPreviewAllow) {\r\n        this.$emit("img-click", this.resource);\r\n      }\r\n    },\r\n    onBtnDeleteClick() {\r\n      this.$emit("delete-click", this.resource);\r\n    },\r\n    onBtnForwardClick() {\r\n      this.$emit("forward-click", this.resource);\r\n    },\r\n    onBtnBackwardClick() {\r\n      this.$emit("backward-click", this.resource);\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.img-card {\r\n  width: 100%;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  border-radius: 4px;\r\n  background-color: $white;\r\n  overflow: hidden;\r\n\r\n  .img {\r\n    // object-fit: fill;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 100;\r\n    position: relative; // 图片要脱离标准流，才能触发鼠标的 cursor\r\n\r\n    &.allow-preview {\r\n      cursor: zoom-in;\r\n    }\r\n  }\r\n}\r\n</style>',".img-card {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.img-card .img {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.img-card .img.allow-preview {\n  cursor: zoom-in;\n}\n\n/*# sourceMappingURL=ImgCard.vue.map */"]},media:void 0})}),un,"data-v-1502f7ae",!1,void 0,!1,T,void 0,void 0),mn={components:{PicFlexibleFrame:dn,ImgCard:fn},props:{resource:{type:Object,required:!0},titleHeight:{type:Number,required:!0},isFlexibleFrameVisible:{type:Boolean,default:!1}},data:function(){return{}},computed:{isPicPreviewAllow:function(){return this.isFlexibleFrameVisible}},methods:{onPicFrameClick:function(){this.$emit("click")},onFlexibleFramDragDotMousedown:function(n,e){this.$emit("drag-dot-mousedown",n,e)},onImgClick:function(){this.isPicPreviewAllow&&this.$emit("preview-click",this.resource)}}},gn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"pic-single-core",attrs:{id:n.resource.id}},[r("div",{staticClass:"head",style:{height:n.titleHeight+"px"}},[n._t("default")],2),n._v(" "),r("div",{staticClass:"pic-frame",style:{width:n.resource.contentWidth+"px",height:n.resource.contentHeight+"px"},on:{click:n.onPicFrameClick}},[r("ImgCard",{attrs:{resource:n.resource,hasSibling:!1,isPicPreviewAllow:n.isPicPreviewAllow,isBtnMoreVisible:n.isFlexibleFrameVisible},on:{"img-click":n.onImgClick,"delete-click":function(e){return n.$emit("delete-click",e)}}}),n._v(" "),r("PicFlexibleFrame",{staticClass:"flexible-frame",attrs:{isVisible:n.isFlexibleFrameVisible},on:{"drag-dot-mousedown":n.onFlexibleFramDragDotMousedown}})],1)])};gn._withStripped=!0;var vn=F({render:gn,staticRenderFns:[]},(function(n){n&&n("data-v-4a8b0109_0",{source:".pic-single-core[data-v-4a8b0109] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.pic-single-core .head[data-v-4a8b0109] {\n  width: 100%;\n}\n.pic-single-core .pic-frame[data-v-4a8b0109] {\n  position: relative;\n}\n.pic-single-core .pic-frame .img[data-v-4a8b0109] {\n  object-fit: fill;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.pic-single-core .pic-frame .img.allow-preview[data-v-4a8b0109] {\n  cursor: zoom-in;\n}\n\n/*# sourceMappingURL=PicSingleCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\PicSingleCore.vue","PicSingleCore.vue"],names:[],mappings:"AAgFA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;AC/EA;ADiFA;EACA,WAAA;AC/EA;ADiFA;EACA,kBAAA;AC/EA;ADgFA;EACA,gBAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,kBAAA;AC9EA;ADgFA;EACA,eAAA;AC9EA;;AAEA,4CAA4C",file:"PicSingleCore.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-22 18:04:21\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-16 15:54:15\r\n * @Description: 图片节点的内容组件(本组件不设置 padding，如有需要在节点对象中设置 padding)\r\n--\x3e\r\n\r\n<template>\r\n  <div :id="resource.id" class="pic-single-core">\r\n    <div class="head" :style="{ height: `${titleHeight}px` }">\r\n      <slot></slot>\r\n    </div>\r\n    <div\r\n      class="pic-frame"\r\n      :style="{\r\n        width: `${resource.contentWidth}px`,\r\n        height: `${resource.contentHeight}px`,\r\n      }"\r\n      @click="onPicFrameClick"\r\n    >\r\n      <ImgCard\r\n        :resource="resource"\r\n        :hasSibling="false"\r\n        :isPicPreviewAllow="isPicPreviewAllow"\r\n        :isBtnMoreVisible="isFlexibleFrameVisible"\r\n        @img-click="onImgClick"\r\n        @delete-click="$emit(\'delete-click\', $event)"\r\n      />\r\n\r\n      <PicFlexibleFrame\r\n        class="flexible-frame"\r\n        :isVisible="isFlexibleFrameVisible"\r\n        @drag-dot-mousedown="onFlexibleFramDragDotMousedown"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n// import { TYPES } from "../../../const.js";\r\n// import Node from "../../../entities/NormalNode.js";\r\nimport PicFlexibleFrame from "../Other/PicFlexibleFrame.vue";\r\n// import Previewer from "../../../components/MindMap/Previewer/Previewer.vue";\r\nimport ImgCard from "../../../components/MindMap/Node/Core/ImgCard.vue";\r\n\r\nexport default {\r\n  components: { PicFlexibleFrame, ImgCard },\r\n  props: {\r\n    resource: { type: Object, required: true },\r\n    titleHeight: { type: Number, required: true },\r\n    isFlexibleFrameVisible: { type: Boolean, default: false }, // 缩放图片的框是否显示\r\n  },\r\n  data() {\r\n    return {};\r\n  },\r\n  computed: {\r\n    // 图片是否处于可预览状态\r\n    isPicPreviewAllow: function () {\r\n      return this.isFlexibleFrameVisible;\r\n    },\r\n  },\r\n  methods: {\r\n    // 图片被点击时(图片可预览状态尚未被激活)\r\n    onPicFrameClick() {\r\n      this.$emit("click");\r\n    },\r\n    // 图片缩放框的右下角圆点被点击时\r\n    onFlexibleFramDragDotMousedown(event, refFrame) {\r\n      this.$emit("drag-dot-mousedown", event, refFrame);\r\n    },\r\n    // 预览图片\r\n    onImgClick() {\r\n      if (this.isPicPreviewAllow) {\r\n        this.$emit("preview-click", this.resource);\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.pic-single-core {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .head {\r\n    width: 100%;\r\n  }\r\n  .pic-frame {\r\n    position: relative;\r\n    .img {\r\n      object-fit: fill;\r\n      width: 100%;\r\n      height: 100%;\r\n      z-index: 100;\r\n      position: relative; // 图片要脱离标准流，才能触发鼠标的 cursor\r\n\r\n      &.allow-preview {\r\n        cursor: zoom-in;\r\n      }\r\n    }\r\n\r\n    // .flexible-frame {\r\n    //   z-index: 200;\r\n    // }\r\n  }\r\n}\r\n</style>',".pic-single-core {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.pic-single-core .head {\n  width: 100%;\n}\n.pic-single-core .pic-frame {\n  position: relative;\n}\n.pic-single-core .pic-frame .img {\n  object-fit: fill;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.pic-single-core .pic-frame .img.allow-preview {\n  cursor: zoom-in;\n}\n\n/*# sourceMappingURL=PicSingleCore.vue.map */"]},media:void 0})}),mn,"data-v-4a8b0109",!1,void 0,!1,T,void 0,void 0),bn={props:{icon:{type:String,validator:function(n){return-1!==["hide","play","pause"].indexOf(n)}}},data:function(){return{PIC_PLAY:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAblJREFUWEfN1zFLw0AUB/D3QttZR0H0KwiOfoFCl0vAb6AgfgBdFB1srYKzg4MgTj24l+tSCmI7FQdBXHRxFSe1CG62Tw4SaGs1CSQ5s/bd/X+5u+buECw/aDkfpgKEEHuIOAcAi8zcKRaLSkr5lAX2B8DzvDVmPpsS1gIASUTnaULGAJVKZbZUKr1FBDQAoEZE92lAxgBCiGVEvI3qmJk/HMepKqWOo2qjfh8DuK67CgDmDeM+HUSsKaWu4jaYrJsEbANAPWlnzHyCiIdE9Jq07eQUmNW/n7SToP7R4InoIkn7NAFhbmMwGNSbzeZdHEgWAGDmTzMa/X6/3u12v/6CZAIYCbwJpkX/hsgaEOZWiWhnGiIvgMluFQqFdSnl8ygkT4BZG23f98vWACZ4OByWtdbtEJHrCASAFa11zxaAiMizMgXM7DuOs6mUeskdwMy7vu8f2Pgb2vkQ2f4UW9uMUtmOtxDxKM42OlqT5oFEICIlAKR7JBNCLCFi5EEis0OpEGIGEd8jRiC7Y7kJdl13AwBOpyCuAeAy04tJGBpczRYAYJ6Ze8wstdYPCdZG7NL/eTmNzU+h8Bu+rt0hwSXo9QAAAABJRU5ErkJggg==",PIC_PAUSE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAMhJREFUWEftl7ENwjAQRb/3AIkeNmAJX09JAVMQpoCCkv5nCTaAHonscUgRRI4FyDohJcW59X356bm5HzDwCQO/jx6AiJwBLAHMvoDdAVxIrj7dW/IdQIxxF0KoSoyoalXX9T6dteY7ABF5AJiUAABoSE7TWWs+BdDCx9sxkvn3mfIO4AbcgBtwA27ADbgBN+AGRmXgCmBeuBnfSC6ytdyUTw1sABwKAbYkjxmAKd/b7V/tZv2joDSqespb0RvEkh9XOS3U/9exJ5/n/CHs2xvHAAAAAElFTkSuQmCC"}},computed:{iconPic:function(){switch(this.icon){case"play":return this.PIC_PLAY;case"pause":return this.PIC_PAUSE;default:return""}},iconStyle:function(){switch(this.icon){case"play":return{"background-position":"60% center"};case"pause":return{"background-position":"center center"};default:return""}}},methods:{onBtnClick:function(){switch(this.icon){case"hide":break;case"play":this.$emit("play-click");break;case"pause":this.$emit("pause-click")}}}},Cn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.iconPic?r("div",{staticClass:"btn-play",style:Object.assign({},{"background-image":"url("+n.iconPic+")"},n.iconStyle),on:{click:function(e){return e.stopPropagation(),n.onBtnClick.apply(null,arguments)}}}):n._e()};Cn._withStripped=!0;var wn=F({render:Cn,staticRenderFns:[]},(function(n){n&&n("data-v-066a53d6_0",{source:".btn-play[data-v-066a53d6] {\n  position: absolute;\n  box-sizing: border-box;\n  width: 48px;\n  height: 48px;\n  top: calc(50% - 24px);\n  right: calc(50% - 24px);\n  border: 1px solid #eeeeee;\n  border-radius: 50%;\n  background-color: #fff;\n  background-repeat: no-repeat;\n  background-size: 24px 24px;\n  z-index: 200;\n}\n.btn-play[data-v-066a53d6]:hover {\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=BtnPlayAndPause.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\BtnPlayAndPause.vue","BtnPlayAndPause.vue"],names:[],mappings:"AAgFA;EAEA,kBAAA;EACA,sBAAA;EACA,WAHA;EAIA,YAJA;EAKA,qBAAA;EACA,uBAAA;EACA,yBAAA;EACA,kBAAA;EACA,sBAAA;EACA,4BAAA;EAEA,0BAAA;EACA,YAAA;ACjFA;ADmFA;EACA,eAAA;ACjFA;;AAEA,8CAA8C",file:"BtnPlayAndPause.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-15 13:45:21\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-16 16:29:21\r\n * @Description: 请输入\r\n--\x3e\r\n<template>\r\n  <div\r\n    v-if="iconPic"\r\n    class="btn-play"\r\n    :style="{ \'background-image\': `url(${iconPic})`, ...iconStyle }"\r\n    @click.stop="onBtnClick"\r\n  ></div>\r\n</template>\r\n<script>\r\nimport PIC_PLAY from "../../../assets/icons/VideoCard/play.png";\r\nimport PIC_PAUSE from "../../../assets/icons/VideoCard/pause.png";\r\n\r\nexport default {\r\n  props: {\r\n    icon: {\r\n      type: String,\r\n      validator: function (v) {\r\n        return ["hide", "play", "pause"].indexOf(v) !== -1;\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return { PIC_PLAY, PIC_PAUSE };\r\n  },\r\n  computed: {\r\n    iconPic: function () {\r\n      switch (this.icon) {\r\n        case "play":\r\n          return this.PIC_PLAY;\r\n        case "pause":\r\n          return this.PIC_PAUSE;\r\n        default:\r\n          return "";\r\n      }\r\n    },\r\n    iconStyle: function () {\r\n      switch (this.icon) {\r\n        case "play":\r\n          return {\r\n            "background-position": "60% center",\r\n          };\r\n        case "pause":\r\n          return {\r\n            "background-position": "center center",\r\n          };\r\n        default:\r\n          return "";\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onBtnClick() {\r\n      switch (this.icon) {\r\n        case "hide": {\r\n          break;\r\n        }\r\n        case "play": {\r\n          this.$emit("play-click");\r\n          break;\r\n        }\r\n        case "pause": {\r\n          this.$emit("pause-click");\r\n          break;\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n@import "../../../scss/_variables.scss";\r\n\r\n.btn-play {\r\n  $size: 48px;\r\n  position: absolute;\r\n  box-sizing: border-box;\r\n  width: $size;\r\n  height: $size;\r\n  top: calc(50% - #{math.div($size, 2)});\r\n  right: calc(50% - #{math.div($size, 2)});\r\n  border: 1px solid $grey-color-light;\r\n  border-radius: 50%;\r\n  background-color: $white;\r\n  background-repeat: no-repeat;\r\n\r\n  background-size: 24px 24px;\r\n  z-index: 200;\r\n\r\n  &:hover {\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>',".btn-play {\n  position: absolute;\n  box-sizing: border-box;\n  width: 48px;\n  height: 48px;\n  top: calc(50% - 24px);\n  right: calc(50% - 24px);\n  border: 1px solid #eeeeee;\n  border-radius: 50%;\n  background-color: #fff;\n  background-repeat: no-repeat;\n  background-size: 24px 24px;\n  z-index: 200;\n}\n.btn-play:hover {\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=BtnPlayAndPause.vue.map */"]},media:void 0})}),bn,"data-v-066a53d6",!1,void 0,!1,T,void 0,void 0),xn={components:{BtnMoreList:hn,BtnPlayAndPause:wn},props:{hasSibling:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!0},isLast:{type:Boolean,default:!0},src:{type:String,required:!0},sourceType:{type:String,default:"video/mp4"},isBtnMoreVisible:{type:Boolean,default:!1}},data:function(){return{}},computed:{isGloballyReadonly:function(){return s.state.isGloballyReadonly}},methods:{onBtnPlayClick:function(){this.$emit("video-play-click")},onBtnDeleteClick:function(){this.$emit("delete-click")},onBtnForwardClick:function(){this.$emit("forward-click")},onBtnBackwardClick:function(){this.$emit("backward-click")}}},kn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"video-card"},[!n.isGloballyReadonly&&n.isBtnMoreVisible?r("BtnMoreList",{attrs:{hasSibling:n.hasSibling,isFirst:n.isFirst,isLast:n.isLast},on:{"delete-click":n.onBtnDeleteClick,"forward-click":n.onBtnForwardClick,"backward-click":n.onBtnBackwardClick}}):n._e(),n._v(" "),r("video",{staticClass:"video",attrs:{preload:"metadata",disablepictureinpicture:""}},[r("source",{staticClass:"source",attrs:{src:n.src,type:n.sourceType}})]),n._v(" "),r("BtnPlayAndPause",{attrs:{icon:"play"},on:{"play-click":n.onBtnPlayClick}})],1)};kn._withStripped=!0;var En=F({render:kn,staticRenderFns:[]},(function(n){n&&n("data-v-5f473eec_0",{source:".video-card[data-v-5f473eec] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.video-card .video[data-v-5f473eec] {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  object-position: 50% 50%;\n  background-color: #666666;\n}\n\n/*# sourceMappingURL=VideoCard.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\Core\\VideoCard.vue","VideoCard.vue"],names:[],mappings:"AA8EA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,gBAAA;AC7EA;AD+EA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EAEA,wBAAA;EACA,yBAAA;AC9EA;;AAEA,wCAAwC",file:"VideoCard.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-10 18:29:54\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-17 13:48:30\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="video-card">\r\n    \x3c!-- <video\r\n      class="video"\r\n      controls\r\n      controlslist="nodownload nofullscreen"\r\n      preload="metadata"\r\n      disablepictureinpicture\r\n    > --\x3e\r\n\r\n    <BtnMoreList\r\n      v-if="!isGloballyReadonly && isBtnMoreVisible"\r\n      :hasSibling="hasSibling"\r\n      :isFirst="isFirst"\r\n      :isLast="isLast"\r\n      @delete-click="onBtnDeleteClick"\r\n      @forward-click="onBtnForwardClick"\r\n      @backward-click="onBtnBackwardClick"\r\n    />\r\n\r\n    <video class="video" preload="metadata" disablepictureinpicture>\r\n      <source class="source" :src="src" :type="sourceType" />\r\n    </video>\r\n\r\n    <BtnPlayAndPause :icon="\'play\'" @play-click="onBtnPlayClick" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../../../../store";\r\nimport BtnMoreList from "./Card/BtnMoreList.vue";\r\nimport BtnPlayAndPause from "../../Btns/BtnPlayAndPause.vue";\r\n\r\nexport default {\r\n  components: { BtnMoreList, BtnPlayAndPause },\r\n  props: {\r\n    hasSibling: { type: Boolean, default: false }, // 单资源还是多资源\r\n    isFirst: { type: Boolean, default: true }, // 是否第一个资源\r\n    isLast: { type: Boolean, default: true }, // 是否最后一个资源\r\n    // resource: { type: Object, required: true }, // 资源对象\r\n    src: { type: String, required: true },\r\n    sourceType: { type: String, default: "video/mp4" },\r\n    isBtnMoreVisible: { type: Boolean, default: false }, // “更多”操作按钮是否显示\r\n  },\r\n  data() {\r\n    return {};\r\n  },\r\n  computed: {\r\n    isGloballyReadonly: function () {\r\n      return myStore.state.isGloballyReadonly;\r\n    },\r\n  },\r\n  methods: {\r\n    onBtnPlayClick() {\r\n      this.$emit("video-play-click");\r\n    },\r\n    onBtnDeleteClick() {\r\n      this.$emit("delete-click");\r\n    },\r\n    onBtnForwardClick() {\r\n      this.$emit("forward-click");\r\n    },\r\n    onBtnBackwardClick() {\r\n      this.$emit("backward-click");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../../scss/_variables.scss";\r\n\r\n.video-card {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  box-sizing: border-box;\r\n  border-radius: 4px;\r\n  background-color: $white;\r\n  overflow: hidden;\r\n\r\n  .video {\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 100;\r\n    // object-fit: scale-down;\r\n    object-position: 50% 50%;\r\n    background-color: $grey-color-dark;\r\n    // .source {\r\n    //   width: 100%;\r\n    //   height: 100%;\r\n    // }\r\n  }\r\n}\r\n</style>',".video-card {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.video-card .video {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  object-position: 50% 50%;\n  background-color: #666666;\n}\n\n/*# sourceMappingURL=VideoCard.vue.map */"]},media:void 0})}),xn,"data-v-5f473eec",!1,void 0,!1,T,void 0,void 0),yn={components:{VideoCard:En,PicFlexibleFrame:dn},data:function(){return{}},props:{resource:{type:Object,required:!0},titleHeight:{type:Number,required:!0},isFlexibleFrameVisible:{type:Boolean,default:!1}},methods:{onVideoFrameClick:function(){this.$emit("click")},onFlexibleFramDragDotMousedown:function(n,e){this.$emit("drag-dot-mousedown",n,e)},onVideoPlayClick:function(){this.$emit("video-play-click",this.resource)}}},Sn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"video-single-core",attrs:{id:n.resource.id}},[r("div",{staticClass:"head",style:{height:n.titleHeight+"px"}},[n._t("default")],2),n._v(" "),r("div",{staticClass:"video-frame",style:{width:n.resource.contentWidth+"px",height:n.resource.contentHeight+"px"},on:{click:n.onVideoFrameClick}},[r("VideoCard",{attrs:{src:n.resource.url,sourceType:n.resource.mimeType,hasSibling:!1,isBtnMoreVisible:n.isFlexibleFrameVisible},on:{"video-play-click":n.onVideoPlayClick,"delete-click":function(e){return n.$emit("delete-click",n.resource)}}}),n._v(" "),r("PicFlexibleFrame",{staticClass:"flexible-frame",attrs:{isVisible:n.isFlexibleFrameVisible},on:{"drag-dot-mousedown":n.onFlexibleFramDragDotMousedown}})],1)])};Sn._withStripped=!0;var Bn=F({render:Sn,staticRenderFns:[]},(function(n){n&&n("data-v-24bce817_0",{source:".video-single-core[data-v-24bce817] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.video-single-core .head[data-v-24bce817] {\n  width: 100%;\n}\n.video-single-core .video-frame[data-v-24bce817] {\n  position: relative;\n}\n\n/*# sourceMappingURL=VideoSingleCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\VideoSingleCore.vue","VideoSingleCore.vue"],names:[],mappings:"AAoEA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;ACnEA;ADqEA;EACA,WAAA;ACnEA;ADqEA;EACA,kBAAA;ACnEA;;AAEA,8CAA8C",file:"VideoSingleCore.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-10 16:20:58\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-16 16:21:52\r\n * @Description: 请输入\r\n--\x3e\r\n<template>\r\n  <div :id="resource.id" class="video-single-core">\r\n    <div class="head" :style="{ height: `${titleHeight}px` }">\r\n      <slot></slot>\r\n    </div>\r\n    <div\r\n      class="video-frame"\r\n      :style="{\r\n        width: `${resource.contentWidth}px`,\r\n        height: `${resource.contentHeight}px`,\r\n      }"\r\n      @click="onVideoFrameClick"\r\n    >\r\n      <VideoCard\r\n        :src="resource.url"\r\n        :sourceType="resource.mimeType"\r\n        :hasSibling="false"\r\n        :isBtnMoreVisible="isFlexibleFrameVisible"\r\n        @video-play-click="onVideoPlayClick"\r\n        @delete-click="$emit(\'delete-click\', resource)"\r\n      />\r\n\r\n      <PicFlexibleFrame\r\n        class="flexible-frame"\r\n        :isVisible="isFlexibleFrameVisible"\r\n        @drag-dot-mousedown="onFlexibleFramDragDotMousedown"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport PicFlexibleFrame from "../Other/PicFlexibleFrame.vue";\r\nimport VideoCard from "../../../components/MindMap/Node/Core/VideoCard.vue";\r\n\r\nexport default {\r\n  components: { VideoCard, PicFlexibleFrame },\r\n  data() {\r\n    return {};\r\n  },\r\n  props: {\r\n    resource: { type: Object, required: true },\r\n    titleHeight: { type: Number, required: true },\r\n    isFlexibleFrameVisible: { type: Boolean, default: false }, // 缩放视频的框是否显示\r\n  },\r\n  methods: {\r\n    // 视频被点击时(图片可预览状态尚未被激活)\r\n    onVideoFrameClick() {\r\n      this.$emit("click");\r\n    },\r\n    // 视频缩放框的右下角圆点被点击时\r\n    onFlexibleFramDragDotMousedown(event, refFrame) {\r\n      this.$emit("drag-dot-mousedown", event, refFrame);\r\n    },\r\n    // 播放视频\r\n    onVideoPlayClick() {\r\n      this.$emit("video-play-click", this.resource);\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.video-single-core {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .head {\r\n    width: 100%;\r\n  }\r\n  .video-frame {\r\n    position: relative;\r\n  }\r\n}\r\n</style>',".video-single-core {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.video-single-core .head {\n  width: 100%;\n}\n.video-single-core .video-frame {\n  position: relative;\n}\n\n/*# sourceMappingURL=VideoSingleCore.vue.map */"]},media:void 0})}),yn,"data-v-24bce817",!1,void 0,!1,T,void 0,void 0),Nn={components:{BtnMoreList:hn},props:{hasSibling:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!0},isLast:{type:Boolean,default:!0},resource:{type:Object,required:!0},isBtnMoreVisible:{type:Boolean,default:!1}},data:function(){return{PIC_FILE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAPVJREFUWEft1z8OgjAUBvDvcQddXJ30EnACYMBLuHsoHR43kEs4uTh5CkJNDSRG+fMe0BCTdiOU9tcvLW0JCxdauH+0AtI0vQIIR+AeAE7MfJF+2wUw0gY+6t0A7OvngxTRCzDGRBIIEdnECgArLWIQkOe5bbizJEkSNoCqqo5BEJw1iFkBzBzFcbzTIGYH2Kg0CCcADcIZoAXxZObN92SaFdAzV9+rg5l/+psMyLJsW5blXbJcnQCaqIlo3YWolymcAYT/CQ/wCfgEfAI+AZ/AnyYg2eeH6ozejoca1r7XnAfGXs36TIU9tovOhNqRTam/+O34BTEjUTBbn+ndAAAAAElFTkSuQmCC"}},computed:{isGloballyReadonly:function(){return s.state.isGloballyReadonly},size:function(){return this.resource.size?I.formatFileSize(this.resource.size):"未知"}},methods:{onBtnDeleteClick:function(){this.$emit("delete-click",this.resource)},onBtnForwardClick:function(){this.$emit("forward-click",this.resource)},onBtnBackwardClick:function(){this.$emit("backward-click",this.resource)}}},Mn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"file-card"},[!n.isGloballyReadonly&&n.isBtnMoreVisible?r("BtnMoreList",{attrs:{hasSibling:n.hasSibling,isFirst:n.isFirst,isLast:n.isLast},on:{"delete-click":n.onBtnDeleteClick,"forward-click":n.onBtnForwardClick,"backward-click":n.onBtnBackwardClick}}):n._e(),n._v(" "),r("div",{staticClass:"main"},[r("div",{staticClass:"icon"},[r("img",{staticClass:"image",attrs:{src:n.PIC_FILE,alt:""}})]),n._v(" "),r("div",{staticClass:"info"},[r("div",{staticClass:"title"},[n._v(n._s(n.resource.title))]),n._v(" "),r("div",{staticClass:"size"},[n._v("附件大小: "+n._s(n.size))])])])],1)};Mn._withStripped=!0;var In=F({render:Mn,staticRenderFns:[]},(function(n){n&&n("data-v-67e48c2d_0",{source:".file-card[data-v-67e48c2d] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.file-card .main[data-v-67e48c2d] {\n  width: 100%;\n  height: 48px;\n  overflow: hidden;\n}\n.file-card .main .icon[data-v-67e48c2d] {\n  float: left;\n  width: 48px;\n  height: 48px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.file-card .main .icon .image[data-v-67e48c2d] {\n  width: 32px;\n  height: 32px;\n}\n.file-card .main .info[data-v-67e48c2d] {\n  float: left;\n  width: calc(100% - 48px);\n  height: 100%;\n  box-sizing: border-box;\n}\n.file-card .main .info .title[data-v-67e48c2d] {\n  width: 100%;\n  height: 24px;\n  line-height: 24px;\n  font-weight: 600;\n}\n.file-card .main .info .size[data-v-67e48c2d] {\n  width: 100%;\n  height: 24px;\n  line-height: 24px;\n  font-size: 12px;\n  color: #aaaaaa;\n}\n\n/*# sourceMappingURL=FileCard.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\Core\\FileCard.vue","FileCard.vue"],names:[],mappings:"AAiFA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,2BAAA;EACA,mBAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,gBAAA;AChFA;ADkFA;EACA,WAAA;EACA,YAdA;EAeA,gBAAA;AChFA;ADiFA;EACA,WAAA;EACA,WAlBA;EAmBA,YAnBA;EAoBA,aAAA;EACA,uBAAA;EACA,mBAAA;AC/EA;ADgFA;EACA,WAAA;EACA,YAAA;AC9EA;ADiFA;EACA,WAAA;EACA,wBAAA;EACA,YAAA;EACA,sBAAA;AC/EA;ADiFA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;EACA,gBAAA;AC/EA;ADiFA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,cAAA;AC/EA;;AAEA,uCAAuC",file:"FileCard.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-02-16 17:03:48\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-17 13:54:51\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="file-card">\r\n    <BtnMoreList\r\n      v-if="!isGloballyReadonly && isBtnMoreVisible"\r\n      :hasSibling="hasSibling"\r\n      :isFirst="isFirst"\r\n      :isLast="isLast"\r\n      @delete-click="onBtnDeleteClick"\r\n      @forward-click="onBtnForwardClick"\r\n      @backward-click="onBtnBackwardClick"\r\n    />\r\n\r\n    <div class="main">\r\n      <div class="icon">\r\n        <img class="image" :src="PIC_FILE" alt="" />\r\n      </div>\r\n      <div class="info">\r\n        <div class="title">{{ resource.title }}</div>\r\n        <div class="size">附件大小: {{ size }}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport myStore from "../../../../store";\r\nimport BtnMoreList from "./Card/BtnMoreList.vue";\r\nimport PIC_FILE from "../../../../assets/icons/FileCard/file.png";\r\nimport FileHelper from "../../../../util/FileHelper.js";\r\n\r\nexport default {\r\n  components: { BtnMoreList },\r\n  props: {\r\n    hasSibling: { type: Boolean, default: false }, // 单资源还是多资源\r\n    isFirst: { type: Boolean, default: true }, // 是否第一\r\n    isLast: { type: Boolean, default: true }, // 是否最后\r\n    resource: { type: Object, required: true }, // 资源对象\r\n    isBtnMoreVisible: { type: Boolean, default: false }, // “更多”操作按钮是否显示\r\n  },\r\n  data() {\r\n    return { PIC_FILE };\r\n  },\r\n  computed: {\r\n    isGloballyReadonly: function () {\r\n      return myStore.state.isGloballyReadonly;\r\n    },\r\n    size: function () {\r\n      if (this.resource.size) {\r\n        return FileHelper.formatFileSize(this.resource.size);\r\n      } else {\r\n        return "未知";\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onBtnDeleteClick() {\r\n      this.$emit("delete-click", this.resource);\r\n    },\r\n    onBtnForwardClick() {\r\n      this.$emit("forward-click", this.resource);\r\n    },\r\n    onBtnBackwardClick() {\r\n      this.$emit("backward-click", this.resource);\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n@import "../../../../scss/_variables.scss";\r\n\r\n$iconSize: 48px;\r\n.file-card {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  border-radius: 4px;\r\n  background-color: $white;\r\n  overflow: hidden;\r\n\r\n  .main {\r\n    width: 100%;\r\n    height: $iconSize;\r\n    overflow: hidden;\r\n    .icon {\r\n      float: left;\r\n      width: $iconSize;\r\n      height: $iconSize;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      .image {\r\n        width: 32px;\r\n        height: 32px;\r\n      }\r\n    }\r\n    .info {\r\n      float: left;\r\n      width: calc(100% - #{$iconSize});\r\n      height: 100%;\r\n      box-sizing: border-box;\r\n      // padding-left: 4px;\r\n      .title {\r\n        width: 100%;\r\n        height: math.div($iconSize, 2);\r\n        line-height: math.div($iconSize, 2);\r\n        font-weight: 600;\r\n      }\r\n      .size {\r\n        width: 100%;\r\n        height: math.div($iconSize, 2);\r\n        line-height: math.div($iconSize, 2);\r\n        font-size: 12px;\r\n        color: $grey-color-normal;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>',".file-card {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n.file-card .main {\n  width: 100%;\n  height: 48px;\n  overflow: hidden;\n}\n.file-card .main .icon {\n  float: left;\n  width: 48px;\n  height: 48px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.file-card .main .icon .image {\n  width: 32px;\n  height: 32px;\n}\n.file-card .main .info {\n  float: left;\n  width: calc(100% - 48px);\n  height: 100%;\n  box-sizing: border-box;\n}\n.file-card .main .info .title {\n  width: 100%;\n  height: 24px;\n  line-height: 24px;\n  font-weight: 600;\n}\n.file-card .main .info .size {\n  width: 100%;\n  height: 24px;\n  line-height: 24px;\n  font-size: 12px;\n  color: #aaaaaa;\n}\n\n/*# sourceMappingURL=FileCard.vue.map */"]},media:void 0})}),Nn,"data-v-67e48c2d",!1,void 0,!1,T,void 0,void 0),Dn={components:{FileCard:In},props:{resource:{type:Object,required:!0},titleHeight:{type:Number,required:!0},isActiveFrameVisible:{type:Boolean,default:!1}},methods:{onFileFrameClick:function(){this.$emit("click")}}},Ln=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"file-single-core",attrs:{id:n.resource.id}},[r("div",{staticClass:"head",style:{height:n.titleHeight+"px"}},[n._t("default")],2),n._v(" "),r("div",{staticClass:"file-frame",style:{width:n.resource.contentWidth+"px",height:n.resource.contentHeight+"px"},on:{click:n.onFileFrameClick}},[r("FileCard",{attrs:{resource:n.resource,hasSibling:!1,isBtnMoreVisible:n.isActiveFrameVisible},on:{"delete-click":function(e){return n.$emit("delete-click",n.resource)}}})],1)])};Ln._withStripped=!0;var Fn=F({render:Ln,staticRenderFns:[]},(function(n){n&&n("data-v-56b853c4_0",{source:".file-single-core[data-v-56b853c4] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.file-single-core .head[data-v-56b853c4] {\n  width: 100%;\n}\n\n/*# sourceMappingURL=FileSingleCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\FileSingleCore.vue","FileSingleCore.vue"],names:[],mappings:"AAwCA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;ACvCA;ADyCA;EACA,WAAA;ACvCA;;AAEA,6CAA6C",file:"FileSingleCore.vue",sourcesContent:['<template>\r\n  <div :id="resource.id" class="file-single-core">\r\n    <div class="head" :style="{ height: `${titleHeight}px` }">\r\n      <slot></slot>\r\n    </div>\r\n    <div\r\n      class="file-frame"\r\n      :style="{\r\n        width: `${resource.contentWidth}px`,\r\n        height: `${resource.contentHeight}px`,\r\n      }"\r\n      @click="onFileFrameClick"\r\n    >\r\n      <FileCard\r\n        :resource="resource"\r\n        :hasSibling="false"\r\n        :isBtnMoreVisible="isActiveFrameVisible"\r\n        @delete-click="$emit(\'delete-click\', resource)"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport FileCard from "../../../components/MindMap/Node/Core/FileCard.vue";\r\n\r\nexport default {\r\n  components: { FileCard },\r\n  props: {\r\n    resource: { type: Object, required: true },\r\n    titleHeight: { type: Number, required: true },\r\n    isActiveFrameVisible: { type: Boolean, default: false },\r\n  },\r\n  methods: {\r\n    onFileFrameClick() {\r\n      this.$emit("click");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.file-single-core {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .head {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>',".file-single-core {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.file-single-core .head {\n  width: 100%;\n}\n\n/*# sourceMappingURL=FileSingleCore.vue.map */"]},media:void 0})}),Dn,"data-v-56b853c4",!1,void 0,!1,T,void 0,void 0),_n={props:{resource:{type:Object,required:!0}}},zn=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"html-card",domProps:{innerHTML:n._s(n.resource.htmlContent)}})};zn._withStripped=!0;var Tn=F({render:zn,staticRenderFns:[]},(function(n){n&&n("data-v-81920780_0",{source:".html-card[data-v-81920780] {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n\n/*# sourceMappingURL=HtmlCard.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\Core\\HtmlCard.vue","HtmlCard.vue"],names:[],mappings:"AAoBA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,gBAAA;ACnBA;;AAEA,uCAAuC",file:"HtmlCard.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-03-27 09:12:08\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-30 15:33:01\r\n * @Description: 请输入\r\n--\x3e\r\n<template>\r\n  <div class="html-card" v-html="resource.htmlContent"></div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    resource: { type: Object, required: true }, // 资源对象\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.html-card {\r\n  width: 100%;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  border-radius: 4px;\r\n  background-color: $white;\r\n  overflow: hidden;\r\n}\r\n</style>',".html-card {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  border-radius: 4px;\n  background-color: #fff;\n  overflow: hidden;\n}\n\n/*# sourceMappingURL=HtmlCard.vue.map */"]},media:void 0})}),_n,"data-v-81920780",!1,void 0,!1,T,void 0,void 0),Rn={components:{HtmlCard:Tn},props:{resource:{type:Object,required:!0},titleHeight:{type:Number,required:!0}},methods:{onHtmlFrameClick:function(){this.$emit("click")}}},Pn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"html-single-core"},[r("div",{staticClass:"head",style:{height:n.titleHeight+"px"}},[n._t("default")],2),n._v(" "),r("div",{staticClass:"html-frame",style:{width:n.resource.contentWidth+"px",height:n.resource.contentHeight+"px"},on:{click:n.onHtmlFrameClick}},[r("HtmlCard",{attrs:{resource:n.resource}})],1)])};Pn._withStripped=!0;var On=F({render:Pn,staticRenderFns:[]},(function(n){n&&n("data-v-5e8b799e_0",{source:".html-single-core[data-v-5e8b799e] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.html-single-core .head[data-v-5e8b799e] {\n  width: 100%;\n}\n\n/*# sourceMappingURL=HtmlSingleCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\HtmlSingleCore.vue","HtmlSingleCore.vue"],names:[],mappings:"AA0CA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;ACzCA;AD2CA;EACA,WAAA;ACzCA;;AAEA,6CAA6C",file:"HtmlSingleCore.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-03-27 09:12:08\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-30 15:33:36\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="html-single-core">\r\n    <div class="head" :style="{ height: `${titleHeight}px` }">\r\n      <slot></slot>\r\n    </div>\r\n    <div\r\n      class="html-frame"\r\n      :style="{\r\n        width: `${resource.contentWidth}px`,\r\n        height: `${resource.contentHeight}px`,\r\n      }"\r\n      @click="onHtmlFrameClick"\r\n    >\r\n      <HtmlCard :resource="resource" />\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport HtmlCard from "../../../components/MindMap/Node/Core/HtmlCard.vue";\r\n\r\nexport default {\r\n  components: { HtmlCard },\r\n  props: {\r\n    resource: { type: Object, required: true },\r\n    titleHeight: { type: Number, required: true },\r\n  },\r\n  methods: {\r\n    onHtmlFrameClick() {\r\n      this.$emit("click");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.html-single-core {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .head {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>',".html-single-core {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.html-single-core .head {\n  width: 100%;\n}\n\n/*# sourceMappingURL=HtmlSingleCore.vue.map */"]},media:void 0})}),Rn,"data-v-5e8b799e",!1,void 0,!1,T,void 0,void 0),Hn={components:{ImgCard:fn,VideoCard:En,FileCard:In,HtmlCard:Tn},props:{resources:{type:Array,required:!0},titleHeight:{type:Number,required:!0}},data:function(){return{TYPES:a,MULTI_MEDIA_SIDE_LENGTH:d,activeResource:null}},computed:{},methods:{onImgClick:function(n){this.isPicPreviewAllow(n)&&this.$emit("pic-preview-click",n)},onMediaClick:function(n,e){this.$emit("media-click",n,e),this.activeResource=n},getMediaStyle:function(n){var e,r;return n%3>0&&(e="8px"),n>2&&(r="8px"),{width:d+"px",height:d+"px",marginLeft:e,marginTop:r}},isActiveFrameVisible:function(n){return s.state.resourceIdOfActiveFrame===n.id},isPicPreviewAllow:function(n){return this.isActiveFrameVisible(n)}}},Wn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"multi-content-core"},[r("div",{staticClass:"head",style:{height:n.titleHeight+"px"}},[n._t("default")],2),n._v(" "),r("div",{staticClass:"multi-media"},[n._l(n.resources,(function(e,t){return[r("div",{key:t,staticClass:"media",style:n.getMediaStyle(t),attrs:{id:e.id},on:{click:function(r){return n.onMediaClick(e,t)}}},[e.type===n.TYPES.PIC?[r("ImgCard",{attrs:{resource:e,hasSibling:!0,isFirst:0===t,isLast:t===n.resources.length-1,isPicPreviewAllow:n.isPicPreviewAllow(e),isBtnMoreVisible:n.isActiveFrameVisible(e)},on:{"img-click":n.onImgClick,"delete-click":function(e){return n.$emit("resource-delete-click",e)},"forward-click":function(e){return n.$emit("resource-forward-click",e)},"backward-click":function(e){return n.$emit("resource-backward-click",e)}}})]:e.type===n.TYPES.VIDEO?[r("VideoCard",{attrs:{src:e.url,sourceType:e.mimeType,hasSibling:!0,isFirst:0===t,isLast:t===n.resources.length-1,isBtnMoreVisible:n.isActiveFrameVisible(e)},on:{"video-play-click":function(r){return n.$emit("video-play-click",e)},"delete-click":function(r){return n.$emit("resource-delete-click",e)},"forward-click":function(r){return n.$emit("resource-forward-click",e)},"backward-click":function(r){return n.$emit("resource-backward-click",e)}}})]:e.type===n.TYPES.FILE?[r("FileCard",{attrs:{resource:e,hasSibling:!0,isFirst:0===t,isLast:t===n.resources.length-1,isBtnMoreVisible:n.isActiveFrameVisible(e)},on:{"delete-click":function(r){return n.$emit("resource-delete-click",e)},"forward-click":function(r){return n.$emit("resource-forward-click",e)},"backward-click":function(r){return n.$emit("resource-backward-click",e)}}})]:e.type===n.TYPES.HTML?[r("HtmlCard",{attrs:{resource:e}})]:n._e(),n._v(" "),n.isActiveFrameVisible(e)?r("div",{staticClass:"active-frame"}):n._e()],2)]}))],2)])};Wn._withStripped=!0;var Vn=F({render:Wn,staticRenderFns:[]},(function(n){n&&n("data-v-13b8809a_0",{source:".multi-content-core[data-v-13b8809a] {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.multi-content-core .head[data-v-13b8809a] {\n  width: 100%;\n}\n.multi-content-core .multi-media[data-v-13b8809a] {\n  overflow: hidden;\n}\n.multi-content-core .multi-media .media[data-v-13b8809a] {\n  float: left;\n  position: relative;\n}\n.multi-content-core .multi-media .media .img[data-v-13b8809a] {\n  object-fit: fill;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.multi-content-core .multi-media .media .img.allow-preview[data-v-13b8809a] {\n  cursor: zoom-in;\n}\n.multi-content-core .multi-media .media .active-frame[data-v-13b8809a] {\n  box-sizing: border-box;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  border: 2px solid #39a3ff;\n  pointer-events: none;\n  z-index: 200;\n}\n\n/*# sourceMappingURL=MultiContentCore.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\MultiContentCore.vue","MultiContentCore.vue"],names:[],mappings:"AAgKA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;AC/JA;ADiKA;EACA,WAAA;AC/JA;ADkKA;EACA,gBAAA;AChKA;ADkKA;EACA,WAAA;EACA,kBAAA;AChKA;ADsKA;EACA,gBAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,kBAAA;ACpKA;ADsKA;EACA,eAAA;ACpKA;ADwKA;EAGA,sBAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EAGA,MAAA;EACA,OAAA;EACA,yBAAA;EACA,oBAAA;EAEA,YAAA;AC3KA;;AAEA,+CAA+C",file:"MultiContentCore.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-18 14:20:06\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-30 15:38:18\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="multi-content-core">\r\n    <div class="head" :style="{ height: `${titleHeight}px` }">\r\n      <slot></slot>\r\n    </div>\r\n    <div class="multi-media">\r\n      <template v-for="(rs, i) in resources">\r\n        <div\r\n          :key="i"\r\n          :id="rs.id"\r\n          class="media"\r\n          :style="getMediaStyle(i)"\r\n          @click="onMediaClick(rs, i)"\r\n        >\r\n          <template v-if="rs.type === TYPES.PIC">\r\n            \x3c!-- <img\r\n              class="img"\r\n              :class="{ \'allow-preview\': isPicPreviewAllow(rs) }"\r\n              :src="rs.url"\r\n              draggable="false"\r\n              @click="onImgClick(rs)"\r\n            /> --\x3e\r\n\r\n            <ImgCard\r\n              :resource="rs"\r\n              :hasSibling="true"\r\n              :isFirst="i === 0"\r\n              :isLast="i === resources.length - 1"\r\n              :isPicPreviewAllow="isPicPreviewAllow(rs)"\r\n              :isBtnMoreVisible="isActiveFrameVisible(rs)"\r\n              @img-click="onImgClick"\r\n              @delete-click="$emit(\'resource-delete-click\', $event)"\r\n              @forward-click="$emit(\'resource-forward-click\', $event)"\r\n              @backward-click="$emit(\'resource-backward-click\', $event)"\r\n            />\r\n          </template>\r\n          <template v-else-if="rs.type === TYPES.VIDEO">\r\n            <VideoCard\r\n              :src="rs.url"\r\n              :sourceType="rs.mimeType"\r\n              :hasSibling="true"\r\n              :isFirst="i === 0"\r\n              :isLast="i === resources.length - 1"\r\n              :isBtnMoreVisible="isActiveFrameVisible(rs)"\r\n              @video-play-click="$emit(\'video-play-click\', rs)"\r\n              @delete-click="$emit(\'resource-delete-click\', rs)"\r\n              @forward-click="$emit(\'resource-forward-click\', rs)"\r\n              @backward-click="$emit(\'resource-backward-click\', rs)"\r\n            />\r\n          </template>\r\n          <template v-else-if="rs.type === TYPES.FILE">\r\n            <FileCard\r\n              :resource="rs"\r\n              :hasSibling="true"\r\n              :isFirst="i === 0"\r\n              :isLast="i === resources.length - 1"\r\n              :isBtnMoreVisible="isActiveFrameVisible(rs)"\r\n              @delete-click="$emit(\'resource-delete-click\', rs)"\r\n              @forward-click="$emit(\'resource-forward-click\', rs)"\r\n              @backward-click="$emit(\'resource-backward-click\', rs)"\r\n            />\r\n          </template>\r\n          <template v-else-if="rs.type === TYPES.HTML">\r\n            <HtmlCard :resource="rs" />\r\n          </template>\r\n          <div v-if="isActiveFrameVisible(rs)" class="active-frame"></div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../../../store";\r\nimport {\r\n  TYPES,\r\n  MULTI_MEDIA_SIDE_LENGTH,\r\n  GAP_BETWEEN_MULTI_MEDIA,\r\n  MULTI_MEDIA_COL_MAX_COUNT,\r\n} from "../../../const.js";\r\nimport ImgCard from "../../../components/MindMap/Node/Core/ImgCard.vue";\r\nimport VideoCard from "../../../components/MindMap/Node/Core/VideoCard.vue";\r\nimport FileCard from "../../../components/MindMap/Node/Core/FileCard.vue";\r\nimport HtmlCard from "../../../components/MindMap/Node/Core/HtmlCard.vue";\r\n\r\nexport default {\r\n  components: { ImgCard, VideoCard, FileCard, HtmlCard },\r\n  props: {\r\n    resources: { type: Array, required: true },\r\n    // hasActiveFrame: { type: Boolean, default: false }, // 资源聚焦的框是否显示\r\n    titleHeight: { type: Number, required: true },\r\n  },\r\n  data() {\r\n    return {\r\n      TYPES,\r\n      MULTI_MEDIA_SIDE_LENGTH,\r\n      activeResource: null,\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    // 预览图片\r\n    onImgClick(resource) {\r\n      if (this.isPicPreviewAllow(resource)) {\r\n        this.$emit("pic-preview-click", resource);\r\n      }\r\n    },\r\n\r\n    onMediaClick(resource, index) {\r\n      this.$emit("media-click", resource, index);\r\n      this.activeResource = resource;\r\n    },\r\n\r\n    getMediaStyle(index) {\r\n      // 每行开头的一个 div 没有 margin-left\r\n      let marginLeft;\r\n      if (index % MULTI_MEDIA_COL_MAX_COUNT > 0)\r\n        marginLeft = `${GAP_BETWEEN_MULTI_MEDIA}px`;\r\n\r\n      // 第一行没有 margin-top\r\n      let marginTop;\r\n      if (index > MULTI_MEDIA_COL_MAX_COUNT - 1)\r\n        marginTop = `${GAP_BETWEEN_MULTI_MEDIA}px`;\r\n\r\n      return {\r\n        width: `${MULTI_MEDIA_SIDE_LENGTH}px`,\r\n        height: `${MULTI_MEDIA_SIDE_LENGTH}px`,\r\n        marginLeft,\r\n        marginTop,\r\n      };\r\n    },\r\n\r\n    // 资源聚焦框是否显示\r\n    isActiveFrameVisible(resource) {\r\n      const rsId = myStore.state.resourceIdOfActiveFrame;\r\n      return rsId === resource.id;\r\n    },\r\n\r\n    // 图片是否处于可预览状态\r\n    isPicPreviewAllow(resource) {\r\n      return this.isActiveFrameVisible(resource);\r\n    },\r\n\r\n    // 视频是否处于可预览状态\r\n    // isVideoPlayAllow(resource) {\r\n    //   return this.isActiveFrameVisible(resource);\r\n    // },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.multi-content-core {\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .head {\r\n    width: 100%;\r\n  }\r\n\r\n  .multi-media {\r\n    overflow: hidden;\r\n\r\n    .media {\r\n      float: left;\r\n      position: relative;\r\n\r\n      // &:not(:nth-child(3n + 1)) {\r\n      //   margin-left: 8px;\r\n      // }\r\n\r\n      .img {\r\n        object-fit: fill;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 100;\r\n        position: relative; // 图片要脱离标准流，才能触发鼠标的 cursor\r\n\r\n        &.allow-preview {\r\n          cursor: zoom-in;\r\n        }\r\n      }\r\n\r\n      .active-frame {\r\n        $border-width: 2px;\r\n\r\n        box-sizing: border-box;\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        // top: -$border-width;\r\n        // left: -$border-width;\r\n        top: 0;\r\n        left: 0;\r\n        border: $border-width solid $main-color-light;\r\n        pointer-events: none; // 穿透过去，才能让图片有鼠标样式并被点击得到\r\n\r\n        z-index: 200;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>',".multi-content-core {\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n}\n.multi-content-core .head {\n  width: 100%;\n}\n.multi-content-core .multi-media {\n  overflow: hidden;\n}\n.multi-content-core .multi-media .media {\n  float: left;\n  position: relative;\n}\n.multi-content-core .multi-media .media .img {\n  object-fit: fill;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  position: relative;\n}\n.multi-content-core .multi-media .media .img.allow-preview {\n  cursor: zoom-in;\n}\n.multi-content-core .multi-media .media .active-frame {\n  box-sizing: border-box;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  border: 2px solid #39a3ff;\n  pointer-events: none;\n  z-index: 200;\n}\n\n/*# sourceMappingURL=MultiContentCore.vue.map */"]},media:void 0})}),Hn,"data-v-13b8809a",!1,void 0,!1,T,void 0,void 0),$n={props:{node:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isHorizontalLayout:{type:Boolean,required:!0}},data:function(){return{btnImg:{plus:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAF5JREFUWEftl0EKACAIBNv/P9roUETQQTEkmM6mwxQsqhUfFc9vYQAzsx1eUqhX6NIYDAAGMIABDKQbOBu+DqmZHSsLACg34H3z9E8IAAYwgAEMfGfAC3yrD++GWQAd4nNwIawlk70AAAAASUVORK5CYII="},btnPlus:{size:20,dashLength:8,dashThickness:2}}},computed:{btnStyle:function(){return this.isHorizontalLayout?{right:this.btnDistance+"px",top:this.node.height/2-this.btnPlus.size/2-this.node.borderWidth+"px"}:{bottom:this.btnDistance+"px"}},btnDistance:function(){return 0-this.node.borderWidth-this.btnPlus.size-this.btnPlus.dashLength},dashStyle:function(){return this.isHorizontalLayout?{width:this.btnPlus.dashLength+"px",height:this.btnPlus.dashThickness+"px",left:-this.btnPlus.dashLength-2+"px",top:this.btnPlus.size/2-3+"px"}:{width:this.btnPlus.dashThickness+"px",height:this.btnPlus.dashLength+"px",top:-this.btnPlus.dashLength-2+"px",right:this.btnPlus.size/2-3+"px"}}},methods:{onClick:function(){this.$emit("btn-plus-click")}}},Yn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.isActive?r("div",{staticClass:"btn-plus",style:Object.assign({},{width:n.btnPlus.size+"px",height:n.btnPlus.size+"px"},n.btnStyle),on:{click:function(e){return e.stopPropagation(),n.onClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",attrs:{src:n.btnImg.plus}}),n._v(" "),r("div",{staticClass:"dash",style:Object.assign({},n.dashStyle)})]):n._e()};Yn._withStripped=!0;var Un=F({render:Yn,staticRenderFns:[]},(function(n){n&&n("data-v-42b065fe_0",{source:".btn-plus[data-v-42b065fe] {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #0065d5;\n  border-radius: 50%;\n  border: solid 2px #0065d5;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-plus .btn-img[data-v-42b065fe] {\n  width: 100%;\n  height: 100%;\n}\n.btn-plus .dash[data-v-42b065fe] {\n  position: absolute;\n  background-color: #0065d5;\n}\n\n/*# sourceMappingURL=BtnPlus.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\BtnPlus.vue","BtnPlus.vue"],names:[],mappings:"AAmGA;EACA,sBAAA;EACA,kBAAA;EACA,yBAAA;EACA,kBAAA;EACA,yBAAA;EACA,eAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;AClGA;ADqGA;EACA,WAFA;EAGA,YAHA;AChGA;ADqGA;EACA,kBAAA;EACA,yBAAA;ACnGA;;AAEA,sCAAsC",file:"BtnPlus.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-09 09:36:04\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:22:33\r\n * @Description: 添加节点的加号按钮\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    v-if="isActive"\r\n    class="btn-plus"\r\n    :style="{\r\n      width: `${btnPlus.size}px`,\r\n      height: `${btnPlus.size}px`,\r\n      ...btnStyle,\r\n    }"\r\n    @click.stop="onClick"\r\n  >\r\n    <img class="btn-img" :src="btnImg.plus" />\r\n    <div\r\n      class="dash"\r\n      :style="{\r\n        ...dashStyle,\r\n      }"\r\n    ></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport PLUS from "../../../assets/icons/Node/plus.png";\r\n\r\nexport default {\r\n  props: {\r\n    node: { type: Object, required: true },\r\n    isActive: { type: Boolean, default: false },\r\n    isHorizontalLayout: { type: Boolean, required: true }, // 横向布局(true)还是竖向布局(false)\r\n  },\r\n  data() {\r\n    return {\r\n      btnImg: {\r\n        // plus: require("../../../assets/icons/Node/plus.png"),\r\n        plus: PLUS,\r\n      },\r\n      btnPlus: {\r\n        size: 20,\r\n        dashLength: 8, // ‘加’按钮和节点间连接线的长度\r\n        dashThickness: 2,\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    btnStyle: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return {\r\n          right: `${this.btnDistance}px`,\r\n          top: `${\r\n            this.node.height / 2 - this.btnPlus.size / 2 - this.node.borderWidth\r\n          }px`,\r\n        };\r\n      } else {\r\n        return {\r\n          bottom: `${this.btnDistance}px`,\r\n        };\r\n      }\r\n    },\r\n    btnDistance: function () {\r\n      return (\r\n        0 - this.node.borderWidth - this.btnPlus.size - this.btnPlus.dashLength\r\n      );\r\n    },\r\n    dashStyle: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return {\r\n          width: `${this.btnPlus.dashLength}px`,\r\n          height: `${this.btnPlus.dashThickness}px`,\r\n          left: `${-this.btnPlus.dashLength - 2}px`,\r\n          top: `${this.btnPlus.size / 2 - 3}px`,\r\n        };\r\n      } else {\r\n        return {\r\n          width: `${this.btnPlus.dashThickness}px`,\r\n          height: `${this.btnPlus.dashLength}px`,\r\n          top: `${-this.btnPlus.dashLength - 2}px`,\r\n          right: `${this.btnPlus.size / 2 - 3}px`,\r\n        };\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onClick(/* event */) {\r\n      this.$emit("btn-plus-click");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n$active-border-color: $main-color-dark;\r\n\r\n.btn-plus {\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  background-color: $active-border-color;\r\n  border-radius: 50%;\r\n  border: solid 2px $active-border-color;\r\n  cursor: pointer;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  $img-per: 100%;\r\n  .btn-img {\r\n    width: $img-per;\r\n    height: $img-per;\r\n  }\r\n  .dash {\r\n    position: absolute;\r\n    background-color: $active-border-color;\r\n  }\r\n}\r\n</style>',".btn-plus {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #0065d5;\n  border-radius: 50%;\n  border: solid 2px #0065d5;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-plus .btn-img {\n  width: 100%;\n  height: 100%;\n}\n.btn-plus .dash {\n  position: absolute;\n  background-color: #0065d5;\n}\n\n/*# sourceMappingURL=BtnPlus.vue.map */"]},media:void 0})}),$n,"data-v-42b065fe",!1,void 0,!1,T,void 0,void 0),Gn={props:{node:{type:Object,required:!0},nodeHovering:{type:Boolean,default:!1},nodeActive:{type:Boolean,default:!1},isHorizontalLayout:{type:Boolean,required:!0}},data:function(){return{btnImg:{foldLeft:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAi9JREFUWEftlj9oE1Ecxz+/l9MKonbJoJ10aXOJmxXEycU/Q9zUpKFD/yQZWsTRQbEIDk5StBVzaYs2KCiugiDiKIJK5YJ/ChacFYW6dEieJHeXLpLcXY5k6W33eHefz/t+3x1P6PMlfeazIxB9Avmvo0htHs0WNXWe5ZHNdjVHK1CsnqXOMnCwCdX1U5SPvumNQL6aA5aAgSZQ5Bol81anTR5NAtPVywjzLZjWs5RTC53gTU8/k9rOKVTn0NxozRGVo5R47Pe93Qnkq3eBWadv/QdUjrL5wi88fAIXnsYYTK2CzrqwDbSMUTbfBoGHE5hYj2NsVUBOOyvnI6IyWIlvQeHBBQqfRsBYRetjLuw1YlyiNPwzDDyYwJR9EqUasR92Yc8ZMi8yJ/WwcP8CRTtNXSrAfgcmFpZZ6AbsPdv5K5j8so9Y7Qcw6MJvY5lXo4D7S2B8bS97jA0g3h+BBnXKTrv9H3AaoEQpWYwihc4VeJTi5xPU6hWEI+7QM4bMTG82oScxuTZMzHgEHHeHXrFbZVhI/Aqbhv8EPMLEhzjGwEPgnDOk36NUlgfmehiJ4AINivMrXgE97u6J79TIspR8F1QinIBHKdh30HLFvf0NKouVeBlEojuBBmnavo7IzRZU6zHKqSd+JboXcCRmELm3DdUzWKlFPxLRCDgSWURW+nMk85aat8+ANA6lh5wPpJeH0m2JUeA+qE126TSLyb/tqoiuAj+F/2fOjkDfE/gHhGCNIerxs7QAAAAASUVORK5CYII=",foldUp:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAIaSURBVFhH7ZW9axRBGMaf2Vs8wa80KTSVFmp2t1TRzsqcAcFGTdQUibt3YAJaWhhIayWJSSS3l4hejKBYWGgUxM5GUInuJUpAwX9A0CrF7fjuzIvm8D5276xkfzAzz/Pe7syzs3MsUlJSUjpiaGUbRj7tYNcWBo/JuRScwlbzKzLVbyiQbhPBYzIKa8cQymVA7uLKD/L9mHdes49N8h0YWTmAari4afGInTCMMvIfDrKPTbIAw++6kTHv0b7t0wVxQ7cIuRcwyxhe79Y+HvEDnHmYgZm9S+qI8gJF+NY11SB8VZPyEMyNRXVtTOIH6HLuUH9SGzxC0S6wBoXIU/9YG3GCri1r3Zp4AfLBTXq8IXYv0WMNsP5Dj3WW+lfayEF4lVtaN6d1ADcYhxRXtZFvscUYwIQItd9EVBPmOUi858oY8pUJ1g1p/jd0g1EIMa20wBfSOcxZ68o3wlvbD4TPSdGhJCSuoGRPKV2HxgHcYJAWXGL3HSFymLffsG+Ou3qUQizT/V1cuQjfvs+6hvoBvKCPfnpCKqsLRg5+7wutY+Ku9kPIp+w26GWfxpwd7UwNf58BLzhMiy+Q0otLeT7x4hEl6xmEcYFdlnZwAd5nmruWeofwNrU9WspRlJwHWrdBsXeJHmCM3W6I6iTr39QJYPxUgxDX4TuzSndCyZlRc0VIehUtuVzZDvfjcXb/jmjODj/dKSkp/yPAL+YMhcor8yMPAAAAAElFTkSuQmCC"},btnFoldAndUnfold:{size:20,dashLength:8,dashThickness:2},allSubsCountWidthWhenFolded:0}},computed:{isBtnAvaliable:function(){return(this.node.redefineSubCount>0||this.node.allSubsCount>0)&&(this.node.isFolded||!!this.nodeHovering)&&!this.nodeActive},subsCount:function(){return this.node.redefineSubCount>0?this.node.redefineSubCount:this.node.allSubsCount},btnOtherStyle:function(){return this.isHorizontalLayout?{right:this.btnDistance+"px",top:this.node.height/2-this.btnFoldAndUnfold.size/2-this.node.borderWidth+"px"}:{left:this.node.width/2-this.btnWidth/2-this.node.borderWidth+"px",bottom:this.btnDistance+"px"}},btnSizeStyle:function(){return this.node.isFolded?{width:this.btnWidth+"px",height:this.btnFoldAndUnfold.size+"px"}:{width:this.btnFoldAndUnfold.size+"px",height:this.btnFoldAndUnfold.size+"px"}},btnWidth:function(){var n;if(this.node.isFolded){var e=this.allSubsCountWidthWhenFolded+10;n=e>this.btnFoldAndUnfold.size?e:this.btnFoldAndUnfold.size}else n=this.btnFoldAndUnfold.size;return n},btnDistance:function(){return this.isHorizontalLayout?0-this.node.borderWidth-this.btnWidth-this.btnFoldAndUnfold.dashLength:0-this.node.borderWidth-this.btnFoldAndUnfold.size-this.btnFoldAndUnfold.dashLength},dashStyle:function(){return this.isHorizontalLayout?{width:this.btnFoldAndUnfold.dashLength+"px",height:this.btnFoldAndUnfold.dashThickness+"px",left:-this.btnFoldAndUnfold.dashLength-2+"px",top:this.btnFoldAndUnfold.size/2-3+"px"}:{width:this.btnFoldAndUnfold.dashThickness+"px",height:this.btnFoldAndUnfold.dashLength+"px",top:-this.btnFoldAndUnfold.dashLength-2+"px",right:this.btnWidth/2-3+"px"}}},watch:{"node.allSubsCount":{immediate:!0,handler:function(){this._calcAllSubsCountWidthWhenFolded()}},"node.isFolded":{immediate:!1,handler:function(){this._calcAllSubsCountWidthWhenFolded()}}},beforeMount:function(){},methods:{onClick:function(){this.node.isFolded?this.$emit("btn-unfold-click"):this.$emit("btn-tofold-click")},_calcAllSubsCountWidthWhenFolded:function(){if(this.node.isFolded){var n=y.pxSize({text:this.subsCount+"",fontFamily:h,fontSize:"14px"}).textWidth;this.allSubsCountWidthWhenFolded=n}}}},jn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.isBtnAvaliable?r("div",{staticClass:"btn-fold-unfold",class:{"horizontal-layout":n.isHorizontalLayout,"vertical-layout":!n.isHorizontalLayout},style:Object.assign({},{borderRadius:n.btnFoldAndUnfold.size/2+"px"},n.btnSizeStyle,n.btnOtherStyle),on:{click:function(e){return e.stopPropagation(),n.onClick.apply(null,arguments)}}},[n.node.isFolded?[r("div",{staticClass:"folded-count"},[r("span",[n._v(n._s(n.subsCount))])])]:[r("img",{staticClass:"btn-img",attrs:{src:n.isHorizontalLayout?n.btnImg.foldLeft:n.btnImg.foldUp}})],n._v(" "),r("div",{staticClass:"dash",style:Object.assign({},n.dashStyle)})],2):n._e()};jn._withStripped=!0;var Xn=F({render:jn,staticRenderFns:[]},(function(n){n&&n("data-v-652650a6_0",{source:".btn-fold-unfold[data-v-652650a6] {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #fff;\n  border: solid 2px #0065d5;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #0065d5;\n}\n.btn-fold-unfold.horizontal-layout .btn-img[data-v-652650a6] {\n  left: -1px;\n}\n.btn-fold-unfold.vertical-layout .btn-img[data-v-652650a6] {\n  top: -1px;\n}\n.btn-fold-unfold .btn-img[data-v-652650a6] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.btn-fold-unfold .folded-count[data-v-652650a6] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n}\n.btn-fold-unfold .dash[data-v-652650a6] {\n  position: absolute;\n  background-color: #0065d5;\n}\n\n/*# sourceMappingURL=BtnFoldAndUnfold.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\BtnFoldAndUnfold.vue","BtnFoldAndUnfold.vue"],names:[],mappings:"AAmOA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EAEA,yBAAA;EACA,eAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,cAAA;ACnOA;ADsOA;EACA,UAAA;ACpOA;ADwOA;EACA,SAAA;ACtOA;AD2OA;EACA,WAFA;EAGA,YAHA;EAIA,kBAAA;ACzOA;AD4OA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,iBAAA;AC1OA;AD4OA;EACA,kBAAA;EACA,yBAAA;AC1OA;;AAEA,+CAA+C",file:"BtnFoldAndUnfold.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-09 09:36:04\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:23:00\r\n * @Description: 添加节点的加号按钮\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    v-if="isBtnAvaliable"\r\n    class="btn-fold-unfold"\r\n    :class="{\r\n      \'horizontal-layout\': isHorizontalLayout,\r\n      \'vertical-layout\': !isHorizontalLayout,\r\n    }"\r\n    :style="{\r\n      borderRadius: `${btnFoldAndUnfold.size / 2}px`,\r\n      ...btnSizeStyle,\r\n      ...btnOtherStyle,\r\n    }"\r\n    @click.stop="onClick"\r\n  >\r\n    <template v-if="node.isFolded">\r\n      <div class="folded-count">\r\n        <span>{{ subsCount }}</span>\r\n      </div>\r\n    </template>\r\n    <template v-else>\r\n      <img\r\n        class="btn-img"\r\n        :src="isHorizontalLayout ? btnImg.foldLeft : btnImg.foldUp"\r\n      />\r\n    </template>\r\n\r\n    <div\r\n      class="dash"\r\n      :style="{\r\n        ...dashStyle,\r\n      }"\r\n    ></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport StringHelper from "../../../util/StringHelper.js";\r\nimport { DEFAULT_FONT_FAMILY } from "../../../const.js";\r\nimport FOLD_LEFT_PNG from "../../../assets/icons/Node/fold-left.png";\r\nimport FOLD_UP_PNG from "../../../assets/icons/Node/fold-up.png";\r\n\r\nexport default {\r\n  props: {\r\n    node: { type: Object, required: true },\r\n    nodeHovering: { type: Boolean, default: false },\r\n    nodeActive: { type: Boolean, default: false },\r\n    isHorizontalLayout: { type: Boolean, required: true }, // 横向布局(true)还是竖向布局(false)\r\n  },\r\n  data() {\r\n    return {\r\n      btnImg: {\r\n        foldLeft: FOLD_LEFT_PNG,\r\n        foldUp: FOLD_UP_PNG,\r\n      },\r\n      btnFoldAndUnfold: {\r\n        size: 20,\r\n        dashLength: 8, // ‘加’按钮和节点间连接线的长度\r\n        dashThickness: 2,\r\n      },\r\n      allSubsCountWidthWhenFolded: 0, // 当前节点如果是被折叠了，则所有下级节点数量的宽度要计算一下，界面上显示要用到\r\n    };\r\n  },\r\n  computed: {\r\n    isBtnAvaliable: function () {\r\n      if (this.node.redefineSubCount > 0 || this.node.allSubsCount > 0) {\r\n        if (this.node.isFolded) {\r\n          if (this.nodeActive) {\r\n            return false;\r\n          } else {\r\n            // 被折叠的节点恒显示本按钮(按钮上是被折叠节点的数量)\r\n            return true;\r\n          }\r\n        } else {\r\n          if (this.nodeHovering) {\r\n            if (this.nodeActive) {\r\n              return false;\r\n            } else {\r\n              return true;\r\n            }\r\n          } else {\r\n            return false;\r\n          }\r\n        }\r\n      } else {\r\n        // 末端节点永不显示本按钮\r\n        return false;\r\n      }\r\n    },\r\n    // 返回自动计算的后代个数，或者返回自定义后代个数\r\n    subsCount: function () {\r\n      if (this.node.redefineSubCount > 0) return this.node.redefineSubCount;\r\n      else return this.node.allSubsCount;\r\n    },\r\n    // 按钮除了尺寸外的其它样式\r\n    btnOtherStyle: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return {\r\n          right: `${this.btnDistance}px`,\r\n          top: `${\r\n            this.node.height / 2 -\r\n            this.btnFoldAndUnfold.size / 2 -\r\n            this.node.borderWidth\r\n          }px`,\r\n        };\r\n      } else {\r\n        return {\r\n          left: `${\r\n            this.node.width / 2 - this.btnWidth / 2 - this.node.borderWidth\r\n          }px`,\r\n          bottom: `${this.btnDistance}px`,\r\n        };\r\n      }\r\n    },\r\n    // 按钮的尺寸样式\r\n    btnSizeStyle: function () {\r\n      if (this.node.isFolded) {\r\n        return {\r\n          width: `${this.btnWidth}px`,\r\n          height: `${this.btnFoldAndUnfold.size}px`,\r\n        };\r\n      } else {\r\n        return {\r\n          width: `${this.btnFoldAndUnfold.size}px`,\r\n          height: `${this.btnFoldAndUnfold.size}px`,\r\n        };\r\n      }\r\n    },\r\n    // 按钮的宽度\r\n    btnWidth: function () {\r\n      let btnWidth;\r\n      if (this.node.isFolded) {\r\n        const btnWidthAtLeast = this.allSubsCountWidthWhenFolded + 10;\r\n        btnWidth =\r\n          btnWidthAtLeast > this.btnFoldAndUnfold.size\r\n            ? btnWidthAtLeast\r\n            : this.btnFoldAndUnfold.size;\r\n      } else {\r\n        btnWidth = this.btnFoldAndUnfold.size;\r\n      }\r\n      return btnWidth;\r\n    },\r\n    // 本按钮和节点之间的距离\r\n    btnDistance: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return (\r\n          0 -\r\n          this.node.borderWidth -\r\n          this.btnWidth -\r\n          this.btnFoldAndUnfold.dashLength\r\n        );\r\n      } else {\r\n        return (\r\n          0 -\r\n          this.node.borderWidth -\r\n          this.btnFoldAndUnfold.size -\r\n          this.btnFoldAndUnfold.dashLength\r\n        );\r\n      }\r\n    },\r\n    // 本按钮和节点之间的连接线的样式\r\n    dashStyle: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return {\r\n          width: `${this.btnFoldAndUnfold.dashLength}px`,\r\n          height: `${this.btnFoldAndUnfold.dashThickness}px`,\r\n          left: `${-this.btnFoldAndUnfold.dashLength - 2}px`,\r\n          top: `${this.btnFoldAndUnfold.size / 2 - 3}px`,\r\n        };\r\n      } else {\r\n        return {\r\n          width: `${this.btnFoldAndUnfold.dashThickness}px`,\r\n          height: `${this.btnFoldAndUnfold.dashLength}px`,\r\n          top: `${-this.btnFoldAndUnfold.dashLength - 2}px`,\r\n          right: `${this.btnWidth / 2 - 3}px`,\r\n        };\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    "node.allSubsCount": {\r\n      immediate: true,\r\n      handler(/* v, ov */) {\r\n        this._calcAllSubsCountWidthWhenFolded();\r\n      },\r\n    },\r\n    "node.isFolded": {\r\n      immediate: false,\r\n      handler(/* v, ov */) {\r\n        this._calcAllSubsCountWidthWhenFolded();\r\n      },\r\n    },\r\n  },\r\n  beforeMount() {},\r\n  methods: {\r\n    onClick(/* event */) {\r\n      if (this.node.isFolded) {\r\n        this.$emit("btn-unfold-click");\r\n      } else {\r\n        this.$emit("btn-tofold-click");\r\n      }\r\n    },\r\n    // 计算折叠时，按钮的宽度(此时按钮显示的是子节点的数量)\r\n    _calcAllSubsCountWidthWhenFolded() {\r\n      if (this.node.isFolded) {\r\n        const { textWidth: countWidth } = StringHelper.pxSize({\r\n          text: this.subsCount + "",\r\n          fontFamily: DEFAULT_FONT_FAMILY,\r\n          fontSize: `${14}px`,\r\n        });\r\n        this.allSubsCountWidthWhenFolded = countWidth;\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n$active-border-color: $main-color-dark;\r\n\r\n.btn-fold-unfold {\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  background-color: $white;\r\n  // border-radius: 50%;\r\n  border: solid 2px $active-border-color;\r\n  cursor: pointer;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: $active-border-color;\r\n\r\n  &.horizontal-layout {\r\n    .btn-img {\r\n      left: -1px; // 向左移动一点，好看点\r\n    }\r\n  }\r\n  &.vertical-layout {\r\n    .btn-img {\r\n      top: -1px; // 向上移动一点，好看点\r\n    }\r\n  }\r\n\r\n  $img-per: 100%;\r\n  .btn-img {\r\n    width: $img-per;\r\n    height: $img-per;\r\n    position: relative;\r\n  }\r\n\r\n  .folded-count {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-weight: bold;\r\n  }\r\n  .dash {\r\n    position: absolute;\r\n    background-color: $active-border-color;\r\n  }\r\n}\r\n</style>',".btn-fold-unfold {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #fff;\n  border: solid 2px #0065d5;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #0065d5;\n}\n.btn-fold-unfold.horizontal-layout .btn-img {\n  left: -1px;\n}\n.btn-fold-unfold.vertical-layout .btn-img {\n  top: -1px;\n}\n.btn-fold-unfold .btn-img {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.btn-fold-unfold .folded-count {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n}\n.btn-fold-unfold .dash {\n  position: absolute;\n  background-color: #0065d5;\n}\n\n/*# sourceMappingURL=BtnFoldAndUnfold.vue.map */"]},media:void 0})}),Gn,"data-v-652650a6",!1,void 0,!1,T,void 0,void 0),Qn={props:{isHorizontalLayout:{type:Boolean,required:!0}},data:function(){return{}},computed:{hoverMaskStyle:function(){return this.isHorizontalLayout?{height:"calc(100% + 6px)",width:this.thickness+"px",right:-this.thickness+"px",top:"-3px"}:{width:"calc(100% + 6px)",height:this.thickness+"px",bottom:-this.thickness+"px",left:"-3px"}},thickness:function(){return 32}},methods:{onMouseEnter:function(n){this.$emit("mouse-enter",n)},onMouseLeave:function(n){this.$emit("mouse-leave",n)}}},Zn=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"hover-mask",class:{"position-right":n.isHorizontalLayout,"position-bottom":!n.isHorizontalLayout},style:n.hoverMaskStyle,on:{click:function(n){n.stopPropagation()},mouseenter:n.onMouseEnter,mouseleave:n.onMouseLeave}})};Zn._withStripped=!0;var Jn={components:{NodeOperation:rn,TextCore:sn,PicSingleCore:vn,VideoSingleCore:Bn,FileSingleCore:Fn,HtmlSingleCore:On,MultiContentCore:Vn,BtnPlus:Un,BtnFoldAndUnfold:Xn,HoverMask:F({render:Zn,staticRenderFns:[]},(function(n){n&&n("data-v-440a3d6e_0",{source:".hover-mask[data-v-440a3d6e] {\n  position: absolute;\n}\n.hover-mask.position-right[data-v-440a3d6e] {\n  height: 100%;\n}\n.hover-mask.position-bottom[data-v-440a3d6e] {\n  width: 100%;\n}\n\n/*# sourceMappingURL=HoverMask.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node\\HoverMask.vue","HoverMask.vue"],names:[],mappings:"AA+DA;EACA,kBAAA;AC9DA;ADkEA;EACA,YAAA;AChEA;ADmEA;EACA,WAAA;ACjEA;;AAEA,wCAAwC",file:"HoverMask.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-20 09:00:17\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-27 09:52:24\r\n * @Description: 将本组件置于Node节点内，则可以扩充Node节点的hover范围\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    class="hover-mask"\r\n    :class="{\r\n      \'position-right\': isHorizontalLayout,\r\n      \'position-bottom\': !isHorizontalLayout,\r\n    }"\r\n    :style="hoverMaskStyle"\r\n    @click.stop\r\n    @mouseenter="onMouseEnter"\r\n    @mouseleave="onMouseLeave"\r\n  ></div>\r\n</template>\r\n<script>\r\nimport { GAP_BETWEEN_LEVEL, NODE_BORDER_WIDTH } from "../../../const.js";\r\nexport default {\r\n  props: {\r\n    isHorizontalLayout: { type: Boolean, required: true }, // 横向布局(true)还是竖向布局(false)\r\n  },\r\n  data() {\r\n    return {};\r\n  },\r\n  computed: {\r\n    hoverMaskStyle: function () {\r\n      if (this.isHorizontalLayout) {\r\n        return {\r\n          height: `calc(100% + ${NODE_BORDER_WIDTH * 2}px)`,\r\n          width: `${this.thickness}px`,\r\n          right: `${-this.thickness}px`,\r\n          top: `${-NODE_BORDER_WIDTH}px`,\r\n        };\r\n      } else {\r\n        return {\r\n          width: `calc(100% + ${NODE_BORDER_WIDTH * 2}px)`,\r\n          height: `${this.thickness}px`,\r\n          bottom: `${-this.thickness}px`,\r\n          left: `${-NODE_BORDER_WIDTH}px`,\r\n        };\r\n      }\r\n    },\r\n    thickness: function () {\r\n      return GAP_BETWEEN_LEVEL * (2 / 3);\r\n    },\r\n  },\r\n  methods: {\r\n    onMouseEnter(event) {\r\n      this.$emit("mouse-enter", event);\r\n    },\r\n    onMouseLeave(event) {\r\n      this.$emit("mouse-leave", event);\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.hover-mask {\r\n  position: absolute;\r\n  // background-color: aqua;\r\n  // z-index: 100;\r\n\r\n  &.position-right {\r\n    height: 100%;\r\n  }\r\n\r\n  &.position-bottom {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>',".hover-mask {\n  position: absolute;\n}\n.hover-mask.position-right {\n  height: 100%;\n}\n.hover-mask.position-bottom {\n  width: 100%;\n}\n\n/*# sourceMappingURL=HoverMask.vue.map */"]},media:void 0})}),Qn,"data-v-440a3d6e",!1,void 0,!1,T,void 0,void 0)},props:{node:{type:Object,required:!0},currActiveNodeIds:{type:Array},currEditingNodeId:{type:String},currDraggingNode:{type:Object,default:null},isHorizontalLayout:{type:Boolean,required:!0},forbiddenHoveringNodeIds:{type:Array,default:function(){return[]}},allowDrop:{type:Boolean,default:!1},titleAttrName:{type:String,default:"title"},viewTop:{type:Number,default:0},viewLeft:{type:Number,default:0},viewWidth:{type:Number,default:0},viewHeight:{type:Number,default:0},isNodeHide:{type:String,default:"vif",validator:function(n){return["none","vshow","vif"].includes(n)}}},data:function(){return{TYPES:a,BLANK_NODE_TIP:A,btnsHeight:32,hovering:!1,dragging:!1,titleEditing:this.node[this.titleAttrName],isHoverMaskHovering:!1}},computed:{isVShow:function(){return"vshow"!==this.isNodeHide||this.isNodeReady&&this.isRenderNeed},isVIf:function(){return"vif"!==this.isNodeHide||this.isNodeReady&&this.isRenderNeed},isNodeReady:function(){return this.viewWidth>0&&this.viewHeight>0},isRenderNeed:function(){if(this.isHorizontalLayout){var n=this.viewLeft>this.node.left+this.node.width,e=this.viewLeft+this.viewWidth<this.node.left,r=this.viewTop>this.node.top+this.node.height,t=this.viewTop+this.viewHeight<this.node.top;return!(n||e||r||t)}return!0},isGloballyReadonly:function(){return s.state.isGloballyReadonly},fontStyle:function(){return this.node.fontStyle?E.fontStyleToPureCss(this.node.fontStyle):{}},isBtnPlusAvailable:function(){return!this.isGloballyReadonly&&!this.node.isReadonly&&1===this.currActiveNodeIds.length},isNodeOperationAvailable:function(){return!this.isGloballyReadonly&&!this.node.isReadonly&&this.isActive&&!this.isDragging&&1===this.currActiveNodeIds.length},whatBtnsToBeShown:function(){return this.node instanceof N?["FONT_STYLE","ADD_PIC","ADD_VIDEO","ADD_FILE","ADD_SIBLING","DELETE"]:this.node instanceof M?["ADD_SIBLING","DELETE"]:[]},isActive:function(){var n=this;return this.currActiveNodeIds.findIndex((function(e){return e===n.node.id}))>-1},isDragging:function(){return!!this.currDraggingNode},isCustomizedNode:function(){return this.node instanceof M},isTextCoreAvalible:function(){return this.node instanceof N&&!this.node.resources.length},isPicSingleCoreAvalible:function(){return this.node instanceof N&&1===this.node.resources.length&&this.node.resources[0].type===a.PIC},isVideoSingleCoreAvalible:function(){return this.node instanceof N&&1===this.node.resources.length&&this.node.resources[0].type===a.VIDEO},isFileSingleCoreAvalible:function(){return this.node instanceof N&&1===this.node.resources.length&&this.node.resources[0].type===a.FILE},isHtmlSingleCoreAvalible:function(){return this.node instanceof N&&1===this.node.resources.length&&this.node.resources[0].type===a.HTML},isMultiMediaCoreAvalible:function(){return this.node instanceof N&&this.node.resources.length>1},isEditing:function(){return this.currEditingNodeId===this.node.id},isFlexibleFrameVisible:function(){return!!(this.node instanceof N&&this.node.resources[0])&&this.isActive&&s.state.resourceIdOfActiveFrame===this.node.resources[0].id},anchorTop:function(){return{x:this.node.left+this.node.width/2,y:this.node.top}},anchorBottom:function(){return{x:this.node.left+this.node.width/2,y:this.node.top+this.node.height}},anchorRight:function(){return{x:this.node.left+this.node.width,y:this.node.top+this.node.height/2}},anchorLeft:function(){return{x:this.node.left,y:this.node.top+this.node.height/2}}},watch:{},mounted:function(){},methods:{ConfirmEditingTitle:function(){if(this.node[this.titleAttrName]!==this.titleEditing&&(""!==this.titleEditing.trim()||""===this.titleEditing)){var n=this.node[this.titleAttrName];this.node[this.titleAttrName]=this.titleEditing,this.node.calcCellSize(this.node),this.$emit("title-changed",n)}},onInputKeyupEnter:function(n){if(this.node[this.titleAttrName]!==n&&""!==n.trim()){var e=this.node[this.titleAttrName];this.node[this.titleAttrName]=n,this.$emit("title-changed",e)}this.$emit("enter-press",n)},onTitleEditing:function(n){this.titleEditing=n},onNodeMouseClick:function(n,e){this.$emit("node-mouseclick",n,e)},onTitleDbclickToEdit:function(n){this.$emit("node-title-dbclick-to-edit",n)},onNodeMouseDown:function(n,e){this.$emit("node-mousedown",n,e)},onNodeMouseEnter:function(n,e){this.$emit("node-mouseenter",n,e),this.isDragging&&this.forbiddenHoveringNodeIds.includes(this.node.id)||(this.hovering=!0,this.$emit("node-hovering",n,e))},onNodeMouseLeave:function(n,e){this.hovering=!1,this.$emit("node-mouseleave",n,e),this.$emit("node-hovering-cancel",n,e)},onHoverMaskMouseEnter:function(){},onHoverMaskMouseLeave:function(){},onBtnPlusClick:function(n,e){this.$emit("btn-plus-click",n,e),this.hovering=!1},onBtnFoldAndUnfoldClick:function(n,e){this.hovering=!1,this.$emit("btn-fold-click",n,e)},onPicCorePicClick:function(){s.state.resourceIdOfActiveFrame=this.node.resources[0].id},onMultiContentCoreMediaClick:function(n){s.state.resourceIdOfActiveFrame=n.id},onPicDragDotMousedown:function(n,e){this.$emit("node-pic-drag-dot-mousedown",n,e)},onPicPreviewClick:function(n){this.$emit("node-pic-preview-click",n)},onVideoCorePicClick:function(){s.state.resourceIdOfActiveFrame=this.node.resources[0].id},onVideoDragDotMousedown:function(n,e){this.$emit("node-video-drag-dot-mousedown",n,e)},onVideoPlayClick:function(n){this.$emit("node-video-play-click",n)},GetAnchorTop:function(){return this.anchorTop},GetAnchorBottom:function(){return this.anchorBottom},GetAnchorRight:function(){return this.anchorRight},GetAnchorLeft:function(){return this.anchorLeft},dragenter_handler:function(n){this.allowDrop&&(n.preventDefault(),this.$emit("node-dragenter",n))},dragleave_handler:function(n){this.allowDrop&&(n.preventDefault(),this.$emit("node-dragleave",n))},dragover_handler:function(n){this.allowDrop&&(n.preventDefault(),this.$emit("node-dragover",n))},drop_handler:function(n){this.allowDrop&&(n.preventDefault(),this.dragging=!1,this.$emit("node-drop",n))}}},Kn=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.isVIf?r("div",{directives:[{name:"show",rawName:"v-show",value:n.isVShow,expression:"isVShow"}],ref:"node",staticClass:"node",class:{root:!n.node.parentId,hovering:n.hovering,dragging:n.dragging,active:n.isActive},style:{width:n.node.width+"px",height:n.node.height+"px",top:n.node.top+"px",left:n.node.left+"px",font:n.node.font,borderWidth:n.node.borderWidth+"px",paddingLeft:n.node.lrPadding+"px",paddingRight:n.node.lrPadding+"px",paddingBottom:n.node.bottomPadding+"px"},attrs:{id:n.node.id},on:{click:function(e){return n.onNodeMouseClick(n.node,e)},mousedown:function(e){return n.onNodeMouseDown(n.node,e)},mouseenter:function(e){return n.onNodeMouseEnter(n.node,e)},mouseleave:function(e){return n.onNodeMouseLeave(n.node,e)},dragenter:n.dragenter_handler,dragleave:n.dragleave_handler,dragover:n.dragover_handler,drop:n.drop_handler}},[n.isCustomizedNode?n._t("default",null,null,n.node):n.isTextCoreAvalible?[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:n.BLANK_NODE_TIP},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})]:n.isPicSingleCoreAvalible?[r("PicSingleCore",{attrs:{resource:n.node.resources[0],titleHeight:n.node.titleHeight,isFlexibleFrameVisible:n.isFlexibleFrameVisible},on:{click:n.onPicCorePicClick,"drag-dot-mousedown":n.onPicDragDotMousedown,"preview-click":n.onPicPreviewClick,"delete-click":function(e){return n.$emit("resource-delete-click",n.node,e)}}},[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:""},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})],1)]:n.isVideoSingleCoreAvalible?[r("VideoSingleCore",{attrs:{resource:n.node.resources[0],titleHeight:n.node.titleHeight,isFlexibleFrameVisible:n.isFlexibleFrameVisible},on:{click:n.onVideoCorePicClick,"drag-dot-mousedown":n.onVideoDragDotMousedown,"video-play-click":n.onVideoPlayClick,"delete-click":function(e){return n.$emit("resource-delete-click",n.node,e)}}},[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:""},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})],1)]:n.isFileSingleCoreAvalible?[r("FileSingleCore",{attrs:{resource:n.node.resources[0],titleHeight:n.node.titleHeight,isActiveFrameVisible:n.isFlexibleFrameVisible},on:{"delete-click":function(e){return n.$emit("resource-delete-click",n.node,e)}}},[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:""},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})],1)]:n.isHtmlSingleCoreAvalible?[r("HtmlSingleCore",{attrs:{resource:n.node.resources[0],titleHeight:n.node.titleHeight}},[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:""},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})],1)]:n.isMultiMediaCoreAvalible?[r("MultiContentCore",{attrs:{resources:n.node.resources,titleHeight:n.node.titleHeight},on:{"media-click":n.onMultiContentCoreMediaClick,"pic-preview-click":n.onPicPreviewClick,"video-play-click":n.onVideoPlayClick,"resource-delete-click":function(e){return n.$emit("resource-delete-click",n.node,e)},"resource-forward-click":function(e){return n.$emit("resource-forward-click",n.node,e)},"resource-backward-click":function(e){return n.$emit("resource-backward-click",n.node,e)}}},[r("TextCore",{attrs:{title:n.node[n.titleAttrName],isEditing:n.isEditing,isRootNode:!n.node.parentId,font:n.node.font,fontStyle:n.fontStyle,blankNodeTip:""},on:{"dbclick-to-edit":function(e){return n.onTitleDbclickToEdit(n.node)},"enter-press":n.onInputKeyupEnter,"title-editing":n.onTitleEditing}})],1)]:n._e(),n._v(" "),r("HoverMask",{attrs:{isHorizontalLayout:n.isHorizontalLayout},on:{"mouse-enter":n.onHoverMaskMouseEnter,"mouse-leave":n.onHoverMaskMouseLeave}}),n._v(" "),n.isBtnPlusAvailable?r("BtnPlus",{attrs:{node:n.node,isActive:n.isActive,isHorizontalLayout:n.isHorizontalLayout},on:{"btn-plus-click":function(e){return n.onBtnPlusClick(n.node,e)}}}):n._e(),n._v(" "),r("BtnFoldAndUnfold",{attrs:{node:n.node,nodeHovering:n.hovering,nodeActive:n.isActive,isHorizontalLayout:n.isHorizontalLayout},on:{"btn-tofold-click":function(e){return n.onBtnFoldAndUnfoldClick(n.node,!0)},"btn-unfold-click":function(e){return n.onBtnFoldAndUnfoldClick(n.node,!1)}}}),n._v(" "),n.isNodeOperationAvailable?r("NodeOperation",{staticClass:"btns",style:{left:-n.node.borderWidth+"px",top:-(n.node.borderWidth+n.btnsHeight+4)+"px"},attrs:{btns:n.whatBtnsToBeShown},on:{"btn-insert-img-click":function(e){return n.$emit("btn-insert-img-click",n.node)},"btn-insert-video-click":function(e){return n.$emit("btn-insert-video-click",n.node)},"btn-insert-file-click":function(e){return n.$emit("btn-insert-file-click",n.node)},"btn-add-sibling-click":function(e){return n.$emit("btn-add-sibling-click",n.node)},"btn-del-node-click":function(e){return n.$emit("btn-del-node-click",n.node)},"btn-bold-click":function(e){return n.$emit("btn-bold-click",n.node)},"btn-italic-click":function(e){return n.$emit("btn-italic-click",n.node)},"btn-underline-click":function(e){return n.$emit("btn-underline-click",n.node)},"btn-eraser-click":function(e){return n.$emit("btn-eraser-click",n.node)},"btn-bgcolor-click":function(e){return n.$emit("btn-bgcolor-click",n.node,e)}}}):n._e()],2):n._e()};Kn._withStripped=!0;var qn=F({render:Kn,staticRenderFns:[]},(function(n){n&&n("data-v-21f7d354_0",{source:".node[data-v-21f7d354] {\n  box-sizing: border-box;\n  position: absolute;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-style: solid;\n  border-color: #eeeeee;\n  border-radius: 8px;\n  background-color: #eeeeee;\n  color: black;\n  cursor: default;\n}\n.node.root[data-v-21f7d354] {\n  border-color: #0089ff;\n  background-color: #0089ff;\n  color: white;\n}\n.node.hovering[data-v-21f7d354] {\n  border-color: #39a3ff;\n}\n.node.dragging[data-v-21f7d354] {\n  border-color: #39a3ff;\n}\n.node.active[data-v-21f7d354] {\n  border-color: #0065d5;\n}\n.node .btns[data-v-21f7d354] {\n  position: absolute;\n}\n\n/*# sourceMappingURL=Node.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Node.vue","Node.vue"],names:[],mappings:"AAynBA;EAMA,sBAAA;EACA,kBAAA;EACA,iBAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,mBAAA;EACA,qBAAA;EACA,kBAAA;EACA,yBAAA;EACA,YAAA;EACA,eAAA;AC7nBA;AD+nBA;EACA,qBAAA;EACA,yBAAA;EAEA,YAAA;AC9nBA;ADioBA;EACA,qBAAA;AC/nBA;ADkoBA;EACA,qBAAA;AChoBA;ADuoBA;EACA,qBAAA;ACroBA;ADwoBA;EACA,kBAAA;ACtoBA;;AAEA,mCAAmC",file:"Node.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-27 17:03:49\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:23:47\r\n * @Description: 节点组件\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    v-if="isVIf"\r\n    v-show="isVShow"\r\n    ref="node"\r\n    class="node"\r\n    :id="node.id"\r\n    :class="{\r\n      root: !node.parentId,\r\n      hovering,\r\n      dragging,\r\n      active: isActive,\r\n    }"\r\n    :style="{\r\n      width: node.width + \'px\',\r\n      height: node.height + \'px\',\r\n      top: node.top + \'px\',\r\n      left: node.left + \'px\',\r\n      font: node.font,\r\n      borderWidth: node.borderWidth + \'px\',\r\n      paddingLeft: node.lrPadding + \'px\',\r\n      paddingRight: node.lrPadding + \'px\',\r\n      paddingBottom: node.bottomPadding + \'px\',\r\n    }"\r\n    @click="onNodeMouseClick(node, $event)"\r\n    @mousedown="onNodeMouseDown(node, $event)"\r\n    @mouseenter="onNodeMouseEnter(node, $event)"\r\n    @mouseleave="onNodeMouseLeave(node, $event)"\r\n    @dragenter="dragenter_handler"\r\n    @dragleave="dragleave_handler"\r\n    @dragover="dragover_handler"\r\n    @drop="drop_handler"\r\n  >\r\n    <slot v-if="isCustomizedNode" v-bind="node"></slot>\r\n    <template v-else-if="isTextCoreAvalible">\r\n      <TextCore\r\n        :title="node[titleAttrName]"\r\n        :isEditing="isEditing"\r\n        :isRootNode="!node.parentId"\r\n        :font="node.font"\r\n        :fontStyle="fontStyle"\r\n        :blankNodeTip="BLANK_NODE_TIP"\r\n        @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n        @enter-press="onInputKeyupEnter"\r\n        @title-editing="onTitleEditing"\r\n      />\r\n    </template>\r\n    <template v-else-if="isPicSingleCoreAvalible">\r\n      <PicSingleCore\r\n        :resource="node.resources[0]"\r\n        :titleHeight="node.titleHeight"\r\n        :isFlexibleFrameVisible="isFlexibleFrameVisible"\r\n        @click="onPicCorePicClick"\r\n        @drag-dot-mousedown="onPicDragDotMousedown"\r\n        @preview-click="onPicPreviewClick"\r\n        @delete-click="$emit(\'resource-delete-click\', node, $event)"\r\n      >\r\n        <TextCore\r\n          :title="node[titleAttrName]"\r\n          :isEditing="isEditing"\r\n          :isRootNode="!node.parentId"\r\n          :font="node.font"\r\n          :fontStyle="fontStyle"\r\n          :blankNodeTip="\'\'"\r\n          @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n          @enter-press="onInputKeyupEnter"\r\n          @title-editing="onTitleEditing"\r\n        />\r\n      </PicSingleCore>\r\n    </template>\r\n    <template v-else-if="isVideoSingleCoreAvalible">\r\n      <VideoSingleCore\r\n        :resource="node.resources[0]"\r\n        :titleHeight="node.titleHeight"\r\n        :isFlexibleFrameVisible="isFlexibleFrameVisible"\r\n        @click="onVideoCorePicClick"\r\n        @drag-dot-mousedown="onVideoDragDotMousedown"\r\n        @video-play-click="onVideoPlayClick"\r\n        @delete-click="$emit(\'resource-delete-click\', node, $event)"\r\n      >\r\n        <TextCore\r\n          :title="node[titleAttrName]"\r\n          :isEditing="isEditing"\r\n          :isRootNode="!node.parentId"\r\n          :font="node.font"\r\n          :fontStyle="fontStyle"\r\n          :blankNodeTip="\'\'"\r\n          @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n          @enter-press="onInputKeyupEnter"\r\n          @title-editing="onTitleEditing"\r\n        />\r\n      </VideoSingleCore>\r\n    </template>\r\n    <template v-else-if="isFileSingleCoreAvalible">\r\n      <FileSingleCore\r\n        :resource="node.resources[0]"\r\n        :titleHeight="node.titleHeight"\r\n        :isActiveFrameVisible="isFlexibleFrameVisible"\r\n        @delete-click="$emit(\'resource-delete-click\', node, $event)"\r\n      >\r\n        <TextCore\r\n          :title="node[titleAttrName]"\r\n          :isEditing="isEditing"\r\n          :isRootNode="!node.parentId"\r\n          :font="node.font"\r\n          :fontStyle="fontStyle"\r\n          :blankNodeTip="\'\'"\r\n          @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n          @enter-press="onInputKeyupEnter"\r\n          @title-editing="onTitleEditing"\r\n        />\r\n      </FileSingleCore>\r\n    </template>\r\n    <template v-else-if="isHtmlSingleCoreAvalible">\r\n      <HtmlSingleCore\r\n        :resource="node.resources[0]"\r\n        :titleHeight="node.titleHeight"\r\n      >\r\n        <TextCore\r\n          :title="node[titleAttrName]"\r\n          :isEditing="isEditing"\r\n          :isRootNode="!node.parentId"\r\n          :font="node.font"\r\n          :fontStyle="fontStyle"\r\n          :blankNodeTip="\'\'"\r\n          @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n          @enter-press="onInputKeyupEnter"\r\n          @title-editing="onTitleEditing"\r\n        />\r\n      </HtmlSingleCore>\r\n    </template>\r\n    <template v-else-if="isMultiMediaCoreAvalible">\r\n      <MultiContentCore\r\n        :resources="node.resources"\r\n        :titleHeight="node.titleHeight"\r\n        @media-click="onMultiContentCoreMediaClick"\r\n        @pic-preview-click="onPicPreviewClick"\r\n        @video-play-click="onVideoPlayClick"\r\n        @resource-delete-click="$emit(\'resource-delete-click\', node, $event)"\r\n        @resource-forward-click="$emit(\'resource-forward-click\', node, $event)"\r\n        @resource-backward-click="\r\n          $emit(\'resource-backward-click\', node, $event)\r\n        "\r\n      >\r\n        <TextCore\r\n          :title="node[titleAttrName]"\r\n          :isEditing="isEditing"\r\n          :isRootNode="!node.parentId"\r\n          :font="node.font"\r\n          :fontStyle="fontStyle"\r\n          :blankNodeTip="\'\'"\r\n          @dbclick-to-edit="onTitleDbclickToEdit(node)"\r\n          @enter-press="onInputKeyupEnter"\r\n          @title-editing="onTitleEditing"\r\n        />\r\n      </MultiContentCore>\r\n    </template>\r\n\r\n    <HoverMask\r\n      :isHorizontalLayout="isHorizontalLayout"\r\n      @mouse-enter="onHoverMaskMouseEnter"\r\n      @mouse-leave="onHoverMaskMouseLeave"\r\n    />\r\n\r\n    <BtnPlus\r\n      v-if="isBtnPlusAvailable"\r\n      :node="node"\r\n      :isActive="isActive"\r\n      :isHorizontalLayout="isHorizontalLayout"\r\n      @btn-plus-click="onBtnPlusClick(node, $event)"\r\n    />\r\n\r\n    <BtnFoldAndUnfold\r\n      :node="node"\r\n      :nodeHovering="hovering"\r\n      :nodeActive="isActive"\r\n      :isHorizontalLayout="isHorizontalLayout"\r\n      @btn-tofold-click="onBtnFoldAndUnfoldClick(node, true)"\r\n      @btn-unfold-click="onBtnFoldAndUnfoldClick(node, false)"\r\n    />\r\n\r\n    <NodeOperation\r\n      v-if="isNodeOperationAvailable"\r\n      class="btns"\r\n      :btns="whatBtnsToBeShown"\r\n      :style="{\r\n        left: -node.borderWidth + \'px\',\r\n        top: -(node.borderWidth + btnsHeight + 4) + \'px\',\r\n      }"\r\n      @btn-insert-img-click="$emit(\'btn-insert-img-click\', node)"\r\n      @btn-insert-video-click="$emit(\'btn-insert-video-click\', node)"\r\n      @btn-insert-file-click="$emit(\'btn-insert-file-click\', node)"\r\n      @btn-add-sibling-click="$emit(\'btn-add-sibling-click\', node)"\r\n      @btn-del-node-click="$emit(\'btn-del-node-click\', node)"\r\n      @btn-bold-click="$emit(\'btn-bold-click\', node)"\r\n      @btn-italic-click="$emit(\'btn-italic-click\', node)"\r\n      @btn-underline-click="$emit(\'btn-underline-click\', node)"\r\n      @btn-eraser-click="$emit(\'btn-eraser-click\', node)"\r\n      @btn-bgcolor-click="$emit(\'btn-bgcolor-click\', node, $event)"\r\n    />\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../../store";\r\n\r\nimport { TYPES, BLANK_NODE_TIP } from "../../const.js";\r\nimport Matrix from "../../algorithm/Matrix.js";\r\n\r\nimport NormalNode from "../../entities/NormalNode.js";\r\nimport CustomizedNode from "../../entities/CustomizedNode.js";\r\n\r\nimport NodeOperation from "./Btns/NodeOperation.vue";\r\nimport TextCore from "./Node/TextCore.vue";\r\nimport PicSingleCore from "./Node/PicSingleCore.vue";\r\nimport VideoSingleCore from "./Node/VideoSingleCore.vue";\r\nimport FileSingleCore from "./Node/FileSingleCore.vue";\r\nimport HtmlSingleCore from "./Node/HtmlSingleCore.vue";\r\nimport MultiContentCore from "./Node/MultiContentCore.vue";\r\nimport BtnPlus from "./Node/BtnPlus.vue";\r\nimport BtnFoldAndUnfold from "./Node/BtnFoldAndUnfold.vue";\r\nimport HoverMask from "./Node/HoverMask.vue";\r\n\r\nexport default {\r\n  components: {\r\n    NodeOperation,\r\n    TextCore,\r\n    PicSingleCore,\r\n    VideoSingleCore,\r\n    FileSingleCore,\r\n    HtmlSingleCore,\r\n    MultiContentCore,\r\n    BtnPlus,\r\n    BtnFoldAndUnfold,\r\n    HoverMask,\r\n  },\r\n  props: {\r\n    node: { type: Object, required: true }, // Node对象\r\n    // currActiveNodeId: { type: String }, // 当前激活的Node对象的id\r\n    currActiveNodeIds: { type: Array },\r\n    currEditingNodeId: { type: String }, // 当前正在编辑名称的Node对象的id\r\n    currDraggingNode: { type: Object, default: null }, // 当前正在被拖动的节点\r\n    isHorizontalLayout: { type: Boolean, required: true }, // 横向布局(true)还是竖向布局(false)\r\n    forbiddenHoveringNodeIds: { type: Array, default: () => [] }, // 当前禁止鼠标悬浮高亮的节点列表\r\n    allowDrop: { type: Boolean, default: false },\r\n    titleAttrName: { type: String, default: "title" }, // Node对象中代表title的字段的字段名\r\n    viewTop: { type: Number, default: 0 },\r\n    viewLeft: { type: Number, default: 0 },\r\n    viewWidth: { type: Number, default: 0 },\r\n    viewHeight: { type: Number, default: 0 },\r\n    isNodeHide: {\r\n      type: String,\r\n      default: "vif",\r\n      validator: function (value) {\r\n        return ["none", "vshow", "vif"].includes(value);\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      TYPES,\r\n      BLANK_NODE_TIP,\r\n      btnsHeight: 32,\r\n      hovering: false,\r\n      dragging: false,\r\n      titleEditing: this.node[this.titleAttrName], // 正在被编辑的标题内容\r\n      isHoverMaskHovering: false, // 鼠标是否进入了 HoverMask\r\n    };\r\n  },\r\n  computed: {\r\n    isVShow: function () {\r\n      if (this.isNodeHide === "vshow") {\r\n        return this.isNodeReady && this.isRenderNeed;\r\n      } else return true;\r\n    },\r\n\r\n    isVIf: function () {\r\n      if (this.isNodeHide === "vif") {\r\n        return this.isNodeReady && this.isRenderNeed;\r\n      } else return true;\r\n    },\r\n\r\n    isNodeReady: function () {\r\n      return this.viewWidth > 0 && this.viewHeight > 0;\r\n    },\r\n\r\n    isRenderNeed: function () {\r\n      if (this.isHorizontalLayout) {\r\n        // 排除掉全部(四个角)在外面的\r\n        const left = this.viewLeft > this.node.left + this.node.width;\r\n        const right = this.viewLeft + this.viewWidth < this.node.left;\r\n        const top = this.viewTop > this.node.top + this.node.height;\r\n        const bottom = this.viewTop + this.viewHeight < this.node.top;\r\n\r\n        return !left && !right && !top && !bottom;\r\n      } else return true;\r\n    },\r\n\r\n    // -----------------------------------------------------------------------\r\n\r\n    isGloballyReadonly: function () {\r\n      return myStore.state.isGloballyReadonly;\r\n    },\r\n\r\n    fontStyle: function () {\r\n      if (this.node.fontStyle) {\r\n        return Matrix.fontStyleToPureCss(this.node.fontStyle);\r\n      } else return {};\r\n    },\r\n\r\n    // 增加子节点的加号按钮是否可用\r\n    isBtnPlusAvailable: function () {\r\n      return (\r\n        !this.isGloballyReadonly &&\r\n        !this.node.isReadonly &&\r\n        this.currActiveNodeIds.length === 1 // 节点多选的时候，不显示加号按钮\r\n      );\r\n    },\r\n    // 节点的编辑按钮是否可用\r\n    isNodeOperationAvailable: function () {\r\n      return (\r\n        !this.isGloballyReadonly &&\r\n        !this.node.isReadonly &&\r\n        this.isActive &&\r\n        !this.isDragging &&\r\n        this.currActiveNodeIds.length === 1 // 节点多选的时候，不显示编辑按钮\r\n      );\r\n    },\r\n\r\n    // 根据不同情况，某些操作按钮可能不予显示\r\n    whatBtnsToBeShown: function () {\r\n      if (this.node instanceof NormalNode)\r\n        return [\r\n          "FONT_STYLE",\r\n          "ADD_PIC",\r\n          "ADD_VIDEO",\r\n          "ADD_FILE",\r\n          "ADD_SIBLING",\r\n          "DELETE",\r\n        ];\r\n      else if (this.node instanceof CustomizedNode)\r\n        return ["ADD_SIBLING", "DELETE"];\r\n      else return [];\r\n    },\r\n\r\n    // 当前是否处于节点选中状态\r\n    isActive: function () {\r\n      // return this.currActiveNodeId === this.node.id;\r\n\r\n      const index = this.currActiveNodeIds.findIndex(\r\n        (id) => id === this.node.id\r\n      );\r\n      return index > -1;\r\n    },\r\n\r\n    // 节点是否正在被拖动\r\n    isDragging: function () {\r\n      return !!this.currDraggingNode;\r\n    },\r\n\r\n    // 当前是否自定义节点\r\n    isCustomizedNode: function () {\r\n      return this.node instanceof CustomizedNode;\r\n    },\r\n    // 当前节点是否纯文字节点\r\n    isTextCoreAvalible: function () {\r\n      return this.node instanceof NormalNode && !this.node.resources.length;\r\n    },\r\n    // 当前节点是否单图片节点\r\n    isPicSingleCoreAvalible: function () {\r\n      return (\r\n        this.node instanceof NormalNode &&\r\n        this.node.resources.length === 1 &&\r\n        this.node.resources[0].type === TYPES.PIC\r\n      );\r\n    },\r\n    // 当前节点是否单视频节点\r\n    isVideoSingleCoreAvalible: function () {\r\n      return (\r\n        this.node instanceof NormalNode &&\r\n        this.node.resources.length === 1 &&\r\n        this.node.resources[0].type === TYPES.VIDEO\r\n      );\r\n    },\r\n    // 当前节点是否单文件节点\r\n    isFileSingleCoreAvalible: function () {\r\n      return (\r\n        this.node instanceof NormalNode &&\r\n        this.node.resources.length === 1 &&\r\n        this.node.resources[0].type === TYPES.FILE\r\n      );\r\n    },\r\n    // 当前节点是否单HTML节点\r\n    isHtmlSingleCoreAvalible: function () {\r\n      return (\r\n        this.node instanceof NormalNode &&\r\n        this.node.resources.length === 1 &&\r\n        this.node.resources[0].type === TYPES.HTML\r\n      );\r\n    },\r\n    // 当前节点是否多资源节点\r\n    isMultiMediaCoreAvalible: function () {\r\n      return this.node instanceof NormalNode && this.node.resources.length > 1;\r\n    },\r\n\r\n    // 当前是否处于标题修改状态\r\n    isEditing: function () {\r\n      return this.currEditingNodeId === this.node.id;\r\n    },\r\n    // 图片缩放框是否显示(单图片/单视频节点)\r\n    isFlexibleFrameVisible: function () {\r\n      if (this.node instanceof NormalNode && this.node.resources[0]) {\r\n        return (\r\n          this.isActive &&\r\n          myStore.state.resourceIdOfActiveFrame === this.node.resources[0].id\r\n        );\r\n      } else return false;\r\n    },\r\n\r\n    // ----------------------------------------------------------------------------\r\n    anchorTop: function () {\r\n      return {\r\n        x: this.node.left + this.node.width / 2,\r\n        y: this.node.top,\r\n      };\r\n    },\r\n    anchorBottom: function () {\r\n      return {\r\n        x: this.node.left + this.node.width / 2,\r\n        y: this.node.top + this.node.height,\r\n      };\r\n    },\r\n    anchorRight: function () {\r\n      return {\r\n        x: this.node.left + this.node.width,\r\n        y: this.node.top + this.node.height / 2,\r\n      };\r\n    },\r\n    anchorLeft: function () {\r\n      return {\r\n        x: this.node.left,\r\n        y: this.node.top + this.node.height / 2,\r\n      };\r\n    },\r\n    // ----------------------------------------------------------------------------\r\n    // dropAllowZoneX: function () {\r\n    //   return this.node.dropZoneRelativeLeft - this.node.borderWidth;\r\n    // },\r\n    // dropAllowZoneY: function () {\r\n    //   return this.node.dropZoneRelativeTop - this.node.borderWidth;\r\n    // },\r\n    // dropAllowZoneWidth: function () {\r\n    //   return this.node.dropZoneWidth;\r\n    // },\r\n    // dropAllowZoneHeight: function () {\r\n    //   return this.node.dropZoneHeight;\r\n    // },\r\n  },\r\n  watch: {\r\n    // "node.id": function (v, ov) {\r\n    //   console.log("id changed");\r\n    // },\r\n  },\r\n  mounted() {\r\n    // console.log("this.node :>> ", this.node);\r\n    // console.log("this.viewWidth :>> ", this.viewWidth);\r\n  },\r\n  methods: {\r\n    // 确定当前正在编辑的标题(外部调用)\r\n    ConfirmEditingTitle() {\r\n      if (\r\n        this.node[this.titleAttrName] !== this.titleEditing && // 修改后标题要跟修改前不一样\r\n        (this.titleEditing.trim() !== "" || this.titleEditing === "") // 不接受空格，接受空字符串\r\n      ) {\r\n        const oldTitle = this.node[this.titleAttrName];\r\n        this.node[this.titleAttrName] = this.titleEditing;\r\n        this.node.calcCellSize(this.node);\r\n        this.$emit("title-changed", oldTitle);\r\n      }\r\n    },\r\n\r\n    onInputKeyupEnter(newTitle) {\r\n      if (\r\n        this.node[this.titleAttrName] !== newTitle &&\r\n        newTitle.trim() !== ""\r\n      ) {\r\n        const oldTitle = this.node[this.titleAttrName];\r\n        this.node[this.titleAttrName] = newTitle;\r\n        this.$emit("title-changed", oldTitle);\r\n      }\r\n      this.$emit("enter-press", newTitle);\r\n    },\r\n    onTitleEditing(newTitle) {\r\n      this.titleEditing = newTitle;\r\n    },\r\n\r\n    onNodeMouseClick(node, event) {\r\n      this.$emit("node-mouseclick", node, event);\r\n    },\r\n    onTitleDbclickToEdit(node) {\r\n      this.$emit("node-title-dbclick-to-edit", node);\r\n    },\r\n\r\n    onNodeMouseDown(node, event) {\r\n      this.$emit("node-mousedown", node, event);\r\n    },\r\n    onNodeMouseEnter(node, event) {\r\n      this.$emit("node-mouseenter", node, event);\r\n\r\n      if (this.isDragging) {\r\n        if (!this.forbiddenHoveringNodeIds.includes(this.node.id)) {\r\n          this.hovering = true;\r\n          this.$emit("node-hovering", node, event);\r\n        }\r\n      } else {\r\n        this.hovering = true;\r\n        this.$emit("node-hovering", node, event);\r\n      }\r\n    },\r\n    onNodeMouseLeave(node, event) {\r\n      this.hovering = false;\r\n      this.$emit("node-mouseleave", node, event);\r\n      this.$emit("node-hovering-cancel", node, event);\r\n    },\r\n\r\n    onHoverMaskMouseEnter(/* event */) {\r\n      // console.log("onHoverMaskMouseEnter");\r\n      // this.isHoverMaskHovering = true;\r\n      // if (this.hovering) {\r\n      //   this.hovering = false;\r\n      // }\r\n    },\r\n    onHoverMaskMouseLeave(/* event */) {\r\n      // console.log("onHoverMaskMouseLeave");\r\n      // this.isHoverMaskHovering = false;\r\n    },\r\n\r\n    onBtnPlusClick(node, event) {\r\n      this.$emit("btn-plus-click", node, event);\r\n      this.hovering = false;\r\n    },\r\n\r\n    onBtnFoldAndUnfoldClick(node, flag) {\r\n      this.hovering = false;\r\n\r\n      if (flag) {\r\n        this.$emit("btn-fold-click", node, flag);\r\n      } else {\r\n        this.$emit("btn-fold-click", node, flag);\r\n      }\r\n    },\r\n\r\n    onPicCorePicClick() {\r\n      myStore.state.resourceIdOfActiveFrame = this.node.resources[0].id;\r\n    },\r\n    onMultiContentCoreMediaClick(resource /* , index */) {\r\n      myStore.state.resourceIdOfActiveFrame = resource.id;\r\n    },\r\n    onPicDragDotMousedown(event, refFrame) {\r\n      this.$emit("node-pic-drag-dot-mousedown", event, refFrame);\r\n    },\r\n    onPicPreviewClick(resource) {\r\n      this.$emit("node-pic-preview-click", resource);\r\n    },\r\n\r\n    onVideoCorePicClick() {\r\n      myStore.state.resourceIdOfActiveFrame = this.node.resources[0].id;\r\n    },\r\n    onVideoDragDotMousedown(event, refFrame) {\r\n      this.$emit("node-video-drag-dot-mousedown", event, refFrame);\r\n    },\r\n    onVideoPlayClick(resource) {\r\n      this.$emit("node-video-play-click", resource);\r\n    },\r\n\r\n    // onDropZoneMaskMouseenter(event) {\r\n    //   this.$emit("drop-zone-mask-mouseenter", this.node);\r\n    // },\r\n    // onDropZoneMaskMouseleave(event) {\r\n    //   this.$emit("drop-zone-mask-mouseleave", this.node);\r\n    // },\r\n\r\n    GetAnchorTop() {\r\n      return this.anchorTop;\r\n    },\r\n    GetAnchorBottom() {\r\n      return this.anchorBottom;\r\n    },\r\n    GetAnchorRight() {\r\n      return this.anchorRight;\r\n    },\r\n    GetAnchorLeft() {\r\n      return this.anchorLeft;\r\n    },\r\n\r\n    dragenter_handler(event) {\r\n      if (this.allowDrop) {\r\n        event.preventDefault();\r\n        this.$emit("node-dragenter", event);\r\n      }\r\n    },\r\n    dragleave_handler(event) {\r\n      if (this.allowDrop) {\r\n        event.preventDefault();\r\n        this.$emit("node-dragleave", event);\r\n      }\r\n    },\r\n    dragover_handler(event) {\r\n      if (this.allowDrop) {\r\n        event.preventDefault();\r\n        this.$emit("node-dragover", event);\r\n      }\r\n    },\r\n    drop_handler(event) {\r\n      if (this.allowDrop) {\r\n        event.preventDefault();\r\n        this.dragging = false;\r\n        this.$emit("node-drop", event);\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.node {\r\n  // $node-height: 36px;\r\n  $root-color: $main-color-normal;\r\n  $hover-border-color: $main-color-light;\r\n  $active-border-color: $main-color-dark;\r\n\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  user-select: none;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  border-style: solid;\r\n  border-color: #eeeeee;\r\n  border-radius: 8px;\r\n  background-color: #eeeeee;\r\n  color: black;\r\n  cursor: default;\r\n\r\n  &.root {\r\n    border-color: $root-color;\r\n    background-color: $root-color;\r\n\r\n    color: white;\r\n  }\r\n\r\n  &.hovering {\r\n    border-color: $hover-border-color;\r\n  }\r\n\r\n  &.dragging {\r\n    border-color: $hover-border-color;\r\n\r\n    // * {\r\n    //   pointer-events: none;\r\n    // }\r\n  }\r\n\r\n  &.active {\r\n    border-color: $active-border-color;\r\n  }\r\n\r\n  .btns {\r\n    position: absolute;\r\n  }\r\n\r\n  // .drop-zone-mask {\r\n  //   position: absolute;\r\n  //   background-color: #ffff0080;\r\n  //   z-index: 1000;\r\n  // }\r\n}\r\n</style>',".node {\n  box-sizing: border-box;\n  position: absolute;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-style: solid;\n  border-color: #eeeeee;\n  border-radius: 8px;\n  background-color: #eeeeee;\n  color: black;\n  cursor: default;\n}\n.node.root {\n  border-color: #0089ff;\n  background-color: #0089ff;\n  color: white;\n}\n.node.hovering {\n  border-color: #39a3ff;\n}\n.node.dragging {\n  border-color: #39a3ff;\n}\n.node.active {\n  border-color: #0065d5;\n}\n.node .btns {\n  position: absolute;\n}\n\n/*# sourceMappingURL=Node.vue.map */"]},media:void 0})}),Jn,"data-v-21f7d354",!1,void 0,!1,T,void 0,void 0),ne={methods:{onMouseEnter:function(){this.$emit("mouse-enter")},onMouseLeave:function(){this.$emit("mouse-leave")}}},ee=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"pallet",on:{mouseenter:n.onMouseEnter,mouseleave:n.onMouseLeave}},[n._t("default")],2)};ee._withStripped=!0;var re=F({render:ee,staticRenderFns:[]},(function(n){n&&n("data-v-2699eaac_0",{source:".pallet[data-v-2699eaac] {\n  box-sizing: border-box;\n  width: 200px;\n  height: 200px;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 16px;\n  background-color: #fff;\n}\n\n/*# sourceMappingURL=Pallet.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\Pallet.vue","Pallet.vue"],names:[],mappings:"AA0BA;EACA,sBAAA;EACA,YAAA;EACA,aAAA;EACA,sBAAA;EACA,kBAAA;EACA,aAAA;EACA,sBAAA;ACzBA;;AAEA,qCAAqC",file:"Pallet.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-29 17:57:56\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2022-09-30 01:06:25\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="pallet" @mouseenter="onMouseEnter" @mouseleave="onMouseLeave">\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  methods: {\r\n    onMouseEnter() {\r\n      this.$emit("mouse-enter");\r\n    },\r\n    onMouseLeave() {\r\n      this.$emit("mouse-leave");\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.pallet {\r\n  box-sizing: border-box;\r\n  width: 200px;\r\n  height: 200px;\r\n  border: 1px solid #eee;\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  background-color: #fff;\r\n}\r\n</style>',".pallet {\n  box-sizing: border-box;\n  width: 200px;\n  height: 200px;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 16px;\n  background-color: #fff;\n}\n\n/*# sourceMappingURL=Pallet.vue.map */"]},media:void 0})}),ne,"data-v-2699eaac",!1,void 0,!1,T,void 0,void 0),te=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"btn-wrapper"},[n._t("default")],2)};te._withStripped=!0;var ie=F({render:te,staticRenderFns:[]},(function(n){n&&n("data-v-0b6021da_0",{source:".btn-wrapper[data-v-0b6021da] {\n  width: 32px;\n  height: 32px;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-wrapper[data-v-0b6021da]:not(:first-child) {\n  margin-top: 4px;\n}\n.btn-wrapper[data-v-0b6021da]:hover:not(.active) {\n  background-color: #eee;\n  border-radius: 4px;\n}\n\n/*# sourceMappingURL=BtnWrapper.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\MapOperation\\BtnWrapper.vue","BtnWrapper.vue"],names:[],mappings:"AAMA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;ACLA;ADOA;EACA,eAAA;ACLA;ADSA;EACA,sBAAA;EACA,kBAAA;ACPA;;AAEA,yCAAyC",file:"BtnWrapper.vue",sourcesContent:['<template>\r\n  <div class="btn-wrapper">\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n<style lang="scss" scoped>\r\n.btn-wrapper {\r\n  width: 32px;\r\n  height: 32px;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  &:not(:first-child) {\r\n    margin-top: 4px;\r\n  }\r\n\r\n  &:hover {\r\n    &:not(.active) {\r\n      background-color: #eee;\r\n      border-radius: 4px;\r\n    }\r\n  }\r\n}\r\n</style>',".btn-wrapper {\n  width: 32px;\n  height: 32px;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.btn-wrapper:not(:first-child) {\n  margin-top: 4px;\n}\n.btn-wrapper:hover:not(.active) {\n  background-color: #eee;\n  border-radius: 4px;\n}\n\n/*# sourceMappingURL=BtnWrapper.vue.map */"]},media:void 0})}),{},"data-v-0b6021da",!1,void 0,!1,T,void 0,void 0),oe={components:{Pallet:re,BtnWrapper:ie},props:{isBtnHorizontalActive:{type:Boolean,default:!1},isBtnVerticalActive:{type:Boolean,default:!1},isBtnMoveCanvasActive:{type:Boolean,default:!1},isCurveLinesActive:{type:Boolean,default:!1},isStraightLinesActive:{type:Boolean,default:!1}},data:function(){return{btnsImg:{setting:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAgVJREFUWEftVkFuwjAQ3CXhHeWIFPOGlpeUvgR4SelLmr4BI3GDvgNHribyoiU4cUmhXMgtSpydnZ2ZDdOdL75zfXoAeDDQiwFjzAsRPWsBM/P3er1eXSrqvgA+iQggmtfUWlteAuIvAMhaO0WxwAhA3QaAMcZ77/fM/BaoXxBRGQFQOufe8jx/JSK8s7DWLrsYSTJQFMU7M88CgFH4WF1ou93ucT8ej0eq6LEezlRVNZX3YkA6AYQP77z3q6qqlqHIV9ucFZAv59w+z/P67GazAXPRqxOAMaYWm7X27D0UGw6HtRDRaQyUMWbuvZ9hdG2gWwGo7s9oVKLTXZ3NW42vlYUUgFpMIkDpoiiKHSoPBoPl4XAoZf7oVLJA2INYtV6ac0iKsGkxudfFhK2GMz4BvGv+AJMEMJlM4IB38XgMQMgCWPVINVhiZmijzoq+IpwHP+N8HTLoNssyiPM4gizL5rCqDiIZgTiozYqtDEinMS8LCGaWXACeExHqbOiyYtKG3vtRLEzEht77J+fcR6xDcUFXRPcJIuyAaLwGZjCOj6sEEXhFFwgjTTcoRREdLggdpZc6nHAmFmInazy1OpuiA+WhUHQZERHYwb/CQlu1lwvkEEDoGQeF/986bqJXKXe3H5KzXzIgSe3+i9dxSh/XeJ6M4msU6R3Fty7+q2V0axCPEfwAJ4BzMIQN03kAAAAASUVORK5CYII=",horizontal:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAP1JREFUWEftVdsNAjEM820Cm8AksAkwCTAJMAkwCchSK1Wlr+QiClIr3delZ5/jOBM6n6kzPgaBoYBGgQuAM4CThYFLBBYANgHI04G+AFzd08rB3/2oLxHYAjhGN5YA7q2oQd0DAO+KCORwqMAewEFBxIQAleEfsQ2zj8aEs0HDDwwClgqs3NQk3Z7rmyQHSr3nnPNwbBlQNGl4zHIgR4Kgt0Ru+HrTHMiR8MHFFsQKZNWz9ICPblFAWRJQ5cNfEqDUzT2uyaJR4GvLyAdL+BNrt441CojXMaXeRTudDqcC0m3I+uR0/HQLcv7pbsKasUXvNS0QAdSKB4HuCrwBiQErIRkgoXEAAAAASUVORK5CYII=",vertical:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAANRJREFUWEftl+EJwlAMhL9Ook6io+gk6iS6iW6imygHFh4xrwFLKEgC/RWS3Lt3l7YDC8ew8HwKQDEQMbAGdsC1I9Yor9rn53FbRACOwAm6Yo3yD+AOHHpuKwDFwBwGLkDrgrOj9lQRqnkbAmDtmgpgHC6vy2pepAOoPfDfDLyMqrTPrcp7DEiYN1O/8V5KU3tgD6yaJrKZjakrUM7a9KtBtIh0ki3gDVezSAPjIXr14TdhNCDK1x6YzYDuUDRLwV5EeQGQc37WQPp/S+SCAlAMpDPwBm1pUiGCKtT0AAAAAElFTkSuQmCC",hand:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAdtJREFUWEfFl4FNxDAMRf9NAmwCkwCTAJMAkwCTAJOAHsqv0l6as9ujjXRSm0vi72/7Oz1o53HY2b7WAriW9CDpUtK7pCdJXxmnlgDAKAYx9FyMYZx55u4l3Ur6KKC6eLIAPivjgGBcFcMAeCtzADErNz0EGQB3xWMMMvAeoz7DAB5LKHhnDQBmw5IBwGF4ZY8MaArAjLAWxgjJyxwL/wkAmz+SYOS75MMRE1sAsPMYhwkqZRhbAKBCCEOdE8z9jS0A1DlAToxY6AFwrRtsNgmdA2kAzm4OcEm57DJVsAiAaxmaUDK85hkvNmEAXcdrh8ZsUPvI6yYM4KnVDhqRV8tqDYBnKx3rpu+LQmD1Mu0c4rBQx/y62j5RPIQonYTW+JoF5ghHDazXY/zftJKmgJo60GKBOfLjNdJiZ5D5XBg8KUQtFiIe99Y4lG5WXSVssbAWQN3Oh6bUU8Jzs+A8Gtk8JcXWbjJ57eAsN6ZwNyTxoK57qwkgayZgpBuyESE6Qh4wWi+Z3p7CDLCQzTBBGIbySQJo0h9hwHYsx0tC4eQblZ8Pjl5IHAr2ZUC4uc1eTKMA3Gx87ycUtOu5cVFCB/Cz3YoNgrZMXvjDpAUCoQl9qmUYSOZdbPnuAH4BUUqpIfXakacAAAAASUVORK5CYII=",straightLines:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIzLTAxLTMwVDE0OjIyOjUxKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMy0wMS0zMFQxNToxOToxOSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMy0wMS0zMFQxNToxOToxOSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NTI2NjEzZi1jZWUzLTY2NDgtYWQwOS01ZGMwMTRjMjA4OWEiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo4NzJkNTQyNi02NzZiLWE5NDktYTQyMi0xMDAzZTU2ZjAyMWMiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2YjJhZDNkZC00OGNmLWI0NDQtYTA5MS1mMmM3NjhkODg3MjAiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjZiMmFkM2RkLTQ4Y2YtYjQ0NC1hMDkxLWYyYzc2OGQ4ODcyMCIgc3RFdnQ6d2hlbj0iMjAyMy0wMS0zMFQxNDoyMjo1MSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NTI2NjEzZi1jZWUzLTY2NDgtYWQwOS01ZGMwMTRjMjA4OWEiIHN0RXZ0OndoZW49IjIwMjMtMDEtMzBUMTU6MTk6MTkrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4xIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6vUjYmAAABHklEQVRIie3VsUrEQBAG4Dm57kiuDGysg/sCIxYWqe3Sh3CPcJVPkBdI0tokYONjWBwZU4oh9WnA0uwDrIUeWIi34x4hHDewXX6+hezMzLTWMGadjaqdwKMA59xA27aLoijWRHQ5DMPSNIeIm6qqblkgEXlxHD84jqMQcSOlfDHN+r6/BQCYcfowDMN7pdSyaZobzkV/Fusf9n1/niTJ3X8xFkhEng3EBr/remzQuuYAAGmarrquu/jrQ04L7AUBAPa91oNtFa210anr2guCQGdZFplmfjuTn6WPo4GI+G6LsUAAACHEa1mWKxuQNUt3w9t13Q9ErKWUz6ZZIcRbFEVPLBDgaz3leb4moiullGOa260nNmhbk2+LEzg98BOr1bGNRJ8EaAAAAABJRU5ErkJggg==",curveLines:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIzLTAxLTMwVDE0OjI1OjE4KzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMy0wMS0zMFQxNToxNzozOSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMy0wMS0zMFQxNToxNzozOSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmODQ0ZWM2NS00MDUxLTlhNGQtYTE4MC1hZmRlMmEzNzlmNjYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjZDM5NWYyZi1kOTBjLTA4NGUtYWZlMi1jZTFkZTFhMTY2YWYiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4YjM4OTNkYy0zZTAxLThiNDgtOTY5Ny04NmRkMjVjNWEzMTUiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjhiMzg5M2RjLTNlMDEtOGI0OC05Njk3LTg2ZGQyNWM1YTMxNSIgc3RFdnQ6d2hlbj0iMjAyMy0wMS0zMFQxNDoyNToxOCswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmODQ0ZWM2NS00MDUxLTlhNGQtYTE4MC1hZmRlMmEzNzlmNjYiIHN0RXZ0OndoZW49IjIwMjMtMDEtMzBUMTU6MTc6MzkrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4xIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Cidh2AAABnklEQVRIie2WMWvCQBiGvdJJyNoh6fzlsnqxdCoFpWNOMpaIs0LWLhnVHxD0Byi4yaXQLVC6x+xespv8gAodmw5tpJWqNSYO0hcOwvFdnuPl/e4OJUlSOqbOjkr7Bxah86J+zDkv+76vep53vVwuBVmWQ8uyJrkDHcepDIdDM4oiMZ3DGAfpN8qzLRqNhs05x6IoxrquP9br9WdFUd5+FCVJcvDwPO9CVdUpIYSNRqPbbbUHwxhjFQBwCSFsPp+Xd9UfBOv3+/cA4GqaZv91TWYLKaU2ALjtdvthn7V7gRzHqTSbzW5qIWOssu9m0Zc1RhiG8qb0LRaLyzTmgiDctVotaprmU5Ykr06abbsSBOE1rUMIlRBC71lgO0G/JdIwjC4AuKqqTrNYmjk0mqbZAOB2Op3iQrM+er2eAQAupbTYtli3ObW48Mb/bjEhhAGAOx6Pb3a2RV6ilNpBEGBJkmJd11mtVntZP7xzBZZKn9fTYDAw4zheXU+KogTVatW3LGuSOzAV57w8m82uOOc4iiIJYxwWCtyk039EnT7wA4q+kC9xYHTZAAAAAElFTkSuQmCC"},isPalletVisible:!1,palletHideTimeoutId:""}},computed:{},methods:{onBtnHorizontalClick:function(){this.$emit("btn-horizontal-click")},onBtnVerticalClick:function(){this.$emit("btn-vertical-click")},onBtnMoveCanvasClick:function(){this.$emit("btn-move-canvas-click")},onBtnCurveLinesClick:function(){this.$emit("btn-curve-lines-click")},onBtnStraightLinesClick:function(){this.$emit("btn-straight-lines-click")},onBtnSettingMouseEnter:function(){this.isPalletVisible=!0},onBtnSettingMouseLeave:function(){var n=this;this.palletHideTimeoutId=setTimeout((function(){n.isPalletVisible=!1}),1e3)},onPalletMouseEnter:function(){this.palletHideTimeoutId&&clearTimeout(this.palletHideTimeoutId)},onPalletMouseLeave:function(){this.isPalletVisible=!1}}},se=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"map-operation"},[r("BtnWrapper",{nativeOn:{mouseenter:function(e){return n.onBtnSettingMouseEnter.apply(null,arguments)},mouseleave:function(e){return n.onBtnSettingMouseLeave.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",attrs:{src:n.btnsImg.setting}})]),n._v(" "),r("BtnWrapper",{class:{active:n.isBtnMoveCanvasActive},nativeOn:{click:function(e){return n.onBtnMoveCanvasClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",style:{width:"75%",height:"75%"},attrs:{src:n.btnsImg.hand}})]),n._v(" "),n.isPalletVisible?r("Pallet",{staticClass:"pallet",on:{"mouse-enter":n.onPalletMouseEnter,"mouse-leave":n.onPalletMouseLeave}},[r("div",{staticClass:"pallet-content"},[r("div",{staticClass:"section"},[r("div",{staticClass:"title"},[r("span",[n._v("布局")])]),n._v(" "),r("div",{staticClass:"btns"},[r("BtnWrapper",{staticClass:"btn",class:{active:n.isBtnHorizontalActive},nativeOn:{click:function(e){return n.onBtnHorizontalClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",attrs:{src:n.btnsImg.horizontal}})]),n._v(" "),r("BtnWrapper",{staticClass:"btn",class:{active:n.isBtnVerticalActive},nativeOn:{click:function(e){return n.onBtnVerticalClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",attrs:{src:n.btnsImg.vertical}})])],1)]),n._v(" "),r("div",{staticClass:"section"},[r("div",{staticClass:"title"},[r("span",[n._v("线型")])]),n._v(" "),r("div",{staticClass:"btns"},[r("BtnWrapper",{staticClass:"btn",class:{active:n.isCurveLinesActive},nativeOn:{click:function(e){return n.onBtnCurveLinesClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",style:{width:"24px",height:"24px"},attrs:{src:n.btnsImg.curveLines}})]),n._v(" "),r("BtnWrapper",{staticClass:"btn",class:{active:n.isStraightLinesActive},nativeOn:{click:function(e){return n.onBtnStraightLinesClick.apply(null,arguments)}}},[r("img",{staticClass:"btn-img",style:{width:"24px",height:"24px"},attrs:{src:n.btnsImg.straightLines}})])],1)])])]):n._e()],1)};se._withStripped=!0;var ae=F({render:se,staticRenderFns:[]},(function(n){n&&n("data-v-e1abec46_0",{source:".map-operation[data-v-e1abec46] {\n  box-sizing: border-box;\n  width: 44px;\n  padding: 8px 0;\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  border: 1px solid #eee;\n  background-color: #fff;\n  position: relative;\n}\n.map-operation .active[data-v-e1abec46] {\n  background-color: #ccc;\n  border-radius: 4px;\n}\n.map-operation .btn-img[data-v-e1abec46] {\n  width: 100%;\n  height: 100%;\n}\n.map-operation .pallet[data-v-e1abec46] {\n  position: absolute;\n  top: 0px;\n  left: 48px;\n}\n.map-operation .pallet .pallet-content[data-v-e1abec46] {\n  width: 100%;\n  height: 100%;\n}\n.map-operation .pallet .pallet-content .section[data-v-e1abec46] {\n  width: 100%;\n}\n.map-operation .pallet .pallet-content .section[data-v-e1abec46]:not(:first-child) {\n  margin-top: 24px;\n}\n.map-operation .pallet .pallet-content .section .title[data-v-e1abec46] {\n  width: 100%;\n  font-size: 16px;\n  line-height: 16px;\n  margin-bottom: 12px;\n}\n.map-operation .pallet .pallet-content .section .btns[data-v-e1abec46] {\n  overflow: hidden;\n}\n.map-operation .pallet .pallet-content .section .btns .btn[data-v-e1abec46] {\n  float: left;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.map-operation .pallet .pallet-content .section .btns .btn[data-v-e1abec46]:not(:first-child) {\n  margin-left: 8px;\n  margin-top: 0px;\n}\n\n/*# sourceMappingURL=MapOperation.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Btns\\MapOperation.vue","MapOperation.vue"],names:[],mappings:"AAkKA;EACA,sBAAA;EACA,WAAA;EACA,cAAA;EACA,kBAAA;EACA,aAAA;EACA,sBAAA;EACA,2BAAA;EACA,mBAAA;EACA,sBAAA;EACA,sBAAA;EACA,kBAAA;ACjKA;ADmKA;EACA,sBAAA;EACA,kBAAA;ACjKA;ADoKA;EACA,WAAA;EACA,YAAA;AClKA;ADqKA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;ACnKA;ADoKA;EACA,WAAA;EACA,YAAA;AClKA;ADmKA;EACA,WAAA;ACjKA;ADkKA;EACA,gBAAA;AChKA;ADkKA;EACA,WAAA;EACA,eAAA;EACA,iBAAA;EACA,mBAAA;AChKA;ADkKA;EACA,gBAAA;AChKA;ADiKA;EACA,WAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;AC/JA;ADiKA;EACA,gBAAA;EACA,eAAA;AC/JA;;AAEA,2CAA2C",file:"MapOperation.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-29 17:26:38\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-01-30 17:16:35\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="map-operation">\r\n    <BtnWrapper\r\n      @mouseenter.native="onBtnSettingMouseEnter"\r\n      @mouseleave.native="onBtnSettingMouseLeave"\r\n    >\r\n      <img class="btn-img" :src="btnsImg.setting" />\r\n    </BtnWrapper>\r\n\r\n    <BtnWrapper\r\n      :class="{ active: isBtnMoveCanvasActive }"\r\n      @click.native="onBtnMoveCanvasClick"\r\n    >\r\n      <img\r\n        class="btn-img"\r\n        :src="btnsImg.hand"\r\n        :style="{ width: \'75%\', height: \'75%\' }"\r\n      />\r\n    </BtnWrapper>\r\n\r\n    <Pallet\r\n      class="pallet"\r\n      v-if="isPalletVisible"\r\n      @mouse-enter="onPalletMouseEnter"\r\n      @mouse-leave="onPalletMouseLeave"\r\n    >\r\n      <div class="pallet-content">\r\n        <div class="section">\r\n          <div class="title">\r\n            <span>布局</span>\r\n          </div>\r\n          <div class="btns">\r\n            <BtnWrapper\r\n              class="btn"\r\n              :class="{ active: isBtnHorizontalActive }"\r\n              @click.native="onBtnHorizontalClick"\r\n            >\r\n              <img class="btn-img" :src="btnsImg.horizontal" />\r\n            </BtnWrapper>\r\n\r\n            <BtnWrapper\r\n              class="btn"\r\n              :class="{ active: isBtnVerticalActive }"\r\n              @click.native="onBtnVerticalClick"\r\n            >\r\n              <img class="btn-img" :src="btnsImg.vertical" />\r\n            </BtnWrapper>\r\n          </div>\r\n        </div>\r\n        <div class="section">\r\n          <div class="title">\r\n            <span>线型</span>\r\n          </div>\r\n          <div class="btns">\r\n            <BtnWrapper\r\n              class="btn"\r\n              :class="{ active: isCurveLinesActive }"\r\n              @click.native="onBtnCurveLinesClick"\r\n            >\r\n              <img\r\n                class="btn-img"\r\n                :style="{ width: \'24px\', height: \'24px\' }"\r\n                :src="btnsImg.curveLines"\r\n              />\r\n            </BtnWrapper>\r\n            <BtnWrapper\r\n              class="btn"\r\n              :class="{ active: isStraightLinesActive }"\r\n              @click.native="onBtnStraightLinesClick"\r\n            >\r\n              <img\r\n                class="btn-img"\r\n                :style="{ width: \'24px\', height: \'24px\' }"\r\n                :src="btnsImg.straightLines"\r\n              />\r\n            </BtnWrapper>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Pallet>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Pallet from "../../../components/MindMap/Btns/Pallet.vue";\r\nimport BtnWrapper from "./MapOperation/BtnWrapper.vue";\r\n\r\nimport SETTING from "../../../assets/icons/MapOperation/setting.png";\r\nimport HORIZONTAL from "../../../assets/icons/MapOperation/horizontal.png";\r\nimport VERTICAL from "../../../assets/icons/MapOperation/vertical.png";\r\nimport HAND from "../../../assets/icons/MapOperation/hand.png";\r\nimport STRAIGHT_LINES from "../../../assets/icons/MapOperation/straight-lines.png";\r\nimport CURVE_LINES from "../../../assets/icons/MapOperation/curve-lines.png";\r\n\r\nexport default {\r\n  components: { Pallet, BtnWrapper },\r\n  props: {\r\n    isBtnHorizontalActive: { type: Boolean, default: false }, // 横向布局的按钮是否激活\r\n    isBtnVerticalActive: { type: Boolean, default: false }, // 竖向布局的按钮是否激活\r\n    isBtnMoveCanvasActive: { type: Boolean, default: false }, // 平移画布的按钮是否激活\r\n    isCurveLinesActive: { type: Boolean, default: false }, // 曲线连线按钮是否激活\r\n    isStraightLinesActive: { type: Boolean, default: false }, // 直角线按钮是否激活\r\n  },\r\n  data() {\r\n    return {\r\n      btnsImg: {\r\n        setting: SETTING,\r\n        horizontal: HORIZONTAL,\r\n        vertical: VERTICAL,\r\n        hand: HAND,\r\n        straightLines: STRAIGHT_LINES,\r\n        curveLines: CURVE_LINES,\r\n      },\r\n      isPalletVisible: false,\r\n      palletHideTimeoutId: "",\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    onBtnHorizontalClick() {\r\n      this.$emit("btn-horizontal-click");\r\n    },\r\n    onBtnVerticalClick() {\r\n      this.$emit("btn-vertical-click");\r\n    },\r\n    onBtnMoveCanvasClick() {\r\n      this.$emit("btn-move-canvas-click");\r\n    },\r\n    onBtnCurveLinesClick() {\r\n      this.$emit("btn-curve-lines-click");\r\n    },\r\n    onBtnStraightLinesClick() {\r\n      this.$emit("btn-straight-lines-click");\r\n    },\r\n\r\n    onBtnSettingMouseEnter() {\r\n      this.isPalletVisible = true;\r\n    },\r\n    onBtnSettingMouseLeave() {\r\n      // 延迟隐藏 Pallet，因为有可能鼠标进入 Pallet\r\n      this.palletHideTimeoutId = setTimeout(() => {\r\n        this.isPalletVisible = false;\r\n      }, 1000);\r\n    },\r\n    onPalletMouseEnter() {\r\n      // 鼠标进入 Pallet 后，Pallet 不自动隐藏\r\n      if (this.palletHideTimeoutId) clearTimeout(this.palletHideTimeoutId);\r\n    },\r\n    onPalletMouseLeave() {\r\n      this.isPalletVisible = false;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.map-operation {\r\n  box-sizing: border-box;\r\n  width: 44px;\r\n  padding: 8px 0;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  border: 1px solid #eee;\r\n  background-color: #fff;\r\n  position: relative;\r\n\r\n  .active {\r\n    background-color: #ccc;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .btn-img {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .pallet {\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 48px;\r\n    .pallet-content {\r\n      width: 100%;\r\n      height: 100%;\r\n      .section {\r\n        width: 100%;\r\n        &:not(:first-child) {\r\n          margin-top: 24px;\r\n        }\r\n        .title {\r\n          width: 100%;\r\n          font-size: 16px;\r\n          line-height: 16px;\r\n          margin-bottom: 12px;\r\n        }\r\n        .btns {\r\n          overflow: hidden;\r\n          .btn {\r\n            float: left;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n\r\n            &:not(:first-child) {\r\n              margin-left: 8px;\r\n              margin-top: 0px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>',".map-operation {\n  box-sizing: border-box;\n  width: 44px;\n  padding: 8px 0;\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  border: 1px solid #eee;\n  background-color: #fff;\n  position: relative;\n}\n.map-operation .active {\n  background-color: #ccc;\n  border-radius: 4px;\n}\n.map-operation .btn-img {\n  width: 100%;\n  height: 100%;\n}\n.map-operation .pallet {\n  position: absolute;\n  top: 0px;\n  left: 48px;\n}\n.map-operation .pallet .pallet-content {\n  width: 100%;\n  height: 100%;\n}\n.map-operation .pallet .pallet-content .section {\n  width: 100%;\n}\n.map-operation .pallet .pallet-content .section:not(:first-child) {\n  margin-top: 24px;\n}\n.map-operation .pallet .pallet-content .section .title {\n  width: 100%;\n  font-size: 16px;\n  line-height: 16px;\n  margin-bottom: 12px;\n}\n.map-operation .pallet .pallet-content .section .btns {\n  overflow: hidden;\n}\n.map-operation .pallet .pallet-content .section .btns .btn {\n  float: left;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.map-operation .pallet .pallet-content .section .btns .btn:not(:first-child) {\n  margin-left: 8px;\n  margin-top: 0px;\n}\n\n/*# sourceMappingURL=MapOperation.vue.map */"]},media:void 0})}),oe,"data-v-e1abec46",!1,void 0,!1,T,void 0,void 0),le={props:{top:{type:Number,default:0},left:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0}},data:function(){return{padding:8}}},de=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"scope-frame",style:{top:n.top-n.padding+"px",left:n.left-n.padding+"px",width:n.width+2*n.padding+"px",height:n.height+2*n.padding+"px"}})};de._withStripped=!0;var ce=F({render:de,staticRenderFns:[]},(function(n){n&&n("data-v-cf6d8b72_0",{source:".scope-frame[data-v-cf6d8b72] {\n  pointer-events: none;\n  box-sizing: border-box;\n  border: 2px dashed #39a3ff;\n  border-radius: 4px;\n}\n\n/*# sourceMappingURL=ScopeFrame.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\ScopeFrame.vue","ScopeFrame.vue"],names:[],mappings:"AAqCA;EACA,oBAAA;EACA,sBAAA;EACA,0BAAA;EACA,kBAAA;ACpCA;;AAEA,yCAAyC",file:"ScopeFrame.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-30 17:19:08\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2022-11-16 16:31:20\r\n * @Description: 移动节点时出现的禁选范围框\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    class="scope-frame"\r\n    :style="{\r\n      top: `${top - padding}px`,\r\n      left: `${left - padding}px`,\r\n      width: `${width + padding * 2}px`,\r\n      height: `${height + padding * 2}px`,\r\n    }"\r\n  ></div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    top: { type: Number, default: 0 },\r\n    left: { type: Number, default: 0 },\r\n    width: { type: Number, default: 0 },\r\n    height: { type: Number, default: 0 },\r\n  },\r\n  data() {\r\n    return {\r\n      padding: 8,\r\n    };\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n\r\n.scope-frame {\r\n  pointer-events: none; // 穿透鼠标事件,为了排序zone的鼠标事件生效\r\n  box-sizing: border-box;\r\n  border: 2px dashed $main-color-light;\r\n  border-radius: 4px;\r\n}\r\n</style>',".scope-frame {\n  pointer-events: none;\n  box-sizing: border-box;\n  border: 2px dashed #39a3ff;\n  border-radius: 4px;\n}\n\n/*# sourceMappingURL=ScopeFrame.vue.map */"]},media:void 0})}),le,"data-v-cf6d8b72",!1,void 0,!1,T,void 0,void 0),Ae={methods:{onBtnCloseClick:function(){this.$emit("close")}}},he=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"btn-close",on:{click:function(e){return e.stopPropagation(),n.onBtnCloseClick.apply(null,arguments)}}},[r("div",{staticClass:"btn-inner el-icon-close"})])};he._withStripped=!0;var ue={components:{BtnClose:F({render:he,staticRenderFns:[]},(function(n){n&&n("data-v-cef6e454_0",{source:'.btn-close[data-v-cef6e454] {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n  box-sizing: border-box;\n  top: 24px;\n  right: calc(10% - 20px);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24px;\n  background-color: #606266;\n  color: #fff;\n  opacity: 0.8;\n  cursor: pointer;\n  user-select: none;\n  z-index: 10000;\n}\n.btn-close .btn-inner[data-v-cef6e454] {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.btn-close .btn-inner.el-icon-close[data-v-cef6e454] {\n  background-image: url("../../../assets/icons/PicPreviewer/close.png");\n}\n\n/*# sourceMappingURL=BtnClose.vue.map */',map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Previewer\\BtnClose.vue","BtnClose.vue"],names:[],mappings:"AAyBA;EAEA,kBAAA;EACA,WAFA;EAGA,YAHA;EAIA,sBAAA;EACA,SAAA;EAEA,uBAAA;EACA,kBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,eAAA;EACA,yBAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;EACA,cAAA;AC1BA;AD2BA;EACA,WAAA;EACA,YAAA;EACA,4BAAA;EACA,wBAAA;ACzBA;AD0BA;EACA,qEAAA;ACxBA;;AAEA,uCAAuC",file:"BtnClose.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-05-23 19:44:15\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2022-11-29 15:02:06\r\n * @Description: 全屏时通用的关闭按钮\r\n--\x3e\r\n\r\n<template>\r\n  <div class="btn-close" @click.stop="onBtnCloseClick">\r\n    <div class="btn-inner el-icon-close"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  methods: {\r\n    onBtnCloseClick() {\r\n      this.$emit("close");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n\r\n.btn-close {\r\n  $btn-close-size: 40px;\r\n  position: absolute;\r\n  width: $btn-close-size;\r\n  height: $btn-close-size;\r\n  box-sizing: border-box;\r\n  top: 24px;\r\n  // right: 40px;\r\n  right: calc(10% - #{math.div($btn-close-size, 2)});\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 24px;\r\n  background-color: #606266;\r\n  color: #fff;\r\n  opacity: 0.8;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  z-index: 10000;\r\n  .btn-inner {\r\n    width: 24px;\r\n    height: 24px;\r\n    background-repeat: no-repeat;\r\n    background-size: contain;\r\n    &.el-icon-close {\r\n      background-image: url("../../../assets/icons/PicPreviewer/close.png");\r\n    }\r\n  }\r\n}\r\n</style>','.btn-close {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n  box-sizing: border-box;\n  top: 24px;\n  right: calc(10% - 20px);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24px;\n  background-color: #606266;\n  color: #fff;\n  opacity: 0.8;\n  cursor: pointer;\n  user-select: none;\n  z-index: 10000;\n}\n.btn-close .btn-inner {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.btn-close .btn-inner.el-icon-close {\n  background-image: url("../../../assets/icons/PicPreviewer/close.png");\n}\n\n/*# sourceMappingURL=BtnClose.vue.map */']},media:void 0})}),Ae,"data-v-cef6e454",!1,void 0,!1,T,void 0,void 0)},methods:{onBtnCloseClick:function(){this.$emit("close")},onWrapperClick:function(){}}},pe=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"layout"},[r("div",{staticClass:"wrapper",on:{click:function(e){return e.stopPropagation(),n.onWrapperClick.apply(null,arguments)}}}),n._v(" "),r("div",{staticClass:"main"},[n._t("main")],2),n._v(" "),r("BtnClose",{staticClass:"btn-close",on:{close:n.onBtnCloseClick}})],1)};pe._withStripped=!0;var fe=F({render:pe,staticRenderFns:[]},(function(n){n&&n("data-v-41a1da95_0",{source:".layout[data-v-41a1da95] {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n}\n.layout .wrapper[data-v-41a1da95] {\n  display: block;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: -1;\n}\n.layout .main[data-v-41a1da95] {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Layout.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Previewer\\Layout.vue","Layout.vue"],names:[],mappings:"AA6BA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,aAAA;AC5BA;AD8BA;EAEA,cAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,oCAAA;EACA,WAAA;AC7BA;ADgCA;EACA,WAAA;EACA,YAAA;AC9BA;;AAEA,qCAAqC",file:"Layout.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-06-13 14:19:03\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2022-11-16 16:32:46\r\n * @Description: 文件预览的布局母版\r\n--\x3e\r\n<template>\r\n  <div class="layout">\r\n    <div class="wrapper" @click.stop="onWrapperClick"></div>\r\n    <div class="main">\r\n      <slot name="main"></slot>\r\n    </div>\r\n    <BtnClose class="btn-close" @close="onBtnCloseClick" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport BtnClose from "../../../components/MindMap/Previewer/BtnClose.vue";\r\nexport default {\r\n  components: { BtnClose },\r\n  methods: {\r\n    onBtnCloseClick() {\r\n      this.$emit("close");\r\n    },\r\n    onWrapperClick() {},\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.layout {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  z-index: 1000;\r\n\r\n  .wrapper {\r\n    // content: "";\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    background-color: rgba(0, 0, 0, 0.7);\r\n    z-index: -1;\r\n  }\r\n\r\n  .main {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>',".layout {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n}\n.layout .wrapper {\n  display: block;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: -1;\n}\n.layout .main {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Layout.vue.map */"]},media:void 0})}),ue,"data-v-41a1da95",!1,void 0,!1,T,void 0,void 0);function me(n){var e=!1;return function(){for(var r=this,t=[],i=arguments.length;i--;)t[i]=arguments[i];e||(e=!0,window.requestAnimationFrame((function(){n.apply(r,t),e=!1})))}}var ge=document.addEventListener?function(n,e,r){n&&e&&r&&n.addEventListener(e,r,!1)}:function(n,e,r){n&&e&&r&&n.attachEvent("on"+e,r)},ve=document.removeEventListener?function(n,e,r){n&&e&&n.removeEventListener(e,r,!1)}:function(n,e,r){n&&e&&n.detachEvent("on"+e,r)},be={CONTAIN:{name:"contain",icon:"icon-full-screen"},ORIGINAL:{name:"original",icon:"icon-c-scale-to-original"}},Ce={getVersion:function(n){var e,r=n||navigator.userAgent,t=r.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(t[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(r)||[])[1]||""}:"Chrome"===t[1]&&null!=(e=r.match(/\bOPR|Edge\/(\d+)/))?{name:"Opera",version:e[1]}:(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=r.match(/version\/(\d+)/i))&&t.splice(1,1,e[1]),{name:t[0],version:t[1]})},isIE:function(){return!isNaN(Number(document.documentMode))},isEdge:function(){return navigator.userAgent.indexOf("Edge")>-1},isFirefox:function(){return!!window.navigator.userAgent.match(/firefox/i)}}.isFirefox()?"DOMMouseScroll":"mousewheel",we={props:{urlList:{type:Array,default:function(){return[]}},initialIndex:{type:Number,default:0},allowMoveout:{type:Boolean,default:!1}},data:function(){return{index:this.initialIndex,infinite:!0,loading:!1,zoomRate:.2,mode:be.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.urlList[this.index]},imgStyle:function(){var n=this.transform,e={transform:"scale("+n.scale+") rotate("+n.deg+"deg) translateX("+n.offsetX+"px) translateY("+n.offsetY+"px)",transition:n.enableTransition?"transform .3s":""};return this.mode===be.CONTAIN&&(e.maxWidth=e.maxHeight="100%"),e}},mounted:function(){this.deviceSupportInstall()},destroyed:function(){this.deviceSupportUninstall()},methods:{hide:function(){this.deviceSupportUninstall()},handleImgLoad:function(){this.loading=!1},handleImgError:function(n){this.loading=!1,n.target.alt="加载失败"},handleActions:function(n,e){if(void 0===e&&(e={}),!this.loading){var r=Object.assign({},{zoomRate:this.zoomRate,rotateDeg:90,enableTransition:!0},e),t=r.zoomRate,i=r.rotateDeg,o=r.enableTransition,s=this.transform;switch(n){case"zoomOut":s.scale>1-2*this.zoomRate&&(s.scale=parseFloat((s.scale-t).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+t).toFixed(3));break;case"clocelise":s.deg+=i;break;case"anticlocelise":s.deg-=i}s.enableTransition=o}},deviceSupportInstall:function(){var n=this;this._keyDownHandler=function(e){switch(e.stopPropagation(),e.keyCode){case 37:n.prev();break;case 38:n.handleActions("zoomIn");break;case 39:n.next();break;case 40:n.handleActions("zoomOut")}},this._mouseWheelHandler=me((function(e){(e.wheelDelta?e.wheelDelta:-e.detail)>0?n.handleActions("zoomIn",{zoomRate:n.zoomRate,enableTransition:!1}):n.handleActions("zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})})),ge(document,"keydown",this._keyDownHandler),ge(document,Ce,this._mouseWheelHandler)},deviceSupportUninstall:function(){ve(document,"keydown",this._keyDownHandler),ve(document,Ce,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleMouseDown:function(n){var e=this;if(!this.loading&&0===n.button){var r=this.transform,t=r.offsetX,i=r.offsetY,o=r.scale,s=n.pageX,a=n.pageY;this._dragHandler=me((function(n){e.transform.offsetX=t+(n.pageX-s)/o,e.transform.offsetY=i+(n.pageY-a)/o})),ge(document,"mousemove",this._dragHandler),ge(document,"mouseup",(function(){ve(document,"mousemove",e._dragHandler)})),n.preventDefault()}},prev:function(){if(!this.isFirst||this.infinite){var n=this.urlList.length;this.index=(this.index-1+n)%n}},next:function(){if(!this.isLast||this.infinite){var n=this.urlList.length;this.index=(this.index+1)%n}},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var n=Object.keys(be),e=(Object.values(be).indexOf(this.mode)+1)%n.length;this.mode=be[n[e]],this.reset()}}}},xe=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"image-viewer__wrapper"},[n.isSingle?n._e():[r("span",{staticClass:"image-viewer__btn image-viewer__prev",class:{"is-disabled":!n.infinite&&n.isFirst},on:{click:n.prev}},[r("div",{staticClass:"arrow-btn icon-arrow-left"})]),n._v(" "),r("span",{staticClass:"image-viewer__btn image-viewer__next",class:{"is-disabled":!n.infinite&&n.isLast},on:{click:n.next}},[r("div",{staticClass:"arrow-btn icon-arrow-right"})])],n._v(" "),r("div",{staticClass:"image-viewer__btn image-viewer__actions"},[r("div",{staticClass:"image-viewer__actions__inner"},[r("div",{staticClass:"action-btn icon-zoom-out",on:{click:function(e){return n.handleActions("zoomOut")}}}),n._v(" "),r("div",{staticClass:"action-btn icon-zoom-in",on:{click:function(e){return n.handleActions("zoomIn")}}}),n._v(" "),r("i",{staticClass:"image-viewer__actions__divider"}),n._v(" "),r("div",{staticClass:"action-btn",class:n.mode.icon,on:{click:n.toggleMode}}),n._v(" "),r("i",{staticClass:"image-viewer__actions__divider"}),n._v(" "),r("div",{staticClass:"action-btn icon-refresh-left",on:{click:function(e){return n.handleActions("anticlocelise")}}}),n._v(" "),r("div",{staticClass:"action-btn icon-refresh-right",on:{click:function(e){return n.handleActions("clocelise")}}})])]),n._v(" "),r("div",{staticClass:"image-viewer__canvas",class:{"allow-moveout":n.allowMoveout}},[n._l(n.urlList,(function(e,t){return[t===n.index?r("img",{key:e,ref:"img",refInFor:!0,staticClass:"image-viewer__img",style:n.imgStyle,attrs:{src:n.currentImg},on:{load:n.handleImgLoad,error:n.handleImgError,mousedown:n.handleMouseDown}}):n._e()]}))],2)],2)};xe._withStripped=!0;var ke=F({render:xe,staticRenderFns:[]},(function(n){n&&n("data-v-9beb8d62_0",{source:'.image-viewer__wrapper[data-v-9beb8d62] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.image-viewer__wrapper .image-viewer__btn[data-v-9beb8d62] {\n  position: absolute;\n  z-index: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0.8;\n  cursor: pointer;\n  box-sizing: border-box;\n  user-select: none;\n  border-radius: 50%;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next[data-v-9beb8d62], .image-viewer__wrapper .image-viewer__btn.image-viewer__prev[data-v-9beb8d62] {\n  top: 50%;\n  transform: translateY(-50%);\n  width: 44px;\n  height: 44px;\n  font-size: 24px;\n  color: #fff;\n  background-color: #606266;\n  border-color: #fff;\n}\n.image-viewer__wrapper .image-viewer__btn .arrow-btn[data-v-9beb8d62] {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__prev[data-v-9beb8d62] {\n  left: 40px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__prev .icon-arrow-left[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/arrow-left.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next[data-v-9beb8d62] {\n  right: 40px;\n  text-indent: 2px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next .icon-arrow-right[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/arrow-right.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions[data-v-9beb8d62] {\n  bottom: 16px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 282px;\n  height: 44px;\n  padding: 0 23px;\n  background-color: #606266;\n  border-color: #fff;\n  border-radius: 22px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner[data-v-9beb8d62] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn[data-v-9beb8d62] {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-zoom-out[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/zoom-out.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-zoom-in[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/zoom-in.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-refresh-left[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/refresh-left.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-refresh-right[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/refresh-right.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-full-screen[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/full-screen.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-c-scale-to-original[data-v-9beb8d62] {\n  background-image: url("../../../assets/icons/PicPreviewer/c-scale-to-original.png");\n}\n.image-viewer__wrapper .image-viewer__canvas[data-v-9beb8d62] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.image-viewer__wrapper .image-viewer__canvas[data-v-9beb8d62]:not(.allow-moveout) {\n  overflow: hidden;\n}\n.image-viewer__wrapper .image-viewer__canvas .image-viewer__img[data-v-9beb8d62] {\n  display: block;\n  user-select: none;\n}\n\n/*# sourceMappingURL=ImageViewerInner.vue.map */',map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Previewer\\ImageViewerInner.vue","ImageViewerInner.vue"],names:[],mappings:"AA8UA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;AC7UA;AD+UA;EACA,kBAAA;EACA,UAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,YAAA;EACA,eAAA;EACA,sBAAA;EACA,iBAAA;EACA,kBAAA;AC7UA;AD+UA;EAEA,QAAA;EACA,2BAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;AC9UA;ADiVA;EACA,WAAA;EACA,YAAA;EACA,4BAAA;EACA,wBAAA;AC/UA;ADkVA;EACA,UAAA;AChVA;ADiVA;EACA,0EAAA;AC/UA;ADmVA;EACA,WAAA;EACA,gBAAA;ACjVA;ADkVA;EACA,2EAAA;AChVA;ADoVA;EAKA,YAAA;EACA,SAAA;EACA,2BAAA;EACA,YAPA;EAQA,YAPA;EAQA,eAAA;EACA,yBAAA;EACA,kBAAA;EACA,mBAAA;ACtVA;ADwVA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,mBAAA;EACA,8BAAA;ACtVA;ADuVA;EACA,WAAA;EACA,YAAA;EACA,4BAAA;EACA,wBAAA;ACrVA;ADsVA;EACA,wEAAA;ACpVA;ADsVA;EACA,uEAAA;ACpVA;ADsVA;EACA,4EAAA;ACpVA;ADsVA;EACA,6EAAA;ACpVA;ADuVA;EACA,2EAAA;ACrVA;ADuVA;EACA,mFAAA;ACrVA;AD4VA;EAKA,WAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;AC9VA;ADsVA;EACA,gBAAA;ACpVA;AD4VA;EACA,cAAA;EACA,iBAAA;AC1VA;;AAEA,+CAA+C",file:"ImageViewerInner.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-05-25 11:18:26\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:08:38\r\n * @Description: 参考elementui自带的内置image-viewer重新实现\r\n--\x3e\r\n<template>\r\n  <div class="image-viewer__wrapper">\r\n    \x3c!-- ARROW --\x3e\r\n    <template v-if="!isSingle">\r\n      <span\r\n        class="image-viewer__btn image-viewer__prev"\r\n        :class="{ \'is-disabled\': !infinite && isFirst }"\r\n        @click="prev"\r\n      >\r\n        <div class="arrow-btn icon-arrow-left"></div>\r\n      </span>\r\n      <span\r\n        class="image-viewer__btn image-viewer__next"\r\n        :class="{ \'is-disabled\': !infinite && isLast }"\r\n        @click="next"\r\n      >\r\n        <div class="arrow-btn icon-arrow-right"></div>\r\n      </span>\r\n    </template>\r\n    \x3c!-- ACTIONS --\x3e\r\n    <div class="image-viewer__btn image-viewer__actions">\r\n      <div class="image-viewer__actions__inner">\r\n        <div\r\n          class="action-btn icon-zoom-out"\r\n          @click="handleActions(\'zoomOut\')"\r\n        ></div>\r\n        <div\r\n          class="action-btn icon-zoom-in"\r\n          @click="handleActions(\'zoomIn\')"\r\n        ></div>\r\n        <i class="image-viewer__actions__divider"></i>\r\n        <div class="action-btn" :class="mode.icon" @click="toggleMode"></div>\r\n        <i class="image-viewer__actions__divider"></i>\r\n        <div\r\n          class="action-btn icon-refresh-left"\r\n          @click="handleActions(\'anticlocelise\')"\r\n        ></div>\r\n        <div\r\n          class="action-btn icon-refresh-right"\r\n          @click="handleActions(\'clocelise\')"\r\n        ></div>\r\n      </div>\r\n    </div>\r\n    \x3c!-- CANVAS --\x3e\r\n    <div\r\n      class="image-viewer__canvas"\r\n      :class="{ \'allow-moveout\': allowMoveout }"\r\n    >\r\n      <template v-for="(url, i) in urlList">\r\n        <img\r\n          v-if="i === index"\r\n          ref="img"\r\n          class="image-viewer__img"\r\n          :key="url"\r\n          :src="currentImg"\r\n          :style="imgStyle"\r\n          @load="handleImgLoad"\r\n          @error="handleImgError"\r\n          @mousedown="handleMouseDown"\r\n        />\r\n      </template>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { on, off, rafThrottle } from "../../../util/Event.js";\r\nimport BrowserVersion from "../../../util/BrowserVersion.js";\r\n\r\nconst Mode = {\r\n  CONTAIN: {\r\n    name: "contain",\r\n    icon: "icon-full-screen",\r\n  },\r\n  ORIGINAL: {\r\n    name: "original",\r\n    icon: "icon-c-scale-to-original",\r\n  },\r\n};\r\nconst MOUSE_WHEEL_EVENT_NAME = BrowserVersion.isFirefox()\r\n  ? "DOMMouseScroll"\r\n  : "mousewheel";\r\n\r\nexport default {\r\n  props: {\r\n    urlList: { type: Array, default: () => [] }, // 待显示的图片地址列表\r\n    initialIndex: { type: Number, default: 0 }, // 一开始要展示的是第几张图片\r\n    allowMoveout: { type: Boolean, default: false }, // 图片是否允许移出父容器\r\n  },\r\n  data() {\r\n    return {\r\n      index: this.initialIndex, // 当前正在显示第几张图片\r\n      infinite: true,\r\n      loading: false, // 图片是否加载中\r\n      zoomRate: 0.2,\r\n      mode: Mode.CONTAIN,\r\n      transform: {\r\n        scale: 1,\r\n        deg: 0,\r\n        offsetX: 0,\r\n        offsetY: 0,\r\n        enableTransition: false,\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    isSingle() {\r\n      return this.urlList.length <= 1;\r\n    },\r\n    isFirst() {\r\n      return this.index === 0;\r\n    },\r\n    isLast() {\r\n      return this.index === this.urlList.length - 1;\r\n    },\r\n    // 当前显示的图片的地址\r\n    currentImg: function () {\r\n      return this.urlList[this.index];\r\n    },\r\n    // 当前图片的当前样式\r\n    imgStyle: function () {\r\n      const { scale, deg, offsetX, offsetY, enableTransition } = this.transform;\r\n      const style = {\r\n        // transform: `scale(${scale}) rotate(${deg}deg)`,\r\n        // transition: enableTransition ? "transform .3s" : "",\r\n        // "margin-left": `${offsetX}px`,\r\n        // "margin-top": `${offsetY}px`,\r\n\r\n        transform: `scale(${scale}) rotate(${deg}deg) translateX(${offsetX}px) translateY(${offsetY}px)`,\r\n        transition: enableTransition ? "transform .3s" : "",\r\n      };\r\n      if (this.mode === Mode.CONTAIN) {\r\n        style.maxWidth = style.maxHeight = "100%";\r\n      }\r\n      return style;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.deviceSupportInstall();\r\n  },\r\n  destroyed() {\r\n    this.deviceSupportUninstall();\r\n  },\r\n  methods: {\r\n    hide() {\r\n      this.deviceSupportUninstall();\r\n    },\r\n\r\n    handleImgLoad(/* e */) {\r\n      this.loading = false;\r\n    },\r\n\r\n    handleImgError(e) {\r\n      this.loading = false;\r\n      e.target.alt = "加载失败";\r\n    },\r\n\r\n    handleActions(action, options = {}) {\r\n      if (this.loading) return;\r\n      const { zoomRate, rotateDeg, enableTransition } = {\r\n        zoomRate: this.zoomRate,\r\n        rotateDeg: 90,\r\n        enableTransition: true,\r\n        ...options,\r\n      };\r\n      const { transform } = this;\r\n      switch (action) {\r\n        case "zoomOut": {\r\n          if (transform.scale > 1 - this.zoomRate * 2) {\r\n            transform.scale = parseFloat(\r\n              (transform.scale - zoomRate).toFixed(3)\r\n            );\r\n          }\r\n          break;\r\n        }\r\n        case "zoomIn": {\r\n          transform.scale = parseFloat((transform.scale + zoomRate).toFixed(3));\r\n          break;\r\n        }\r\n        case "clocelise": {\r\n          transform.deg += rotateDeg;\r\n          break;\r\n        }\r\n        case "anticlocelise": {\r\n          transform.deg -= rotateDeg;\r\n          break;\r\n        }\r\n      }\r\n      transform.enableTransition = enableTransition;\r\n    },\r\n\r\n    deviceSupportInstall() {\r\n      this._keyDownHandler = (e) => {\r\n        e.stopPropagation();\r\n        const keyCode = e.keyCode;\r\n        switch (keyCode) {\r\n          // ESC\r\n          //   case 27:\r\n          //     this.hide();\r\n          //     break;\r\n          // SPACE\r\n          //   case 32:\r\n          //     this.toggleMode();\r\n          //     break;\r\n          // LEFT_ARROW\r\n          case 37:\r\n            this.prev();\r\n            break;\r\n          // UP_ARROW\r\n          case 38:\r\n            this.handleActions("zoomIn");\r\n            break;\r\n          // RIGHT_ARROW\r\n          case 39:\r\n            this.next();\r\n            break;\r\n          // DOWN_ARROW\r\n          case 40:\r\n            this.handleActions("zoomOut");\r\n            break;\r\n        }\r\n      };\r\n      this._mouseWheelHandler = rafThrottle((e) => {\r\n        const delta = e.wheelDelta ? e.wheelDelta : -e.detail;\r\n        if (delta > 0) {\r\n          this.handleActions("zoomIn", {\r\n            zoomRate: this.zoomRate,\r\n            enableTransition: false,\r\n          });\r\n        } else {\r\n          this.handleActions("zoomOut", {\r\n            zoomRate: this.zoomRate,\r\n            enableTransition: false,\r\n          });\r\n        }\r\n      });\r\n      on(document, "keydown", this._keyDownHandler);\r\n      on(document, MOUSE_WHEEL_EVENT_NAME, this._mouseWheelHandler);\r\n    },\r\n\r\n    deviceSupportUninstall() {\r\n      off(document, "keydown", this._keyDownHandler);\r\n      off(document, MOUSE_WHEEL_EVENT_NAME, this._mouseWheelHandler);\r\n      this._keyDownHandler = null;\r\n      this._mouseWheelHandler = null;\r\n    },\r\n\r\n    handleMouseDown(e) {\r\n      if (this.loading || e.button !== 0) return;\r\n\r\n      const { offsetX, offsetY, scale } = this.transform;\r\n      const startX = e.pageX;\r\n      const startY = e.pageY;\r\n\r\n      // ------------------------------------------------------------\r\n      //   const imgEle = this.$refs["img"][0];\r\n\r\n      //   const originOffsetX_ = imgEle.style["margin-left"];\r\n      //   const originOffsetY_ = imgEle.style["margin-top"];\r\n\r\n      //   const originOffsetX = Number(\r\n      //     originOffsetX_.substring(0, originOffsetX_.length - 2)\r\n      //   );\r\n      //   const originOffsetY = Number(\r\n      //     originOffsetY_.substring(0, originOffsetY_.length - 2)\r\n      //   );\r\n\r\n      //   this._dragHandler = (ev) => {\r\n      //     const offsetX = originOffsetX + ev.pageX - startX;\r\n      //     const offsetY = originOffsetY + ev.pageY - startY;\r\n\r\n      //     imgEle.style["margin-left"] = `${offsetX}px`;\r\n      //     imgEle.style["margin-top"] = `${offsetY}px`;\r\n      //   };\r\n      // ------------------------------------------------------------\r\n\r\n      this._dragHandler = rafThrottle((ev) => {\r\n        this.transform.offsetX = offsetX + (ev.pageX - startX) / scale;\r\n        this.transform.offsetY = offsetY + (ev.pageY - startY) / scale;\r\n      });\r\n\r\n      on(document, "mousemove", this._dragHandler);\r\n      on(document, "mouseup", (/* ev */) => {\r\n        off(document, "mousemove", this._dragHandler);\r\n      });\r\n\r\n      e.preventDefault();\r\n    },\r\n\r\n    prev() {\r\n      if (this.isFirst && !this.infinite) return;\r\n      const len = this.urlList.length;\r\n      this.index = (this.index - 1 + len) % len;\r\n    },\r\n\r\n    next() {\r\n      if (this.isLast && !this.infinite) return;\r\n      const len = this.urlList.length;\r\n      this.index = (this.index + 1) % len;\r\n    },\r\n\r\n    reset() {\r\n      this.transform = {\r\n        scale: 1,\r\n        deg: 0,\r\n        offsetX: 0,\r\n        offsetY: 0,\r\n        enableTransition: false,\r\n      };\r\n    },\r\n\r\n    // 全屏、原大小之间切换\r\n    toggleMode() {\r\n      if (this.loading) return;\r\n\r\n      const modeNames = Object.keys(Mode);\r\n      const modeValues = Object.values(Mode);\r\n      const index = modeValues.indexOf(this.mode);\r\n      const nextIndex = (index + 1) % modeNames.length;\r\n      this.mode = Mode[modeNames[nextIndex]];\r\n      this.reset();\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n\r\n.image-viewer__wrapper {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n\r\n  .image-viewer__btn {\r\n    position: absolute;\r\n    z-index: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    opacity: 0.8;\r\n    cursor: pointer;\r\n    box-sizing: border-box;\r\n    user-select: none;\r\n    border-radius: 50%;\r\n\r\n    &.image-viewer__next,\r\n    &.image-viewer__prev {\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      width: 44px;\r\n      height: 44px;\r\n      font-size: 24px;\r\n      color: #fff;\r\n      background-color: #606266;\r\n      border-color: #fff;\r\n    }\r\n\r\n    .arrow-btn {\r\n      width: 24px;\r\n      height: 24px;\r\n      background-repeat: no-repeat;\r\n      background-size: contain;\r\n    }\r\n\r\n    &.image-viewer__prev {\r\n      left: 40px;\r\n      .icon-arrow-left {\r\n        background-image: url("../../../assets/icons/PicPreviewer/arrow-left.png");\r\n      }\r\n    }\r\n\r\n    &.image-viewer__next {\r\n      right: 40px;\r\n      text-indent: 2px;\r\n      .icon-arrow-right {\r\n        background-image: url("../../../assets/icons/PicPreviewer/arrow-right.png");\r\n      }\r\n    }\r\n\r\n    &.image-viewer__actions {\r\n      $actions-width: 282px;\r\n      $actions-height: 44px;\r\n      $actions-padding: 23px;\r\n\r\n      bottom: 16px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      width: $actions-width;\r\n      height: $actions-height;\r\n      padding: 0 $actions-padding;\r\n      background-color: #606266;\r\n      border-color: #fff;\r\n      border-radius: math.div($actions-height, 2);\r\n\r\n      .image-viewer__actions__inner {\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        .action-btn {\r\n          width: 24px;\r\n          height: 24px;\r\n          background-repeat: no-repeat;\r\n          background-size: contain;\r\n          &.icon-zoom-out {\r\n            background-image: url("../../../assets/icons/PicPreviewer/zoom-out.png");\r\n          }\r\n          &.icon-zoom-in {\r\n            background-image: url("../../../assets/icons/PicPreviewer/zoom-in.png");\r\n          }\r\n          &.icon-refresh-left {\r\n            background-image: url("../../../assets/icons/PicPreviewer/refresh-left.png");\r\n          }\r\n          &.icon-refresh-right {\r\n            background-image: url("../../../assets/icons/PicPreviewer/refresh-right.png");\r\n          }\r\n\r\n          &.icon-full-screen {\r\n            background-image: url("../../../assets/icons/PicPreviewer/full-screen.png");\r\n          }\r\n          &.icon-c-scale-to-original {\r\n            background-image: url("../../../assets/icons/PicPreviewer/c-scale-to-original.png");\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .image-viewer__canvas {\r\n    &:not(.allow-moveout) {\r\n      overflow: hidden;\r\n    }\r\n\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    .image-viewer__img {\r\n      display: block;\r\n      user-select: none;\r\n    }\r\n  }\r\n}\r\n</style>','.image-viewer__wrapper {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.image-viewer__wrapper .image-viewer__btn {\n  position: absolute;\n  z-index: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0.8;\n  cursor: pointer;\n  box-sizing: border-box;\n  user-select: none;\n  border-radius: 50%;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next, .image-viewer__wrapper .image-viewer__btn.image-viewer__prev {\n  top: 50%;\n  transform: translateY(-50%);\n  width: 44px;\n  height: 44px;\n  font-size: 24px;\n  color: #fff;\n  background-color: #606266;\n  border-color: #fff;\n}\n.image-viewer__wrapper .image-viewer__btn .arrow-btn {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__prev {\n  left: 40px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__prev .icon-arrow-left {\n  background-image: url("../../../assets/icons/PicPreviewer/arrow-left.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next {\n  right: 40px;\n  text-indent: 2px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__next .icon-arrow-right {\n  background-image: url("../../../assets/icons/PicPreviewer/arrow-right.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions {\n  bottom: 16px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 282px;\n  height: 44px;\n  padding: 0 23px;\n  background-color: #606266;\n  border-color: #fff;\n  border-radius: 22px;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn {\n  width: 24px;\n  height: 24px;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-zoom-out {\n  background-image: url("../../../assets/icons/PicPreviewer/zoom-out.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-zoom-in {\n  background-image: url("../../../assets/icons/PicPreviewer/zoom-in.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-refresh-left {\n  background-image: url("../../../assets/icons/PicPreviewer/refresh-left.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-refresh-right {\n  background-image: url("../../../assets/icons/PicPreviewer/refresh-right.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-full-screen {\n  background-image: url("../../../assets/icons/PicPreviewer/full-screen.png");\n}\n.image-viewer__wrapper .image-viewer__btn.image-viewer__actions .image-viewer__actions__inner .action-btn.icon-c-scale-to-original {\n  background-image: url("../../../assets/icons/PicPreviewer/c-scale-to-original.png");\n}\n.image-viewer__wrapper .image-viewer__canvas {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.image-viewer__wrapper .image-viewer__canvas:not(.allow-moveout) {\n  overflow: hidden;\n}\n.image-viewer__wrapper .image-viewer__canvas .image-viewer__img {\n  display: block;\n  user-select: none;\n}\n\n/*# sourceMappingURL=ImageViewerInner.vue.map */']},media:void 0})}),we,"data-v-9beb8d62",!1,void 0,!1,T,void 0,void 0),Ee={components:{BtnPlayAndPause:wn},props:{src:{type:String},sourceType:{type:String,default:"video/mp4"}},data:function(){return{stateType:{notbegin:"notbegin",play:"play",pause:"pause",ended:"ended"},state:"",refVideo:null}},created:function(){this.state=this.stateType.notbegin},mounted:function(){var n=this;this.refVideo=this.$refs.video,this.refVideo.addEventListener("loadstart",(function(){})),this.refVideo.addEventListener("play",(function(){n.state=n.stateType.play})),this.refVideo.addEventListener("pause",(function(){n.state=n.stateType.pause})),this.refVideo.addEventListener("ended",(function(){n.state=n.stateType.ended}))},computed:{icon:function(){switch(this.state){case this.stateType.notbegin:case this.stateType.play:return"hide";case this.stateType.pause:return"pause";case this.stateType.ended:return"play";default:return"hide"}}},methods:{onBtnClick:function(){this.refVideo.play()},onVideoClick:function(){switch(this.state){case this.stateType.play:this.refVideo.pause();break;case this.stateType.pause:this.refVideo.play()}}}},ye=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"video-viewer-inner"},[r("video",{ref:"video",staticClass:"video",attrs:{preload:"auto",autoplay:"",muted:"",disablepictureinpicture:""},domProps:{muted:!0},on:{click:n.onVideoClick}},[r("source",{staticClass:"source",attrs:{src:n.src}})]),n._v(" "),"play"!==n.state?r("BtnPlayAndPause",{attrs:{icon:n.icon},on:{"play-click":n.onBtnClick,"pause-click":n.onBtnClick}}):n._e()],1)};ye._withStripped=!0;var Se={components:{Layout:fe,ImageViewerInner:ke,VideoViewerInner:F({render:ye,staticRenderFns:[]},(function(n){n&&n("data-v-e1df6e20_0",{source:".video-viewer-inner[data-v-e1df6e20] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.video-viewer-inner .video[data-v-e1df6e20] {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  object-position: 50% 50%;\n  background-color: #666666;\n}\n\n/*# sourceMappingURL=VideoViewerInner.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Previewer\\VideoViewerInner.vue","VideoViewerInner.vue"],names:[],mappings:"AAoGA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;ACnGA;ADqGA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EAEA,wBAAA;EACA,yBAAA;ACpGA;;AAEA,+CAA+C",file:"VideoViewerInner.vue",sourcesContent:['<template>\r\n  <div class="video-viewer-inner">\r\n    <video\r\n      ref="video"\r\n      class="video"\r\n      preload="auto"\r\n      autoplay\r\n      muted\r\n      disablepictureinpicture\r\n      @click="onVideoClick"\r\n    >\r\n      <source class="source" :src="src" />\r\n      \x3c!-- <source class="source" :src="src" :type="sourceType" /> --\x3e\r\n    </video>\r\n    <BtnPlayAndPause\r\n      v-if="state !== \'play\'"\r\n      :icon="icon"\r\n      @play-click="onBtnClick"\r\n      @pause-click="onBtnClick"\r\n    />\r\n  </div>\r\n</template>\r\n<script>\r\nimport BtnPlayAndPause from "../Btns/BtnPlayAndPause.vue";\r\n\r\nexport default {\r\n  components: { BtnPlayAndPause },\r\n  props: {\r\n    src: { type: String },\r\n    sourceType: { type: String, default: "video/mp4" },\r\n  },\r\n  data() {\r\n    return {\r\n      stateType: {\r\n        notbegin: "notbegin", // 一切都还没开始\r\n        play: "play",\r\n        pause: "pause",\r\n        ended: "ended",\r\n      },\r\n      state: "",\r\n      refVideo: null,\r\n    };\r\n  },\r\n  created() {\r\n    this.state = this.stateType.notbegin;\r\n  },\r\n  mounted() {\r\n    this.refVideo = this.$refs["video"];\r\n\r\n    this.refVideo.addEventListener("loadstart", () => {});\r\n    this.refVideo.addEventListener("play", () => {\r\n      this.state = this.stateType.play;\r\n    });\r\n    this.refVideo.addEventListener("pause", () => {\r\n      this.state = this.stateType.pause;\r\n    });\r\n    this.refVideo.addEventListener("ended", () => {\r\n      this.state = this.stateType.ended;\r\n    });\r\n  },\r\n  computed: {\r\n    icon: function () {\r\n      switch (this.state) {\r\n        case this.stateType.notbegin:\r\n          return "hide";\r\n        case this.stateType.play:\r\n          return "hide";\r\n        case this.stateType.pause:\r\n          return "pause";\r\n        case this.stateType.ended:\r\n          return "play";\r\n        default:\r\n          return "hide";\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onBtnClick() {\r\n      this.refVideo.play();\r\n    },\r\n    onVideoClick() {\r\n      switch (this.state) {\r\n        case this.stateType.play: {\r\n          this.refVideo.pause();\r\n          break;\r\n        }\r\n        case this.stateType.pause: {\r\n          this.refVideo.play();\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n\r\n.video-viewer-inner {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n\r\n  .video {\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 100;\r\n    // object-fit: scale-down;\r\n    object-position: 50% 50%;\r\n    background-color: $grey-color-dark;\r\n    // .source {\r\n    //   width: 100%;\r\n    //   height: 100%;\r\n    // }\r\n  }\r\n}\r\n</style>',".video-viewer-inner {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.video-viewer-inner .video {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  object-position: 50% 50%;\n  background-color: #666666;\n}\n\n/*# sourceMappingURL=VideoViewerInner.vue.map */"]},media:void 0})}),Ee,"data-v-e1df6e20",!1,void 0,!1,T,void 0,void 0)},props:{previewType:{type:String},url:{type:[Array,String]}},data:function(){return{TYPES:a}},computed:{},watch:{},methods:{onBtnCloseClick:function(){this.$emit("update:previewType","")}}},Be=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.previewType?r("div",{staticClass:"previewer"},[r("Layout",{on:{close:n.onBtnCloseClick}},[r("template",{slot:"main"},[r("div",{staticClass:"preview-container"},[n.previewType===n.TYPES.PIC?r("ImageViewerInner",{attrs:{urlList:n.url}}):n.previewType===n.TYPES.VIDEO?r("VideoViewerInner",{attrs:{src:n.url}}):n._e()],1)])],2)],1):n._e()};Be._withStripped=!0;var Ne=F({render:Be,staticRenderFns:[]},(function(n){n&&n("data-v-8d650832_0",{source:".previewer .preview-container[data-v-8d650832] {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Previewer.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Previewer\\Previewer.vue","Previewer.vue"],names:[],mappings:"AAqEA;EACA,WAAA;EACA,YAAA;ACpEA;;AAEA,wCAAwC",file:"Previewer.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-06-13 14:31:13\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-23 16:46:31\r\n * @Description: 文件预览器\r\n--\x3e\r\n\r\n<template>\r\n  <div class="previewer" v-if="previewType">\r\n    <Layout @close="onBtnCloseClick">\r\n      <template slot="main">\r\n        <div class="preview-container">\r\n          <ImageViewerInner v-if="previewType === TYPES.PIC" :urlList="url" />\r\n          <VideoViewerInner\r\n            v-else-if="previewType === TYPES.VIDEO"\r\n            :src="url"\r\n          />\r\n          \x3c!-- <OfficeIframe\r\n            v-if="currPreviewUrl && isOfficeDoc"\r\n            :src="currPreviewUrl"\r\n          />\r\n          <PdfAndTxtViewer\r\n            v-if="currPreviewUrl && (isPdf || isTxt)"\r\n            :src="currPreviewUrl"\r\n            :fileName="file.title"\r\n          />\r\n          <ModelViewer\r\n            v-if="currPreviewUrl && isModel"\r\n            :modelId="currPreviewUrl"\r\n          /> --\x3e\r\n        </div>\r\n      </template>\r\n    </Layout>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { TYPES } from "../../../const.js";\r\nimport Layout from "./Layout.vue";\r\nimport ImageViewerInner from "../../../components/MindMap/Previewer/ImageViewerInner.vue";\r\nimport VideoViewerInner from "../../../components/MindMap/Previewer/VideoViewerInner.vue";\r\n\r\nexport default {\r\n  components: {\r\n    Layout,\r\n    ImageViewerInner,\r\n    VideoViewerInner,\r\n  },\r\n  props: {\r\n    previewType: { type: String }, // TYPES 的可选值之一\r\n    // visible: { type: Boolean, default: false }, // 本全屏弹窗是否可见\r\n    url: { type: [Array, String] }, // 当前要预览的图片地址\r\n  },\r\n  data() {\r\n    return {\r\n      TYPES,\r\n    };\r\n  },\r\n  computed: {},\r\n  watch: {},\r\n  methods: {\r\n    onBtnCloseClick() {\r\n      this.$emit("update:previewType", "");\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.previewer {\r\n  .preview-container {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>',".previewer .preview-container {\n  width: 100%;\n  height: 100%;\n}\n\n/*# sourceMappingURL=Previewer.vue.map */"]},media:void 0})}),Se,"data-v-8d650832",!1,void 0,!1,T,void 0,void 0),Me={components:{Tips:$},props:{scaleValue:{type:Number,default:1},isFullScreen:{type:Boolean,default:!1}},data:function(){return{PIC_ADD:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIVJREFUWEftlrsNgDAMRJ19bjCoYQyoYTDvA7KUgo8Qig1yc6md+OlZOqdI8inJ/YUAIQMAOhuhqq7eUUYBtgrgfsd90RoDIAAN0AANfG8AwCAikzdaX+6Nqjofa25JWPN9+Qmgv+4NRjEN0AAN0EDUgO0N+5af8r0lxkMALY2eagmQbmAHg4tiITu+EYUAAAAASUVORK5CYII=",PIC_MINUS:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAFJJREFUWEft1bENACAIRNFjH3bTUXQ3BrI1MZYKxWeAA15IMCWXJfcXAyCAAAIIIFBPwN2bpPHoS/aImHv2IZA+wKPNr7H1bgABBBBAAAEEfgss6SAKIbawIjEAAAAASUVORK5CYII=",PIC_FULL_SCREEN:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAQpJREFUWEftVzFuAjEQ9N69gU+cd6tUpIKKF6SHhnwhbfp8IFTpkKBHooIqPGDX94iUeYA3IopQAJ21nHTiCrv1jHd25FnZ4O684M713UkAImpKTIxxVtf1h0UwEc1V9T2BPYjI43H/UsC+iaSqixDC0iLAez8BgJcEdiQiv7WvBIjI2FKkLQYRd865LCA70EMHqqqalmX5xcybtjfcwkPEEQAMmHl9FkMLuQtMf0ZxF91ZzswOZAeyA/1xgIieYozfIYStJb9tMd77qigKfzWK/96E+/wiyg5kBxLxehWRxo/Lfx4RPajq260fk0/n3LCJBADPzLyw5P84U1R1lcCe4t6fSWjprAvMD7EXuCHBFnCeAAAAAElFTkSuQmCC",PIC_RESTORE_SCREEN:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAATRJREFUWEftVjFOxDAQ3E3yD44uSuw3wD2CDglo4AUUVMA3qKA9HgE8IfImimjIQxwbHUqinORkrYPoKGwpVda749Hu7CAc+OCB6wMLQEp5Zq3dGGOuqqp69gEspbw2xty1bbuu67qZu8MCEELcA8DD9iOiRx8AoztrInoPAAIDXgx03Z5NBO/bhNt7rvPRN+cwBUIIy3T4PlMwmZKIfmoPALIsu4yi6GgGxICaG8U0TVdJklxMxSFipZR63QHAJV3qPytESxXu8wYAgYHAQGBgYIBZRqC1fuHs1Vi0Olfk1DGnFOd5/oWIqxnl+7NlZK1tyrI83tkF3QJxATj5jSd0PUhr3fRssk0YTGlg4D8wcAoAb4h4o5R68jEonabcxnF8XhTFp5cr9km8RAw7hksUHef8Bgav0yEpqGG0AAAAAElFTkSuQmCC",PIC_FOUCS_CENTER:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA4lJREFUWEfFV01oFVcU/s4jEboQXfhfdGNEG4vNmzMawSIJ7cJQ1Kr4t6tuNeJSQdGioMvStNu2O21LtaZIXCiGUsHonHlWNFrUjaJJ1IXiQjBhTjnNnfAymXkzeZHmwjC8ufee891zvnu+8wjTPGia/WNKAJj5ezuAiOyr9yBTBXDVAWj/3wGUy+XmUqn0mzmOomhbpVLprwfEpCLged4xIioDWAtgfsLhEIDrqloJw/DromAKAfA8r4mIfgKwDsAgEd1SVXs2mSMi6iaiFlVtAbAAwDVV/SoMw4d5QHIBeJ63h4h+cIZOisjR2CgzT+AAM58AcMTWqOreMAx/rAWiJgDP8zYQUY8RHcBGERmoNmYpsd/JkDPzQgB/AGBV7QjD8FIWiEwAra2t80dGRgYBnBeRrXmhTJtn5nMAtjQ0NCzo6+szjkwYmQA8zztDRLsAzBaR13UCmAXglaqeDcNwd2EAju3HiagzCILv6nEe7/F9f7+qdqnq8bTbkRoBZr4IwBeR5FUbw8LMvwNY7T7cFJEvs4Ays4U/EJEvkmuyALwAcFtEPsvIrbrvj9x7qauIWfauAFglInNzAZTL5U9KpdItAF0iciC5gZl/AbCdiNqDIOi1ed/321TVruSvIrIjZc+3ADqjKGqpVCp/V8+PIfZ9v1tVZwKwK7QcwD0AQ6raW507Zrab8U5EllQbYubHAGaIiBWi/4bjUpurmh8B+AfAABG9CYJgtIjFi52yNbtKtkJV+4noeQqApwDeikhTAoBVvQ9E5MMkAFWdR0Rm+75VUgD9sYJOyJkTmbsATovI4ZRwGvk2Z6TgQhoZmfkUgENRFK1MilYWaazeV4Ig6Mgh4RM3v7gWCX3f71HVcnV6YrtZAOyUrSJifEgdjozr3eSfaeSrSq+V8L606KQCiAsRgHHikwWm1vdYnCZViMwgM//l5HdRUoSKAnGi9MzkWUQ+TdtXSwusB3gw2vKJX9Rp4mYEThGXZfUGeXIc9wLnAexJilINOTYRsj5gS15PUKQhiXsC63zGiVNaQxKLj0UirxcYV4hqhdh6g+Hh4W+cPD8HcAeA1YrP3b7LAFYC+BjAPJPfxsbGg1k9QLWv3AhUL3a3Yw0Ae+YkQL8EcENVb7z3pjQtOk60fra5KIp2JkWmKGknFYGUsjx9f0wMjCmovWNlK3rqujlQj4O8PVNKQZ7xIvP/AgZtnTC2RzsjAAAAAElFTkSuQmCC",isPercentBtnsVisible:!1,currMouseenterBtnName:""}},computed:{scaleValuePercent:function(){return Math.round(100*this.scaleValue)}},methods:{SetPercentBtnsUnvisible:function(){this.isPercentBtnsVisible=!1},onBtnFoucsCenterClick:function(){this.$emit("foucs-center-click")},onBtnMinusClick:function(){this.$emit("update:scaleValue",this.scaleValue-u)},onBtnAddClick:function(){this.$emit("update:scaleValue",this.scaleValue+u)},onScaleValueClick:function(){this.isPercentBtnsVisible=!this.isPercentBtnsVisible},onPercentBtnClick:function(n){var e=n/100;this.scaleValue!==e&&this.$emit("update:scaleValue",e)},onFullScreenClick:function(){this.$emit("update:isFullScreen",!this.isFullScreen)},onBtnMouseEnter:function(n){this.currMouseenterBtnName=n},onBtnMouseLeave:function(){this.currMouseenterBtnName=""}}},Ie=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"bottom-bar"},[r("div",{staticClass:"btns left"},[r("div",{staticClass:"btn clickable",on:{click:n.onFullScreenClick,mouseenter:function(e){return n.onBtnMouseEnter("FULL_SCREEN_OR_NOT")},mouseleave:n.onBtnMouseLeave}},[n.isFullScreen?[r("div",{staticClass:"icon restore-screen",style:{"background-image":"url("+n.PIC_RESTORE_SCREEN+")"}}),n._v(" "),"FULL_SCREEN_OR_NOT"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"取消全屏显示",translateX:"-40%"}}):n._e()]:[r("div",{staticClass:"icon full-screen",style:{"background-image":"url("+n.PIC_FULL_SCREEN+")"}}),n._v(" "),"FULL_SCREEN_OR_NOT"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"全屏显示",translateX:"-40%"}}):n._e()]],2)]),n._v(" "),r("div",{staticClass:"btns right"},[r("div",{staticClass:"btn clickable",on:{click:n.onBtnFoucsCenterClick,mouseenter:function(e){return n.onBtnMouseEnter("FOUCS_CENTER")},mouseleave:n.onBtnMouseLeave}},[r("div",{staticClass:"icon foucs-center",style:{"background-image":"url("+n.PIC_FOUCS_CENTER+")"}}),n._v(" "),"FOUCS_CENTER"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"定位到中心"}}):n._e()],1),n._v(" "),n._m(0),n._v(" "),r("div",{staticClass:"btn clickable",on:{click:n.onBtnMinusClick,mouseenter:function(e){return n.onBtnMouseEnter("SCALE_MINUS")},mouseleave:n.onBtnMouseLeave}},[r("div",{staticClass:"icon scale-minus",style:{"background-image":"url("+n.PIC_MINUS+")"}}),n._v(" "),"SCALE_MINUS"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"缩小"}}):n._e()],1),n._v(" "),r("div",{staticClass:"scale"},[r("div",{staticClass:"scale-value clickable",class:{active:n.isPercentBtnsVisible},on:{click:n.onScaleValueClick,mouseenter:function(e){return n.onBtnMouseEnter("SCALE_VALUE")},mouseleave:n.onBtnMouseLeave}},[r("span",[n._v(n._s(n.scaleValuePercent)+"%")]),n._v(" "),"SCALE_VALUE"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"选择比例"}}):n._e()],1),n._v(" "),n.isPercentBtnsVisible?r("div",{staticClass:"panel"},[r("div",{staticClass:"percent-btn",on:{click:function(e){return n.onPercentBtnClick(100)}}},[r("span",[n._v("100%")])]),n._v(" "),r("div",{staticClass:"percent-btn",on:{click:function(e){return n.onPercentBtnClick(75)}}},[r("span",[n._v("75%")])]),n._v(" "),r("div",{staticClass:"percent-btn",on:{click:function(e){return n.onPercentBtnClick(50)}}},[r("span",[n._v("50%")])])]):n._e()]),n._v(" "),r("div",{staticClass:"btn clickable",on:{click:n.onBtnAddClick,mouseenter:function(e){return n.onBtnMouseEnter("SCALE_ADD")},mouseleave:n.onBtnMouseLeave}},[r("div",{staticClass:"icon scale-add",style:{"background-image":"url("+n.PIC_ADD+")"}}),n._v(" "),"SCALE_ADD"===n.currMouseenterBtnName?r("Tips",{attrs:{tipsContent:"放大"}}):n._e()],1)])])};Ie._withStripped=!0;var De=F({render:Ie,staticRenderFns:[function(){var n=this.$createElement,e=this._self._c||n;return e("div",{staticClass:"split"},[e("div",{staticClass:"line"})])}]},(function(n){n&&n("data-v-293b9142_0",{source:".bottom-bar[data-v-293b9142] {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  padding: 0 16px;\n  background-color: #eeeeee;\n  border-top: 1px solid #dddddd;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.bottom-bar .btns[data-v-293b9142] {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n}\n.bottom-bar .btns .btn[data-v-293b9142] {\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.bottom-bar .btns .btn .icon[data-v-293b9142] {\n  width: 20px;\n  height: 20px;\n  background-repeat: no-repeat;\n  background-size: 16px;\n  background-position: center center;\n}\n.bottom-bar .btns .scale[data-v-293b9142] {\n  width: 48px;\n  height: 24px;\n  box-sizing: border-box;\n  position: relative;\n}\n.bottom-bar .btns .scale .scale-value[data-v-293b9142] {\n  height: 100%;\n  line-height: 24px;\n  text-align: center;\n  box-sizing: border-box;\n  padding: 0 4px;\n}\n.bottom-bar .btns .scale .scale-value.active[data-v-293b9142] {\n  background-color: #aaaaaa;\n}\n.bottom-bar .btns .scale .panel[data-v-293b9142] {\n  width: 64px;\n  box-sizing: border-box;\n  border: 1px solid #dddddd;\n  position: absolute;\n  bottom: 40px;\n  left: -8px;\n  border-radius: 4px;\n  padding: 4px;\n  z-index: 2001;\n  background-color: #fff;\n}\n.bottom-bar .btns .scale .panel .percent-btn[data-v-293b9142] {\n  width: 100%;\n  height: 32px;\n  box-sizing: border-box;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.bottom-bar .btns .scale .panel .percent-btn[data-v-293b9142]:hover {\n  cursor: pointer;\n  background-color: #dddddd;\n}\n.bottom-bar .btns .split[data-v-293b9142] {\n  width: 9px;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.bottom-bar .btns .split .line[data-v-293b9142] {\n  width: 1px;\n  height: 70%;\n  background-color: #555d6b;\n}\n.bottom-bar .btns .clickable[data-v-293b9142] {\n  position: relative;\n  cursor: pointer;\n}\n.bottom-bar .btns .clickable[data-v-293b9142]:hover {\n  background-color: #dddddd;\n}\n\n/*# sourceMappingURL=BottomBar.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\BottomBar.vue","BottomBar.vue"],names:[],mappings:"AA+LA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,eAAA;EACA,yBAAA;EACA,6BAAA;EACA,aAAA;EACA,mBAAA;EACA,8BAAA;AC9LA;ADgMA;EACA,YAAA;EACA,aAAA;EACA,mBAAA;EACA,2BAAA;AC9LA;ADmMA;EACA,WAJA;EAKA,YALA;EAMA,eAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;ACjMA;ADmMA;EACA,WAXA;EAYA,YAZA;EAaA,4BAAA;EACA,qBAAA;EACA,kCAAA;ACjMA;AD4MA;EACA,WAHA;EAIA,YA7BA;EA8BA,sBAAA;EACA,kBAAA;AC1MA;AD4MA;EACA,YAAA;EACA,iBAnCA;EAoCA,kBAAA;EACA,sBAAA;EACA,cAAA;AC1MA;AD4MA;EACA,yBAAA;AC1MA;AD+MA;EACA,WAFA;EAGA,sBAAA;EACA,yBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;EACA,kBAAA;EACA,YAAA;EACA,aAAA;EACA,sBAAA;AC7MA;AD+MA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EAEA,aAAA;EACA,mBAAA;EACA,uBAAA;AC9MA;ADgNA;EACA,eAAA;EACA,yBAAA;AC9MA;ADoNA;EAGA,UAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;ACpNA;ADsNA;EACA,UAAA;EACA,WAAA;EACA,yBAXA;ACzMA;ADwNA;EACA,kBAAA;EACA,eAAA;ACtNA;ADuNA;EACA,yBAAA;ACrNA;;AAEA,wCAAwC",file:"BottomBar.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-13 16:35:00\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-03-22 16:29:46\r\n * @Description: 请输入\r\n--\x3e\r\n\r\n<template>\r\n  <div class="bottom-bar">\r\n    <div class="btns left">\r\n      <div\r\n        class="btn clickable"\r\n        @click="onFullScreenClick"\r\n        @mouseenter="onBtnMouseEnter(\'FULL_SCREEN_OR_NOT\')"\r\n        @mouseleave="onBtnMouseLeave"\r\n      >\r\n        <template v-if="isFullScreen">\r\n          <div\r\n            class="icon restore-screen"\r\n            :style="{ \'background-image\': `url(${PIC_RESTORE_SCREEN})` }"\r\n          ></div>\r\n          <Tips\r\n            v-if="currMouseenterBtnName === \'FULL_SCREEN_OR_NOT\'"\r\n            :tipsContent="\'取消全屏显示\'"\r\n            :translateX="\'-40%\'"\r\n          />\r\n        </template>\r\n        <template v-else>\r\n          <div\r\n            class="icon full-screen"\r\n            :style="{ \'background-image\': `url(${PIC_FULL_SCREEN})` }"\r\n          ></div>\r\n          <Tips\r\n            v-if="currMouseenterBtnName === \'FULL_SCREEN_OR_NOT\'"\r\n            :tipsContent="\'全屏显示\'"\r\n            :translateX="\'-40%\'"\r\n          />\r\n        </template>\r\n      </div>\r\n    </div>\r\n    <div class="btns right">\r\n      <div\r\n        class="btn clickable"\r\n        @click="onBtnFoucsCenterClick"\r\n        @mouseenter="onBtnMouseEnter(\'FOUCS_CENTER\')"\r\n        @mouseleave="onBtnMouseLeave"\r\n      >\r\n        <div\r\n          class="icon foucs-center"\r\n          :style="{ \'background-image\': `url(${PIC_FOUCS_CENTER})` }"\r\n        ></div>\r\n        <Tips\r\n          v-if="currMouseenterBtnName === \'FOUCS_CENTER\'"\r\n          :tipsContent="\'定位到中心\'"\r\n        />\r\n      </div>\r\n      <div class="split">\r\n        <div class="line"></div>\r\n      </div>\r\n      <div\r\n        class="btn clickable"\r\n        @click="onBtnMinusClick"\r\n        @mouseenter="onBtnMouseEnter(\'SCALE_MINUS\')"\r\n        @mouseleave="onBtnMouseLeave"\r\n      >\r\n        <div\r\n          class="icon scale-minus"\r\n          :style="{ \'background-image\': `url(${PIC_MINUS})` }"\r\n        ></div>\r\n        <Tips\r\n          v-if="currMouseenterBtnName === \'SCALE_MINUS\'"\r\n          :tipsContent="\'缩小\'"\r\n        />\r\n      </div>\r\n      <div class="scale">\r\n        <div\r\n          class="scale-value clickable"\r\n          :class="{ active: isPercentBtnsVisible }"\r\n          @click="onScaleValueClick"\r\n          @mouseenter="onBtnMouseEnter(\'SCALE_VALUE\')"\r\n          @mouseleave="onBtnMouseLeave"\r\n        >\r\n          <span>{{ scaleValuePercent }}%</span>\r\n          <Tips\r\n            v-if="currMouseenterBtnName === \'SCALE_VALUE\'"\r\n            :tipsContent="\'选择比例\'"\r\n          />\r\n        </div>\r\n\r\n        <div class="panel" v-if="isPercentBtnsVisible">\r\n          <div class="percent-btn" @click="onPercentBtnClick(100)">\r\n            <span>100%</span>\r\n          </div>\r\n          <div class="percent-btn" @click="onPercentBtnClick(75)">\r\n            <span>75%</span>\r\n          </div>\r\n          <div class="percent-btn" @click="onPercentBtnClick(50)">\r\n            <span>50%</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class="btn clickable"\r\n        @click="onBtnAddClick"\r\n        @mouseenter="onBtnMouseEnter(\'SCALE_ADD\')"\r\n        @mouseleave="onBtnMouseLeave"\r\n      >\r\n        <div\r\n          class="icon scale-add"\r\n          :style="{ \'background-image\': `url(${PIC_ADD})` }"\r\n        ></div>\r\n        <Tips\r\n          v-if="currMouseenterBtnName === \'SCALE_ADD\'"\r\n          :tipsContent="\'放大\'"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { SCROLL_SCALE_UNIT } from "../../../const.js";\r\nimport Tips from "../Common/Tips.vue";\r\n\r\nimport PIC_ADD from "../../../assets/icons/BottomBar/add.png";\r\nimport PIC_MINUS from "../../../assets/icons/BottomBar/minus.png";\r\nimport PIC_FULL_SCREEN from "../../../assets/icons/BottomBar/full-screen.png";\r\nimport PIC_RESTORE_SCREEN from "../../../assets/icons/BottomBar/restore-screen.png";\r\nimport PIC_FOUCS_CENTER from "../../../assets/icons/BottomBar/foucs-center.png";\r\n\r\nexport default {\r\n  components: { Tips },\r\n  props: {\r\n    scaleValue: { type: Number, default: 1 }, // 缩放比例\r\n    isFullScreen: { type: Boolean, default: false }, // 是否全屏\r\n  },\r\n  data() {\r\n    return {\r\n      PIC_ADD,\r\n      PIC_MINUS,\r\n      PIC_FULL_SCREEN,\r\n      PIC_RESTORE_SCREEN,\r\n      PIC_FOUCS_CENTER,\r\n\r\n      isPercentBtnsVisible: false,\r\n      currMouseenterBtnName: "",\r\n    };\r\n  },\r\n  computed: {\r\n    scaleValuePercent: function () {\r\n      return Math.round(this.scaleValue * 100);\r\n    },\r\n  },\r\n  methods: {\r\n    SetPercentBtnsUnvisible() {\r\n      this.isPercentBtnsVisible = false;\r\n    },\r\n    onBtnFoucsCenterClick() {\r\n      this.$emit("foucs-center-click");\r\n    },\r\n    onBtnMinusClick() {\r\n      this.$emit("update:scaleValue", this.scaleValue - SCROLL_SCALE_UNIT);\r\n    },\r\n    onBtnAddClick() {\r\n      this.$emit("update:scaleValue", this.scaleValue + SCROLL_SCALE_UNIT);\r\n    },\r\n    onScaleValueClick() {\r\n      this.isPercentBtnsVisible = !this.isPercentBtnsVisible;\r\n    },\r\n    onPercentBtnClick(percent) {\r\n      const _scaleValue = percent / 100;\r\n      if (this.scaleValue !== _scaleValue) {\r\n        this.$emit("update:scaleValue", _scaleValue);\r\n      }\r\n    },\r\n    onFullScreenClick() {\r\n      this.$emit("update:isFullScreen", !this.isFullScreen);\r\n    },\r\n    onBtnMouseEnter(btnName) {\r\n      this.currMouseenterBtnName = btnName;\r\n    },\r\n    onBtnMouseLeave() {\r\n      this.currMouseenterBtnName = "";\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@use "sass:math";\r\n@import "./src/scss/_variables.scss";\r\n\r\n.bottom-bar {\r\n  width: 100%;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  padding: 0 16px;\r\n  background-color: $grey-color-light;\r\n  border-top: 1px solid $grey-color-light2;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n\r\n  .btns {\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: flex-start;\r\n\r\n    $btn-size: 24px;\r\n    $icon-size: 20px;\r\n\r\n    .btn {\r\n      width: $btn-size;\r\n      height: $btn-size;\r\n      cursor: pointer;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n\r\n      .icon {\r\n        width: $icon-size;\r\n        height: $icon-size;\r\n        background-repeat: no-repeat;\r\n        background-size: 16px;\r\n        background-position: center center;\r\n\r\n        &.scale-add {\r\n        }\r\n        &.scale-minus {\r\n        }\r\n      }\r\n    }\r\n\r\n    $scale-value-width: 48px;\r\n\r\n    .scale {\r\n      width: $scale-value-width;\r\n      height: $btn-size;\r\n      box-sizing: border-box;\r\n      position: relative;\r\n\r\n      .scale-value {\r\n        height: 100%;\r\n        line-height: $btn-size;\r\n        text-align: center;\r\n        box-sizing: border-box;\r\n        padding: 0 4px;\r\n\r\n        &.active {\r\n          background-color: $grey-color-normal;\r\n        }\r\n      }\r\n\r\n      $panel-width: 64px;\r\n      .panel {\r\n        width: $panel-width;\r\n        box-sizing: border-box;\r\n        border: 1px solid $grey-color-light2;\r\n        position: absolute;\r\n        bottom: $btn-size + 16px;\r\n        left: math.div(-$panel-width, 2) + math.div($scale-value-width, 2);\r\n        border-radius: 4px;\r\n        padding: 4px;\r\n        z-index: 2001;\r\n        background-color: #fff;\r\n\r\n        .percent-btn {\r\n          width: 100%;\r\n          height: 32px;\r\n          box-sizing: border-box;\r\n          border-radius: 4px;\r\n\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n\r\n          &:hover {\r\n            cursor: pointer;\r\n            background-color: $grey-color-light2;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .split {\r\n      $split-bg-color: #555d6b;\r\n\r\n      width: 9px;\r\n      height: 100%;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n\r\n      .line {\r\n        width: 1px;\r\n        height: 70%;\r\n        background-color: $split-bg-color;\r\n      }\r\n    }\r\n\r\n    .clickable {\r\n      position: relative;\r\n      cursor: pointer;\r\n      &:hover {\r\n        background-color: $grey-color-light2;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>',".bottom-bar {\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  padding: 0 16px;\n  background-color: #eeeeee;\n  border-top: 1px solid #dddddd;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.bottom-bar .btns {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n}\n.bottom-bar .btns .btn {\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.bottom-bar .btns .btn .icon {\n  width: 20px;\n  height: 20px;\n  background-repeat: no-repeat;\n  background-size: 16px;\n  background-position: center center;\n}\n.bottom-bar .btns .scale {\n  width: 48px;\n  height: 24px;\n  box-sizing: border-box;\n  position: relative;\n}\n.bottom-bar .btns .scale .scale-value {\n  height: 100%;\n  line-height: 24px;\n  text-align: center;\n  box-sizing: border-box;\n  padding: 0 4px;\n}\n.bottom-bar .btns .scale .scale-value.active {\n  background-color: #aaaaaa;\n}\n.bottom-bar .btns .scale .panel {\n  width: 64px;\n  box-sizing: border-box;\n  border: 1px solid #dddddd;\n  position: absolute;\n  bottom: 40px;\n  left: -8px;\n  border-radius: 4px;\n  padding: 4px;\n  z-index: 2001;\n  background-color: #fff;\n}\n.bottom-bar .btns .scale .panel .percent-btn {\n  width: 100%;\n  height: 32px;\n  box-sizing: border-box;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.bottom-bar .btns .scale .panel .percent-btn:hover {\n  cursor: pointer;\n  background-color: #dddddd;\n}\n.bottom-bar .btns .split {\n  width: 9px;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.bottom-bar .btns .split .line {\n  width: 1px;\n  height: 70%;\n  background-color: #555d6b;\n}\n.bottom-bar .btns .clickable {\n  position: relative;\n  cursor: pointer;\n}\n.bottom-bar .btns .clickable:hover {\n  background-color: #dddddd;\n}\n\n/*# sourceMappingURL=BottomBar.vue.map */"]},media:void 0})}),Me,"data-v-293b9142",!1,void 0,!1,T,void 0,void 0),Le=200,Fe={props:{isHorizontal:{type:Boolean,default:!1},hasNeighbor:{type:Boolean,default:!0},clientLength:{type:Number,required:!1},scrollLength:{type:Number,required:!0},scrollDistance:{type:Number,default:0}},data:function(){return{DRAG_MASK_SIZE:Le,SCROLL_BAR_SIZE:p,isMousedown:!1}},computed:{barPercent:function(){return this.clientLength/this.scrollLength*100},scrollPercent:function(){return this.scrollDistance/this.scrollLength*100},barContainerStyle:function(){return this.isHorizontal?{width:this.hasNeighbor?"calc(100% - 16px)":"100%",height:"16px"}:{height:this.hasNeighbor?"calc(100% - 16px)":"100%",width:"16px"}},barStyle:function(){return this.isHorizontal?{width:this.barPercent+"%",left:this.scrollPercent+"%"}:{height:this.barPercent+"%",top:this.scrollPercent+"%"}},maskStyle:function(){return this.isHorizontal?{height:Le+"px",top:"-92px"}:{width:Le+"px",left:"-92px"}}},mounted:function(){},methods:{onBarMousedown:function(n){var e=this;n.preventDefault();var r=window.document.body,t=r.overflow;r.style.overflow="hidden",this.isMousedown=!0,this.$nextTick((function(){var n,i=e.$refs.bar,o=e.$refs.mask;n=e.isHorizontal?i.clientWidth:i.clientHeight;var s=e.clientLength/n;o.onmousemove=function(n){n.preventDefault(),e.isHorizontal?e.$emit("mouse-drag",n.movementX,n.movementX*s):e.$emit("mouse-drag",n.movementY,n.movementY*s)},o.onmouseleave=function(n){n.preventDefault(),e.isMousedown=!1,o.onmousemove=null,o.onmouseleave=null,o.onmouseup=null,r.style.overflow=t},o.onmouseup=function(n){n.preventDefault(),e.isMousedown=!1,o.onmousemove=null,o.onmouseleave=null,o.onmouseup=null,r.style.overflow=t}}))},onBarMouseup:function(){},onScrollBarClickSelf:function(n){var e=n.offsetX,r=n.offsetY,t=this.$refs["scroll-bar"].offsetWidth,i=this.$refs["scroll-bar"].offsetHeight;(this.isHorizontal?e/t*100:r/i*100)>this.scrollPercent?this.$emit("scroll-bar-blank-click",!0):this.$emit("scroll-bar-blank-click",!1)}}},_e=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{ref:"scroll-bar",staticClass:"scroll-bar",class:{row:n.isHorizontal,col:!n.isHorizontal},style:n.barContainerStyle,on:{click:function(e){return e.target!==e.currentTarget?null:n.onScrollBarClickSelf.apply(null,arguments)}}},[r("div",{ref:"bar",staticClass:"bar",class:{mousedown:n.isMousedown},style:n.barStyle,on:{mousedown:function(e){return e.stopPropagation(),n.onBarMousedown.apply(null,arguments)}}}),n._v(" "),n.isMousedown?r("div",{ref:"mask",staticClass:"mask",style:n.maskStyle}):n._e()])};_e._withStripped=!0;var ze=F({render:_e,staticRenderFns:[]},(function(n){n&&n("data-v-4e6d54f0_0",{source:".scroll-bar[data-v-4e6d54f0] {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #eeeeee;\n  z-index: 1000;\n}\n.scroll-bar .bar[data-v-4e6d54f0] {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #dddddd;\n  z-index: 1500;\n}\n.scroll-bar .bar[data-v-4e6d54f0]:hover {\n  background-color: #aaaaaa;\n}\n.scroll-bar .bar.mousedown[data-v-4e6d54f0] {\n  background-color: #666666;\n}\n.scroll-bar .mask[data-v-4e6d54f0] {\n  position: absolute;\n  z-index: 2000;\n  cursor: pointer;\n}\n.scroll-bar.col[data-v-4e6d54f0] {\n  top: 0px;\n  right: 0px;\n}\n.scroll-bar.col .bar[data-v-4e6d54f0] {\n  width: 100%;\n}\n.scroll-bar.col .mask[data-v-4e6d54f0] {\n  height: 100%;\n  top: 0px;\n}\n.scroll-bar.row[data-v-4e6d54f0] {\n  left: 0px;\n  bottom: 0px;\n}\n.scroll-bar.row .bar[data-v-4e6d54f0] {\n  height: 100%;\n}\n.scroll-bar.row .mask[data-v-4e6d54f0] {\n  width: 100%;\n  left: 0px;\n}\n\n/*# sourceMappingURL=ScrollBar.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\ScrollBar.vue","ScrollBar.vue"],names:[],mappings:"AAwMA;EACA,sBAAA;EACA,kBAAA;EACA,yBAAA;EACA,aAAA;ACvMA;ADyMA;EACA,sBAAA;EACA,kBAAA;EACA,yBAAA;EACA,aAAA;ACvMA;ADwMA;EACA,yBAAA;ACtMA;ADwMA;EACA,yBAAA;ACtMA;AD0MA;EACA,kBAAA;EACA,aAAA;EACA,eAAA;ACxMA;AD4MA;EAEA,QAAA;EACA,UAAA;AC3MA;AD6MA;EACA,WAAA;AC3MA;AD8MA;EACA,YAAA;EACA,QAAA;AC5MA;ADgNA;EAEA,SAAA;EACA,WAAA;AC/MA;ADiNA;EACA,YAAA;AC/MA;ADkNA;EACA,WAAA;EACA,SAAA;AChNA;;AAEA,wCAAwC",file:"ScrollBar.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-10-14 15:43:43\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-01-31 14:36:11\r\n * @Description: 滚动条\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    ref="scroll-bar"\r\n    class="scroll-bar"\r\n    :class="{ row: isHorizontal, col: !isHorizontal }"\r\n    :style="barContainerStyle"\r\n    @click.self="onScrollBarClickSelf"\r\n  >\r\n    <div\r\n      ref="bar"\r\n      class="bar"\r\n      :class="{ mousedown: isMousedown }"\r\n      :style="barStyle"\r\n      @mousedown.stop="onBarMousedown"\r\n    ></div>\r\n\r\n    <div v-if="isMousedown" class="mask" ref="mask" :style="maskStyle"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nconst DRAG_MASK_SIZE = 200;\r\n\r\nimport { SCROLL_BAR_SIZE } from "../../../const.js";\r\nexport default {\r\n  props: {\r\n    isHorizontal: { type: Boolean, default: false }, // 水平还是竖向滚动\r\n    hasNeighbor: { type: Boolean, default: true }, // 是否有相邻得滚动条(要预留一个非滚动空间出来)\r\n    clientLength: { type: Number, required: false }, // 当前视口宽或高\r\n    scrollLength: { type: Number, required: true }, // 可滚动的范围\r\n    scrollDistance: { type: Number, default: 0 }, // 当前已滚动的距离\r\n  },\r\n  data() {\r\n    return {\r\n      DRAG_MASK_SIZE,\r\n      SCROLL_BAR_SIZE,\r\n      isMousedown: false, // 鼠标是否在滚动条上被按下\r\n    };\r\n  },\r\n  computed: {\r\n    // 滚动条操作杆的长度占整个滚动条槽的比例\r\n    barPercent: function () {\r\n      return (this.clientLength / this.scrollLength) * 100;\r\n    },\r\n    // 滚动条操作杆的上沿或左侧距离整个滚动条槽起点的距离换算成百分比\r\n    scrollPercent: function () {\r\n      return (this.scrollDistance / this.scrollLength) * 100;\r\n    },\r\n    barContainerStyle: function () {\r\n      if (this.isHorizontal) {\r\n        const width = this.hasNeighbor\r\n          ? `calc(100% - ${SCROLL_BAR_SIZE}px)`\r\n          : "100%";\r\n        return {\r\n          width,\r\n          height: `${SCROLL_BAR_SIZE}px`,\r\n        };\r\n      } else {\r\n        const height = this.hasNeighbor\r\n          ? `calc(100% - ${SCROLL_BAR_SIZE}px)`\r\n          : "100%";\r\n        return {\r\n          height,\r\n          width: `${SCROLL_BAR_SIZE}px`,\r\n        };\r\n      }\r\n    },\r\n    // 滚动条的样式\r\n    barStyle: function () {\r\n      if (this.isHorizontal)\r\n        return {\r\n          width: `${this.barPercent}%`,\r\n          left: `${this.scrollPercent}%`,\r\n        };\r\n      else\r\n        return {\r\n          height: `${this.barPercent}%`,\r\n          top: `${this.scrollPercent}%`,\r\n        };\r\n    },\r\n    // 拖动遮罩的样式\r\n    maskStyle: function () {\r\n      if (this.isHorizontal)\r\n        return {\r\n          height: `${DRAG_MASK_SIZE}px`,\r\n          top: `${-DRAG_MASK_SIZE / 2 + SCROLL_BAR_SIZE / 2}px`,\r\n        };\r\n      else\r\n        return {\r\n          width: `${DRAG_MASK_SIZE}px`,\r\n          left: `${-DRAG_MASK_SIZE / 2 + SCROLL_BAR_SIZE / 2}px`,\r\n        };\r\n    },\r\n  },\r\n  mounted() {\r\n    // const refBar = this.$refs["bar"];\r\n    // refBar.onmousedown = (e) => {\r\n    //   this.onBarMousedown();\r\n    // };\r\n  },\r\n  methods: {\r\n    onBarMousedown(e) {\r\n      e.preventDefault();\r\n\r\n      const body = window.document.body;\r\n      const bodyOverFlowOriginal = body.overflow;\r\n      body.style.overflow = "hidden";\r\n\r\n      this.isMousedown = true;\r\n\r\n      this.$nextTick(() => {\r\n        const refBar = this.$refs["bar"];\r\n        const refMask = this.$refs["mask"];\r\n\r\n        let barLength;\r\n        if (this.isHorizontal) {\r\n          barLength = refBar.clientWidth;\r\n        } else {\r\n          barLength = refBar.clientHeight;\r\n        }\r\n        const ratio = this.clientLength / barLength;\r\n\r\n        refMask.onmousemove = (e) => {\r\n          e.preventDefault();\r\n\r\n          if (this.isHorizontal) {\r\n            this.$emit("mouse-drag", e.movementX, e.movementX * ratio);\r\n          } else {\r\n            this.$emit("mouse-drag", e.movementY, e.movementY * ratio);\r\n          }\r\n        };\r\n        refMask.onmouseleave = (e) => {\r\n          e.preventDefault();\r\n\r\n          //   console.log("onmouseleave");\r\n          this.isMousedown = false;\r\n\r\n          refMask.onmousemove = null;\r\n          refMask.onmouseleave = null;\r\n          refMask.onmouseup = null;\r\n          // refBar.onmousedown = null;\r\n          body.style.overflow = bodyOverFlowOriginal;\r\n        };\r\n        refMask.onmouseup = (e) => {\r\n          e.preventDefault();\r\n\r\n          this.isMousedown = false;\r\n\r\n          refMask.onmousemove = null;\r\n          refMask.onmouseleave = null;\r\n          refMask.onmouseup = null;\r\n          // refBar.onmousedown = null;\r\n          body.style.overflow = bodyOverFlowOriginal;\r\n        };\r\n      });\r\n    },\r\n    onBarMouseup() {\r\n      //   this.isMousedown = false;\r\n    },\r\n    onScrollBarClickSelf(event) {\r\n      // 计算点击位置处于整个滚动条的高或宽的百分之几处\r\n      const oX = event.offsetX;\r\n      const oY = event.offsetY;\r\n      const oW = this.$refs["scroll-bar"].offsetWidth;\r\n      const oH = this.$refs["scroll-bar"].offsetHeight;\r\n\r\n      let percent;\r\n      if (this.isHorizontal) {\r\n        // 水平滚动\r\n        percent = (oX / oW) * 100;\r\n      } else {\r\n        // 垂直滚动\r\n        percent = (oY / oH) * 100;\r\n      }\r\n\r\n      // console.log("oX, oY, oW, oH :>> ", oX, oY, oW, oH);\r\n      // console.log("percent :>> ", percent);\r\n      // console.log("this.scrollPercent :>> ", this.scrollPercent);\r\n\r\n      if (percent > this.scrollPercent) {\r\n        // 在下/在右\r\n        this.$emit("scroll-bar-blank-click", true);\r\n      } else {\r\n        // 在上/在左\r\n        this.$emit("scroll-bar-blank-click", false);\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "./src/scss/_variables.scss";\r\n\r\n.scroll-bar {\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n  background-color: $grey-color-light;\r\n  z-index: 1000;\r\n\r\n  .bar {\r\n    box-sizing: border-box;\r\n    position: absolute;\r\n    background-color: $grey-color-light2;\r\n    z-index: 1500;\r\n    &:hover {\r\n      background-color: $grey-color-normal;\r\n    }\r\n    &.mousedown {\r\n      background-color: $grey-color-dark;\r\n    }\r\n  }\r\n\r\n  .mask {\r\n    position: absolute;\r\n    z-index: 2000;\r\n    cursor: pointer;\r\n    // background-color: rgba(255, 0, 0, 0.1);\r\n  }\r\n\r\n  &.col {\r\n    // height: 100%;\r\n    top: 0px;\r\n    right: 0px;\r\n\r\n    .bar {\r\n      width: 100%;\r\n    }\r\n\r\n    .mask {\r\n      height: 100%;\r\n      top: 0px;\r\n    }\r\n  }\r\n\r\n  &.row {\r\n    // width: 100%;\r\n    left: 0px;\r\n    bottom: 0px;\r\n\r\n    .bar {\r\n      height: 100%;\r\n    }\r\n\r\n    .mask {\r\n      width: 100%;\r\n      left: 0px;\r\n    }\r\n  }\r\n}\r\n</style>',".scroll-bar {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #eeeeee;\n  z-index: 1000;\n}\n.scroll-bar .bar {\n  box-sizing: border-box;\n  position: absolute;\n  background-color: #dddddd;\n  z-index: 1500;\n}\n.scroll-bar .bar:hover {\n  background-color: #aaaaaa;\n}\n.scroll-bar .bar.mousedown {\n  background-color: #666666;\n}\n.scroll-bar .mask {\n  position: absolute;\n  z-index: 2000;\n  cursor: pointer;\n}\n.scroll-bar.col {\n  top: 0px;\n  right: 0px;\n}\n.scroll-bar.col .bar {\n  width: 100%;\n}\n.scroll-bar.col .mask {\n  height: 100%;\n  top: 0px;\n}\n.scroll-bar.row {\n  left: 0px;\n  bottom: 0px;\n}\n.scroll-bar.row .bar {\n  height: 100%;\n}\n.scroll-bar.row .mask {\n  width: 100%;\n  left: 0px;\n}\n\n/*# sourceMappingURL=ScrollBar.vue.map */"]},media:void 0})}),Fe,"data-v-4e6d54f0",!1,void 0,!1,T,void 0,void 0),Te={props:{IS_DEBUGGING:{type:Boolean,default:!1},siblingNodes:{type:Array,default:function(){return[]}},isHorizontalLayout:{type:Boolean,required:!0},currDraggingNode:{type:Object,default:null}},data:function(){return{zones:[]}},watch:{siblingNodes:function(n){n.length>0&&this.calcGapDropZone()}},methods:{onZoneMouseenter:function(){},onZoneMouseleave:function(){},onZoneMouseup:function(n,e){var r=this.insertAndOrderNodes(n,e),t=r.oldOrderNo,i=r.newOrderNo;this.$emit("nodes-reorder",[this.currDraggingNode],i,[t])},insertAndOrderNodes:function(n){var e=this;if(this.currDraggingNode){if(this.siblingNodes.length>1){var r=this.siblingNodes.findIndex((function(n){return n.id===e.currDraggingNode.id}));if(r>-1){var t,i=void 0===n?this.siblingNodes.length:n,o=r;return r>=i&&(o+=1),t=this.currDraggingNode.orderNo,this.siblingNodes.splice(i,0,this.currDraggingNode),this.siblingNodes.splice(o,1),this.reCalcSiblingNodesOrderNo(),{oldOrderNo:t,newOrderNo:this.currDraggingNode.orderNo}}throw new Error("当前拖动节点不在兄弟节点之中")}throw new Error("必须多于一个节点")}throw new Error("必须有正在被拖动的节点")},calcGapDropZone:function(){if(this.zones=[],this.siblingNodes.length>0){var n=this.siblingNodes[0],e=E.calcFirstSiblingDropAllowZone({firstNode:n,isHorizontal:this.isHorizontalLayout}),r=e.zoneWidth,t=e.zoneHeight,i=e.zoneMinX,o=e.zoneMinY;this.zones.push({zoneWidth:r,zoneHeight:t,zoneMinX:i,zoneMinY:o,node2Index:0})}for(var s=0;s<this.siblingNodes.length;s++)if(s>0){var a=this.siblingNodes[s-1],l=this.siblingNodes[s],d=E.calcSiblingDropAllowZoneBetween2Nodes({node1:a,node2:l,isHorizontal:this.isHorizontalLayout}),c=d.zoneWidth,A=d.zoneHeight,h=d.zoneMinX,u=d.zoneMinY;this.zones.push({zoneWidth:c,zoneHeight:A,zoneMinX:h,zoneMinY:u,node1Index:s-1,node2Index:s})}if(this.siblingNodes.length>0){var p=this.siblingNodes[this.siblingNodes.length-1],f=E.calcLastSiblingDropAllowZone({lastNode:p,isHorizontal:this.isHorizontalLayout}),m=f.zoneWidth,g=f.zoneHeight,v=f.zoneMinX,b=f.zoneMinY;this.zones.push({zoneWidth:m,zoneHeight:g,zoneMinX:v,zoneMinY:b,node1Index:this.siblingNodes.length-1})}},reCalcSiblingNodesOrderNo:function(){for(var n=0;n<this.siblingNodes.length;n++)this.siblingNodes[n].orderNo=n+1}}},Re=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"sibling-drop-zones",class:{debugging:n.IS_DEBUGGING}},[n._l(n.zones,(function(e,t){return[r("div",{key:t,staticClass:"sibling-drop-zone",style:{top:e.zoneMinY+"px",left:e.zoneMinX+"px",width:e.zoneWidth+"px",height:e.zoneHeight+"px"},on:{mouseenter:function(r){return n.onZoneMouseenter(e.node1Index,e.node2Index)},mouseleave:function(r){return n.onZoneMouseleave(e.node1Index,e.node2Index)},mouseup:function(r){return n.onZoneMouseup(e.node1Index,e.node2Index)}}})]}))],2)};Re._withStripped=!0;var Pe=F({render:Re,staticRenderFns:[]},(function(n){n&&n("data-v-6e263932_0",{source:".sibling-drop-zones[data-v-6e263932] {\n  position: absolute;\n  box-sizing: border-box;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n}\n.sibling-drop-zones .sibling-drop-zone[data-v-6e263932] {\n  position: absolute;\n}\n.sibling-drop-zones.debugging .sibling-drop-zone[data-v-6e263932] {\n  background-color: rgba(0, 255, 255, 0.5019607843);\n}\n\n/*# sourceMappingURL=SiblingDropZones.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\SiblingDropZones.vue","SiblingDropZones.vue"],names:[],mappings:"AAmLA;EAEA,kBAAA;EACA,sBAAA;EACA,UAAA;EACA,WAAA;EACA,QAAA;EACA,SAAA;ACnLA;ADoLA;EACA,kBAAA;AClLA;ADwLA;EACA,iDAAA;ACrLA;;AAEA,+CAA+C",file:"SiblingDropZones.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-11-03 15:17:50\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-04-27 14:20:27\r\n * @Description: 潜在兄弟节点的拖放区域集(用于节点排序)\r\n--\x3e\r\n\r\n<template>\r\n  <div class="sibling-drop-zones" :class="{ debugging: IS_DEBUGGING }">\r\n    <template v-for="(zone, index) in zones">\r\n      <div\r\n        class="sibling-drop-zone"\r\n        :key="index"\r\n        :style="{\r\n          top: `${zone.zoneMinY}px`,\r\n          left: `${zone.zoneMinX}px`,\r\n          width: `${zone.zoneWidth}px`,\r\n          height: `${zone.zoneHeight}px`,\r\n        }"\r\n        @mouseenter="onZoneMouseenter(zone.node1Index, zone.node2Index)"\r\n        @mouseleave="onZoneMouseleave(zone.node1Index, zone.node2Index)"\r\n        @mouseup="onZoneMouseup(zone.node1Index, zone.node2Index)"\r\n      ></div>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Matrix from "../../../algorithm/Matrix.js";\r\nexport default {\r\n  props: {\r\n    IS_DEBUGGING: { type: Boolean, default: false }, // 当前是否正处于开发调试当中\r\n    siblingNodes: { type: Array, default: () => [] }, // 兄弟节点(默认已排好序)\r\n    isHorizontalLayout: { type: Boolean, required: true }, // 横向布局(true)还是竖向布局(false)\r\n    currDraggingNode: { type: Object, default: null },\r\n  },\r\n  data() {\r\n    return {\r\n      zones: [],\r\n    };\r\n  },\r\n  watch: {\r\n    siblingNodes: function (v /* , ov */) {\r\n      if (v.length > 0) {\r\n        this.calcGapDropZone();\r\n        // this.reCalcSiblingNodesOrderNo();\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    onZoneMouseenter(/* node1Index, node2Index */) {},\r\n    onZoneMouseleave(/* node1Index, node2Index */) {},\r\n    onZoneMouseup(node1Index, node2Index) {\r\n      // try {\r\n      const { oldOrderNo, newOrderNo } = this.insertAndOrderNodes(\r\n        node1Index,\r\n        node2Index\r\n      );\r\n      this.$emit("nodes-reorder", [this.currDraggingNode], newOrderNo, [\r\n        oldOrderNo,\r\n      ]);\r\n      // } catch (err) {}\r\n    },\r\n\r\n    insertAndOrderNodes(/* node1Index, */ node2Index) {\r\n      // 必须有正在被拖动的节点\r\n      if (this.currDraggingNode) {\r\n        // 必须多于一个节点\r\n        if (this.siblingNodes.length > 1) {\r\n          // 必须不是拖到节点的前后间隙\r\n          const currNodeIndex = this.siblingNodes.findIndex(\r\n            (n) => n.id === this.currDraggingNode.id\r\n          );\r\n\r\n          if (currNodeIndex > -1) {\r\n            // 当前拖动节点是在兄弟节点之中\r\n\r\n            const start =\r\n              node2Index === undefined ? this.siblingNodes.length : node2Index;\r\n\r\n            let originIndex = currNodeIndex;\r\n            if (currNodeIndex >= start) originIndex = originIndex + 1;\r\n\r\n            let newOrderNo, oldOrderNo;\r\n            oldOrderNo = this.currDraggingNode.orderNo;\r\n\r\n            this.siblingNodes.splice(start, 0, this.currDraggingNode);\r\n            this.siblingNodes.splice(originIndex, 1);\r\n            this.reCalcSiblingNodesOrderNo();\r\n\r\n            newOrderNo = this.currDraggingNode.orderNo;\r\n\r\n            return { oldOrderNo, newOrderNo };\r\n          } else {\r\n            throw new Error("当前拖动节点不在兄弟节点之中");\r\n          }\r\n        } else {\r\n          throw new Error("必须多于一个节点");\r\n        }\r\n      } else {\r\n        throw new Error("必须有正在被拖动的节点");\r\n      }\r\n    },\r\n\r\n    calcGapDropZone(/* node1Index, node2Index */) {\r\n      this.zones = [];\r\n\r\n      // 计算第一个节点前\r\n      if (this.siblingNodes.length > 0) {\r\n        const firstNode = this.siblingNodes[0];\r\n        const { zoneWidth, zoneHeight, zoneMinX, zoneMinY } =\r\n          Matrix.calcFirstSiblingDropAllowZone({\r\n            firstNode,\r\n            isHorizontal: this.isHorizontalLayout,\r\n          });\r\n\r\n        this.zones.push({\r\n          zoneWidth,\r\n          zoneHeight,\r\n          zoneMinX,\r\n          zoneMinY,\r\n          node2Index: 0,\r\n        });\r\n      }\r\n\r\n      // 先计算节点间的\r\n      for (let i = 0; i < this.siblingNodes.length; i++) {\r\n        if (i > 0) {\r\n          // 此时才有节点间的\r\n          const n1 = this.siblingNodes[i - 1];\r\n          const n2 = this.siblingNodes[i];\r\n\r\n          const { zoneWidth, zoneHeight, zoneMinX, zoneMinY } =\r\n            Matrix.calcSiblingDropAllowZoneBetween2Nodes({\r\n              node1: n1,\r\n              node2: n2,\r\n              isHorizontal: this.isHorizontalLayout,\r\n            });\r\n\r\n          this.zones.push({\r\n            zoneWidth,\r\n            zoneHeight,\r\n            zoneMinX,\r\n            zoneMinY,\r\n            node1Index: i - 1,\r\n            node2Index: i,\r\n          });\r\n        }\r\n      }\r\n\r\n      // 计算最后一个节点后的\r\n      if (this.siblingNodes.length > 0) {\r\n        const lastNode = this.siblingNodes[this.siblingNodes.length - 1];\r\n        const { zoneWidth, zoneHeight, zoneMinX, zoneMinY } =\r\n          Matrix.calcLastSiblingDropAllowZone({\r\n            lastNode,\r\n            isHorizontal: this.isHorizontalLayout,\r\n          });\r\n\r\n        this.zones.push({\r\n          zoneWidth,\r\n          zoneHeight,\r\n          zoneMinX,\r\n          zoneMinY,\r\n          node1Index: this.siblingNodes.length - 1,\r\n        });\r\n      }\r\n    },\r\n\r\n    reCalcSiblingNodesOrderNo() {\r\n      for (let i = 0; i < this.siblingNodes.length; i++) {\r\n        const node = this.siblingNodes[i];\r\n        node.orderNo = i + 1;\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n.sibling-drop-zones {\r\n  // transform-origin: left top;\r\n  position: absolute;\r\n  box-sizing: border-box;\r\n  width: 0px;\r\n  height: 0px;\r\n  top: 0px;\r\n  left: 0px;\r\n  .sibling-drop-zone {\r\n    position: absolute;\r\n  }\r\n}\r\n\r\n.sibling-drop-zones {\r\n  &.debugging {\r\n    .sibling-drop-zone {\r\n      background-color: #00ffff80;\r\n    }\r\n  }\r\n}\r\n</style>',".sibling-drop-zones {\n  position: absolute;\n  box-sizing: border-box;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n}\n.sibling-drop-zones .sibling-drop-zone {\n  position: absolute;\n}\n\n.sibling-drop-zones.debugging .sibling-drop-zone {\n  background-color: rgba(0, 255, 255, 0.5019607843);\n}\n\n/*# sourceMappingURL=SiblingDropZones.vue.map */"]},media:void 0})}),Te,"data-v-6e263932",!1,void 0,!1,T,void 0,void 0),Oe={props:{isVisible:{type:Boolean,default:!1},borderWidth:{type:Number,default:2}}},He=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:n.isVisible,expression:"isVisible"}],staticClass:"scope-selection-frame",style:{width:"0px",height:"0px",borderWidth:n.borderWidth+"px"}})};He._withStripped=!0;var We={addEvent:function(n){var e=n.name,r=n.attachment,t=n.info;s.commit("addEvent",new o({name:e,attachment:r,info:t}))},traceback:async function(){return await s.dispatch("popEvent")}},Ve={parentId:null,title:""},$e={components:{MindMapNode:qn,MapOperation:ae,ScopeFrame:ce,Previewer:Ne,BottomBar:De,ScrollBar:ze,SiblingDropZones:Pe,ScopeSelectionFrame:F({render:He,staticRenderFns:[]},(function(n){n&&n("data-v-4f011c54_0",{source:".scope-selection-frame[data-v-4f011c54] {\n  position: absolute;\n  box-sizing: content-box;\n  border: solid #88c5fa;\n  background-color: rgba(136, 197, 250, 0.3);\n  z-index: 1999;\n}\n\n/*# sourceMappingURL=ScopeSelectionFrame.vue.map */",map:{version:3,sources:["E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap\\Other\\ScopeSelectionFrame.vue","ScopeSelectionFrame.vue"],names:[],mappings:"AAyBA;EAGA,kBAAA;EAEA,uBAAA;EACA,qBAAA;EACA,0CAAA;EACA,aAAA;AC3BA;;AAEA,kDAAkD",file:"ScopeSelectionFrame.vue",sourcesContent:['\x3c!--\r\n * @Author: Billy\r\n * @Date: 2023-01-30 18:22:40\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-02-02 15:34:48\r\n * @Description: 用于框选多个节点的可调节大小的框\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    v-show="isVisible"\r\n    class="scope-selection-frame"\r\n    :style="{ width: \'0px\', height: \'0px\', borderWidth: `${borderWidth}px` }"\r\n  ></div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    isVisible: { type: Boolean, default: false },\r\n    borderWidth: { type: Number, default: 2 },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../../../scss/_variables.scss";\r\n.scope-selection-frame {\r\n  $border-width: 2px;\r\n\r\n  position: absolute;\r\n  //   box-sizing: border-box;\r\n  box-sizing: content-box;\r\n  border: solid $main-color-light-more;\r\n  background-color: rgba($main-color-light-more, 0.3);\r\n  z-index: 1999;\r\n}\r\n</style>',".scope-selection-frame {\n  position: absolute;\n  box-sizing: content-box;\n  border: solid #88c5fa;\n  background-color: rgba(136, 197, 250, 0.3);\n  z-index: 1999;\n}\n\n/*# sourceMappingURL=ScopeSelectionFrame.vue.map */"]},media:void 0})}),Oe,"data-v-4f011c54",!1,void 0,!1,T,void 0,void 0)},props:{flatNodes:{type:Array,default:function(){return[Ve]}},isReadonly:{type:Boolean,default:!1},defaultLayout:{type:String,default:"horizontal",validator:function(n){return["horizontal","vertical"].includes(n)}},defaultLineStyle:{type:String,default:"curve",validator:function(n){return["curve","straight"].includes(n)}},defaultLineColor:{type:String,default:"#338AFF",validator:function(n){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(n)}},allowDrop:{type:Boolean,default:!1},isBottomBarVisible:{type:Boolean,default:!0},isNodeHide:{type:String,default:"vif",validator:function(n){return["none","vshow","vif"].includes(n)}},isMultipleSelectAllowed:{type:Boolean,default:!1},fullScreenMapZIndex:{type:Number,default:1e3},fontSize:{type:Number,default:14},fontFamily:{type:String,default:h},paddingLr:{type:Number,default:16},paddingTb:{type:Number,default:40},beforeChildAdded:{type:Function,default:async function(){return!0}},beforeSiblingAdded:{type:Function,default:async function(){return!0}},beforeImgInserted:{type:Function,default:async function(){return!0}},beforeVideoInserted:{type:Function,default:async function(){return!0}},beforeFileInserted:{type:Function,default:async function(){return!0}},beforeChangeParent:{type:Function,default:async function(){return!0}},titleAttrName:{type:String,default:"title"}},data:function(){return{IS_DEBUGGING:!1,bottomBarHeight:32,nodes:[],tree:[],links:[],currActiveNodeIds:[],currEditingNodeId:"",scaleValue:1,isFullScreen:!1,currDraggingNode:null,cursorPos:{x:0,y:0},cursorSize:{w:36,h:16},isScopeFrameDisplay:!1,scopeFramePos:{x:0,y:0},scopeFrameSize:{w:0,h:0},isHorizontal:!0,isMovingMode:!1,isCurveLines:"curve"===this.defaultLineStyle,currPreviewType:"",currPicPreview:{urls:[]},currVideoPlay:{url:""},mindmapScope:{minX:0,minY:0,maxX:0,maxY:0},mapMoveMaskSize:{width:0,height:0},cursorMoveMaskSize:{width:0,height:0},currOffspringDropZoneMouseenterNodeId:"",offspringTempLineCanvas:{top:0,left:0,width:0,height:0},unOffspringDroppableNodes:[],currHoveringNode:null,isMindmapBiggerThanScrollFrame:!1,selectionFrame:{isVisible:!1,isMaskAvalible:!1,borderWidth:2,start:{x:0,y:0},end:{x:0,y:0}},scrollInfo:{clientWidth:0,clientHeight:0},scrollWidth:0,scrollHeight:0,scrollWidthFinal:0,scrollHeightFinal:0,scrollTop:0,scrollLeft:0,mapMoveOffsetLeft:0,mapMoveOffsetTop:0,mindmapScopeRecord:{wBefore:0,hBefore:0,wCurrent:0,hCurrent:0}}},computed:{mainHeight:function(){return this.isBottomBarVisible?"calc(100% - "+this.bottomBarHeight+"px)":"100%"},bottomHeight:function(){return this.isBottomBarVisible?this.bottomBarHeight+"px":void 0},scrollTopFinal:function(){return this.scrollTop+this.mapMoveOffsetTop},scrollLeftFinal:function(){return this.scrollLeft+this.mapMoveOffsetLeft},scrollTopCalc:function(){return this.scrollTop},scrollLeftCalc:function(){return this.scrollLeft},rightScrollBarMaxScrollDistance:function(){return this.scrollHeightFinal>this.scrollInfo.clientHeight?this.scrollHeightFinal-this.scrollInfo.clientHeight:0},bottomScrollBarMaxScrollDistance:function(){return this.scrollWidthFinal>this.scrollInfo.clientWidth?this.scrollWidthFinal-this.scrollInfo.clientWidth:0},isRightScrollBarAvalible:function(){return!!this.rightScrollBarMaxScrollDistance},isBottomScrollBarAvalible:function(){return!!this.bottomScrollBarMaxScrollDistance},mindmapScopeWidth:function(){return this._calcMindmapScopeWidth()},mindmapScopeHeight:function(){return this._calcMindmapScopeHeight()},mindmapMoveX:function(){return 0-this.scrollLeftFinal},mindmapMoveY:function(){return 0-this.scrollTopFinal},isCursorDisplay:function(){return!!this.currDraggingNode},siblingsOfCurrDraggingNode:function(){var n=this;return this.currDraggingNode?this.nodes.filter((function(e){return e.parentId===n.currDraggingNode.parentId})).sort((function(n,e){return n.orderNo-e.orderNo})):[]},hasCurrEditing:function(){return this.currEditingNodeId},forbiddenHoveringNodeIds:function(){return this.unOffspringDroppableNodes.map((function(n){return n.id}))},mindmapStyle:function(){return this.isFullScreen?{top:"0px",left:"0px",position:"fixed"}:{}},mapSize:function(){var n=this.mindmapScopeWidth+2*this.paddingLr,e=this.mindmapScopeHeight+2*this.paddingTb;return this.isRightScrollBarAvalible&&(n+=p),this.isBottomScrollBarAvalible&&(e+=p),{width:n,height:e}},scrollFrameStyle:function(){return this.isMindmapBiggerThanScrollFrame?{"justify-content":"flex-start","align-items":"flex-start"}:this.isHorizontal?{"justify-content":"flex-start","align-items":"center"}:{"justify-content":"center","align-items":"flex-start"}},selectionFrameMaskStyle:function(){return{width:this.isRightScrollBarAvalible?"calc(100% - 16px)":"100%",height:this.isBottomScrollBarAvalible?"calc(100% - 16px)":"100%"}},currPreviewUrl:function(){switch(this.currPreviewType){case a.PIC:return this.currPicPreview.urls;case a.VIDEO:return this.currVideoPlay.url;default:return""}}},watch:{flatNodes:{immediate:!0,handler:async function(){Array.isArray(this.flatNodes)&&0===this.flatNodes.length&&this.flatNodes.push(Ve),this.flatNodesToMyNodes(),await this.initialNodesAndLinks()}},isReadonly:{immediate:!0,handler:function(n){s.state.isGloballyReadonly=n}},isCursorDisplay:function(n){var e=this;n?this.$nextTick((function(){e.setCursorMoveMaskSize()})):this.setCursorMoveMaskSizeZero()},isMovingMode:function(n){var e=this;n?this.$nextTick((function(){e.setMapMoveMaskSize()})):this.setMapMoveMaskSizeZero()},isFullScreen:function(n){var e=this;n?this.$emit("before-full-screen"):this.$emit("before-cancel-full-screen"),this.$nextTick((function(){e.getScrollInfo()}))},mindmapScopeRecord:{immediate:!1,deep:!0,handler:function(){var n=this;if(this.mindmapScopeRecord.wBefore>this.mindmapScopeRecord.wCurrent){var e,r=this.mindmapScopeRecord.wBefore-this.mindmapScopeRecord.wCurrent;this.scrollLeft>0&&(e=this.scrollLeft<r?0:this.scrollLeft-r,this.$nextTick((function(){n.moveCanvas({fromNum:n.scrollLeft,toNum:e,callback:function(e){n.$refs.map.style.left=-e+"px"},callbackWhenFinished:function(){n.scrollLeft=e}})})))}if(this.mindmapScopeRecord.hBefore>this.mindmapScopeRecord.hCurrent){var t,i=this.mindmapScopeRecord.hBefore-this.mindmapScopeRecord.hCurrent;this.scrollTop>0&&(t=this.scrollTop<i?0:this.scrollTop-i,this.$nextTick((function(){n.moveCanvas({fromNum:n.scrollTop,toNum:t,callback:function(e){n.$refs.map.style.top=-e+"px"},callbackWhenFinished:function(){n.scrollTop=t}})})))}}},mapSize:function(n){this.isHorizontal?this.scrollInfo.clientHeight<n.height?this.isMindmapBiggerThanScrollFrame=!0:this.isMindmapBiggerThanScrollFrame=!1:this.scrollInfo.clientWidth<n.width?this.isMindmapBiggerThanScrollFrame=!0:this.isMindmapBiggerThanScrollFrame=!1,this.$emit("map-style-change",this.toMapStyles())},scaleValue:function(){this.$emit("map-style-change",this.toMapStyles())},mindmapMoveX:function(){this.$emit("map-style-change",this.toMapStyles())},mindmapMoveY:function(){this.$emit("map-style-change",this.toMapStyles())}},created:function(){this.isHorizontal="horizontal"===this.defaultLayout},beforeMount:async function(){},mounted:async function(){window.addEventListener("optimizedResize",this.onWindowResize),window.addEventListener("keyup",this.onMindmapKeyup),this.$refs["scroll-frame"].addEventListener("mousewheel",this.onScrollFrameScroll,{passive:!1})},beforeDestroy:function(){window.removeEventListener("optimizedResize",this.onWindowResize),window.removeEventListener("keyup",this.onMindmapKeyup),this.$refs["scroll-frame"].removeEventListener("mousewheel",this.onScrollFrameScroll)},methods:{getNodeOrderNoById:function(n){var e=this.nodes.find((function(e){return e.id===n}));return e?e.orderNo:void 0},foldOrUnfold:function(n,e){var r,t=this;for(var i of(void 0===n&&(n=[]),void 0===e&&(e=!0),n))r=void 0,(r=t.nodes.find((function(n){return n.id===i})))&&(r.isFolded=e);this.refreshNodesAndLinks()},focusToNode:async function(n){var e=this.nodes.find((function(e){return e.id===n}));if(e){var r=E.findAllAncestors(this.nodes,e),t=0;for(var i of r)i.isFolded&&(i.isFolded=!1,t++);t>0&&await this.refreshNodesAndLinks(),this.scrollTop=0,this.mapMoveOffsetTop=0,this.scrollLeft=0,this.mapMoveOffsetLeft=0;var o=e.top-(this.scrollInfo.clientHeight-e.height)/2+this.paddingTb,s=e.left-(this.scrollInfo.clientWidth-e.width)/2+this.paddingLr;this._setScrollTop(o),this._setScrollLeft(s)}},plusScaleValue:function(){this.$refs["bottom-bar"].onBtnAddClick()},minusScaleValue:function(){this.$refs["bottom-bar"].onBtnMinusClick()},setScaleValue:function(n){this.scaleValue=n},setFullScreen:function(n){this.isFullScreen=n},focusCenter:function(){this.mapMoveOffsetTop=0,this.mapMoveOffsetLeft=0,this.scrollTop=this.rightScrollBarMaxScrollDistance/2,this.scrollLeft=this.bottomScrollBarMaxScrollDistance/2},insertResource:async function(n,e){var r=this.nodes.find((function(e){return e.id===n}));if(r&&e){var t,i=new S({type:e.type,title:e.title,mimeType:e.mimeType,size:e.size,url:e.url,htmlContent:e.htmlContent});switch(r.resources&&r.resources.length>=0||(r.resources=[]),r.resources.push(i),await r.calcCellSize(r),this.refreshNodesAndLinks(),e.type){case a.PIC:t="img-inserted";break;case a.VIDEO:t="video-inserted";break;case a.FILE:t="file-inserted";break;case a.HTML:t="html-inserted";break;default:throw new Error("resource 的 type 不符合预期")}We.addEvent({name:t,attachment:r,info:{rsIndex:r.resources.length-1,resource:i}})}},flatNodesToMyNodes:function(){this.nodes=this.flatNodes.map((function(n){return n.isCustomized?new M(Object.assign({},n)):new N(Object.assign({},n))}))},getNodeStyle:function(n){return 1===this.currActiveNodeIds.length&&this.currActiveNodeIds[0]===n.id?{"z-index":1100}:{}},onMindmapKeyup:async function(n){if(!this.isReadonly)if(n.ctrlKey)switch(n.key){case"z":var e=await We.traceback();e&&this.traceback(e.name,e.attachment,e.info);break;case"0":this.scaleValue=1}else"Delete"===n.key&&(this.currActiveNodeIds.length>0&&this.delNodesByIds(this.currActiveNodeIds),this.currActiveNodeIds=[])},onContainerClick:function(){},onScrollFrameMousedown2:function(n){var e=this;if(this.isMultipleSelectAllowed){var r,t,i,o,s=this.$refs["scroll-frame"],a=this.$refs.map,l=this.$refs.container,d=this.$refs["selection-frame"].$el,c=s.getBoundingClientRect(),A=n.pageX-c.left,h=n.pageY-c.top;n.target!==s&&n.target!==a&&n.target!==l||(this.selectionFrame.isMaskAvalible=!0,d.style.left=A+"px",d.style.top=h+"px",s.onmousemove=function(n){n.preventDefault(),e.selectionFrame.isVisible=!0;var s=n.pageX-c.left,a=n.pageY-c.top,l=e.calcFramePosAndSize({startX:A,startY:h,endX:s,endY:a});r=l.left,t=l.top,i=l.width,o=l.height,d.style.left=r+"px",d.style.top=t+"px",d.style.width=i+"px",d.style.height=o+"px"},s.onmouseup=function(n){n.preventDefault(),s.onmousemove=null,d.style.width="0px",d.style.height="0px",e.selectionFrame.isVisible=!1,e.selectionFrame.isMaskAvalible=!1;var a=r/e.scaleValue,l=t/e.scaleValue,c=(a+i)/e.scaleValue,A=(l+o)/e.scaleValue;E.findAllVisibleNodesAtScope({startX:a,startY:l,endX:c,endY:A})})}},calcFramePosAndSize:function(n){var e,r,t,i,o=n.startX,s=n.startY,a=n.endX,l=n.endY,d=a-o,c=l-s,A=Math.abs(d),h=Math.abs(c);return d>0?(e=o-this.selectionFrame.borderWidth,t=A):d<0?(e=a-this.selectionFrame.borderWidth,t=A):(e=0,t=0),c>0?(r=s-this.selectionFrame.borderWidth,i=h):c<0?(r=l-this.selectionFrame.borderWidth,i=h):(r=0,i=0),{left:e,top:r,width:t,height:i}},onScrollFrameClick:function(n){var e=this.$refs["scroll-frame"],r=this.$refs.map,t=this.$refs.container,i=this.$refs["selection-frame-mask"];n.target!==e&&n.target!==t&&n.target!==r&&n.target!==i||this.operationsWhenClickBackground()},onNodeMouseClick:function(n,e){if(n.resources){var r=s.state.resourceIdOfActiveFrame;-1===n.resources.findIndex((function(n){return n.id===r}))&&(s.state.resourceIdOfActiveFrame="")}this.confirmEditingTitle(),e.ctrlKey?this.currActiveNodeIds.push(n.id):this.setSingleActiveNodeId(n.id)},onNodeDragenter:function(n,e){this.$emit("node-dragenter",this.cloneNode(n),e)},onNodeDragleave:function(n,e){this.$emit("node-dragleave",this.cloneNode(n),e)},onNodeDragover:function(n,e){this.$emit("node-dragover",this.cloneNode(n),e)},onNodeDrop:function(n,e){this.$emit("node-drop",this.cloneNode(n),e)},onNodeTitleDbClickToEdit:function(n){var e=s.state.resourceIdOfActiveFrame;-1===n.resources.findIndex((function(n){return n.id===e}))&&(s.state.resourceIdOfActiveFrame=""),this.currEditingNodeId=n.id},onNodeMouseDown:function(n,e){var r=this;if(this.currEditingNodeId&&this.currEditingNodeId===n.id);else if(n.parentId)if(n.isReadonly);else if(this.isReadonly);else{var t=this.$refs.container,i=t.getBoundingClientRect().left,o=t.getBoundingClientRect().top,s=e.clientX-i,a=e.clientY-o,l=s-this.cursorSize.w/2,d=a-this.cursorSize.h/2,c=this.$refs.cursor;c.style.transform="translate("+l+"px, "+d+"px)";var A=this.$refs["canvas-offspring-temp-line"].getContext("2d");this.unOffspringDroppableNodes=[],t.onmousemove=function(e){e.preventDefault();var t=e.clientX-i,l=e.clientY-o,d=Math.abs(t-s),h=Math.abs(l-a);if(Math.sqrt(Math.pow(d,2)+Math.pow(h,2))>10){r.currDraggingNode=n;var u=t-r.cursorSize.w/2,p=l-r.cursorSize.h/2;if(c.style.transform="translate("+u+"px, "+p+"px)",r.isScopeFrameDisplay||(r.unOffspringDroppableNodes=r.drawNodesScopeFrame(n)),r.currOffspringDropZoneMouseenterNodeId){if(!r.unOffspringDroppableNodes.map((function(n){return n.id})).includes(r.currOffspringDropZoneMouseenterNodeId)){var f=r.$refs["node-"+r.currOffspringDropZoneMouseenterNodeId][0];if(f){var m,g,v,b,C,w,x,k,E,y;if(r.isHorizontal){var S=f.GetAnchorRight();E=S.x,y=S.y}else{var B=f.GetAnchorBottom();E=B.x,y=B.y}t-E>0?(g=E,v=t-E):(g=t,v=E-t),l-y>0?(m=y,b=l-y):(m=l,b=y-l),t-E>0?l-y>0?(C=0,w=0,x=v,k=b):(C=0,w=b,x=v,k=0):l-y>0?(C=0,w=b,x=v,k=0):(C=v,w=b,x=0,k=0),r.isHorizontal?(m-=1,b+=2,w+=1,k+=1):(g-=1,v+=2,C+=1,x+=1),r.offspringTempLineCanvas.top=m,r.offspringTempLineCanvas.left=g,r.offspringTempLineCanvas.width=v,r.offspringTempLineCanvas.height=b,r.$nextTick((function(){A.strokeStyle=r.defaultLineColor,A.lineWidth=2,r._drawLine(A,{beginX:C,beginY:w,endX:x,endY:k})}))}}}else r.offspringTempLineCanvas.top=0,r.offspringTempLineCanvas.left=0,r.offspringTempLineCanvas.width=0,r.offspringTempLineCanvas.height=0}},t.onmouseup=async function(e){e.preventDefault(),t.onmousemove=null,t.onmouseup&&(t.onmouseup=null);var i=n.parentId;function o(){We.addEvent({name:"change-parent",attachment:[n],info:{newParentId:n.parentId,oldParentIds:[i]}})}r.isCursorDisplay&&r.currOffspringDropZoneMouseenterNodeId&&!r.unOffspringDroppableNodes.map((function(n){return n.id})).includes(r.currOffspringDropZoneMouseenterNodeId)&&!1!==await r.beforeChangeParent([r.cloneNode(n)],n.parentId,[i])&&(n.parentId=r.currOffspringDropZoneMouseenterNodeId,r.refreshNodesAndLinks(),r.$emit("change-parent",[r.cloneNode(n)],n.parentId,[i]),o()),r.isCursorDisplay&&r.currHoveringNode&&r.currHoveringNode.id!==n.id&&!1!==await r.beforeChangeParent([r.cloneNode(n)],n.parentId,[i])&&(n.parentId=r.currHoveringNode.id,r.refreshNodesAndLinks(),r.$emit("change-parent",[r.cloneNode(n)],n.parentId,[i]),o()),r.currDraggingNode&&(r.currDraggingNode=null),r.isScopeFrameDisplay&&(r.isScopeFrameDisplay=!1),r.offspringTempLineCanvas.top=0,r.offspringTempLineCanvas.left=0,r.offspringTempLineCanvas.width=0,r.offspringTempLineCanvas.height=0}}},onNodeMouseEnter:function(){},onNodeMouseLeave:function(){},onEditingNodeEnterPress:function(){this.currEditingNodeId=""},onNodeTitleChanged:function(n,e){this.$emit("title-changed",this.cloneNode(n),e),We.addEvent({name:"title-changed",attachment:n,info:e})},onBtnHorizontalClick:function(){this.isHorizontal||(this.isHorizontal=!0,this.refreshNodesAndLinks())},onBtnVerticalClick:function(){this.isHorizontal&&(this.isHorizontal=!1,this.refreshNodesAndLinks())},onBtnMoveCanvasClick:function(){this.isMovingMode=!this.isMovingMode},onBtnCurveLinesClick:function(){this.isCurveLines||(this.isCurveLines=!0,this.refreshLinks())},onBtnStraightLinesClick:function(){this.isCurveLines&&(this.isCurveLines=!1,this.refreshLinks())},onNodeBtnPlusClick:async function(n){this.currActiveNodeIds=[];var e,r=E.calcNodeChildrenCount({node:n,tree:this.tree})+1;if(n instanceof M)e=new M({id:m.uuidv4(),parentId:n.id,isReadonly:n.isReadonly});else{if(!(n instanceof N))throw new Error("parentNode 的类型出错");e=new N({id:m.uuidv4(),parentId:n.id,isReadonly:n.isReadonly})}var t,i=this.cloneNode(e,!1);!1!==await this.beforeChildAdded(i,this.cloneNode(n,!1),r)&&((t=i.isCustomized?new M(i):new N(i)).calcCellSize(t),this.nodes.push(t),await this.refreshNodesAndLinks(),this.setSingleActiveNodeId(t.id),this.$emit("child-added",this.cloneNode(t,!0),this.cloneNode(n,!1),r),We.addEvent({name:"child-added",attachment:t,info:{parentNode:n,newNodeOrderNo:r}}))},onNodesReorder:function(n,e,r){this.refreshNodesAndLinks(),this.$emit("nodes-reorder",this.cloneNodes(n),e,r)},onNodePicSinglePreviewClick:function(n,e){this.currPicPreview.urls=[e.url],this.currPreviewType=a.PIC},onNodeVideoPlayClick:function(n,e){this.currVideoPlay.url=e.url,this.currPreviewType=a.VIDEO},onNodePicDragDotMousedown:function(n,e,r){this.flexFrameResize({node:n,refFlexibleFrame:r,eventName:"frame-size-reseted"})},onNodeVideoDragDotMousedown:function(n,e,r){this.flexFrameResize({node:n,refFlexibleFrame:r,eventName:"frame-size-reseted"})},flexFrameResize:function(n){var e,r,t=this,i=n.node,o=n.refFlexibleFrame,s=n.eventName,a=this.$refs["scroll-frame"];a.onmousemove=function(n){n.preventDefault(),e=o.offsetWidth+n.movementX,r=o.offsetHeight+n.movementY,o.style.width=e+"px",o.style.height=r+"px",o.style.borderStyle="dashed"},a.onmouseup=function(n){if(n.preventDefault(),a.onmousemove&&(a.onmousemove=null),a.onmouseup&&(a.onmouseup=null),o.style.borderStyle="",e&&r){var l=i.resources[0],d=l.contentWidth,c=l.contentHeight;t.setResourceFrameSize({node:i,width:e,height:r}),t.$emit(s,t.cloneNode(i),t.cloneResource(l,i.id),{w:e,h:r},{w:d,h:c}),We.addEvent({name:s,attachment:i,info:{originalWidth:d,originalHeight:c,picFrameWidth:e,picFrameHeight:r,refFlexibleFrame:o,resource:l}})}}},onResourceDeleteClick:async function(n,e){var r=n.resources.findIndex((function(n){return n.id===e.id}));r>-1&&n.resources.splice(r,1),await n.calcCellSize(n),this.refreshNodesAndLinks(),this.$emit("resource-deleted",this.cloneNode(n),this.cloneResource(e,n.id)),We.addEvent({name:"resource-deleted",attachment:n,info:{rsIndex:r,resource:e}})},onResourceForwardClick:function(n,e){var r=n.resources.findIndex((function(n){return n.id===e.id}));this.moveForward(n.resources,r),s.state.resourceIdOfActiveFrame="",this.$emit("resource-forward",this.cloneNode(n),this.cloneResource(e,n.id)),We.addEvent({name:"resource-forward",attachment:n,info:{rsIndex:r-1,resource:e}})},onResourceBackwardClick:function(n,e){var r=n.resources.findIndex((function(n){return n.id===e.id}));this.moveBackward(n.resources,r),s.state.resourceIdOfActiveFrame="",this.$emit("resource-backward",this.cloneNode(n),this.cloneResource(e,n.id)),We.addEvent({name:"resource-backward",attachment:n,info:{rsIndex:r+1,resource:e}})},onBtnFoldAndUnfoldClick:function(n,e){this.foldOrUnfold([n.id],e),e?(this.$emit("node-folded",this.cloneNode(n)),We.addEvent({name:"node-folded",attachment:n})):(this.$emit("node-unfolded",this.cloneNode(n)),We.addEvent({name:"node-unfolded",attachment:n}))},onNodeHovering:function(n){this.currHoveringNode=n},onNodeHoveringCancel:function(){this.currHoveringNode=null},onWindowResize:function(){this.isMovingMode&&this.setMapMoveMaskSize(),this.isCursorDisplay&&this.setCursorMoveMaskSize(),this.getScrollInfo()},onRightScrollBarBlankClick:function(n){var e=80*this.scrollInfo.clientHeight;n?this.scrollDownward(e):this.scrollUpward(-e)},onBottomScrollBarBlankClick:function(n){var e=80*this.scrollInfo.clientWidth;n?this.scrollRightward(e):this.scrollLeftward(-e)},onBtnInsertImgClick:async function(n){await this.onResourceInsert({node:n,fileAccept:[".jpg",".png"].toString(),resourceType:a.PIC,beforeFunc:this.beforeImgInserted,eventName:"img-inserted"})},onBtnInsertVideoClick:async function(n){await this.onResourceInsert({node:n,fileAccept:[".mp4"].toString(),resourceType:a.VIDEO,beforeFunc:this.beforeVideoInserted,eventName:"video-inserted"})},onBtnInsertFileClick:async function(n){await this.onResourceInsert({node:n,resourceType:a.FILE,beforeFunc:this.beforeFileInserted,eventName:"file-inserted"})},onResourceInsert:async function(n){var e,r=n.node,t=n.fileAccept,i=n.resourceType,o=n.beforeFunc,l=n.eventName,d=await I.selectLocalFiles({fileAccept:t,multiple:!1}),c=s.state.resourceIdOfActiveFrame;e=c?r.resources.findIndex((function(n){return n.id===c})):r.resources.length;var A=d[0],h=new S({type:i,title:A.name,mimeType:A.type,size:A.size});if(!1!==await o(d,e,h)){var u=new S({type:i,id:h.id,title:h.name,mimeType:h.type,size:h.size});if(h.url)u.url=h.url;else switch(i){case a.PIC:var p=await I.fileToImgDataUrl(A);u.url=p;break;case a.VIDEO:var f=I.fileToObjUrl(A);u.url=f;break;case a.FILE:var m=I.fileToObjUrl(A);u.url=m}r.resources.splice(e,0,u),await r.calcCellSize(r),this.refreshNodesAndLinks(),this.$emit(l,this.cloneNode(r),this.cloneResource(u,r.id),d,e),We.addEvent({name:l,attachment:r,info:{rsIndex:e,resource:u}})}},onBtnAddSiblingClick:async function(n){var e,r=n,t=r.orderNo;if(r instanceof M)e=new M({id:m.uuidv4(),parentId:r.parentId,isReadonly:r.isReadonly});else{if(!(r instanceof N))throw new Error("siblingNode 的类型出错");e=new N({id:m.uuidv4(),parentId:r.parentId,isReadonly:r.isReadonly})}var i,o=this.cloneNode(e,!1);!1!==await this.beforeSiblingAdded(o,this.cloneNode(r,!1),t+1)&&((i=o.isCustomized?new M(o):new N(o)).orderNo=t,i.calcCellSize(i),this.nodes.push(i),await this.refreshNodesAndLinks(),this.setSingleActiveNodeId(i.id),this.$emit("sibling-added",this.cloneNode(i,!0),this.cloneNode(r,!1),i.orderNo))},onBtnDelNodeClick:function(n){this.delNodesByIds([n.id])},onNodeDropZoneMaskMouseenter:function(n,e){this.isCursorDisplay&&(this.currOffspringDropZoneMouseenterNodeId&&this.currOffspringDropZoneMouseenterNodeId===e.id||(this.currOffspringDropZoneMouseenterNodeId=e.id))},onNodeDropZoneMaskMouseleave:function(n,e){this.currOffspringDropZoneMouseenterNodeId===e.id&&(this.currOffspringDropZoneMouseenterNodeId="")},onBtnBoldClick:async function(n){n.fontStyle.bold=!n.fontStyle.bold,await n.calcCellSize(n),this.refreshNodesAndLinks();var e=n.fontStyle.bold;this.$emit("font-bold",this.cloneNode(n),e),We.addEvent({name:"font-bold",attachment:n,info:{flat:e}})},onBtnItalicClick:async function(n){n.fontStyle.italic=!n.fontStyle.italic,await n.calcCellSize(n),this.refreshNodesAndLinks();var e=n.fontStyle.italic;this.$emit("font-italic",this.cloneNode(n),e),We.addEvent({name:"font-italic",attachment:n,info:{flat:e}})},onBtnUnderlineClick:async function(n){n.fontStyle.underline=!n.fontStyle.underline,await n.calcCellSize(n),this.refreshNodesAndLinks();var e=n.fontStyle.underline;this.$emit("font-underline",this.cloneNode(n),e),We.addEvent({name:"font-underline",attachment:n,info:{flat:e}})},onBtnEraserClick:async function(n){var e=new B(n.fontStyle);n.fontStyle=new B({}),await n.calcCellSize(n),this.refreshNodesAndLinks(),this.$emit("font-eraser",this.cloneNode(n)),We.addEvent({name:"font-eraser",attachment:n,info:{oldFontStyle:e}})},onBtnBgcolorClick:async function(n,e){var r=n.fontStyle.color;n.fontStyle.color=e,this.$emit("font-bg-color",this.cloneNode(n),e),We.addEvent({name:"font-bg-color",attachment:n,info:{newColor:e,oldColor:r}})},onFoucsCenterClick:function(){this.focusCenter()},initialNodesAndLinks:async function(){var n=this;for(var e of this.nodes)await e.calcCellSize(e);return new Promise((function(e){var r=E.calcNodesPos({flatNodes:n.nodes,isHorizontal:n.isHorizontal}),t=r.links,i=r.tree;E.calcNodesOffspringDropAllowZones({flatNodes:n.nodes,isHorizontal:n.isHorizontal}),n.links=t,n.tree=i,n.calcNodesScopeAndResizeCanvas(),n.$nextTick((function(){n.drawLinesBetweenNodes(),n.getScrollInfo(),e(),n.$emit("algorithm-complete")}))}))},refreshNodesAndLinks:async function(){var n=this;return new Promise((function(e){var r=E.calcNodesPos({flatNodes:n.nodes,isHorizontal:n.isHorizontal}),t=r.links,i=r.tree;E.calcNodesOffspringDropAllowZones({flatNodes:n.nodes,isHorizontal:n.isHorizontal}),n.links=t,n.tree=i,n.mindmapScopeRecord.wBefore=n._calcMindmapScopeWidth(),n.mindmapScopeRecord.hBefore=n._calcMindmapScopeHeight(),n.clearLines(),n.$nextTick((function(){n.calcNodesScopeAndResizeCanvas(),n.$nextTick((function(){n.drawLinesBetweenNodes(),n.getScrollInfo(),e(),n.$emit("algorithm-complete")}))}))}))},refreshLinks:async function(){var n=this;return new Promise((function(e){n.clearLines(),n.$nextTick((function(){n.calcNodesScopeAndResizeCanvas(),n.$nextTick((function(){n.drawLinesBetweenNodes(),e()}))}))}))},calcNodesScopeAndResizeCanvas:function(){var n=E.calcNodesScope({tree:this.tree,isHorizontal:this.isHorizontal}),e=n.minX,r=n.minY,t=n.maxX,i=n.maxY;this.mindmapScope.minX=e,this.mindmapScope.minY=r,this.mindmapScope.maxX=t,this.mindmapScope.maxY=i,this.mindmapScopeRecord.wCurrent=this._calcMindmapScopeWidth(),this.mindmapScopeRecord.hCurrent=this._calcMindmapScopeHeight()},_calcMindmapScopeWidth:function(){return this.mindmapScope.maxX-this.mindmapScope.minX},_calcMindmapScopeHeight:function(){return this.mindmapScope.maxY-this.mindmapScope.minY},clearLines:function(){this.mindmapScope.minX=0,this.mindmapScope.minY=0,this.mindmapScope.maxX=0,this.mindmapScope.maxY=0},drawLinesBetweenNodes:function(){var n=this.$refs.canvas.getContext("2d");for(var e of(n.strokeStyle=this.defaultLineColor,n.lineWidth=2,this.links)){var r=this.$refs["node-"+e.node1.id],t=this.$refs["node-"+e.node2.id];if(r&&t){var i=r[0],o=t[0];if(this.isHorizontal){var s=i.GetAnchorRight(),a=s.x,l=s.y,d=o.GetAnchorLeft(),c=d.x,A=d.y;this._drawLine(n,{beginX:a,beginY:l,endX:c,endY:A})}else{var h=i.GetAnchorBottom(),u=h.x,p=h.y,f=o.GetAnchorTop(),m=f.x,g=f.y;this._drawLine(n,{beginX:u,beginY:p,endX:m,endY:g})}}}},drawNodesScopeFrame:function(n){var e=E.calcNodesScope({tree:this.tree,nodeId:n.id,isHorizontal:this.isHorizontal}),r=e.minX,t=e.minY,i=e.maxX,o=e.maxY,s=e.nodes;return this.scopeFramePos.x=r,this.scopeFramePos.y=t,this.scopeFrameSize.w=i-r,this.scopeFrameSize.h=o-t,this.isScopeFrameDisplay=!0,s},_drawLine:function(n,e){var r,t,i,o,s=e.beginX,a=e.beginY,l=e.endX,d=e.endY;n.beginPath(),n.moveTo(s,a),this.isHorizontal?(r=s+(l-s)/2,t=a,i=s+(l-s)/2,o=d):(r=s,t=a+(d-a)/2,i=l,o=a+(d-a)/2),this.isCurveLines?n.bezierCurveTo(r,t,i,o,l,d):(n.lineTo(r,t),n.lineTo(i,o),n.lineTo(l,d)),n.stroke()},setMapMoveMaskSize:function(){var n=this._getScrollFrameScrollSize(),e=n.width,r=n.height;this.mapMoveMaskSize.width=e,this.mapMoveMaskSize.height=r},setMapMoveMaskSizeZero:function(){this.mapMoveMaskSize.width=0,this.mapMoveMaskSize.height=0},setCursorMoveMaskSize:function(){var n=this._getScrollFrameScrollSize(),e=n.width,r=n.height;this.cursorMoveMaskSize.width=e,this.cursorMoveMaskSize.height=r},setCursorMoveMaskSizeZero:function(){this.cursorMoveMaskSize.width=0,this.cursorMoveMaskSize.height=0},operationsWhenClickBackground:function(){this.confirmEditingTitle(),this.$refs["bottom-bar"].SetPercentBtnsUnvisible(),this.currActiveNodeIds=[],this.currEditingNodeId="",s.state.resourceIdOfActiveFrame=""},_getScrollFrameScrollSize:function(){var n=this.$refs["scroll-frame"];return{width:n.scrollWidth,height:n.scrollHeight}},delNodesByIds:function(n){var e,r=this,t=Array.from(this.nodes),i=[];for(var o of n){var s=E.findFamilyNodesByParentId(o,this.tree),a=[];for(var l of s)e=void 0,e=r.nodes.findIndex((function(n){return n.id===l.id})),a.push(r.nodes[e]),r.nodes.splice(e,1);i.push(this.cloneNodes(a))}this.$nextTick((function(){r.refreshNodesAndLinks()})),this.$emit("nodes-deleted",i),We.addEvent({name:"nodes-deleted",attachment:i,info:{originalNodes:t}})},getScrollInfo:function(){this.getClientSize(),this.getScrollSize(),this.getScrollSizeFinal()},getClientSize:function(){var n=this.$refs["scroll-frame"],e=n.clientWidth,r=n.clientHeight;this.scrollInfo.clientWidth=e,this.scrollInfo.clientHeight=r},getScrollSize:function(){var n=this.mindmapScopeWidth*this.scaleValue+2*this.paddingLr,e=this.mindmapScopeHeight*this.scaleValue+2*this.paddingTb;e>this.scrollInfo.clientHeight&&(n+=p),n>this.scrollInfo.clientWidth&&(e+=p),this.scrollWidth=n,this.scrollHeight=e},getScrollSizeFinal:function(){this.getScrollWidthFinal(),this.getScrollHeightFinal()},getScrollWidthFinal:function(){this.scrollWidthFinal=this.scrollWidth+Math.abs(this.mapMoveOffsetLeft)},getScrollHeightFinal:function(){this.scrollHeightFinal=this.scrollHeight+Math.abs(this.mapMoveOffsetTop)},confirmEditingTitle:function(){this.hasCurrEditing&&(this.$refs["node-"+this.currEditingNodeId][0].ConfirmEditingTitle(),this.refreshNodesAndLinks())},setSingleActiveNodeId:function(n){this.currActiveNodeIds=[],this.currActiveNodeIds.push(n)},onMapMoveMaskMousedown:function(n){var e=this;n.preventDefault();var r=this.$refs["map-move-mask"];r.onmousemove=function(n){n.preventDefault();var r=-n.movementX,t=-n.movementY;e._setScrollLeft(r),e._setScrollTop(t)},r.onmouseup=function(n){n.preventDefault(),r.onmousemove=null}},onScrollBarMouseDrag:function(n,e,r){n?r>0?this.scrollRightward(r):this.scrollLeftward(r):r>0?this.scrollDownward(r):this.scrollUpward(r)},onScrollFrameScroll:function(n){n.ctrlKey?(n.preventDefault(),n.deltaY>0?this.scaleValue-=u:this.scaleValue+=u,this.getScrollInfo()):(n.preventDefault(),n.deltaY>0?this.scrollDownward(30):this.scrollUpward(-30))},scrollDownward:function(n){if(this.mapMoveOffsetTop>0);else if(this.mapMoveOffsetTop<0)this.mapMoveOffsetTop+n<0?this.mapMoveOffsetTop+=n:this.mapMoveOffsetTop=0,this.getScrollHeightFinal();else{var e=this.rightScrollBarMaxScrollDistance;this.scrollTopFinal+n<e?this.scrollTop+=n:this.scrollTop=e}},scrollRightward:function(n){if(this.mapMoveOffsetLeft>0);else if(this.mapMoveOffsetLeft<0)this.mapMoveOffsetLeft+n<0?this.mapMoveOffsetLeft+=n:this.mapMoveOffsetLeft=0,this.getScrollWidthFinal();else{var e=this.bottomScrollBarMaxScrollDistance;this.scrollLeftFinal+n<e?this.scrollLeft+=n:this.scrollLeft=e}},scrollUpward:function(n){var e=this;if(this.mapMoveOffsetTop<0);else if(this.mapMoveOffsetTop>0){this.getScrollHeightFinal();var r=this.scrollTopFinal+n,t=e.scrollHeightFinal>e.scrollInfo.clientHeight?e.scrollHeightFinal-e.scrollInfo.clientHeight:0;r-t>0?(this.mapMoveOffsetTop=r-t,this.scrollTop=t):(this.mapMoveOffsetTop=0,this.scrollTop=r,this.getScrollHeightFinal())}else this.scrollTopFinal+n>0?this.scrollTop+=n:this.scrollTop=0},scrollLeftward:function(n){var e=this;if(this.mapMoveOffsetLeft<0);else if(this.mapMoveOffsetLeft>0){this.getScrollWidthFinal();var r=this.scrollLeftFinal+n,t=e.scrollWidthFinal>e.scrollInfo.clientWidth?e.scrollWidthFinal-e.scrollInfo.clientWidth:0;r-t>0?(this.mapMoveOffsetLeft=r-t,this.scrollLeft=t):(this.mapMoveOffsetLeft=0,this.scrollLeft=r,this.getScrollWidthFinal())}else this.scrollLeftFinal+n>0?this.scrollLeft+=n:this.scrollLeft=0},setResourceFrameSize:function(n){var e=n.node,r=n.width,t=n.height,i=e.resources[0];i.contentWidth=r,i.contentHeight=t,e.calcCellSize(e),this.refreshNodesAndLinks()},moveCanvas:function(n){var e=n.fromNum,r=n.toNum,t=n.callback,i=n.callbackWhenFinished,o=n.totalTime;void 0===o&&(o=500);var s=n.updateCount;void 0===s&&(s=50);var a=o/s,l=0,d=o,c=setInterval((function(){l+=a,d-=a;var n=D.easeInOutQuad(l/1e3,e,r-e,o/1e3);t(n),0===d&&(clearInterval(c),i())}),a)},_setScrollLeft:async function(n){var e=await this._calcScrollLeft(n),r=e.mapMoveOffsetLeft,t=e.scrollLeft;this.mapMoveOffsetLeft=r,this.scrollLeft=t},_setScrollTop:async function(n){var e=await this._calcScrollTop(n),r=e.mapMoveOffsetTop,t=e.scrollTop;this.mapMoveOffsetTop=r,this.scrollTop=t},_calcScrollLeft:async function(n){var e=this;return this.getScrollSize(),this.getScrollSizeFinal(),new Promise((function(r){e.$nextTick((function(){var t,i,o=e.scrollWidthFinal>e.scrollInfo.clientWidth?e.scrollWidthFinal-e.scrollInfo.clientWidth:0,s=e.scrollLeftFinal+n;s<0?(t=s,i=0):s>o?(t=s-o,i=o):(t=0,i=s),r({mapMoveOffsetLeft:t,scrollLeft:i})}))}))},_calcScrollTop:async function(n){var e=this;return this.getScrollSize(),this.getScrollSizeFinal(),new Promise((function(r){e.$nextTick((function(){var t,i,o=e.scrollHeightFinal>e.scrollInfo.clientHeight?e.scrollHeightFinal-e.scrollInfo.clientHeight:0,s=e.scrollTopFinal+n;s<0?(t=s,i=0):s>o?(t=s-o,i=o):(t=0,i=s),r({mapMoveOffsetTop:t,scrollTop:i})}))}))},traceback:async function(n,e,r){switch(n){case"title-changed":e.title=r,await e.calcCellSize(e),this.$emit("recover-title-changed",this.cloneNode(e));break;case"frame-size-reseted":this.setResourceFrameSize({node:e,width:r.originalWidth,height:r.originalHeight}),r.refPicFlexibleFrame.style.width=r.originalWidth+"px",r.refPicFlexibleFrame.style.height=r.originalHeight+"px",this.$emit("recover-frame-size-reseted",this.cloneNode(e),this.cloneResource(r.onlyRes,e.id),{w:r.originalWidth,h:r.originalHeight},{w:r.picFrameWidth,h:r.picFrameHeight});break;case"child-added":var t=this.nodes.findIndex((function(n){return n.id===e.id}));this.nodes.splice(t,1),this.refreshNodesAndLinks(),this.$emit("recover-child-added",this.cloneNode(e),this.cloneNode(r.parentNode),r.newNodeOrderNo);break;case"nodes-deleted":this.nodes=r.originalNodes,this.refreshNodesAndLinks(),this.$emit("recover-nodes-deleted",e);break;case"img-inserted":e.resources.splice(r.rsIndex,1),await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-img-inserted",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"video-inserted":e.resources.splice(r.rsIndex,1),await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-video-inserted",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"file-inserted":e.resources.splice(r.rsIndex,1),await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-file-inserted",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"html-inserted":e.resources.splice(r.rsIndex,1),await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-html-inserted",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"resource-deleted":e.resources.splice(r.rsIndex,0,r.resource),await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-resource-deleted",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"resource-forward":this.moveBackward(e.resources,r.rsIndex),this.$emit("recover-resource-forward",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"resource-backward":this.moveForward(e.resources,r.rsIndex),this.$emit("recover-resource-backward",this.cloneNode(e),this.cloneResource(r.resource,e.id));break;case"node-folded":e.isFolded=!1,this.refreshNodesAndLinks(),this.$emit("recover-node-folded",this.cloneNode(e));break;case"node-unfolded":e.isFolded=!0,this.refreshNodesAndLinks(),this.$emit("recover-node-unfolded",this.cloneNode(e));break;case"change-parent":for(var i=0;i<e.length;i++)e[i].parentId=r.oldParentIds[i];this.refreshNodesAndLinks(),this.$emit("recover-change-parent",this.cloneNodes(e),r.oldParentIds,r.newParentId);break;case"font-bold":e.fontStyle.bold=!r.flat,await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-font-bold",this.cloneNodes(e),e.fontStyle.bold);break;case"font-italic":e.fontStyle.italic=!r.flat,await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-font-italic",this.cloneNodes(e),e.fontStyle.italic);break;case"font-underline":e.fontStyle.underline=!r.flat,await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-font-underline",this.cloneNodes(e),e.fontStyle.underline);break;case"font-eraser":e.fontStyle=r.oldFontStyle,await e.calcCellSize(e),this.refreshNodesAndLinks(),this.$emit("recover-font-eraser",this.cloneNodes(e),this.cloneFontStyle(e.fontStyle));break;case"font-bg-color":e.fontStyle.color=r.oldColor,this.$emit("recover-font-bg-color",this.cloneNodes(e),r.oldColor)}},cloneNode:function(n,e){void 0===e&&(e=!1);var r=n.parentId,t=n.isReadonly,i=n.extra,o=this.changeNodeId,s={parentId:r,isReadonly:t,extra:i};if(n instanceof N)s.isCustomized=!1,s.title=n.title;else{if(!(n instanceof M))throw new Error("node 的类型出错");s.isCustomized=!0,s.width=n.width,s.height=n.height}return e?Object.assign({},s,{get id(){return n.id},setId:function(e){o(n.id,e)}}):Object.assign({},s,{id:n.id})},cloneNodes:function(n,e){var r=this;return void 0===e&&(e=!1),n.map((function(n){return r.cloneNode(n,e)}))},changeNodeId:function(n,e){this.nodes.find((function(e){return e.id===n})).id=e,E.findNodeFromTree(n,this.tree).id=e},cloneResource:function(n,e,r){void 0===r&&(r=!1);var t=new S(n),i=this.changeResourceId;return r?Object.assign({},t,{get id(){return t.id},setId:function(n){i(e,t.id,n)}}):Object.assign({},t,{id:t.id})},cloneFontStyle:function(n,e){return{nodeId:e,bold:n.bold,italic:n.italic,underline:n.underline,color:n.color}},changeResourceId:function(n,e,r){this.nodes.find((function(e){return e.id===n})).resources.find((function(n){return n.id===e})).id=r},moveForward:function(n,e){e>0&&(n[e]=n.splice(e-1,1,n[e])[0])},moveBackward:function(n,e){e<n.length-1&&(n[e]=n.splice(e+1,1,n[e])[0])},toMapStyles:function(){return{width:this.mapSize.width,height:this.mapSize.height,scale:this.scaleValue,top:this.mindmapMoveY,left:this.mindmapMoveX}}}},Ye=$e,Ue=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{ref:"mind-map",staticClass:"mind-map",class:{debugging:n.IS_DEBUGGING,"full-screen":n.isFullScreen},style:Object.assign({},n.mindmapStyle,{"z-index":n.fullScreenMapZIndex})},[r("div",{staticClass:"main",style:{height:n.mainHeight}},[n.isRightScrollBarAvalible?r("ScrollBar",{attrs:{isHorizontal:!1,scrollLength:n.scrollHeightFinal,clientLength:n.scrollInfo.clientHeight,scrollDistance:n.scrollTop,hasNeighbor:n.isBottomScrollBarAvalible},on:{"mouse-drag":function(e){for(var r=arguments,t=arguments.length,i=Array(t);t--;)i[t]=r[t];return n.onScrollBarMouseDrag.apply(void 0,[!1].concat(i))},"scroll-bar-blank-click":n.onRightScrollBarBlankClick}}):n._e(),n._v(" "),n.isBottomScrollBarAvalible?r("ScrollBar",{attrs:{isHorizontal:!0,scrollLength:n.scrollWidthFinal,clientLength:n.scrollInfo.clientWidth,scrollDistance:n.scrollLeft,hasNeighbor:n.isRightScrollBarAvalible},on:{"mouse-drag":function(e){for(var r=arguments,t=arguments.length,i=Array(t);t--;)i[t]=r[t];return n.onScrollBarMouseDrag.apply(void 0,[!0].concat(i))},"scroll-bar-blank-click":n.onBottomScrollBarBlankClick}}):n._e(),n._v(" "),r("div",{ref:"scroll-frame",staticClass:"scroll-frame",class:{horizontal:n.isHorizontal,vertical:!n.isHorizontal},style:Object.assign({},n.scrollFrameStyle),on:{click:n.onScrollFrameClick,mousedown:n.onScrollFrameMousedown2}},[r("ScopeSelectionFrame",{ref:"selection-frame",attrs:{isVisible:n.selectionFrame.isVisible,borderWidth:n.selectionFrame.borderWidth}}),n._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:n.selectionFrame.isMaskAvalible,expression:"selectionFrame.isMaskAvalible"}],ref:"selection-frame-mask",staticClass:"selection-frame-mask",style:Object.assign({},n.selectionFrameMaskStyle)}),n._v(" "),r("div",{ref:"map",staticClass:"map",style:{width:n.mapSize.width+"px",height:n.mapSize.height+"px",transform:"scale("+n.scaleValue+", "+n.scaleValue+")",top:n.mindmapMoveY+"px",left:n.mindmapMoveX+"px"}},[r("div",{ref:"container",staticClass:"container",style:{width:n.mindmapScopeWidth+"px",height:n.mindmapScopeHeight+"px",top:n.paddingTb+"px",left:n.paddingLr+"px"},on:{click:function(e){return e.target!==e.currentTarget?null:n.onContainerClick.apply(null,arguments)}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:n.isCursorDisplay,expression:"isCursorDisplay"}],ref:"cursor",staticClass:"cursor",style:{width:n.cursorSize.w+"px",height:n.cursorSize.h+"px"}}),n._v(" "),r("div",{ref:"cursor-move-mask",staticClass:"cursor-move-mask",style:{width:n.cursorMoveMaskSize.width+"px",height:n.cursorMoveMaskSize.height+"px",top:-n.paddingTb+"px",left:-n.paddingLr+"px"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:n.IS_DEBUGGING||n.isCursorDisplay,expression:"IS_DEBUGGING || isCursorDisplay"}],staticClass:"drop-zone-area",style:{top:n.paddingTb+"px",left:n.paddingLr+"px"}},[n._l(n.nodes,(function(e){return[e.isVisible&&!n.unOffspringDroppableNodes.map((function(n){return n.id})).includes(e.id)?r("div",{key:e.id,staticClass:"offspring-drop-zone",class:{enter:e.id===n.currOffspringDropZoneMouseenterNodeId},style:{top:e.dropZoneMinY+"px",left:e.dropZoneMinX+"px",width:e.dropZoneWidth+"px",height:e.dropZoneHeight+"px"},on:{mouseenter:function(r){return n.onNodeDropZoneMaskMouseenter(r,e)},mouseleave:function(r){return n.onNodeDropZoneMaskMouseleave(r,e)}}}):n._e()]})),n._v(" "),r("SiblingDropZones",{attrs:{IS_DEBUGGING:n.IS_DEBUGGING,siblingNodes:n.siblingsOfCurrDraggingNode,isHorizontalLayout:n.isHorizontal,currDraggingNode:n.currDraggingNode},on:{"nodes-reorder":n.onNodesReorder}})],2)]),n._v(" "),n._l(n.nodes,(function(e){return[e.isVisible?r("MindMapNode",{key:e.id,ref:"node-"+e.id,refInFor:!0,staticClass:"mind-map-node",attrs:{node:e,currActiveNodeIds:n.currActiveNodeIds,currEditingNodeId:n.currEditingNodeId,currDraggingNode:n.currDraggingNode,isHorizontalLayout:n.isHorizontal,forbiddenHoveringNodeIds:n.forbiddenHoveringNodeIds,allowDrop:n.allowDrop,titleAttrName:n.titleAttrName,viewWidth:n.scrollInfo.clientWidth,viewHeight:n.scrollInfo.clientHeight,viewTop:n.scrollTop,viewLeft:n.scrollLeft,isNodeHide:n.isNodeHide},on:{"node-mousedown":n.onNodeMouseDown,"node-mouseenter":n.onNodeMouseEnter,"node-mouseleave":n.onNodeMouseLeave,"node-mouseclick":n.onNodeMouseClick,"node-dragenter":function(r){return n.onNodeDragenter(e,r)},"node-dragleave":function(r){return n.onNodeDragleave(e,r)},"node-dragover":function(r){return n.onNodeDragover(e,r)},"node-drop":function(r){return n.onNodeDrop(e,r)},"enter-press":n.onEditingNodeEnterPress,"title-changed":function(r){return n.onNodeTitleChanged(e,r)},"btn-plus-click":n.onNodeBtnPlusClick,"node-title-dbclick-to-edit":n.onNodeTitleDbClickToEdit,"node-pic-drag-dot-mousedown":function(r){for(var t=arguments,i=arguments.length,o=Array(i);i--;)o[i]=t[i];return n.onNodePicDragDotMousedown.apply(void 0,[e].concat(o))},"node-pic-preview-click":function(r){return n.onNodePicSinglePreviewClick(e,r)},"node-video-drag-dot-mousedown":function(r){for(var t=arguments,i=arguments.length,o=Array(i);i--;)o[i]=t[i];return n.onNodeVideoDragDotMousedown.apply(void 0,[e].concat(o))},"node-video-play-click":function(r){return n.onNodeVideoPlayClick(e,r)},"resource-delete-click":n.onResourceDeleteClick,"resource-forward-click":n.onResourceForwardClick,"resource-backward-click":n.onResourceBackwardClick,"btn-fold-click":n.onBtnFoldAndUnfoldClick,"node-hovering":n.onNodeHovering,"node-hovering-cancel":n.onNodeHoveringCancel,"btn-insert-img-click":n.onBtnInsertImgClick,"btn-insert-video-click":n.onBtnInsertVideoClick,"btn-insert-file-click":n.onBtnInsertFileClick,"btn-add-sibling-click":n.onBtnAddSiblingClick,"btn-del-node-click":n.onBtnDelNodeClick,"btn-bold-click":n.onBtnBoldClick,"btn-italic-click":n.onBtnItalicClick,"btn-underline-click":n.onBtnUnderlineClick,"btn-eraser-click":n.onBtnEraserClick,"btn-bgcolor-click":n.onBtnBgcolorClick},scopedSlots:n._u([{key:"default",fn:function(e){return[n._t("default",null,null,e)]}}],null,!0)}):n._e()]})),n._v(" "),n.isScopeFrameDisplay?r("ScopeFrame",{staticClass:"scope-frame",attrs:{top:n.scopeFramePos.y,left:n.scopeFramePos.x,width:n.scopeFrameSize.w,height:n.scopeFrameSize.h}}):n._e()],2),n._v(" "),r("canvas",{ref:"canvas",staticClass:"canvas",style:{top:n.paddingTb+"px",left:n.paddingLr+"px"},attrs:{width:n.mindmapScopeWidth+"px",height:n.mindmapScopeHeight+"px"}}),n._v(" "),r("canvas",{ref:"canvas-offspring-temp-line",staticClass:"canvas canvas-offspring-temp-line",style:{top:n.offspringTempLineCanvas.top+n.paddingTb+"px",left:n.offspringTempLineCanvas.left+n.paddingLr+"px"},attrs:{width:n.offspringTempLineCanvas.width+"px",height:n.offspringTempLineCanvas.height+"px"}})]),n._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:n.isMovingMode,expression:"isMovingMode"}],ref:"map-move-mask",staticClass:"map-move-mask",class:{"moving-mode":n.isMovingMode},style:{width:n.mapMoveMaskSize.width+"px",height:n.mapMoveMaskSize.height+"px"},on:{mousedown:n.onMapMoveMaskMousedown}})],1)],1),n._v(" "),n.isBottomBarVisible?r("div",{staticClass:"bottom",style:{height:n.bottomHeight}},[r("BottomBar",{ref:"bottom-bar",attrs:{scaleValue:n.scaleValue,isFullScreen:n.isFullScreen},on:{"update:scaleValue":function(e){n.scaleValue=e},"update:scale-value":function(e){n.scaleValue=e},"update:isFullScreen":function(e){n.isFullScreen=e},"update:is-full-screen":function(e){n.isFullScreen=e},"foucs-center-click":n.onFoucsCenterClick}})],1):n._e(),n._v(" "),r("MapOperation",{staticClass:"map-operation",attrs:{isBtnHorizontalActive:n.isHorizontal,isBtnVerticalActive:!n.isHorizontal,isBtnMoveCanvasActive:n.isMovingMode,isCurveLinesActive:n.isCurveLines,isStraightLinesActive:!n.isCurveLines},on:{"btn-horizontal-click":n.onBtnHorizontalClick,"btn-vertical-click":n.onBtnVerticalClick,"btn-move-canvas-click":n.onBtnMoveCanvasClick,"btn-curve-lines-click":n.onBtnCurveLinesClick,"btn-straight-lines-click":n.onBtnStraightLinesClick}}),n._v(" "),r("Previewer",{attrs:{url:n.currPreviewUrl,previewType:n.currPreviewType},on:{"update:previewType":function(e){n.currPreviewType=e},"update:preview-type":function(e){n.currPreviewType=e}}})],1)};Ue._withStripped=!0;var Ge=F({render:Ue,staticRenderFns:[]},(function(n){n&&n("data-v-127bc0d8_0",{source:"[data-v-127bc0d8]::-webkit-scrollbar {\n  width: 10px;\n  height: 10px;\n}\n[data-v-127bc0d8]::-webkit-scrollbar-track {\n  border-radius: 10px;\n  background: rgba(0, 0, 0, 0.03);\n}\n[data-v-127bc0d8]::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  background: rgba(0, 0, 0, 0.1);\n}\n[data-v-127bc0d8]::-webkit-scrollbar-thumb:hover {\n  background: rgba(0, 0, 0, 0.3);\n}\n[data-v-127bc0d8]::-webkit-scrollbar-thumb:active {\n  background: rgba(0, 0, 0, 0.5);\n}\nbody[data-v-127bc0d8] {\n  scrollbar-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.03);\n  scrollbar-width: thin;\n}\n.mind-map[data-v-127bc0d8] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  overflow: hidden;\n  background-color: #fff;\n}\n.mind-map .main[data-v-127bc0d8] {\n  width: 100%;\n  box-sizing: border-box;\n  position: relative;\n}\n.mind-map .main .scroll-frame[data-v-127bc0d8] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  overflow: clip;\n  display: flex;\n}\n.mind-map .main .scroll-frame .selection-frame-mask[data-v-127bc0d8] {\n  position: absolute;\n  z-index: 2000;\n}\n.mind-map .main .scroll-frame .map-move-mask[data-v-127bc0d8] {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.mind-map .main .scroll-frame .map-move-mask.moving-mode[data-v-127bc0d8] {\n  cursor: grab;\n}\n.mind-map .main .scroll-frame .map[data-v-127bc0d8] {\n  transform-origin: left top;\n  box-sizing: border-box;\n  position: relative;\n}\n.mind-map .main .scroll-frame .map .container[data-v-127bc0d8] {\n  transform-origin: left top;\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 0;\n}\n.mind-map .main .scroll-frame .map .container .cursor[data-v-127bc0d8] {\n  pointer-events: none;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  border-radius: 8px;\n  background-color: rgba(3, 79, 146, 0.5411764706);\n  cursor: grab;\n  z-index: 1200;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask[data-v-127bc0d8] {\n  transform-origin: left top;\n  position: absolute;\n  box-sizing: border-box;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area[data-v-127bc0d8] {\n  width: 0px;\n  height: 0px;\n  position: absolute;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area .offspring-drop-zone[data-v-127bc0d8] {\n  position: absolute;\n  z-index: 1000;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area .offspring-drop-zone.enter[data-v-127bc0d8] {\n  z-index: 900;\n}\n.mind-map .main .scroll-frame .map .canvas[data-v-127bc0d8] {\n  transform-origin: left top;\n  position: absolute;\n  z-index: -100;\n}\n.mind-map .main .scroll-frame .map .canvas.canvas-offspring-temp-line[data-v-127bc0d8] {\n  z-index: 1100;\n}\n.mind-map .bottom[data-v-127bc0d8] {\n  box-sizing: border-box;\n}\n.mind-map .map-operation[data-v-127bc0d8] {\n  position: absolute;\n  top: 8px;\n  left: 8px;\n}\n.mind-map .scope-frame[data-v-127bc0d8] {\n  position: absolute;\n}\n.mind-map.debugging .cursor-move-mask[data-v-127bc0d8] {\n  background-color: rgba(255, 0, 0, 0.4196078431);\n}\n.mind-map.debugging .offspring-drop-zone[data-v-127bc0d8] {\n  background-color: rgba(255, 255, 0, 0.5019607843);\n}\n\n/*# sourceMappingURL=MindMap.vue.map */",map:{version:3,sources:["MindMap.vue","E:\\_hub0\\MINDMAP\\bi-vue-mindmap\\src\\components\\MindMap.vue"],names:[],mappings:"AAAA;EACE,WAAW;EACX,YAAY;AACd;AAEA;EACE,mBAAmB;EACnB,+BAA+B;AACjC;AAEA;EACE,mBAAmB;EACnB,8BAA8B;AAChC;AAEA;EACE,8BAA8B;AAChC;AAEA;EACE,8BAA8B;AAChC;AAEA;EACE,uDAAuD;EACvD,qBAAqB;AACvB;AC8zGA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,sBAAA;EACA,gBAAA;EACA,sBAAA;AD3zGA;AC+zGA;EACA,WAAA;EAEA,sBAAA;EACA,kBAAA;AD9zGA;ACg0GA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,sBAAA;EACA,cAAA;EAGA,aAAA;ADh0GA;ACk0GA;EACA,kBAAA;EACA,aAAA;ADh0GA;AC+0GA;EAGA,kBAAA;EACA,QAAA;EACA,SAAA;AD/0GA;ACk1GA;EACA,YAAA;ADh1GA;ACo1GA;EACA,0BAAA;EACA,sBAAA;EACA,kBAAA;ADl1GA;ACo1GA;EACA,0BAAA;EACA,sBAAA;EACA,kBAAA;EACA,UAAA;ADl1GA;ACo1GA;EACA,oBAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,gDAAA;EACA,YAAA;EACA,aAAA;ADl1GA;AC21GA;EACA,0BAAA;EACA,kBAAA;EACA,sBAAA;EACA,UAAA;EACA,WAAA;EACA,QAAA;EACA,SAAA;ADz1GA;AC41GA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;AD11GA;AC61GA;EACA,kBAAA;EAEA,aAAA;AD51GA;AC61GA;EAEA,YAAA;AD51GA;ACu2GA;EACA,0BAAA;EACA,kBAAA;EACA,aAAA;ADr2GA;ACs2GA;EAEA,aAAA;ADr2GA;AC42GA;EAEA,sBAAA;AD32GA;AC82GA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;AD52GA;AC+2GA;EACA,kBAAA;AD72GA;ACm3GA;EACA,+CAAA;ADh3GA;ACk3GA;EACA,iDAAA;ADh3GA;;AAEA,sCAAsC",file:"MindMap.vue",sourcesContent:["::-webkit-scrollbar {\n  width: 10px;\n  height: 10px;\n}\n\n::-webkit-scrollbar-track {\n  border-radius: 10px;\n  background: rgba(0, 0, 0, 0.03);\n}\n\n::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  background: rgba(0, 0, 0, 0.1);\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: rgba(0, 0, 0, 0.3);\n}\n\n::-webkit-scrollbar-thumb:active {\n  background: rgba(0, 0, 0, 0.5);\n}\n\nbody {\n  scrollbar-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.03);\n  scrollbar-width: thin;\n}\n\n.mind-map {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  overflow: hidden;\n  background-color: #fff;\n}\n.mind-map .main {\n  width: 100%;\n  box-sizing: border-box;\n  position: relative;\n}\n.mind-map .main .scroll-frame {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  box-sizing: border-box;\n  overflow: clip;\n  display: flex;\n}\n.mind-map .main .scroll-frame .selection-frame-mask {\n  position: absolute;\n  z-index: 2000;\n}\n.mind-map .main .scroll-frame .map-move-mask {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.mind-map .main .scroll-frame .map-move-mask.moving-mode {\n  cursor: grab;\n}\n.mind-map .main .scroll-frame .map {\n  transform-origin: left top;\n  box-sizing: border-box;\n  position: relative;\n}\n.mind-map .main .scroll-frame .map .container {\n  transform-origin: left top;\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 0;\n}\n.mind-map .main .scroll-frame .map .container .cursor {\n  pointer-events: none;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  border-radius: 8px;\n  background-color: rgba(3, 79, 146, 0.5411764706);\n  cursor: grab;\n  z-index: 1200;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask {\n  transform-origin: left top;\n  position: absolute;\n  box-sizing: border-box;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  left: 0px;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area {\n  width: 0px;\n  height: 0px;\n  position: absolute;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area .offspring-drop-zone {\n  position: absolute;\n  z-index: 1000;\n}\n.mind-map .main .scroll-frame .map .container .cursor-move-mask .drop-zone-area .offspring-drop-zone.enter {\n  z-index: 900;\n}\n.mind-map .main .scroll-frame .map .canvas {\n  transform-origin: left top;\n  position: absolute;\n  z-index: -100;\n}\n.mind-map .main .scroll-frame .map .canvas.canvas-offspring-temp-line {\n  z-index: 1100;\n}\n.mind-map .bottom {\n  box-sizing: border-box;\n}\n.mind-map .map-operation {\n  position: absolute;\n  top: 8px;\n  left: 8px;\n}\n.mind-map .scope-frame {\n  position: absolute;\n}\n\n.mind-map.debugging .cursor-move-mask {\n  background-color: rgba(255, 0, 0, 0.4196078431);\n}\n.mind-map.debugging .offspring-drop-zone {\n  background-color: rgba(255, 255, 0, 0.5019607843);\n}\n\n/*# sourceMappingURL=MindMap.vue.map */",'\x3c!--\r\n * @Author: Billy\r\n * @Date: 2022-09-26 16:37:42\r\n * @LastEditors: Billy\r\n * @LastEditTime: 2023-05-18 15:03:39\r\n * @Description: 思维导图核心组件\r\n--\x3e\r\n\r\n<template>\r\n  <div\r\n    ref="mind-map"\r\n    class="mind-map"\r\n    :class="{ debugging: IS_DEBUGGING, \'full-screen\': isFullScreen }"\r\n    :style="{ ...mindmapStyle, \'z-index\': fullScreenMapZIndex }"\r\n  >\r\n    <div class="main" :style="{ height: mainHeight }">\r\n      <ScrollBar\r\n        v-if="isRightScrollBarAvalible"\r\n        :isHorizontal="false"\r\n        :scrollLength="scrollHeightFinal"\r\n        :clientLength="scrollInfo.clientHeight"\r\n        :scrollDistance="scrollTop"\r\n        :hasNeighbor="isBottomScrollBarAvalible"\r\n        @mouse-drag="onScrollBarMouseDrag(false, ...arguments)"\r\n        @scroll-bar-blank-click="onRightScrollBarBlankClick"\r\n      />\r\n\r\n      <ScrollBar\r\n        v-if="isBottomScrollBarAvalible"\r\n        :isHorizontal="true"\r\n        :scrollLength="scrollWidthFinal"\r\n        :clientLength="scrollInfo.clientWidth"\r\n        :scrollDistance="scrollLeft"\r\n        :hasNeighbor="isRightScrollBarAvalible"\r\n        @mouse-drag="onScrollBarMouseDrag(true, ...arguments)"\r\n        @scroll-bar-blank-click="onBottomScrollBarBlankClick"\r\n      />\r\n\r\n      <div\r\n        ref="scroll-frame"\r\n        class="scroll-frame"\r\n        :class="{ horizontal: isHorizontal, vertical: !isHorizontal }"\r\n        :style="{ ...scrollFrameStyle }"\r\n        @click="onScrollFrameClick"\r\n        @mousedown="onScrollFrameMousedown2"\r\n      >\r\n        \x3c!-- <div\r\n        ref="scroll-frame"\r\n        class="scroll-frame"\r\n        :class="{ horizontal: isHorizontal, vertical: !isHorizontal }"\r\n        :style="{ ...scrollFrameStyle }"\r\n        @click="onScrollFrameClick"\r\n      > --\x3e\r\n        <ScopeSelectionFrame\r\n          ref="selection-frame"\r\n          :isVisible="selectionFrame.isVisible"\r\n          :borderWidth="selectionFrame.borderWidth"\r\n        />\r\n        <div\r\n          ref="selection-frame-mask"\r\n          v-show="selectionFrame.isMaskAvalible"\r\n          class="selection-frame-mask"\r\n          :style="{ ...selectionFrameMaskStyle }"\r\n        ></div>\r\n        <div\r\n          ref="map"\r\n          class="map"\r\n          :style="{\r\n            width: `${mapSize.width}px`,\r\n            height: `${mapSize.height}px`,\r\n            transform: `scale(${scaleValue}, ${scaleValue})`,\r\n            top: `${mindmapMoveY}px`,\r\n            left: `${mindmapMoveX}px`,\r\n          }"\r\n        >\r\n          <div\r\n            ref="container"\r\n            class="container"\r\n            :style="{\r\n              width: `${mindmapScopeWidth}px`,\r\n              height: `${mindmapScopeHeight}px`,\r\n              top: `${paddingTb}px`,\r\n              left: `${paddingLr}px`,\r\n            }"\r\n            @click.self="onContainerClick"\r\n          >\r\n            <div\r\n              v-show="isCursorDisplay"\r\n              ref="cursor"\r\n              class="cursor"\r\n              :style="{\r\n                width: cursorSize.w + \'px\',\r\n                height: cursorSize.h + \'px\',\r\n              }"\r\n            ></div>\r\n\r\n            <div\r\n              ref="cursor-move-mask"\r\n              class="cursor-move-mask"\r\n              :style="{\r\n                width: `${cursorMoveMaskSize.width}px`,\r\n                height: `${cursorMoveMaskSize.height}px`,\r\n                top: `${-paddingTb}px`,\r\n                left: `${-paddingLr}px`,\r\n              }"\r\n            >\r\n              <div\r\n                v-show="IS_DEBUGGING || isCursorDisplay"\r\n                class="drop-zone-area"\r\n                :style="{\r\n                  top: `${paddingTb}px`,\r\n                  left: `${paddingLr}px`,\r\n                }"\r\n              >\r\n                <template v-for="n in nodes">\r\n                  <div\r\n                    v-if="\r\n                      n.isVisible &&\r\n                      !unOffspringDroppableNodes.map((n) => n.id).includes(n.id)\r\n                    "\r\n                    class="offspring-drop-zone"\r\n                    :class="{\r\n                      enter: n.id === currOffspringDropZoneMouseenterNodeId,\r\n                    }"\r\n                    :key="n.id"\r\n                    :style="{\r\n                      top: `${n.dropZoneMinY}px`,\r\n                      left: `${n.dropZoneMinX}px`,\r\n                      width: `${n.dropZoneWidth}px`,\r\n                      height: `${n.dropZoneHeight}px`,\r\n                    }"\r\n                    @mouseenter="onNodeDropZoneMaskMouseenter($event, n)"\r\n                    @mouseleave="onNodeDropZoneMaskMouseleave($event, n)"\r\n                  ></div>\r\n                </template>\r\n\r\n                <SiblingDropZones\r\n                  :IS_DEBUGGING="IS_DEBUGGING"\r\n                  :siblingNodes="siblingsOfCurrDraggingNode"\r\n                  :isHorizontalLayout="isHorizontal"\r\n                  :currDraggingNode="currDraggingNode"\r\n                  @nodes-reorder="onNodesReorder"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <template v-for="n in nodes">\r\n              <MindMapNode\r\n                v-slot="node"\r\n                class="mind-map-node"\r\n                v-if="n.isVisible"\r\n                :ref="\'node-\' + n.id"\r\n                :key="n.id"\r\n                :node="n"\r\n                :currActiveNodeIds="currActiveNodeIds"\r\n                :currEditingNodeId="currEditingNodeId"\r\n                :currDraggingNode="currDraggingNode"\r\n                :isHorizontalLayout="isHorizontal"\r\n                :forbiddenHoveringNodeIds="forbiddenHoveringNodeIds"\r\n                :allowDrop="allowDrop"\r\n                :titleAttrName="titleAttrName"\r\n                :viewWidth="scrollInfo.clientWidth"\r\n                :viewHeight="scrollInfo.clientHeight"\r\n                :viewTop="scrollTop"\r\n                :viewLeft="scrollLeft"\r\n                :isNodeHide="isNodeHide"\r\n                @node-mousedown="onNodeMouseDown"\r\n                @node-mouseenter="onNodeMouseEnter"\r\n                @node-mouseleave="onNodeMouseLeave"\r\n                @node-mouseclick="onNodeMouseClick"\r\n                @node-dragenter="onNodeDragenter(n, $event)"\r\n                @node-dragleave="onNodeDragleave(n, $event)"\r\n                @node-dragover="onNodeDragover(n, $event)"\r\n                @node-drop="onNodeDrop(n, $event)"\r\n                @enter-press="onEditingNodeEnterPress"\r\n                @title-changed="onNodeTitleChanged(n, $event)"\r\n                @btn-plus-click="onNodeBtnPlusClick"\r\n                @node-title-dbclick-to-edit="onNodeTitleDbClickToEdit"\r\n                @node-pic-drag-dot-mousedown="\r\n                  onNodePicDragDotMousedown(n, ...arguments)\r\n                "\r\n                @node-pic-preview-click="onNodePicSinglePreviewClick(n, $event)"\r\n                @node-video-drag-dot-mousedown="\r\n                  onNodeVideoDragDotMousedown(n, ...arguments)\r\n                "\r\n                @node-video-play-click="onNodeVideoPlayClick(n, $event)"\r\n                @resource-delete-click="onResourceDeleteClick"\r\n                @resource-forward-click="onResourceForwardClick"\r\n                @resource-backward-click="onResourceBackwardClick"\r\n                @btn-fold-click="onBtnFoldAndUnfoldClick"\r\n                @node-hovering="onNodeHovering"\r\n                @node-hovering-cancel="onNodeHoveringCancel"\r\n                @btn-insert-img-click="onBtnInsertImgClick"\r\n                @btn-insert-video-click="onBtnInsertVideoClick"\r\n                @btn-insert-file-click="onBtnInsertFileClick"\r\n                @btn-add-sibling-click="onBtnAddSiblingClick"\r\n                @btn-del-node-click="onBtnDelNodeClick"\r\n                @btn-bold-click="onBtnBoldClick"\r\n                @btn-italic-click="onBtnItalicClick"\r\n                @btn-underline-click="onBtnUnderlineClick"\r\n                @btn-eraser-click="onBtnEraserClick"\r\n                @btn-bgcolor-click="onBtnBgcolorClick"\r\n              >\r\n                <slot v-bind="node"></slot>\r\n              </MindMapNode>\r\n            </template>\r\n\r\n            <ScopeFrame\r\n              v-if="isScopeFrameDisplay"\r\n              class="scope-frame"\r\n              :top="scopeFramePos.y"\r\n              :left="scopeFramePos.x"\r\n              :width="scopeFrameSize.w"\r\n              :height="scopeFrameSize.h"\r\n            />\r\n          </div>\r\n\r\n          <canvas\r\n            ref="canvas"\r\n            class="canvas"\r\n            :width="`${mindmapScopeWidth}px`"\r\n            :height="`${mindmapScopeHeight}px`"\r\n            :style="{ top: `${paddingTb}px`, left: `${paddingLr}px` }"\r\n          ></canvas>\r\n\r\n          <canvas\r\n            ref="canvas-offspring-temp-line"\r\n            class="canvas canvas-offspring-temp-line"\r\n            :width="`${offspringTempLineCanvas.width}px`"\r\n            :height="`${offspringTempLineCanvas.height}px`"\r\n            :style="{\r\n              top: `${offspringTempLineCanvas.top + paddingTb}px`,\r\n              left: `${offspringTempLineCanvas.left + paddingLr}px`,\r\n            }"\r\n          ></canvas>\r\n        </div>\r\n\r\n        <div\r\n          v-show="isMovingMode"\r\n          ref="map-move-mask"\r\n          class="map-move-mask"\r\n          :class="{ \'moving-mode\': isMovingMode }"\r\n          :style="{\r\n            width: `${mapMoveMaskSize.width}px`,\r\n            height: `${mapMoveMaskSize.height}px`,\r\n          }"\r\n          @mousedown="onMapMoveMaskMousedown"\r\n        ></div>\r\n      </div>\r\n    </div>\r\n\r\n    <div\r\n      class="bottom"\r\n      v-if="isBottomBarVisible"\r\n      :style="{ height: bottomHeight }"\r\n    >\r\n      <BottomBar\r\n        ref="bottom-bar"\r\n        :scaleValue.sync="scaleValue"\r\n        :isFullScreen.sync="isFullScreen"\r\n        @foucs-center-click="onFoucsCenterClick"\r\n      />\r\n    </div>\r\n\r\n    <MapOperation\r\n      class="map-operation"\r\n      :isBtnHorizontalActive="isHorizontal"\r\n      :isBtnVerticalActive="!isHorizontal"\r\n      :isBtnMoveCanvasActive="isMovingMode"\r\n      :isCurveLinesActive="isCurveLines"\r\n      :isStraightLinesActive="!isCurveLines"\r\n      @btn-horizontal-click="onBtnHorizontalClick"\r\n      @btn-vertical-click="onBtnVerticalClick"\r\n      @btn-move-canvas-click="onBtnMoveCanvasClick"\r\n      @btn-curve-lines-click="onBtnCurveLinesClick"\r\n      @btn-straight-lines-click="onBtnStraightLinesClick"\r\n    />\r\n\r\n    <Previewer :url="currPreviewUrl" :previewType.sync="currPreviewType" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport myStore from "../store";\r\nimport {\r\n  TYPES,\r\n  LAYOUT_TYPES,\r\n  DEFAULT_LAYOUT,\r\n  DEFAULT_FONT_SIZE,\r\n  DEFAULT_FONT_FAMILY,\r\n  SCROLL_SCALE_UNIT,\r\n  SCROLL_BAR_SIZE,\r\n} from "../const.js";\r\n// import Node from "../entities/NormalNode.js";\r\nimport NormalNode from "../entities/NormalNode.js";\r\nimport CustomizedNode from "../entities/CustomizedNode.js";\r\nimport Resource from "../entities/Resource.js";\r\nimport FontStyle from "../entities/FontStyle.js";\r\n\r\nimport Matrix from "../algorithm/Matrix.js";\r\nimport EncryptionHelper from "../util/EncryptionHelper.js";\r\nimport FileHelper from "../util/FileHelper.js";\r\nimport EasingFunc from "../algorithm/EasingFunc.js";\r\n\r\nimport MindMapNode from "../components/MindMap/Node.vue";\r\nimport MapOperation from "../components/MindMap/Btns/MapOperation.vue";\r\nimport ScopeFrame from "../components/MindMap/Other/ScopeFrame.vue";\r\nimport Previewer from "../components/MindMap/Previewer/Previewer.vue";\r\nimport BottomBar from "../components/MindMap/Other/BottomBar.vue";\r\nimport ScrollBar from "../components/MindMap/Other/ScrollBar.vue";\r\nimport SiblingDropZones from "../components/MindMap/Other/SiblingDropZones.vue";\r\nimport ScopeSelectionFrame from "../components/MindMap/Other/ScopeSelectionFrame.vue";\r\n\r\nimport HistoryBiz from "../biz/History.js";\r\n\r\nconst IS_DEBUGGING = false; // 当前是否正处于开发调试当中(编译前记得标记为false)\r\nconst CURSOR_MOUSE_MOVE_DISTANCE = 10; // 鼠标移动多长距离，cursor才出现\r\nconst CANVAS_STROKE_STYLE = "#338AFF";\r\nconst CANVAS_LINE_WIDTH = 2;\r\n\r\n// let gScrollWidth = 0; // 可滚动区域宽度\r\n// let gScrollHeight = 0; // 可滚动区域高度\r\n// let gScrollWidthFinal = 0;\r\n// let gScrollHeightFinal = 0;\r\n\r\n// let gScrollLeft = 0; // 脑图容器的左右偏移\r\n// let gScrollTop = 0; // 脑图容器的上下偏移\r\n// let gScrollLeftFinal = 0;\r\n// let gScrollTopFinal = 0;\r\n\r\n// let gMapMoveOffsetLeft = 0;\r\n// let gMapMoveOffsetTop = 0;\r\n\r\nconst DEFAULT_PARENT_NODE = {\r\n  // id: "1",\r\n  parentId: null,\r\n  title: "",\r\n};\r\n\r\nexport default {\r\n  components: {\r\n    MindMapNode,\r\n    MapOperation,\r\n    ScopeFrame,\r\n    Previewer,\r\n    BottomBar,\r\n    ScrollBar,\r\n    SiblingDropZones,\r\n    ScopeSelectionFrame,\r\n  },\r\n  props: {\r\n    // ------------------------------- 以下对外公开 -------------------------------\r\n    // 节点数据(扁平数组)\r\n    flatNodes: { type: Array, default: () => [DEFAULT_PARENT_NODE] },\r\n    // 是否全局只读\r\n    isReadonly: { type: Boolean, default: false },\r\n    // 默认展示的布局方式(横向/竖向)\r\n    defaultLayout: {\r\n      type: String,\r\n      default:\r\n        DEFAULT_LAYOUT === LAYOUT_TYPES.HORIZONTAL ? "horizontal" : "vertical",\r\n      validator: (v) => ["horizontal", "vertical"].includes(v),\r\n    },\r\n    // 默认的节点间连线样式\r\n    defaultLineStyle: {\r\n      type: String,\r\n      default: "curve",\r\n      validator: (v) => ["curve", "straight"].includes(v),\r\n    },\r\n\r\n    // 默认的节点间连线的颜色(以 # 开头的十六进制颜色)\r\n    defaultLineColor: {\r\n      type: String,\r\n      default: CANVAS_STROKE_STYLE,\r\n      validator: (v) => {\r\n        // 正则表达式检测是否符合 #RRGGBB 或 #RGB 格式\r\n        const hexColorPattern = /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;\r\n        return hexColorPattern.test(v);\r\n      },\r\n    },\r\n\r\n    // 是否允许往节点拖放东西\r\n    allowDrop: { type: Boolean, default: false },\r\n    // 是否隐藏底部工具栏\r\n    isBottomBarVisible: { type: Boolean, default: true },\r\n\r\n    // 不在视窗范围内的节点是否渲染，取值范围["none", "vshow", "vif"]\r\n    isNodeHide: {\r\n      type: String,\r\n      default: "vif",\r\n      validator: function (value) {\r\n        return ["none", "vshow", "vif"].includes(value);\r\n      },\r\n    },\r\n\r\n    // --------------------------------------------------------------------------------------\r\n\r\n    // 是否允许多选节点\r\n    isMultipleSelectAllowed: { type: Boolean, default: false },\r\n    // 全屏显示时，导图最上层 div 的 z-index 值\r\n    fullScreenMapZIndex: { type: Number, default: 1000 },\r\n    // 文字大小\r\n    fontSize: { type: Number, default: DEFAULT_FONT_SIZE },\r\n    // 文字字体\r\n    fontFamily: { type: String, default: DEFAULT_FONT_FAMILY },\r\n    // 思维导图的左右内边距\r\n    paddingLr: { type: Number, default: 16 },\r\n    // 思维导图的上下内边距\r\n    paddingTb: { type: Number, default: 40 },\r\n\r\n    // --------------------------------------------------------------------------------------\r\n\r\n    // child-added 事件的前置钩子\r\n    beforeChildAdded: { type: Function, default: async () => true },\r\n    // sibling-added 事件的前置钩子\r\n    beforeSiblingAdded: { type: Function, default: async () => true },\r\n    // img-inserted 事件的前置钩子\r\n    beforeImgInserted: { type: Function, default: async () => true },\r\n    // video-inserted 事件的前置钩子\r\n    beforeVideoInserted: { type: Function, default: async () => true },\r\n    // file-inserted 事件的前置钩子\r\n    beforeFileInserted: { type: Function, default: async () => true },\r\n    // change-parent 事件的前置钩子\r\n    beforeChangeParent: { type: Function, default: async () => true },\r\n\r\n    // --------------------------------------------------------------------------------------\r\n\r\n    // Node对象中代表title的字段的字段名(对自定义节点无效)\r\n    titleAttrName: { type: String, default: "title" },\r\n  },\r\n  data() {\r\n    return {\r\n      IS_DEBUGGING,\r\n\r\n      bottomBarHeight: 32,\r\n\r\n      nodes: [], // 节点数据(扁平数组)\r\n      tree: [], // 节点扁平数据转换而来的树型数据\r\n      links: [], // 链接线数据\r\n\r\n      // currActiveNodeId: "", // 当前激活的Node对象id\r\n      currActiveNodeIds: [], // 当前激活的所有 Node 对象的 id\r\n\r\n      currEditingNodeId: "", // 当前正在编辑名称的节点id\r\n\r\n      scaleValue: 1, // 导图缩放比例(0~1)\r\n      isFullScreen: false, // 导图是否全屏\r\n\r\n      currDraggingNode: null, // 当前正在被拖动的节点\r\n      cursorPos: { x: 0, y: 0 }, // 跟随鼠标的游标的当前位置\r\n      cursorSize: { w: 36, h: 16 }, // 跟随鼠标的游标的大小\r\n\r\n      isScopeFrameDisplay: false, // 不可成为当前拖动节点的父节点的节点范围框\r\n      scopeFramePos: { x: 0, y: 0 },\r\n      scopeFrameSize: { w: 0, h: 0 },\r\n\r\n      isHorizontal: true, // 横向布局(true)还是竖向布局(false)\r\n      isMovingMode: false, // 当前是否处于平移画布模式\r\n      isCurveLines: this.defaultLineStyle === "curve" ? true : false, // 当前连线是曲线还是直角线\r\n\r\n      currPreviewType: "",\r\n      // 当前正在预览的图片的信息\r\n      currPicPreview: {\r\n        urls: [],\r\n        // visible: false,\r\n      },\r\n      // 当前正在预览的视频的信息\r\n      currVideoPlay: {\r\n        url: "",\r\n        // visible: false,\r\n      },\r\n\r\n      // canvas 的左上角和右下角的坐标\r\n      mindmapScope: {\r\n        minX: 0,\r\n        minY: 0,\r\n        maxX: 0,\r\n        maxY: 0,\r\n      },\r\n\r\n      // 脑图平移遮罩的尺寸\r\n      mapMoveMaskSize: {\r\n        width: 0,\r\n        height: 0,\r\n      },\r\n\r\n      // 节点移动游标的遮罩尺寸\r\n      cursorMoveMaskSize: {\r\n        width: 0,\r\n        height: 0,\r\n      },\r\n\r\n      // 当前鼠标进入的可连线区域所属的节点id\r\n      currOffspringDropZoneMouseenterNodeId: "",\r\n\r\n      // 用于绘制拖动节点时和潜在父节点之间的临时连线的 canvas\r\n      offspringTempLineCanvas: {\r\n        top: 0,\r\n        left: 0,\r\n        width: 0,\r\n        height: 0,\r\n      },\r\n\r\n      // 不能作为当前拖动节点的父节点的节点集合\r\n      unOffspringDroppableNodes: [],\r\n\r\n      // 当前正在被鼠标悬停的节点对象\r\n      currHoveringNode: null,\r\n\r\n      // 脑图容器是否比滚动容器的可视区域大\r\n      isMindmapBiggerThanScrollFrame: false,\r\n\r\n      selectionFrame: {\r\n        isVisible: false, // 多选框是否显示\r\n        isMaskAvalible: false,\r\n        borderWidth: 2, // 多选框的边框厚度\r\n        start: { x: 0, y: 0 }, // 起始点坐标\r\n        end: { x: 0, y: 0 }, // 结束点坐标\r\n      },\r\n\r\n      // scroll-frame 的尺寸数据\r\n      scrollInfo: {\r\n        clientWidth: 0, // 可视区域宽度\r\n        clientHeight: 0, // 可视区域高度\r\n      },\r\n\r\n      scrollWidth: 0, // 可滚动区域宽度\r\n      scrollHeight: 0, // 可滚动区域高度\r\n      scrollWidthFinal: 0,\r\n      scrollHeightFinal: 0,\r\n\r\n      scrollTop: 0, // 脑图容器的上下偏移\r\n      scrollLeft: 0, // 脑图容器的左右偏移\r\n      // scrollTopFinal: 0,\r\n      // scrollLeftFinal: 0,\r\n\r\n      mapMoveOffsetLeft: 0,\r\n      mapMoveOffsetTop: 0,\r\n\r\n      // ----------------------------------\r\n\r\n      // 用于记录 mindmap 尺寸更新前后的变化(用于判断 scrollTop 和 scrollLeft 是否需要缩减)\r\n      mindmapScopeRecord: {\r\n        wBefore: 0,\r\n        hBefore: 0,\r\n        wCurrent: 0,\r\n        hCurrent: 0,\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    // scrollWidthFinal: function () {\r\n    //   return this.scrollWidth + Math.abs(this.mapMoveOffsetLeft);\r\n    // },\r\n    // scrollHeightFinal: function () {\r\n    //   return this.scrollHeight + Math.abs(this.mapMoveOffsetTop);\r\n    // },\r\n\r\n    mainHeight: function () {\r\n      if (this.isBottomBarVisible)\r\n        return `calc(100% - ${this.bottomBarHeight}px)`;\r\n      else return `100%`;\r\n    },\r\n\r\n    bottomHeight: function () {\r\n      if (this.isBottomBarVisible) return `${this.bottomBarHeight}px`;\r\n      else return undefined;\r\n    },\r\n\r\n    scrollTopFinal: function () {\r\n      return this.scrollTop + this.mapMoveOffsetTop;\r\n    },\r\n    scrollLeftFinal: function () {\r\n      return this.scrollLeft + this.mapMoveOffsetLeft;\r\n    },\r\n\r\n    scrollTopCalc: function () {\r\n      return this.scrollTop;\r\n    },\r\n    scrollLeftCalc: function () {\r\n      return this.scrollLeft;\r\n    },\r\n\r\n    // 右滚动条最大滚动/拖动距离\r\n    rightScrollBarMaxScrollDistance: function () {\r\n      if (this.scrollHeightFinal > this.scrollInfo.clientHeight)\r\n        return this.scrollHeightFinal - this.scrollInfo.clientHeight;\r\n      else return 0;\r\n    },\r\n    // 底滚动条最大滚动/拖动距离\r\n    bottomScrollBarMaxScrollDistance: function () {\r\n      if (this.scrollWidthFinal > this.scrollInfo.clientWidth)\r\n        return this.scrollWidthFinal - this.scrollInfo.clientWidth;\r\n      else return 0;\r\n    },\r\n\r\n    // 右侧是否需要滚动条\r\n    isRightScrollBarAvalible: function () {\r\n      return !!this.rightScrollBarMaxScrollDistance;\r\n    },\r\n    // 底部是否需要滚动条\r\n    isBottomScrollBarAvalible: function () {\r\n      return !!this.bottomScrollBarMaxScrollDistance;\r\n    },\r\n\r\n    // 脑图的宽\r\n    mindmapScopeWidth: function () {\r\n      // return this.mindmapScope.maxX - this.mindmapScope.minX;\r\n      return this._calcMindmapScopeWidth();\r\n    },\r\n    // 脑图的高\r\n    mindmapScopeHeight: function () {\r\n      // return this.mindmapScope.maxY - this.mindmapScope.minY;\r\n      return this._calcMindmapScopeHeight();\r\n    },\r\n\r\n    // 脑图容器的偏移量X\r\n    mindmapMoveX: function () {\r\n      return -this.scrollLeftFinal + 0;\r\n    },\r\n    // 脑图容器的偏移量Y\r\n    mindmapMoveY: function () {\r\n      return -this.scrollTopFinal + 0;\r\n    },\r\n\r\n    // 跟随鼠标的游标是否显示\r\n    isCursorDisplay: function () {\r\n      return !!this.currDraggingNode;\r\n    },\r\n    // 当前正在拖动的节点的兄弟节点集合\r\n    siblingsOfCurrDraggingNode: function () {\r\n      if (this.currDraggingNode) {\r\n        return this.nodes\r\n          .filter((n) => n.parentId === this.currDraggingNode.parentId)\r\n          .sort((a, b) => a.orderNo - b.orderNo);\r\n      } else {\r\n        return [];\r\n      }\r\n    },\r\n    // 当前是否有节点正处于编辑当中\r\n    hasCurrEditing: function () {\r\n      return this.currEditingNodeId;\r\n    },\r\n    // 当前禁止鼠标悬浮高亮的节点列表\r\n    forbiddenHoveringNodeIds: function () {\r\n      return this.unOffspringDroppableNodes.map((n) => n.id);\r\n    },\r\n\r\n    mindmapStyle: function () {\r\n      if (this.isFullScreen)\r\n        return {\r\n          top: "0px",\r\n          left: "0px",\r\n          position: "fixed",\r\n        };\r\n      else return {};\r\n    },\r\n    // 脑图容器的可变尺寸\r\n    mapSize: function () {\r\n      let width = this.mindmapScopeWidth + this.paddingLr * 2;\r\n      let height = this.mindmapScopeHeight + this.paddingTb * 2;\r\n      if (this.isRightScrollBarAvalible) {\r\n        // 此时，右侧滚动条会挡掉右边一部分\r\n        width += SCROLL_BAR_SIZE;\r\n      }\r\n      if (this.isBottomScrollBarAvalible) {\r\n        // 此时，底部滚动条会挡掉底部一部分\r\n        height += SCROLL_BAR_SIZE;\r\n      }\r\n      return {\r\n        width,\r\n        height,\r\n      };\r\n    },\r\n\r\n    // 滚动容器的可变样式\r\n    scrollFrameStyle: function () {\r\n      if (this.isMindmapBiggerThanScrollFrame) {\r\n        return { "justify-content": "flex-start", "align-items": "flex-start" };\r\n      } else {\r\n        if (this.isHorizontal) {\r\n          return { "justify-content": "flex-start", "align-items": "center" };\r\n        } else {\r\n          return { "justify-content": "center", "align-items": "flex-start" };\r\n        }\r\n      }\r\n    },\r\n    // 多选框遮罩的可变样式\r\n    selectionFrameMaskStyle: function () {\r\n      let width, height;\r\n      if (this.isRightScrollBarAvalible)\r\n        width = `calc(100% - ${SCROLL_BAR_SIZE}px)`;\r\n      else width = "100%";\r\n\r\n      if (this.isBottomScrollBarAvalible)\r\n        height = `calc(100% - ${SCROLL_BAR_SIZE}px)`;\r\n      else height = "100%";\r\n\r\n      return { width, height };\r\n    },\r\n\r\n    currPreviewUrl: function () {\r\n      switch (this.currPreviewType) {\r\n        case TYPES.PIC: {\r\n          return this.currPicPreview.urls;\r\n        }\r\n        case TYPES.VIDEO: {\r\n          return this.currVideoPlay.url;\r\n        }\r\n        default:\r\n          return "";\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    flatNodes: {\r\n      immediate: true,\r\n      async handler(/* v, ov */) {\r\n        if (Array.isArray(this.flatNodes) && this.flatNodes.length === 0) {\r\n          this.flatNodes.push(DEFAULT_PARENT_NODE);\r\n        }\r\n        this.flatNodesToMyNodes();\r\n        await this.initialNodesAndLinks();\r\n      },\r\n    },\r\n    isReadonly: {\r\n      immediate: true,\r\n      handler(v) {\r\n        myStore.state.isGloballyReadonly = v;\r\n      },\r\n    },\r\n    isCursorDisplay: function (v) {\r\n      if (v) {\r\n        this.$nextTick(() => {\r\n          this.setCursorMoveMaskSize();\r\n        });\r\n      } else {\r\n        this.setCursorMoveMaskSizeZero();\r\n      }\r\n    },\r\n    isMovingMode: function (v) {\r\n      if (v) {\r\n        this.$nextTick(() => {\r\n          this.setMapMoveMaskSize();\r\n        });\r\n      } else {\r\n        this.setMapMoveMaskSizeZero();\r\n      }\r\n    },\r\n    isFullScreen: function (v) {\r\n      if (v) this.$emit("before-full-screen");\r\n      else this.$emit("before-cancel-full-screen");\r\n\r\n      this.$nextTick(() => {\r\n        this.getScrollInfo();\r\n      });\r\n    },\r\n\r\n    mindmapScopeRecord: {\r\n      immediate: false,\r\n      deep: true,\r\n      handler(/* v, ov */) {\r\n        if (\r\n          this.mindmapScopeRecord.wBefore > this.mindmapScopeRecord.wCurrent\r\n        ) {\r\n          const dif =\r\n            this.mindmapScopeRecord.wBefore - this.mindmapScopeRecord.wCurrent;\r\n          // 画布宽度缩小了,检查 scrollLeft 是否有值,有值的话需要扣除缩小了的宽度\r\n          if (this.scrollLeft > 0) {\r\n            // this.scrollLeft = this.scrollLeft < dif ? 0 : this.scrollLeft - dif;\r\n            let to;\r\n            if (this.scrollLeft < dif) to = 0;\r\n            else to = this.scrollLeft - dif;\r\n\r\n            this.$nextTick(() => {\r\n              this.moveCanvas({\r\n                fromNum: this.scrollLeft,\r\n                toNum: to,\r\n                callback: (newValue) => {\r\n                  // this.scrollLeft = newValue;\r\n                  const refMap = this.$refs["map"];\r\n                  refMap.style.left = `${-newValue}px`;\r\n                },\r\n                callbackWhenFinished: () => {\r\n                  this.scrollLeft = to;\r\n                },\r\n              });\r\n            });\r\n\r\n            // this.scrollLeft = to;\r\n          }\r\n        }\r\n\r\n        if (\r\n          this.mindmapScopeRecord.hBefore > this.mindmapScopeRecord.hCurrent\r\n        ) {\r\n          const dif =\r\n            this.mindmapScopeRecord.hBefore - this.mindmapScopeRecord.hCurrent;\r\n          // 画布高度缩小了,检查 scrollTop 是否有值,有值的话需要扣除缩小了的高度\r\n          if (this.scrollTop > 0) {\r\n            // this.scrollTop = this.scrollTop < dif ? 0 : this.scrollTop - dif;\r\n            let to;\r\n            if (this.scrollTop < dif) to = 0;\r\n            else to = this.scrollTop - dif;\r\n\r\n            this.$nextTick(() => {\r\n              this.moveCanvas({\r\n                fromNum: this.scrollTop,\r\n                toNum: to,\r\n                callback: (newValue) => {\r\n                  const refMap = this.$refs["map"];\r\n                  refMap.style.top = `${-newValue}px`;\r\n                },\r\n                callbackWhenFinished: () => {\r\n                  this.scrollTop = to;\r\n                },\r\n              });\r\n            });\r\n\r\n            // this.scrollTop = to;\r\n          }\r\n        }\r\n      },\r\n    },\r\n\r\n    mapSize: function (v) {\r\n      if (this.isHorizontal) {\r\n        if (this.scrollInfo.clientHeight < v.height) {\r\n          this.isMindmapBiggerThanScrollFrame = true;\r\n        } else {\r\n          this.isMindmapBiggerThanScrollFrame = false;\r\n        }\r\n      } else {\r\n        if (this.scrollInfo.clientWidth < v.width) {\r\n          this.isMindmapBiggerThanScrollFrame = true;\r\n        } else {\r\n          this.isMindmapBiggerThanScrollFrame = false;\r\n        }\r\n      }\r\n\r\n      this.$emit("map-style-change", this.toMapStyles());\r\n    },\r\n\r\n    scaleValue: function () {\r\n      this.$emit("map-style-change", this.toMapStyles());\r\n    },\r\n\r\n    mindmapMoveX: function () {\r\n      this.$emit("map-style-change", this.toMapStyles());\r\n    },\r\n\r\n    mindmapMoveY: function () {\r\n      this.$emit("map-style-change", this.toMapStyles());\r\n    },\r\n  },\r\n  created() {\r\n    this.isHorizontal = this.defaultLayout === "horizontal" ? true : false;\r\n  },\r\n  async beforeMount() {\r\n    // await this.initialNodesAndLinks();\r\n  },\r\n  async mounted() {\r\n    window.addEventListener("optimizedResize", this.onWindowResize);\r\n    window.addEventListener("keyup", this.onMindmapKeyup);\r\n\r\n    this.$refs["scroll-frame"].addEventListener(\r\n      "mousewheel",\r\n      this.onScrollFrameScroll,\r\n      { passive: false }\r\n    );\r\n\r\n    // this.$refs["mind-map"].addEventListener("keydown", async (event) => {\r\n    //   switch (event.key) {\r\n    //     case "Tab": {\r\n    //       console.log("tab");\r\n    //       break;\r\n    //     }\r\n    //   }\r\n    // });\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener("optimizedResize", this.onWindowResize);\r\n    window.removeEventListener("keyup", this.onMindmapKeyup);\r\n    this.$refs["scroll-frame"].removeEventListener(\r\n      "mousewheel",\r\n      this.onScrollFrameScroll\r\n    );\r\n  },\r\n  methods: {\r\n    // 通过节点id,获取节点的顺序号\r\n    getNodeOrderNoById(id) {\r\n      const node = this.nodes.find((n) => n.id === id);\r\n      if (node) return node.orderNo;\r\n      else return undefined;\r\n    },\r\n\r\n    // 批量折叠节点\r\n    foldOrUnfold(nodeIds = [], isFolded = true) {\r\n      for (const id of nodeIds) {\r\n        const n = this.nodes.find((n) => n.id === id);\r\n        if (n) n.isFolded = isFolded;\r\n      }\r\n      this.refreshNodesAndLinks();\r\n    },\r\n\r\n    // 屏幕视角中心聚焦到某个节点\r\n    async focusToNode(nodeId) {\r\n      const node = this.nodes.find((n) => n.id === nodeId);\r\n\r\n      // ----------------------------------------------------\r\n\r\n      if (!node) return;\r\n\r\n      const ancestors = Matrix.findAllAncestors(this.nodes, node);\r\n\r\n      let foldCount = 0;\r\n\r\n      // 看看父节点们有没有没展开的，先展开\r\n\r\n      for (const node of ancestors) {\r\n        if (node.isFolded) {\r\n          node.isFolded = false;\r\n          foldCount++;\r\n        }\r\n      }\r\n\r\n      if (foldCount > 0) {\r\n        await this.refreshNodesAndLinks();\r\n      }\r\n\r\n      // ----------------------------------------------------\r\n\r\n      this.scrollTop = 0;\r\n      this.mapMoveOffsetTop = 0;\r\n\r\n      this.scrollLeft = 0;\r\n      this.mapMoveOffsetLeft = 0;\r\n\r\n      const distMoveFromTop =\r\n        node.top -\r\n        (this.scrollInfo.clientHeight - node.height) / 2 +\r\n        this.paddingTb;\r\n\r\n      const distMoveFromLeft =\r\n        node.left -\r\n        (this.scrollInfo.clientWidth - node.width) / 2 +\r\n        this.paddingLr;\r\n\r\n      this._setScrollTop(distMoveFromTop);\r\n      this._setScrollLeft(distMoveFromLeft);\r\n\r\n      // ----------------------------------------------------\r\n\r\n      // this.getScrollInfo();\r\n    },\r\n\r\n    // ----------------------------\r\n    // 放大一个单位导图缩放比例\r\n    plusScaleValue() {\r\n      this.$refs["bottom-bar"].onBtnAddClick();\r\n    },\r\n\r\n    // 缩小一个单位导图缩放比例\r\n    minusScaleValue() {\r\n      this.$refs["bottom-bar"].onBtnMinusClick();\r\n    },\r\n\r\n    // 设置缩放比例(例如设置为0.5，则表示导图缩小为正常尺寸的一半)\r\n    setScaleValue(scaleValue) {\r\n      this.scaleValue = scaleValue;\r\n    },\r\n\r\n    // 设置导图是否全屏\r\n    setFullScreen(isFullScreen) {\r\n      this.isFullScreen = isFullScreen;\r\n    },\r\n\r\n    // 焦点定位到中心\r\n    focusCenter() {\r\n      // 取消手动拖动画布的移位操作\r\n      this.mapMoveOffsetTop = 0;\r\n      this.mapMoveOffsetLeft = 0;\r\n      // 滚动条拖动一半距离\r\n      this.scrollTop = this.rightScrollBarMaxScrollDistance / 2;\r\n      this.scrollLeft = this.bottomScrollBarMaxScrollDistance / 2;\r\n    },\r\n    // ----------------------------\r\n\r\n    // 向指定节点追加一个资源\r\n    async insertResource(nodeId, resource) {\r\n      const node = this.nodes.find((n) => n.id === nodeId);\r\n\r\n      if (node && resource) {\r\n        const rs = new Resource({\r\n          type: resource.type,\r\n          title: resource.title,\r\n          mimeType: resource.mimeType,\r\n          size: resource.size,\r\n          url: resource.url,\r\n          htmlContent: resource.htmlContent,\r\n        });\r\n\r\n        if (!node.resources || !(node.resources.length >= 0)) {\r\n          node.resources = [];\r\n        }\r\n\r\n        node.resources.push(rs);\r\n        await node.calcCellSize(node);\r\n        this.refreshNodesAndLinks();\r\n\r\n        let eventName;\r\n        switch (resource.type) {\r\n          case TYPES.PIC: {\r\n            eventName = "img-inserted";\r\n            break;\r\n          }\r\n          case TYPES.VIDEO: {\r\n            eventName = "video-inserted";\r\n            break;\r\n          }\r\n          case TYPES.FILE: {\r\n            eventName = "file-inserted";\r\n            break;\r\n          }\r\n          case TYPES.HTML: {\r\n            eventName = "html-inserted";\r\n            break;\r\n          }\r\n          default:\r\n            throw new Error("resource 的 type 不符合预期");\r\n        }\r\n        HistoryBiz.addEvent({\r\n          name: eventName,\r\n          attachment: node,\r\n          info: {\r\n            rsIndex: node.resources.length - 1,\r\n            resource: rs,\r\n          },\r\n        });\r\n      }\r\n    },\r\n\r\n    flatNodesToMyNodes() {\r\n      this.nodes = this.flatNodes.map((fn) => {\r\n        if (fn.isCustomized) {\r\n          return new CustomizedNode({ ...fn });\r\n        } else {\r\n          return new NormalNode({ ...fn });\r\n        }\r\n      });\r\n    },\r\n\r\n    getNodeStyle(node) {\r\n      if (\r\n        this.currActiveNodeIds.length === 1 &&\r\n        this.currActiveNodeIds[0] === node.id\r\n      ) {\r\n        return {\r\n          "z-index": 1100,\r\n        };\r\n      } else {\r\n        return {};\r\n      }\r\n    },\r\n\r\n    async onMindmapKeyup(event) {\r\n      if (this.isReadonly) return;\r\n\r\n      if (event.ctrlKey) {\r\n        switch (event.key) {\r\n          case "z": {\r\n            // 还原上一步操作\r\n            const lastEvent = await HistoryBiz.traceback();\r\n            if (lastEvent) {\r\n              this.traceback(\r\n                lastEvent.name,\r\n                lastEvent.attachment,\r\n                lastEvent.info\r\n              );\r\n            }\r\n            break;\r\n          }\r\n          case "0": {\r\n            this.scaleValue = 1;\r\n          }\r\n        }\r\n      } else {\r\n        switch (event.key) {\r\n          case "Delete": {\r\n            // 删除当前选中节点\r\n            if (this.currActiveNodeIds.length > 0) {\r\n              this.delNodesByIds(this.currActiveNodeIds);\r\n            }\r\n            this.currActiveNodeIds = [];\r\n            break;\r\n          }\r\n          // case "Tab": {\r\n          //   // 禁用 tab(如果导图内有表单元素，tab 会移动光标焦点，使导图通过浏览器原生滚动功能向下滚动)\r\n          //   // event.preventDefault();\r\n          //   break;\r\n          // }\r\n        }\r\n      }\r\n    },\r\n\r\n    // 当节点容器被点击时(不包含节点被点击)\r\n    onContainerClick() {\r\n      // this.operationsWhenClickBackground();\r\n    },\r\n\r\n    // // 当容器被鼠标按下时(含画出多选框的功能)\r\n    // onScrollFrameMousedown(event) {\r\n    //   const refScrollFrame = this.$refs["scroll-frame"];\r\n    //   const refMap = this.$refs["map"];\r\n    //   const refContainer = this.$refs["container"];\r\n    //   const refFrame = this.$refs["selection-frame"].$el;\r\n    //   const refMask = this.$refs["selection-frame-mask"];\r\n\r\n    //   const adjust = (target, x, y) => {\r\n    //     console.log("x, y :>> ", x, y);\r\n    //     let _x = x,\r\n    //       _y = y;\r\n\r\n    //     if (target === refMask) {\r\n    //       console.log("target === refMask");\r\n    //     } else if (target === refContainer) {\r\n    //       console.log("target === refContainer");\r\n    //       _x += this.paddingLr * this.scaleValue;\r\n    //       _y += this.paddingTb * this.scaleValue;\r\n    //     }\r\n\r\n    //     if (target === refMap || target === refContainer) {\r\n    //       _x += refMap.offsetLeft;\r\n    //       _y += refMap.offsetTop;\r\n    //     }\r\n    //     return { x: _x, y: _y };\r\n    //   };\r\n\r\n    //   if (\r\n    //     event.target === refScrollFrame ||\r\n    //     event.target === refMap ||\r\n    //     event.target === refContainer\r\n    //   ) {\r\n    //     this.selectionFrame.isMaskAvalible = true;\r\n\r\n    //     refFrame.style.width = "0px";\r\n    //     refFrame.style.height = "0px";\r\n\r\n    //     let { x, y } = adjust(event.target, event.offsetX, event.offsetY);\r\n\r\n    //     x *= this.scaleValue;\r\n    //     y *= this.scaleValue;\r\n\r\n    //     const startX = x;\r\n    //     const startY = y;\r\n    //     this.selectionFrame.start.x = startX;\r\n    //     this.selectionFrame.start.y = startY;\r\n\r\n    //     const leftStart = startX - this.selectionFrame.borderWidth;\r\n    //     const topStart = startY - this.selectionFrame.borderWidth;\r\n    //     refFrame.style.left = `${leftStart}px`;\r\n    //     refFrame.style.top = `${topStart}px`;\r\n\r\n    //     let left, top, width, height;\r\n\r\n    //     refScrollFrame.onmousemove = (e) => {\r\n    //       e.preventDefault();\r\n\r\n    //       this.selectionFrame.isVisible = true;\r\n\r\n    //       const { x, y } = adjust(e.target, e.offsetX, e.offsetY);\r\n    //       const endX = x;\r\n    //       const endY = y;\r\n    //       const relDistanceX = endX - startX;\r\n    //       const relDistanceY = endY - startY;\r\n\r\n    //       this.selectionFrame.end.x = endX;\r\n    //       this.selectionFrame.end.y = endX;\r\n\r\n    //       const frameW = Math.abs(relDistanceX);\r\n    //       const frameH = Math.abs(relDistanceY);\r\n\r\n    //       // 判断当前鼠标相较初始位置而言的方位\r\n    //       if (relDistanceX > 0) {\r\n    //         // 在右\r\n    //         console.log("在右");\r\n    //         left = startX - this.selectionFrame.borderWidth;\r\n    //         width = frameW;\r\n    //       } else if (relDistanceX < 0) {\r\n    //         // 在左\r\n    //         console.log("在左");\r\n    //         left = endX - this.selectionFrame.borderWidth;\r\n    //         width = frameW;\r\n    //       } else {\r\n    //         left = 0;\r\n    //         width = 0;\r\n    //       }\r\n\r\n    //       if (relDistanceY > 0) {\r\n    //         // 在下\r\n    //         console.log("在下");\r\n    //         top = startY - this.selectionFrame.borderWidth;\r\n    //         height = frameH;\r\n    //       } else if (relDistanceY < 0) {\r\n    //         // 在上\r\n    //         console.log("在上");\r\n    //         top = endY - this.selectionFrame.borderWidth;\r\n    //         height = frameH;\r\n    //       } else {\r\n    //         top = 0;\r\n    //         height = 0;\r\n    //       }\r\n\r\n    //       refFrame.style.left = `${left}px`;\r\n    //       refFrame.style.top = `${top}px`;\r\n    //       refFrame.style.width = `${width}px`;\r\n    //       refFrame.style.height = `${height}px`;\r\n    //     };\r\n\r\n    //     refScrollFrame.onmouseup = (e) => {\r\n    //       e.preventDefault();\r\n    //       refScrollFrame.onmousemove = null;\r\n    //       refFrame.style.width = "0px";\r\n    //       refFrame.style.height = "0px";\r\n    //       this.selectionFrame.isVisible = false;\r\n    //       this.selectionFrame.isMaskAvalible = false;\r\n\r\n    //       const startX = left / this.scaleValue;\r\n    //       const startY = top / this.scaleValue;\r\n    //       const endX = (startX + width) / this.scaleValue;\r\n    //       const endY = (startY + height) / this.scaleValue;\r\n\r\n    //       Matrix.findAllVisibleNodesAtScope({\r\n    //         startX,\r\n    //         startY,\r\n    //         endX,\r\n    //         endY,\r\n    //       });\r\n    //     };\r\n    //   }\r\n    // },\r\n\r\n    // 当容器被鼠标按下时(含画出多选框的功能)\r\n\r\n    onScrollFrameMousedown2(event) {\r\n      if (this.isMultipleSelectAllowed) {\r\n        const refScrollFrame = this.$refs["scroll-frame"];\r\n        const refMap = this.$refs["map"];\r\n        const refContainer = this.$refs["container"];\r\n        const refFrame = this.$refs["selection-frame"].$el;\r\n\r\n        const scrollFrameRect = refScrollFrame.getBoundingClientRect();\r\n\r\n        const startX = event.pageX - scrollFrameRect.left;\r\n        const startY = event.pageY - scrollFrameRect.top;\r\n\r\n        if (\r\n          event.target === refScrollFrame ||\r\n          event.target === refMap ||\r\n          event.target === refContainer\r\n        ) {\r\n          this.selectionFrame.isMaskAvalible = true;\r\n\r\n          refFrame.style.left = `${startX}px`;\r\n          refFrame.style.top = `${startY}px`;\r\n\r\n          let left, top, width, height;\r\n\r\n          refScrollFrame.onmousemove = (e) => {\r\n            e.preventDefault();\r\n\r\n            this.selectionFrame.isVisible = true;\r\n\r\n            const endX = e.pageX - scrollFrameRect.left;\r\n            const endY = e.pageY - scrollFrameRect.top;\r\n\r\n            const ps = this.calcFramePosAndSize({\r\n              startX,\r\n              startY,\r\n              endX,\r\n              endY,\r\n            });\r\n\r\n            left = ps.left;\r\n            top = ps.top;\r\n            width = ps.width;\r\n            height = ps.height;\r\n\r\n            refFrame.style.left = `${left}px`;\r\n            refFrame.style.top = `${top}px`;\r\n            refFrame.style.width = `${width}px`;\r\n            refFrame.style.height = `${height}px`;\r\n          };\r\n\r\n          refScrollFrame.onmouseup = (e) => {\r\n            e.preventDefault();\r\n            refScrollFrame.onmousemove = null;\r\n            refFrame.style.width = "0px";\r\n            refFrame.style.height = "0px";\r\n            this.selectionFrame.isVisible = false;\r\n            this.selectionFrame.isMaskAvalible = false;\r\n\r\n            const _startX = left / this.scaleValue;\r\n            const _startY = top / this.scaleValue;\r\n            const _endX = (_startX + width) / this.scaleValue;\r\n            const _endY = (_startY + height) / this.scaleValue;\r\n\r\n            Matrix.findAllVisibleNodesAtScope({\r\n              startX: _startX,\r\n              startY: _startY,\r\n              endX: _endX,\r\n              endY: _endY,\r\n            });\r\n          };\r\n        }\r\n      }\r\n    },\r\n\r\n    calcFramePosAndSize({ startX, startY, endX, endY }) {\r\n      const relDistanceX = endX - startX;\r\n      const relDistanceY = endY - startY;\r\n\r\n      const frameW = Math.abs(relDistanceX);\r\n      const frameH = Math.abs(relDistanceY);\r\n\r\n      let left, top, width, height;\r\n\r\n      // 判断当前鼠标相较初始位置而言的方位\r\n      if (relDistanceX > 0) {\r\n        // 在右\r\n        // console.log("在右");\r\n        left = startX - this.selectionFrame.borderWidth;\r\n        width = frameW;\r\n      } else if (relDistanceX < 0) {\r\n        // 在左\r\n        // console.log("在左");\r\n        left = endX - this.selectionFrame.borderWidth;\r\n        width = frameW;\r\n      } else {\r\n        left = 0;\r\n        width = 0;\r\n      }\r\n\r\n      if (relDistanceY > 0) {\r\n        // 在下\r\n        // console.log("在下");\r\n        top = startY - this.selectionFrame.borderWidth;\r\n        height = frameH;\r\n      } else if (relDistanceY < 0) {\r\n        // 在上\r\n        // console.log("在上");\r\n        top = endY - this.selectionFrame.borderWidth;\r\n        height = frameH;\r\n      } else {\r\n        top = 0;\r\n        height = 0;\r\n      }\r\n\r\n      return { left, top, width, height };\r\n    },\r\n\r\n    // 当滚动容器被点击时\r\n    onScrollFrameClick(event) {\r\n      const refScrollFrame = this.$refs["scroll-frame"];\r\n      const refMap = this.$refs["map"];\r\n      const refContainer = this.$refs["container"];\r\n      const refMask = this.$refs["selection-frame-mask"];\r\n\r\n      // event.target 是触发事件的元素(判断触发事件的是父容器本身，而不是子标签)\r\n      // if (\r\n      //   event.target === refContainer ||\r\n      //   event.target === refMap ||\r\n      //   event.target === refMask\r\n      // ) {\r\n      // this.operationsWhenClickBackground();\r\n      // }\r\n      if (\r\n        event.target === refScrollFrame ||\r\n        event.target === refContainer ||\r\n        event.target === refMap ||\r\n        event.target === refMask\r\n      )\r\n        this.operationsWhenClickBackground();\r\n    },\r\n\r\n    // 当节点被鼠标点击时\r\n    onNodeMouseClick(node, event) {\r\n      // 自定义节点没有 resources\r\n      if (node.resources) {\r\n        const rsId = myStore.state.resourceIdOfActiveFrame;\r\n        if (node.resources.findIndex((rs) => rs.id === rsId) === -1) {\r\n          // 当前激活框选的资源不属于当前被点击的节点\r\n          myStore.state.resourceIdOfActiveFrame = "";\r\n        }\r\n      }\r\n\r\n      this.confirmEditingTitle();\r\n\r\n      // this.currActiveNodeId = node.id;\r\n\r\n      // ctrl键是否被按下\r\n      if (event.ctrlKey) {\r\n        // 多选节点\r\n        this.currActiveNodeIds.push(node.id);\r\n      } else {\r\n        // 单选节点\r\n        this.setSingleActiveNodeId(node.id);\r\n      }\r\n    },\r\n\r\n    onNodeDragenter(node, event) {\r\n      this.$emit("node-dragenter", this.cloneNode(node), event);\r\n    },\r\n\r\n    onNodeDragleave(node, event) {\r\n      this.$emit("node-dragleave", this.cloneNode(node), event);\r\n    },\r\n\r\n    onNodeDragover(node, event) {\r\n      this.$emit("node-dragover", this.cloneNode(node), event);\r\n    },\r\n\r\n    onNodeDrop(node, event) {\r\n      this.$emit("node-drop", this.cloneNode(node), event);\r\n    },\r\n\r\n    onNodeTitleDbClickToEdit(node) {\r\n      const rsId = myStore.state.resourceIdOfActiveFrame;\r\n      if (node.resources.findIndex((rs) => rs.id === rsId) === -1) {\r\n        // 当前激活框选的资源不属于当前被点击的节点\r\n        myStore.state.resourceIdOfActiveFrame = "";\r\n      }\r\n      this.currEditingNodeId = node.id;\r\n    },\r\n\r\n    onNodeMouseDown(node, event) {\r\n      if (this.currEditingNodeId && this.currEditingNodeId === node.id) {\r\n        // 节点正处于编辑当中，不能拖动\r\n      } else if (!node.parentId) {\r\n        // 节点是根节点，不能拖动\r\n      } else if (node.isReadonly) {\r\n        // 节点是只读，不能拖动\r\n      } else if (this.isReadonly) {\r\n        // 如果全局只读，节点不可移动\r\n      } else {\r\n        // 节点可以拖动\r\n        const refContainer = this.$refs["container"];\r\n        // const refCursorMoveMask = this.$refs["cursor-move-mask"];\r\n        const mindmapLeft = refContainer.getBoundingClientRect().left;\r\n        const mindmapTop = refContainer.getBoundingClientRect().top;\r\n        // 计算鼠标相对于mindmap的div的坐标\r\n        const mouseRelLeft = event.clientX - mindmapLeft;\r\n        const mouseRelTop = event.clientY - mindmapTop;\r\n        const mouseMidPointRelLeft = mouseRelLeft - this.cursorSize.w / 2;\r\n        const mouseMidPointRelTop = mouseRelTop - this.cursorSize.h / 2;\r\n\r\n        const refCursor = this.$refs["cursor"];\r\n        refCursor.style.transform = `translate(${mouseMidPointRelLeft}px, ${mouseMidPointRelTop}px)`;\r\n\r\n        const refCanvas = this.$refs["canvas-offspring-temp-line"];\r\n        const ctx = refCanvas.getContext("2d");\r\n        // ctx.strokeStyle = this.defaultLineColor;\r\n        // ctx.lineWidth = CANVAS_LINE_WIDTH;\r\n\r\n        this.unOffspringDroppableNodes = [];\r\n\r\n        // refCursorMoveMask.onmousemove = (e) => {\r\n        //   console.log("refCursorMoveMask");\r\n        // };\r\n\r\n        refContainer.onmousemove = (e) => {\r\n          e.preventDefault();\r\n\r\n          const _mouseRelLeft = e.clientX - mindmapLeft;\r\n          const _mouseRelTop = e.clientY - mindmapTop;\r\n\r\n          const movedDistanceX = Math.abs(_mouseRelLeft - mouseRelLeft);\r\n          const movedDistanceY = Math.abs(_mouseRelTop - mouseRelTop);\r\n          const movedDistance = Math.sqrt(\r\n            Math.pow(movedDistanceX, 2) + Math.pow(movedDistanceY, 2)\r\n          );\r\n\r\n          if (movedDistance > CURSOR_MOUSE_MOVE_DISTANCE) {\r\n            // this.isCursorDisplay = true;\r\n            this.currDraggingNode = node;\r\n            const _mouseMidPointRelLeft = _mouseRelLeft - this.cursorSize.w / 2;\r\n            const _mouseMidPointRelTop = _mouseRelTop - this.cursorSize.h / 2;\r\n            refCursor.style.transform = `translate(${_mouseMidPointRelLeft}px, ${_mouseMidPointRelTop}px)`;\r\n\r\n            if (!this.isScopeFrameDisplay) {\r\n              this.unOffspringDroppableNodes = this.drawNodesScopeFrame(node);\r\n            }\r\n\r\n            // 如果鼠标进入了某个节点的可拖放区域\r\n            if (this.currOffspringDropZoneMouseenterNodeId) {\r\n              if (\r\n                !this.unOffspringDroppableNodes\r\n                  .map((n) => n.id)\r\n                  .includes(this.currOffspringDropZoneMouseenterNodeId)\r\n              ) {\r\n                const refNode =\r\n                  this.$refs[\r\n                    "node-" + this.currOffspringDropZoneMouseenterNodeId\r\n                  ][0];\r\n\r\n                if (refNode) {\r\n                  let top, left, width, height;\r\n                  let beginX, beginY, endX, endY;\r\n                  let anchorX, anchorY;\r\n\r\n                  if (this.isHorizontal) {\r\n                    const { x: rx, y: ry } = refNode.GetAnchorRight();\r\n                    anchorX = rx;\r\n                    anchorY = ry;\r\n                  } else {\r\n                    const { x: bx, y: by } = refNode.GetAnchorBottom();\r\n                    anchorX = bx;\r\n                    anchorY = by;\r\n                  }\r\n\r\n                  if (_mouseRelLeft - anchorX > 0) {\r\n                    // 在右\r\n                    left = anchorX;\r\n                    width = _mouseRelLeft - anchorX;\r\n                  } else {\r\n                    // 在左\r\n                    left = _mouseRelLeft;\r\n                    width = anchorX - _mouseRelLeft;\r\n                  }\r\n\r\n                  if (_mouseRelTop - anchorY > 0) {\r\n                    // 在下\r\n                    top = anchorY;\r\n                    height = _mouseRelTop - anchorY;\r\n                  } else {\r\n                    // 在上\r\n                    top = _mouseRelTop;\r\n                    height = anchorY - _mouseRelTop;\r\n                  }\r\n\r\n                  if (_mouseRelLeft - anchorX > 0) {\r\n                    // 右\r\n                    if (_mouseRelTop - anchorY > 0) {\r\n                      // 下\r\n                      beginX = 0;\r\n                      beginY = 0;\r\n                      endX = width;\r\n                      endY = height;\r\n                    } else {\r\n                      // 上\r\n                      beginX = 0;\r\n                      beginY = height;\r\n                      endX = width;\r\n                      endY = 0;\r\n                    }\r\n                  } else {\r\n                    // 左\r\n                    if (_mouseRelTop - anchorY > 0) {\r\n                      // 下\r\n                      beginX = 0;\r\n                      beginY = height;\r\n                      endX = width;\r\n                      endY = 0;\r\n                    } else {\r\n                      // 上\r\n                      beginX = width;\r\n                      beginY = height;\r\n                      endX = 0;\r\n                      endY = 0;\r\n                    }\r\n                  }\r\n\r\n                  if (this.isHorizontal) {\r\n                    top -= CANVAS_LINE_WIDTH / 2;\r\n                    height += CANVAS_LINE_WIDTH;\r\n                    beginY += CANVAS_LINE_WIDTH / 2;\r\n                    endY += CANVAS_LINE_WIDTH / 2;\r\n                  } else {\r\n                    left -= CANVAS_LINE_WIDTH / 2;\r\n                    width += CANVAS_LINE_WIDTH;\r\n                    beginX += CANVAS_LINE_WIDTH / 2;\r\n                    endX += CANVAS_LINE_WIDTH / 2;\r\n                  }\r\n\r\n                  this.offspringTempLineCanvas.top = top;\r\n                  this.offspringTempLineCanvas.left = left;\r\n                  this.offspringTempLineCanvas.width = width;\r\n                  this.offspringTempLineCanvas.height = height;\r\n\r\n                  this.$nextTick(() => {\r\n                    ctx.strokeStyle = this.defaultLineColor;\r\n                    ctx.lineWidth = CANVAS_LINE_WIDTH;\r\n                    this._drawLine(ctx, {\r\n                      beginX,\r\n                      beginY,\r\n                      endX,\r\n                      endY,\r\n                    });\r\n                  });\r\n                }\r\n              }\r\n            } else {\r\n              this.offspringTempLineCanvas.top = 0;\r\n              this.offspringTempLineCanvas.left = 0;\r\n              this.offspringTempLineCanvas.width = 0;\r\n              this.offspringTempLineCanvas.height = 0;\r\n            }\r\n          }\r\n        };\r\n\r\n        // 注:会捕获节点div的所有mouseup事件,包括子元素的\r\n        refContainer.onmouseup = async (e) => {\r\n          e.preventDefault();\r\n\r\n          // 清空事件回调\r\n          refContainer.onmousemove = null;\r\n          if (refContainer.onmouseup) refContainer.onmouseup = null;\r\n\r\n          const oldParentId = node.parentId;\r\n\r\n          // 如果游标在某个节点的可拖放区域,则当前被拖动节点会成为该节点的子节点\r\n          if (\r\n            this.isCursorDisplay &&\r\n            this.currOffspringDropZoneMouseenterNodeId &&\r\n            !this.unOffspringDroppableNodes\r\n              .map((n) => n.id)\r\n              .includes(this.currOffspringDropZoneMouseenterNodeId)\r\n          ) {\r\n            const br = await this.beforeChangeParent(\r\n              [this.cloneNode(node)],\r\n              node.parentId,\r\n              [oldParentId]\r\n            );\r\n\r\n            if (br !== false) {\r\n              node.parentId = this.currOffspringDropZoneMouseenterNodeId;\r\n              this.refreshNodesAndLinks();\r\n              this.$emit(\r\n                "change-parent",\r\n                [this.cloneNode(node)], // 父节点被改变的节点集合\r\n                node.parentId, // 现父节点\r\n                [oldParentId] // 原父节点集合(与“父节点被改变的节点集合”同序)\r\n              );\r\n              addEvent();\r\n            }\r\n          }\r\n\r\n          // 如果游标正在悬停于某个节点,则当前被拖动节点会成为该节点的子节点(不允许悬停的节点已被排除)\r\n          if (\r\n            this.isCursorDisplay &&\r\n            this.currHoveringNode &&\r\n            this.currHoveringNode.id !== node.id\r\n          ) {\r\n            const br = await this.beforeChangeParent(\r\n              [this.cloneNode(node)],\r\n              node.parentId,\r\n              [oldParentId]\r\n            );\r\n\r\n            if (br !== false) {\r\n              node.parentId = this.currHoveringNode.id;\r\n              this.refreshNodesAndLinks();\r\n              this.$emit(\r\n                "change-parent",\r\n                [this.cloneNode(node)],\r\n                node.parentId,\r\n                [oldParentId]\r\n              );\r\n              addEvent();\r\n            }\r\n          }\r\n\r\n          if (this.currDraggingNode) this.currDraggingNode = null;\r\n          if (this.isScopeFrameDisplay) this.isScopeFrameDisplay = false;\r\n\r\n          this.offspringTempLineCanvas.top = 0;\r\n          this.offspringTempLineCanvas.left = 0;\r\n          this.offspringTempLineCanvas.width = 0;\r\n          this.offspringTempLineCanvas.height = 0;\r\n\r\n          function addEvent() {\r\n            HistoryBiz.addEvent({\r\n              name: "change-parent",\r\n              attachment: [node],\r\n              info: {\r\n                newParentId: node.parentId,\r\n                oldParentIds: [oldParentId],\r\n              },\r\n            });\r\n          }\r\n        };\r\n      }\r\n    },\r\n\r\n    onNodeMouseEnter(/* node, event */) {},\r\n\r\n    onNodeMouseLeave(/* node, event */) {},\r\n\r\n    onEditingNodeEnterPress(/* newTitle */) {\r\n      this.currEditingNodeId = "";\r\n    },\r\n\r\n    onNodeTitleChanged(node, oldTitle) {\r\n      this.$emit("title-changed", this.cloneNode(node), oldTitle);\r\n      HistoryBiz.addEvent({\r\n        name: "title-changed",\r\n        attachment: node,\r\n        info: oldTitle,\r\n      });\r\n    },\r\n\r\n    onBtnHorizontalClick() {\r\n      if (!this.isHorizontal) {\r\n        this.isHorizontal = true;\r\n        this.refreshNodesAndLinks();\r\n      }\r\n    },\r\n\r\n    onBtnVerticalClick() {\r\n      if (this.isHorizontal) {\r\n        this.isHorizontal = false;\r\n        this.refreshNodesAndLinks();\r\n      }\r\n    },\r\n\r\n    onBtnMoveCanvasClick() {\r\n      this.isMovingMode = !this.isMovingMode;\r\n    },\r\n\r\n    onBtnCurveLinesClick() {\r\n      if (!this.isCurveLines) {\r\n        this.isCurveLines = true;\r\n        this.refreshLinks();\r\n      }\r\n    },\r\n\r\n    onBtnStraightLinesClick() {\r\n      if (this.isCurveLines) {\r\n        this.isCurveLines = false;\r\n        this.refreshLinks();\r\n      }\r\n    },\r\n\r\n    // 节点后方的+号按钮被点击时(新增单个子节点)\r\n    async onNodeBtnPlusClick(parentNode /* , event */) {\r\n      // this.currActiveNodeId = "";\r\n      this.currActiveNodeIds = [];\r\n\r\n      const count = Matrix.calcNodeChildrenCount({\r\n        node: parentNode,\r\n        tree: this.tree,\r\n      });\r\n      const newNodeOrderNo = count + 1;\r\n\r\n      // 根据父节点决定子节点的类型\r\n      let _node;\r\n      if (parentNode instanceof CustomizedNode) {\r\n        _node = new CustomizedNode({\r\n          id: EncryptionHelper.uuidv4(),\r\n          parentId: parentNode.id,\r\n          // orderNo: newNodeOrderNo,\r\n          isReadonly: parentNode.isReadonly, // 跟随父节点的可读性\r\n        });\r\n      } else if (parentNode instanceof NormalNode) {\r\n        _node = new NormalNode({\r\n          id: EncryptionHelper.uuidv4(),\r\n          parentId: parentNode.id,\r\n          // orderNo: newNodeOrderNo,\r\n          isReadonly: parentNode.isReadonly, // 跟随父节点的可读性\r\n        });\r\n      } else {\r\n        throw new Error("parentNode 的类型出错");\r\n      }\r\n\r\n      const cloneNode = this.cloneNode(_node, false);\r\n\r\n      const br = await this.beforeChildAdded(\r\n        cloneNode,\r\n        this.cloneNode(parentNode, false),\r\n        newNodeOrderNo\r\n      );\r\n\r\n      if (br !== false) {\r\n        // 检查 cloneNode 是否有被修改\r\n        let __node;\r\n        if (cloneNode.isCustomized) {\r\n          __node = new CustomizedNode(cloneNode);\r\n        } else {\r\n          __node = new NormalNode(cloneNode);\r\n        }\r\n\r\n        __node.calcCellSize(__node);\r\n        this.nodes.push(__node);\r\n        await this.refreshNodesAndLinks();\r\n\r\n        // this.currActiveNodeId = __node.id;\r\n        this.setSingleActiveNodeId(__node.id);\r\n\r\n        this.$emit(\r\n          "child-added",\r\n          this.cloneNode(__node, true),\r\n          this.cloneNode(parentNode, false),\r\n          newNodeOrderNo\r\n        );\r\n\r\n        HistoryBiz.addEvent({\r\n          name: "child-added",\r\n          attachment: __node,\r\n          info: {\r\n            parentNode,\r\n            newNodeOrderNo,\r\n          },\r\n        });\r\n      }\r\n    },\r\n\r\n    onNodesReorder(nodes, newOrderNo, oldOrderNo) {\r\n      this.refreshNodesAndLinks();\r\n      this.$emit(\r\n        "nodes-reorder",\r\n        this.cloneNodes(nodes),\r\n        newOrderNo,\r\n        oldOrderNo\r\n      );\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    onNodePicSinglePreviewClick(node, resource) {\r\n      this.currPicPreview.urls = [resource.url];\r\n      // this.currPicPreview.visible = true;\r\n      this.currPreviewType = TYPES.PIC;\r\n    },\r\n\r\n    onNodeVideoPlayClick(node, resource) {\r\n      this.currVideoPlay.url = resource.url;\r\n      this.currPreviewType = TYPES.VIDEO;\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    onNodePicDragDotMousedown(node, event, refPicFlexibleFrame) {\r\n      this.flexFrameResize({\r\n        node,\r\n        refFlexibleFrame: refPicFlexibleFrame,\r\n        eventName: "frame-size-reseted",\r\n      });\r\n    },\r\n\r\n    onNodeVideoDragDotMousedown(node, event, refVideoFlexibleFrame) {\r\n      this.flexFrameResize({\r\n        node,\r\n        refFlexibleFrame: refVideoFlexibleFrame,\r\n        eventName: "frame-size-reseted",\r\n      });\r\n    },\r\n\r\n    flexFrameResize({ node, refFlexibleFrame, eventName }) {\r\n      const refScrollFrame = this.$refs["scroll-frame"];\r\n\r\n      let picFrameWidth, picFrameHeight;\r\n\r\n      refScrollFrame.onmousemove = (e) => {\r\n        e.preventDefault();\r\n\r\n        picFrameWidth = refFlexibleFrame.offsetWidth + e.movementX;\r\n        picFrameHeight = refFlexibleFrame.offsetHeight + e.movementY;\r\n        refFlexibleFrame.style.width = picFrameWidth + "px";\r\n        refFlexibleFrame.style.height = picFrameHeight + "px";\r\n\r\n        refFlexibleFrame.style.borderStyle = "dashed";\r\n      };\r\n\r\n      refScrollFrame.onmouseup = (e) => {\r\n        e.preventDefault();\r\n\r\n        if (refScrollFrame.onmousemove) refScrollFrame.onmousemove = null;\r\n        if (refScrollFrame.onmouseup) refScrollFrame.onmouseup = null;\r\n        refFlexibleFrame.style.borderStyle = "";\r\n\r\n        // 节点图片的尺寸已被调整过\r\n        if (picFrameWidth && picFrameHeight) {\r\n          // 单资源情况下，图片尺寸才能缩放\r\n          const onlyRes = node.resources[0];\r\n          const originalWidth = onlyRes.contentWidth; // 用于 ctrl+z\r\n          const originalHeight = onlyRes.contentHeight; // 用于 ctrl+z\r\n\r\n          this.setResourceFrameSize({\r\n            node,\r\n            width: picFrameWidth,\r\n            height: picFrameHeight,\r\n          });\r\n\r\n          this.$emit(\r\n            eventName,\r\n            this.cloneNode(node),\r\n            this.cloneResource(onlyRes, node.id),\r\n            { w: picFrameWidth, h: picFrameHeight },\r\n            { w: originalWidth, h: originalHeight }\r\n          );\r\n\r\n          HistoryBiz.addEvent({\r\n            name: eventName,\r\n            attachment: node,\r\n            info: {\r\n              originalWidth,\r\n              originalHeight,\r\n              picFrameWidth,\r\n              picFrameHeight,\r\n              refFlexibleFrame,\r\n              resource: onlyRes,\r\n            },\r\n          });\r\n        }\r\n      };\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    // 当资源被点击删除的时候\r\n    async onResourceDeleteClick(node, resource) {\r\n      const rsIndex = node.resources.findIndex((r) => r.id === resource.id);\r\n      if (rsIndex > -1) node.resources.splice(rsIndex, 1);\r\n\r\n      await node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n      this.$emit(\r\n        "resource-deleted",\r\n        this.cloneNode(node),\r\n        this.cloneResource(resource, node.id)\r\n      );\r\n\r\n      HistoryBiz.addEvent({\r\n        name: "resource-deleted",\r\n        attachment: node,\r\n        info: { rsIndex, resource },\r\n      });\r\n    },\r\n\r\n    onResourceForwardClick(node, resource) {\r\n      const rsIndex = node.resources.findIndex((r) => r.id === resource.id);\r\n\r\n      // 前移一位\r\n      this.moveForward(node.resources, rsIndex);\r\n      myStore.state.resourceIdOfActiveFrame = "";\r\n\r\n      this.$emit(\r\n        "resource-forward",\r\n        this.cloneNode(node),\r\n        this.cloneResource(resource, node.id)\r\n      );\r\n\r\n      HistoryBiz.addEvent({\r\n        name: "resource-forward",\r\n        attachment: node,\r\n        info: { rsIndex: rsIndex - 1, resource },\r\n      });\r\n    },\r\n\r\n    onResourceBackwardClick(node, resource) {\r\n      const rsIndex = node.resources.findIndex((r) => r.id === resource.id);\r\n      // 后移一位\r\n      this.moveBackward(node.resources, rsIndex);\r\n      myStore.state.resourceIdOfActiveFrame = "";\r\n\r\n      this.$emit(\r\n        "resource-backward",\r\n        this.cloneNode(node),\r\n        this.cloneResource(resource, node.id)\r\n      );\r\n\r\n      HistoryBiz.addEvent({\r\n        name: "resource-backward",\r\n        attachment: node,\r\n        info: { rsIndex: rsIndex + 1, resource },\r\n      });\r\n    },\r\n\r\n    onBtnFoldAndUnfoldClick(node, flag) {\r\n      // node.isFolded = flag;\r\n      // this.refreshNodesAndLinks();\r\n      this.foldOrUnfold([node.id], flag);\r\n      if (flag) {\r\n        this.$emit("node-folded", this.cloneNode(node));\r\n        HistoryBiz.addEvent({\r\n          name: "node-folded",\r\n          attachment: node,\r\n        });\r\n      } else {\r\n        this.$emit("node-unfolded", this.cloneNode(node));\r\n        HistoryBiz.addEvent({\r\n          name: "node-unfolded",\r\n          attachment: node,\r\n        });\r\n      }\r\n    },\r\n\r\n    onNodeHovering(node) {\r\n      this.currHoveringNode = node;\r\n    },\r\n\r\n    onNodeHoveringCancel(/* node */) {\r\n      this.currHoveringNode = null;\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    onWindowResize() {\r\n      if (this.isMovingMode) {\r\n        this.setMapMoveMaskSize();\r\n      }\r\n      if (this.isCursorDisplay) {\r\n        this.setCursorMoveMaskSize();\r\n      }\r\n      this.getScrollInfo();\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    onRightScrollBarBlankClick(isBackward) {\r\n      const scrollPercent = 80;\r\n      let shouldMoveDistance = this.scrollInfo.clientHeight * scrollPercent;\r\n      if (isBackward) this.scrollDownward(shouldMoveDistance);\r\n      else this.scrollUpward(-shouldMoveDistance);\r\n    },\r\n\r\n    onBottomScrollBarBlankClick(isBackward) {\r\n      const scrollPercent = 80;\r\n      let shouldMoveDistance = this.scrollInfo.clientWidth * scrollPercent;\r\n      if (isBackward) this.scrollRightward(shouldMoveDistance);\r\n      else this.scrollLeftward(-shouldMoveDistance);\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    // 操作按钮 bar\r\n\r\n    async onBtnInsertImgClick(node) {\r\n      await this.onResourceInsert({\r\n        node,\r\n        fileAccept: [".jpg", ".png"].toString(),\r\n        resourceType: TYPES.PIC,\r\n        beforeFunc: this.beforeImgInserted,\r\n        eventName: "img-inserted",\r\n      });\r\n    },\r\n\r\n    async onBtnInsertVideoClick(node) {\r\n      await this.onResourceInsert({\r\n        node,\r\n        fileAccept: [".mp4"].toString(),\r\n        resourceType: TYPES.VIDEO,\r\n        beforeFunc: this.beforeVideoInserted,\r\n        eventName: "video-inserted",\r\n      });\r\n    },\r\n\r\n    async onBtnInsertFileClick(node) {\r\n      await this.onResourceInsert({\r\n        node,\r\n        resourceType: TYPES.FILE,\r\n        beforeFunc: this.beforeFileInserted,\r\n        eventName: "file-inserted",\r\n      });\r\n    },\r\n\r\n    async onResourceInsert({\r\n      node,\r\n      fileAccept,\r\n      resourceType,\r\n      beforeFunc,\r\n      eventName,\r\n    }) {\r\n      const files = await FileHelper.selectLocalFiles({\r\n        fileAccept,\r\n        multiple: false,\r\n      });\r\n\r\n      const rsId = myStore.state.resourceIdOfActiveFrame;\r\n      let rsIndex;\r\n      if (rsId) rsIndex = node.resources.findIndex((rs) => rs.id === rsId);\r\n      // 如果当前有激活的资源，则新图片插入到激活资源的前一位\r\n      else rsIndex = node.resources.length; // 如果当前没有激活的资源，则新图片插入到最后\r\n\r\n      const file = files[0];\r\n\r\n      const rs = new Resource({\r\n        type: resourceType,\r\n        title: file.name,\r\n        mimeType: file.type,\r\n        size: file.size,\r\n      });\r\n\r\n      const br = await beforeFunc(files, rsIndex, rs);\r\n\r\n      if (br !== false) {\r\n        // 检查 rs 是否有被修改\r\n        const _rs = new Resource({\r\n          type: resourceType,\r\n          id: rs.id,\r\n          title: rs.name,\r\n          mimeType: rs.type,\r\n          size: rs.size,\r\n        });\r\n\r\n        if (rs.url) {\r\n          _rs.url = rs.url;\r\n        } else {\r\n          switch (resourceType) {\r\n            case TYPES.PIC: {\r\n              const dataUrl = await FileHelper.fileToImgDataUrl(file);\r\n              _rs.url = dataUrl;\r\n              break;\r\n            }\r\n            case TYPES.VIDEO: {\r\n              const dataUrl = FileHelper.fileToObjUrl(file);\r\n              _rs.url = dataUrl;\r\n              break;\r\n            }\r\n            case TYPES.FILE: {\r\n              const dataUrl = FileHelper.fileToObjUrl(file);\r\n              _rs.url = dataUrl;\r\n              break;\r\n            }\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n\r\n        node.resources.splice(rsIndex, 0, _rs);\r\n        await node.calcCellSize(node);\r\n        this.refreshNodesAndLinks();\r\n\r\n        this.$emit(\r\n          eventName,\r\n          this.cloneNode(node),\r\n          this.cloneResource(_rs, node.id),\r\n          files,\r\n          rsIndex\r\n        );\r\n\r\n        HistoryBiz.addEvent({\r\n          name: eventName,\r\n          attachment: node,\r\n          info: {\r\n            rsIndex,\r\n            resource: _rs,\r\n          },\r\n        });\r\n      }\r\n    },\r\n\r\n    // 当新增单个兄弟节点的按钮被点击时\r\n    async onBtnAddSiblingClick(node) {\r\n      const siblingNode = node;\r\n      const order = siblingNode.orderNo;\r\n\r\n      // 根据兄弟节点决定新节点的类型\r\n      let _node;\r\n      if (siblingNode instanceof CustomizedNode) {\r\n        _node = new CustomizedNode({\r\n          id: EncryptionHelper.uuidv4(),\r\n          parentId: siblingNode.parentId,\r\n          // orderNo: order + 1,\r\n          isReadonly: siblingNode.isReadonly, // 跟随兄弟节点的可读性\r\n        });\r\n      } else if (siblingNode instanceof NormalNode) {\r\n        _node = new NormalNode({\r\n          id: EncryptionHelper.uuidv4(),\r\n          parentId: siblingNode.parentId,\r\n          // orderNo: order + 1,\r\n          isReadonly: siblingNode.isReadonly, // 跟随兄弟节点的可读性\r\n        });\r\n      } else {\r\n        throw new Error("siblingNode 的类型出错");\r\n      }\r\n\r\n      const cloneNode = this.cloneNode(_node, false);\r\n      const br = await this.beforeSiblingAdded(\r\n        cloneNode,\r\n        this.cloneNode(siblingNode, false),\r\n        order + 1\r\n      );\r\n\r\n      if (br !== false) {\r\n        // 检查 cloneNode 是否有被修改\r\n        let __node;\r\n        if (cloneNode.isCustomized) {\r\n          __node = new CustomizedNode(cloneNode);\r\n        } else {\r\n          __node = new NormalNode(cloneNode);\r\n        }\r\n\r\n        __node.orderNo = order; // 与前一位兄弟节点同排序号，算法会重新计算正确的排序号\r\n\r\n        __node.calcCellSize(__node);\r\n        this.nodes.push(__node);\r\n        await this.refreshNodesAndLinks();\r\n\r\n        // this.currActiveNodeId = __node.id;\r\n        this.setSingleActiveNodeId(__node.id);\r\n\r\n        this.$emit(\r\n          "sibling-added",\r\n          this.cloneNode(__node, true),\r\n          this.cloneNode(siblingNode, false),\r\n          __node.orderNo\r\n        );\r\n\r\n        // HistoryBiz.addEvent({\r\n        //   name: "child-added",\r\n        //   attachment: __node,\r\n        //   info: {\r\n        //     parentNode,\r\n        //     newNodeOrderNo,\r\n        //   },\r\n        // });\r\n      }\r\n    },\r\n\r\n    onBtnDelNodeClick(node /* , event */) {\r\n      this.delNodesByIds([node.id]);\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    onNodeDropZoneMaskMouseenter(event, node) {\r\n      if (this.isCursorDisplay) {\r\n        if (\r\n          !this.currOffspringDropZoneMouseenterNodeId ||\r\n          this.currOffspringDropZoneMouseenterNodeId !== node.id\r\n        ) {\r\n          this.currOffspringDropZoneMouseenterNodeId = node.id;\r\n        }\r\n      }\r\n    },\r\n\r\n    onNodeDropZoneMaskMouseleave(event, node) {\r\n      if (this.currOffspringDropZoneMouseenterNodeId === node.id) {\r\n        this.currOffspringDropZoneMouseenterNodeId = "";\r\n      }\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    async onBtnBoldClick(node) {\r\n      node.fontStyle.bold = !node.fontStyle.bold;\r\n      await node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n\r\n      const flat = node.fontStyle.bold;\r\n      this.$emit("font-bold", this.cloneNode(node), flat);\r\n      HistoryBiz.addEvent({\r\n        name: "font-bold",\r\n        attachment: node,\r\n        info: { flat },\r\n      });\r\n    },\r\n\r\n    async onBtnItalicClick(node) {\r\n      node.fontStyle.italic = !node.fontStyle.italic;\r\n      await node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n\r\n      const flat = node.fontStyle.italic;\r\n      this.$emit("font-italic", this.cloneNode(node), flat);\r\n      HistoryBiz.addEvent({\r\n        name: "font-italic",\r\n        attachment: node,\r\n        info: { flat },\r\n      });\r\n    },\r\n\r\n    async onBtnUnderlineClick(node) {\r\n      node.fontStyle.underline = !node.fontStyle.underline;\r\n      await node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n\r\n      const flat = node.fontStyle.underline;\r\n      this.$emit("font-underline", this.cloneNode(node), flat);\r\n      HistoryBiz.addEvent({\r\n        name: "font-underline",\r\n        attachment: node,\r\n        info: { flat },\r\n      });\r\n    },\r\n\r\n    async onBtnEraserClick(node) {\r\n      const oldFontStyle = new FontStyle(node.fontStyle);\r\n\r\n      node.fontStyle = new FontStyle({});\r\n      await node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n\r\n      this.$emit("font-eraser", this.cloneNode(node));\r\n      HistoryBiz.addEvent({\r\n        name: "font-eraser",\r\n        attachment: node,\r\n        info: { oldFontStyle },\r\n      });\r\n    },\r\n\r\n    async onBtnBgcolorClick(node, colorValue) {\r\n      const oldColor = node.fontStyle.color;\r\n      node.fontStyle.color = colorValue;\r\n\r\n      this.$emit("font-bg-color", this.cloneNode(node), colorValue);\r\n      HistoryBiz.addEvent({\r\n        name: "font-bg-color",\r\n        attachment: node,\r\n        info: {\r\n          newColor: colorValue,\r\n          oldColor,\r\n        },\r\n      });\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    // 定位到中心\r\n    onFoucsCenterClick() {\r\n      this.focusCenter();\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    // 初始化节点及连线\r\n    async initialNodesAndLinks() {\r\n      for (const n of this.nodes) {\r\n        await n.calcCellSize(n);\r\n      }\r\n\r\n      return new Promise((resolve /* , reject */) => {\r\n        const { links, tree } = Matrix.calcNodesPos({\r\n          flatNodes: this.nodes,\r\n          isHorizontal: this.isHorizontal,\r\n        });\r\n        Matrix.calcNodesOffspringDropAllowZones({\r\n          flatNodes: this.nodes,\r\n          isHorizontal: this.isHorizontal,\r\n        });\r\n\r\n        this.links = links;\r\n        this.tree = tree;\r\n\r\n        this.calcNodesScopeAndResizeCanvas();\r\n\r\n        this.$nextTick(() => {\r\n          this.drawLinesBetweenNodes();\r\n          this.getScrollInfo();\r\n\r\n          resolve();\r\n          this.$emit("algorithm-complete");\r\n        });\r\n      });\r\n    },\r\n\r\n    // 重绘节点及连线\r\n    async refreshNodesAndLinks() {\r\n      return new Promise((resolve /* , reject */) => {\r\n        const { links, tree } = Matrix.calcNodesPos({\r\n          flatNodes: this.nodes,\r\n          isHorizontal: this.isHorizontal,\r\n        });\r\n        Matrix.calcNodesOffspringDropAllowZones({\r\n          flatNodes: this.nodes,\r\n          isHorizontal: this.isHorizontal,\r\n        });\r\n\r\n        this.links = links;\r\n        this.tree = tree;\r\n\r\n        // this.setCanvasZero(); // 先让 scroll-frame 有时间调整自身的高宽\r\n\r\n        // 记住重新计算导图范围之前,导图的尺寸\r\n        this.mindmapScopeRecord.wBefore = this._calcMindmapScopeWidth();\r\n        this.mindmapScopeRecord.hBefore = this._calcMindmapScopeHeight();\r\n\r\n        this.clearLines();\r\n\r\n        this.$nextTick(() => {\r\n          this.calcNodesScopeAndResizeCanvas();\r\n\r\n          this.$nextTick(() => {\r\n            // this.calcNodesScopeAndResizeCanvas(); // 再让 canvas 高宽随 scroll-frame 改变\r\n            this.drawLinesBetweenNodes();\r\n            this.getScrollInfo();\r\n\r\n            resolve();\r\n            this.$emit("algorithm-complete");\r\n          });\r\n        });\r\n      });\r\n    },\r\n\r\n    async refreshLinks() {\r\n      return new Promise((resolve /* , reject */) => {\r\n        this.clearLines();\r\n        this.$nextTick(() => {\r\n          this.calcNodesScopeAndResizeCanvas();\r\n          this.$nextTick(() => {\r\n            this.drawLinesBetweenNodes();\r\n            resolve();\r\n          });\r\n        });\r\n      });\r\n    },\r\n\r\n    // --------------------------------------------------------------------\r\n\r\n    // 计算思维导图的左上角和右下角坐标，兼具使 canvas 的尺寸刚好包住思维导图\r\n    calcNodesScopeAndResizeCanvas() {\r\n      const { minX, minY, maxX, maxY } = Matrix.calcNodesScope({\r\n        tree: this.tree,\r\n        isHorizontal: this.isHorizontal,\r\n      });\r\n      this.mindmapScope.minX = minX;\r\n      this.mindmapScope.minY = minY;\r\n      this.mindmapScope.maxX = maxX;\r\n      this.mindmapScope.maxY = maxY;\r\n\r\n      // 记录导图的新尺寸\r\n      this.mindmapScopeRecord.wCurrent = this._calcMindmapScopeWidth();\r\n      this.mindmapScopeRecord.hCurrent = this._calcMindmapScopeHeight();\r\n    },\r\n\r\n    _calcMindmapScopeWidth() {\r\n      return this.mindmapScope.maxX - this.mindmapScope.minX;\r\n    },\r\n\r\n    _calcMindmapScopeHeight() {\r\n      return this.mindmapScope.maxY - this.mindmapScope.minY;\r\n    },\r\n\r\n    // 把 canvas 的高宽设置为0(同时也具备clearLines()的作用)\r\n    // setCanvasZero() {\r\n    //   const refCanvas = this.$refs["canvas"];\r\n    //   refCanvas.setAttribute("width", 0);\r\n    //   refCanvas.setAttribute("height", 0);\r\n    // },\r\n    // 清除 canvas 上所有的连接线\r\n    clearLines() {\r\n      // const refCanvas = this.$refs["canvas"];\r\n      // const w = refCanvas.width;\r\n      // const h = refCanvas.height;\r\n      // refCanvas.width = w;\r\n      // refCanvas.height = h;\r\n\r\n      // 记住重新计算导图范围之前,导图的尺寸\r\n      // this.mindmapScopeRecord.wBefore = this._calcMindmapScopeWidth();\r\n      // this.mindmapScopeRecord.hBefore = this._calcMindmapScopeHeight();\r\n\r\n      this.mindmapScope.minX = 0;\r\n      this.mindmapScope.minY = 0;\r\n      this.mindmapScope.maxX = 0;\r\n      this.mindmapScope.maxY = 0;\r\n    },\r\n\r\n    // 在所有节点间画上连线\r\n    drawLinesBetweenNodes() {\r\n      const refCanvas = this.$refs["canvas"];\r\n      const ctx = refCanvas.getContext("2d");\r\n      ctx.strokeStyle = this.defaultLineColor;\r\n      ctx.lineWidth = CANVAS_LINE_WIDTH;\r\n\r\n      for (const link of this.links) {\r\n        const refNode1_ = this.$refs["node-" + link.node1.id];\r\n        const refNode2_ = this.$refs["node-" + link.node2.id];\r\n\r\n        if (refNode1_ && refNode2_) {\r\n          const refNode1 = refNode1_[0];\r\n          const refNode2 = refNode2_[0];\r\n\r\n          if (this.isHorizontal) {\r\n            const { x: rx1, y: ry1 } = refNode1.GetAnchorRight();\r\n            const { x: lx2, y: ly2 } = refNode2.GetAnchorLeft();\r\n\r\n            this._drawLine(ctx, {\r\n              beginX: rx1,\r\n              beginY: ry1,\r\n              endX: lx2,\r\n              endY: ly2,\r\n            });\r\n          } else {\r\n            const { x: bx1, y: by1 } = refNode1.GetAnchorBottom();\r\n            const { x: tx2, y: ty2 } = refNode2.GetAnchorTop();\r\n\r\n            this._drawLine(ctx, {\r\n              beginX: bx1,\r\n              beginY: by1,\r\n              endX: tx2,\r\n              endY: ty2,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // 拖动节点时，绘制出被拖动节点的“禁止摆放区”(节点不能成为自身的子节点，及不能成为其子节点的子节点)\r\n    drawNodesScopeFrame(node) {\r\n      const { minX, minY, maxX, maxY, nodes } = Matrix.calcNodesScope({\r\n        tree: this.tree,\r\n        nodeId: node.id,\r\n        isHorizontal: this.isHorizontal,\r\n      });\r\n\r\n      this.scopeFramePos.x = minX;\r\n      this.scopeFramePos.y = minY;\r\n      this.scopeFrameSize.w = maxX - minX;\r\n      this.scopeFrameSize.h = maxY - minY;\r\n      this.isScopeFrameDisplay = true;\r\n\r\n      return nodes;\r\n    },\r\n\r\n    // 在 canvas 上画连接线\r\n    _drawLine(ctx, { beginX, beginY, endX, endY }) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(beginX, beginY);\r\n\r\n      let cp1x, cp1y, cp2x, cp2y;\r\n      if (this.isHorizontal) {\r\n        cp1x = beginX + (endX - beginX) / 2; // 第一个控制点x\r\n        cp1y = beginY; // 第一个控制点y\r\n        cp2x = beginX + (endX - beginX) / 2; // 第二个控制点x\r\n        cp2y = endY; // 第二个控制点y\r\n      } else {\r\n        cp1x = beginX;\r\n        cp1y = beginY + (endY - beginY) / 2;\r\n        cp2x = endX;\r\n        cp2y = beginY + (endY - beginY) / 2;\r\n      }\r\n\r\n      if (this.isCurveLines) {\r\n        ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, endX, endY);\r\n      } else {\r\n        ctx.lineTo(cp1x, cp1y);\r\n        ctx.lineTo(cp2x, cp2y);\r\n        ctx.lineTo(endX, endY);\r\n      }\r\n\r\n      ctx.stroke();\r\n      // ctx.closePath();\r\n    },\r\n\r\n    // 设置脑图平移遮罩的尺寸与 scroll-frame 内部同大\r\n    setMapMoveMaskSize() {\r\n      const { width, height } = this._getScrollFrameScrollSize();\r\n      this.mapMoveMaskSize.width = width;\r\n      this.mapMoveMaskSize.height = height;\r\n    },\r\n\r\n    // 设置脑图平移遮罩的尺寸归零\r\n    setMapMoveMaskSizeZero() {\r\n      this.mapMoveMaskSize.width = 0;\r\n      this.mapMoveMaskSize.height = 0;\r\n    },\r\n\r\n    // 设置游标平移遮罩的尺寸与 scroll-frame 内部同大\r\n    setCursorMoveMaskSize() {\r\n      const { width, height } = this._getScrollFrameScrollSize();\r\n      this.cursorMoveMaskSize.width = width;\r\n      this.cursorMoveMaskSize.height = height;\r\n    },\r\n\r\n    // 设置游标平移遮罩的尺寸归零\r\n    setCursorMoveMaskSizeZero() {\r\n      this.cursorMoveMaskSize.width = 0;\r\n      this.cursorMoveMaskSize.height = 0;\r\n    },\r\n\r\n    // 当鼠标点击导图背景时的操作\r\n    operationsWhenClickBackground() {\r\n      this.confirmEditingTitle();\r\n\r\n      this.$refs["bottom-bar"].SetPercentBtnsUnvisible(); // 使’选择显示比例‘的上拉菜单隐藏\r\n\r\n      // this.currActiveNodeId = "";\r\n      this.currActiveNodeIds = [];\r\n\r\n      this.currEditingNodeId = "";\r\n      myStore.state.resourceIdOfActiveFrame = ""; // 任何激活框选的资源，都取消激活框选\r\n    },\r\n\r\n    _getScrollFrameScrollSize() {\r\n      const refScrollFrame = this.$refs["scroll-frame"];\r\n      const width = refScrollFrame.scrollWidth;\r\n      const height = refScrollFrame.scrollHeight;\r\n      return {\r\n        width,\r\n        height,\r\n      };\r\n    },\r\n\r\n    // 根据节点id，删除节点\r\n    // delNodeById(nodeId) {\r\n    //   const index = this.nodes.findIndex((n) => n.id === nodeId);\r\n    //   const node = this.nodes.find((n) => n.id === nodeId);\r\n    //   this.nodes.splice(index, 1);\r\n    //   this.refreshNodesAndLinks();\r\n\r\n    //   this.$emit("node-deleted", this.cloneNode(node));\r\n    //   HistoryBiz.addEvent({\r\n    //     name: "node-deleted",\r\n    //     attachment: node,\r\n    //     info: {\r\n    //       index,\r\n    //     },\r\n    //   });\r\n    // },\r\n\r\n    // 根据节点ids，批量删除节点\r\n    delNodesByIds(nodeIds) {\r\n      const originalNodes = Array.from(this.nodes); // 克隆一份，用于回滚\r\n      const nodesDeleted = [];\r\n\r\n      for (const nodeId of nodeIds) {\r\n        // 找出包含自己的所有下级子节点\r\n        const familyNodesFromTree = Matrix.findFamilyNodesByParentId(\r\n          nodeId,\r\n          this.tree\r\n        );\r\n\r\n        const familyNodes = [];\r\n        for (const node of familyNodesFromTree) {\r\n          const i = this.nodes.findIndex((n) => n.id === node.id);\r\n          familyNodes.push(this.nodes[i]);\r\n          this.nodes.splice(i, 1);\r\n        }\r\n\r\n        nodesDeleted.push(this.cloneNodes(familyNodes));\r\n      }\r\n\r\n      this.$nextTick(() => {\r\n        this.refreshNodesAndLinks();\r\n      });\r\n\r\n      this.$emit("nodes-deleted", nodesDeleted);\r\n      HistoryBiz.addEvent({\r\n        name: "nodes-deleted",\r\n        attachment: nodesDeleted,\r\n        info: {\r\n          originalNodes,\r\n        },\r\n      });\r\n    },\r\n\r\n    // ------------------------------------------------------------------\r\n    getScrollInfo() {\r\n      this.getClientSize();\r\n      this.getScrollSize();\r\n      this.getScrollSizeFinal();\r\n    },\r\n\r\n    getClientSize() {\r\n      const refScrollFrame = this.$refs["scroll-frame"];\r\n\r\n      const clientWidth = refScrollFrame.clientWidth;\r\n      const clientHeight = refScrollFrame.clientHeight;\r\n\r\n      this.scrollInfo.clientWidth = clientWidth;\r\n      this.scrollInfo.clientHeight = clientHeight;\r\n    },\r\n\r\n    getScrollSize() {\r\n      let scrollWidthPure =\r\n        this.mindmapScopeWidth * this.scaleValue + this.paddingLr * 2;\r\n      let scrollHeightPure =\r\n        this.mindmapScopeHeight * this.scaleValue + this.paddingTb * 2;\r\n\r\n      // 计算是否会出现右侧滚动条\r\n      if (scrollHeightPure > this.scrollInfo.clientHeight) {\r\n        // 有右侧滚动条\r\n        scrollWidthPure += SCROLL_BAR_SIZE;\r\n      }\r\n\r\n      // 计算是否会出现底部滚动条\r\n      if (scrollWidthPure > this.scrollInfo.clientWidth) {\r\n        // 有底部滚动条\r\n        scrollHeightPure += SCROLL_BAR_SIZE;\r\n      }\r\n\r\n      this.scrollWidth = scrollWidthPure;\r\n      this.scrollHeight = scrollHeightPure;\r\n    },\r\n\r\n    getScrollSizeFinal() {\r\n      this.getScrollWidthFinal();\r\n      this.getScrollHeightFinal();\r\n    },\r\n\r\n    getScrollWidthFinal() {\r\n      this.scrollWidthFinal =\r\n        this.scrollWidth + Math.abs(this.mapMoveOffsetLeft);\r\n    },\r\n\r\n    getScrollHeightFinal() {\r\n      this.scrollHeightFinal =\r\n        this.scrollHeight + Math.abs(this.mapMoveOffsetTop);\r\n    },\r\n\r\n    // 当用户编辑完节点，按回车按背景或者按别的节点时，需要保存当前正在编辑的节点标题\r\n    confirmEditingTitle() {\r\n      if (this.hasCurrEditing) {\r\n        const refNode = this.$refs["node-" + this.currEditingNodeId][0];\r\n        refNode.ConfirmEditingTitle();\r\n        this.refreshNodesAndLinks();\r\n      }\r\n    },\r\n\r\n    // 设置单个选中激活节点\r\n    setSingleActiveNodeId(nodeId) {\r\n      this.currActiveNodeIds = [];\r\n      this.currActiveNodeIds.push(nodeId);\r\n    },\r\n\r\n    // ----------平移、滚动相关----------\r\n    // 脑图平移遮罩的鼠标点击事件\r\n    onMapMoveMaskMousedown(e) {\r\n      e.preventDefault();\r\n\r\n      const refMapMoveMask = this.$refs["map-move-mask"];\r\n      refMapMoveMask.onmousemove = (e) => {\r\n        e.preventDefault();\r\n\r\n        const shouldMoveDistanceX = -e.movementX;\r\n        const shouldMoveDistanceY = -e.movementY;\r\n\r\n        this._setScrollLeft(shouldMoveDistanceX);\r\n        this._setScrollTop(shouldMoveDistanceY);\r\n      };\r\n      refMapMoveMask.onmouseup = (e) => {\r\n        e.preventDefault();\r\n        refMapMoveMask.onmousemove = null;\r\n      };\r\n    },\r\n\r\n    /**\r\n     * 当滚动条被鼠标拖拉时\r\n     * @param isHorizontal 是否水平滚动，否则垂直滚动\r\n     * @param dragDistance 鼠标移动的距离\r\n     * @param shouldMoveDistance 画布移动的距离\r\n     */\r\n    onScrollBarMouseDrag(isHorizontal, dragDistance, shouldMoveDistance) {\r\n      if (isHorizontal) {\r\n        // const maxDistance = this.bottomScrollBarMaxScrollDistance;\r\n        if (shouldMoveDistance > 0) {\r\n          // 向右拖动\r\n          this.scrollRightward(shouldMoveDistance);\r\n        } else {\r\n          // 向左拖动\r\n          this.scrollLeftward(shouldMoveDistance);\r\n        }\r\n      } else {\r\n        if (shouldMoveDistance > 0) {\r\n          // 向下拖动\r\n          this.scrollDownward(shouldMoveDistance);\r\n        } else {\r\n          // 向上拖动\r\n          this.scrollUpward(shouldMoveDistance);\r\n        }\r\n      }\r\n    },\r\n\r\n    // 当在 ScrollFrame 滚动鼠标中轮时\r\n    onScrollFrameScroll(e) {\r\n      // 判断是不是按下ctrl键\r\n      if (e.ctrlKey) {\r\n        // 此时为缩放脑图请求\r\n        // 取消浏览器默认的放大缩小网页行为\r\n        e.preventDefault();\r\n        // 判断是向上滚动还是向下滚动\r\n        if (e.deltaY > 0) {\r\n          // 放大重写，业务代码\r\n          this.scaleValue -= SCROLL_SCALE_UNIT;\r\n        } else {\r\n          // 缩小重写，业务代码\r\n          this.scaleValue += SCROLL_SCALE_UNIT;\r\n        }\r\n\r\n        this.getScrollInfo();\r\n      } else {\r\n        // 此时为滚动脑图请求\r\n        e.preventDefault();\r\n\r\n        const scrollUnit = 30;\r\n        if (e.deltaY > 0) {\r\n          // 向下滚动\r\n          this.scrollDownward(scrollUnit);\r\n        } else {\r\n          // 向上滚动\r\n          this.scrollUpward(-scrollUnit);\r\n        }\r\n      }\r\n    },\r\n\r\n    scrollDownward(shouldMoveDistance) {\r\n      if (this.mapMoveOffsetTop > 0) {\r\n        // 被平移过，产生了正偏离\r\n      } else if (this.mapMoveOffsetTop < 0) {\r\n        // 被平移过，产生了负偏离\r\n        if (this.mapMoveOffsetTop + shouldMoveDistance < 0) {\r\n          this.mapMoveOffsetTop += shouldMoveDistance;\r\n        } else {\r\n          this.mapMoveOffsetTop = 0;\r\n        }\r\n        // this.getScrollSize();\r\n        this.getScrollHeightFinal();\r\n      } else {\r\n        // 没有被平移过\r\n        const maxDistance = this.rightScrollBarMaxScrollDistance;\r\n\r\n        if (this.scrollTopFinal + shouldMoveDistance < maxDistance) {\r\n          this.scrollTop += shouldMoveDistance;\r\n        } else {\r\n          this.scrollTop = maxDistance;\r\n        }\r\n      }\r\n    },\r\n\r\n    scrollRightward(shouldMoveDistance) {\r\n      if (this.mapMoveOffsetLeft > 0) {\r\n        // 被平移过，产生了正偏离\r\n      } else if (this.mapMoveOffsetLeft < 0) {\r\n        // 被平移过，产生了负偏离\r\n        if (this.mapMoveOffsetLeft + shouldMoveDistance < 0) {\r\n          this.mapMoveOffsetLeft += shouldMoveDistance;\r\n        } else {\r\n          this.mapMoveOffsetLeft = 0;\r\n        }\r\n        // this.getScrollSize();\r\n        this.getScrollWidthFinal();\r\n      } else {\r\n        // 没有被平移过\r\n        const maxDistance = this.bottomScrollBarMaxScrollDistance;\r\n\r\n        if (this.scrollLeftFinal + shouldMoveDistance < maxDistance) {\r\n          this.scrollLeft += shouldMoveDistance;\r\n        } else {\r\n          this.scrollLeft = maxDistance;\r\n        }\r\n      }\r\n    },\r\n\r\n    scrollUpward(shouldMoveDistance) {\r\n      if (this.mapMoveOffsetTop < 0) {\r\n        // 被平移过，产生了负偏离\r\n      } else if (this.mapMoveOffsetTop > 0) {\r\n        // 被平移过，产生了正偏离\r\n\r\n        this.getScrollHeightFinal();\r\n\r\n        const scrollTop = this.scrollTopFinal + shouldMoveDistance;\r\n        const maxDistance = (() => {\r\n          if (this.scrollHeightFinal > this.scrollInfo.clientHeight)\r\n            return this.scrollHeightFinal - this.scrollInfo.clientHeight;\r\n          else return 0;\r\n        })();\r\n        // const maxDistance = this.rightScrollBarMaxScrollDistance;\r\n\r\n        if (scrollTop - maxDistance > 0) {\r\n          this.mapMoveOffsetTop = scrollTop - maxDistance;\r\n          this.scrollTop = maxDistance;\r\n        } else {\r\n          this.mapMoveOffsetTop = 0;\r\n          this.scrollTop = scrollTop;\r\n\r\n          this.getScrollHeightFinal();\r\n        }\r\n      } else {\r\n        // 没有被平移过\r\n        if (this.scrollTopFinal + shouldMoveDistance > 0) {\r\n          this.scrollTop += shouldMoveDistance;\r\n        } else {\r\n          this.scrollTop = 0;\r\n        }\r\n      }\r\n    },\r\n\r\n    scrollLeftward(shouldMoveDistance) {\r\n      if (this.mapMoveOffsetLeft < 0) {\r\n        // 被平移过，产生了负偏离\r\n      } else if (this.mapMoveOffsetLeft > 0) {\r\n        // 被平移过，产生了正偏离\r\n\r\n        this.getScrollWidthFinal();\r\n\r\n        const scrollLeft = this.scrollLeftFinal + shouldMoveDistance;\r\n        const maxDistance = (() => {\r\n          if (this.scrollWidthFinal > this.scrollInfo.clientWidth)\r\n            return this.scrollWidthFinal - this.scrollInfo.clientWidth;\r\n          else return 0;\r\n        })();\r\n        // const maxDistance = this.bottomScrollBarMaxScrollDistance;\r\n\r\n        if (scrollLeft - maxDistance > 0) {\r\n          this.mapMoveOffsetLeft = scrollLeft - maxDistance;\r\n          this.scrollLeft = maxDistance;\r\n        } else {\r\n          this.mapMoveOffsetLeft = 0;\r\n          this.scrollLeft = scrollLeft;\r\n\r\n          this.getScrollWidthFinal();\r\n        }\r\n      } else {\r\n        // 没有被平移过\r\n        if (this.scrollLeftFinal + shouldMoveDistance > 0) {\r\n          this.scrollLeft += shouldMoveDistance;\r\n        } else {\r\n          this.scrollLeft = 0;\r\n        }\r\n      }\r\n    },\r\n\r\n    // ------------------------------------------------\r\n\r\n    /**\r\n     * @description 设置图片或视频的显示宽高\r\n     * @param {Node} node 节点对象\r\n     * @param {number} width 图片或视频的显示宽度\r\n     * @param {number} height 图片或视频的显示高度\r\n     */\r\n    setResourceFrameSize({ node, width, height }) {\r\n      const onlyRes = node.resources[0];\r\n      onlyRes.contentWidth = width;\r\n      onlyRes.contentHeight = height;\r\n      node.calcCellSize(node);\r\n      this.refreshNodesAndLinks();\r\n    },\r\n\r\n    // ------------------------------------------------\r\n\r\n    /**\r\n     * @description 线性动画移动画布\r\n     * @param {number} fromNum 从什么数字开始计算\r\n     * @param {number} toNum 到什么数字结束计算\r\n     * @param {Function} callback 在单位时间间隔内(单个线性周期)，需要回调的函数(参数为当前线性量)\r\n     * @param {Function} callbackWhenFinished 当所有线性周期运转完后，最后要回调的函数\r\n     * @param {number} totalTime 总耗时\r\n     * @param {number} updateCount 周期数量\r\n     */\r\n    moveCanvas({\r\n      fromNum,\r\n      toNum,\r\n      callback,\r\n      callbackWhenFinished,\r\n      totalTime = 500,\r\n      updateCount = 50,\r\n    }) {\r\n      const intervalTime = totalTime / updateCount;\r\n      let usedTime = 0;\r\n      let leftTime = totalTime;\r\n\r\n      const id = setInterval(() => {\r\n        usedTime += intervalTime;\r\n        leftTime -= intervalTime;\r\n\r\n        const num = EasingFunc.easeInOutQuad(\r\n          usedTime / 1000,\r\n          fromNum,\r\n          toNum - fromNum,\r\n          totalTime / 1000\r\n        );\r\n\r\n        callback(num);\r\n\r\n        if (leftTime === 0) {\r\n          clearInterval(id);\r\n          callbackWhenFinished();\r\n        }\r\n      }, intervalTime);\r\n    },\r\n\r\n    async _setScrollLeft(shouldMoveDistance) {\r\n      const { mapMoveOffsetLeft, scrollLeft } = await this._calcScrollLeft(\r\n        shouldMoveDistance\r\n      );\r\n      this.mapMoveOffsetLeft = mapMoveOffsetLeft;\r\n      this.scrollLeft = scrollLeft;\r\n    },\r\n\r\n    async _setScrollTop(shouldMoveDistance) {\r\n      const { mapMoveOffsetTop, scrollTop } = await this._calcScrollTop(\r\n        shouldMoveDistance\r\n      );\r\n      this.mapMoveOffsetTop = mapMoveOffsetTop;\r\n      this.scrollTop = scrollTop;\r\n    },\r\n\r\n    // 根据希望移动的距离(像素),自动计算水平位移相关属性\r\n    async _calcScrollLeft(shouldMoveDistance) {\r\n      this.getScrollSize();\r\n      this.getScrollSizeFinal();\r\n\r\n      return new Promise((resolve /* , reject */) => {\r\n        this.$nextTick(() => {\r\n          const maxDistance = (() => {\r\n            if (this.scrollWidthFinal > this.scrollInfo.clientWidth) {\r\n              return this.scrollWidthFinal - this.scrollInfo.clientWidth;\r\n            } else return 0;\r\n          })();\r\n\r\n          const _scrollLeft = this.scrollLeftFinal + shouldMoveDistance;\r\n\r\n          let mapMoveOffsetLeft, scrollLeft;\r\n          if (_scrollLeft < 0) {\r\n            // 向右平移(产生负偏离)\r\n            mapMoveOffsetLeft = _scrollLeft;\r\n            scrollLeft = 0;\r\n          } else if (_scrollLeft > maxDistance) {\r\n            // 向左平移(已触底)(产生正偏离)\r\n            mapMoveOffsetLeft = _scrollLeft - maxDistance;\r\n            scrollLeft = maxDistance;\r\n          } else {\r\n            // 向左平移(未触底)\r\n            mapMoveOffsetLeft = 0;\r\n            scrollLeft = _scrollLeft;\r\n          }\r\n\r\n          resolve({ mapMoveOffsetLeft, scrollLeft });\r\n        });\r\n      });\r\n    },\r\n\r\n    // 根据希望移动的距离(像素),自动计算垂直位移相关属性\r\n    async _calcScrollTop(shouldMoveDistance) {\r\n      this.getScrollSize();\r\n      this.getScrollSizeFinal();\r\n\r\n      return new Promise((resolve /* , reject */) => {\r\n        this.$nextTick(() => {\r\n          const maxDistance = (() => {\r\n            if (this.scrollHeightFinal > this.scrollInfo.clientHeight)\r\n              return this.scrollHeightFinal - this.scrollInfo.clientHeight;\r\n            else return 0;\r\n          })();\r\n\r\n          const _scrollTop = this.scrollTopFinal + shouldMoveDistance;\r\n          let mapMoveOffsetTop, scrollTop;\r\n\r\n          if (_scrollTop < 0) {\r\n            // 向下平移(产生负偏离)\r\n            mapMoveOffsetTop = _scrollTop;\r\n            scrollTop = 0;\r\n          } else if (_scrollTop > maxDistance) {\r\n            // 向上平移(已触底)(产生正偏离)\r\n            mapMoveOffsetTop = _scrollTop - maxDistance;\r\n            scrollTop = maxDistance;\r\n          } else {\r\n            // 向上平移(未触底)\r\n            mapMoveOffsetTop = 0;\r\n            scrollTop = _scrollTop;\r\n          }\r\n\r\n          resolve({ mapMoveOffsetTop, scrollTop });\r\n        });\r\n      });\r\n    },\r\n\r\n    // ------------------------------------------------\r\n\r\n    async traceback(eventName, eventAttachment, info) {\r\n      switch (eventName) {\r\n        case "title-changed": {\r\n          eventAttachment.title = info;\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.$emit("recover-title-changed", this.cloneNode(eventAttachment));\r\n          break;\r\n        }\r\n        case "frame-size-reseted": {\r\n          this.setResourceFrameSize({\r\n            node: eventAttachment,\r\n            width: info.originalWidth,\r\n            height: info.originalHeight,\r\n          });\r\n          info.refPicFlexibleFrame.style.width = info.originalWidth + "px";\r\n          info.refPicFlexibleFrame.style.height = info.originalHeight + "px";\r\n          this.$emit(\r\n            "recover-frame-size-reseted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.onlyRes, eventAttachment.id),\r\n            { w: info.originalWidth, h: info.originalHeight },\r\n            { w: info.picFrameWidth, h: info.picFrameHeight }\r\n          );\r\n          break;\r\n        }\r\n        case "child-added": {\r\n          const nodeIndex = this.nodes.findIndex(\r\n            (n) => n.id === eventAttachment.id\r\n          );\r\n          this.nodes.splice(nodeIndex, 1);\r\n          this.refreshNodesAndLinks();\r\n\r\n          // this.currActiveNodeId = "";\r\n\r\n          this.$emit(\r\n            "recover-child-added",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneNode(info.parentNode),\r\n            info.newNodeOrderNo\r\n          );\r\n          break;\r\n        }\r\n        // case "node-deleted": {\r\n        //   eventAttachment.orderNo -= 0.5; // 因为orderNo会被重新计算，所以节点要回到原来的位置，orderNo要减去0.5\r\n        //   this.nodes.splice(info.index, 0, eventAttachment);\r\n        //   this.refreshNodesAndLinks();\r\n\r\n        //   // this.currActiveNodeId = eventAttachment.id;\r\n        //   this.setSingleActiveNodeId(eventAttachment.id);\r\n\r\n        //   this.$emit("recover-node-deleted", this.cloneNode(eventAttachment));\r\n        //   break;\r\n        // }\r\n        case "nodes-deleted": {\r\n          this.nodes = info.originalNodes;\r\n          this.refreshNodesAndLinks();\r\n\r\n          this.$emit("recover-nodes-deleted", eventAttachment);\r\n          break;\r\n        }\r\n        case "img-inserted": {\r\n          eventAttachment.resources.splice(info.rsIndex, 1);\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-img-inserted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "video-inserted": {\r\n          eventAttachment.resources.splice(info.rsIndex, 1);\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-video-inserted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "file-inserted": {\r\n          eventAttachment.resources.splice(info.rsIndex, 1);\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-file-inserted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "html-inserted": {\r\n          eventAttachment.resources.splice(info.rsIndex, 1);\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-html-inserted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "resource-deleted": {\r\n          eventAttachment.resources.splice(info.rsIndex, 0, info.resource);\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-resource-deleted",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "resource-forward": {\r\n          this.moveBackward(eventAttachment.resources, info.rsIndex);\r\n          this.$emit(\r\n            "recover-resource-forward",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "resource-backward": {\r\n          this.moveForward(eventAttachment.resources, info.rsIndex);\r\n          this.$emit(\r\n            "recover-resource-backward",\r\n            this.cloneNode(eventAttachment),\r\n            this.cloneResource(info.resource, eventAttachment.id)\r\n          );\r\n          break;\r\n        }\r\n        case "node-folded": {\r\n          eventAttachment.isFolded = false;\r\n          this.refreshNodesAndLinks();\r\n          this.$emit("recover-node-folded", this.cloneNode(eventAttachment));\r\n          break;\r\n        }\r\n        case "node-unfolded": {\r\n          eventAttachment.isFolded = true;\r\n          this.refreshNodesAndLinks();\r\n          this.$emit("recover-node-unfolded", this.cloneNode(eventAttachment));\r\n          break;\r\n        }\r\n        case "change-parent": {\r\n          for (let i = 0; i < eventAttachment.length; i++) {\r\n            const node = eventAttachment[i];\r\n            node.parentId = info.oldParentIds[i];\r\n          }\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-change-parent",\r\n            this.cloneNodes(eventAttachment),\r\n            info.oldParentIds, // 还原后的新父节点集合\r\n            info.newParentId // 还原前的父节点\r\n          );\r\n          break;\r\n        }\r\n        case "font-bold": {\r\n          eventAttachment.fontStyle.bold = !info.flat;\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-font-bold",\r\n            this.cloneNodes(eventAttachment),\r\n            eventAttachment.fontStyle.bold\r\n          );\r\n          break;\r\n        }\r\n        case "font-italic": {\r\n          eventAttachment.fontStyle.italic = !info.flat;\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-font-italic",\r\n            this.cloneNodes(eventAttachment),\r\n            eventAttachment.fontStyle.italic\r\n          );\r\n          break;\r\n        }\r\n        case "font-underline": {\r\n          eventAttachment.fontStyle.underline = !info.flat;\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-font-underline",\r\n            this.cloneNodes(eventAttachment),\r\n            eventAttachment.fontStyle.underline\r\n          );\r\n          break;\r\n        }\r\n        case "font-eraser": {\r\n          eventAttachment.fontStyle = info.oldFontStyle;\r\n          await eventAttachment.calcCellSize(eventAttachment);\r\n          this.refreshNodesAndLinks();\r\n          this.$emit(\r\n            "recover-font-eraser",\r\n            this.cloneNodes(eventAttachment),\r\n            this.cloneFontStyle(eventAttachment.fontStyle)\r\n          );\r\n          break;\r\n        }\r\n        case "font-bg-color": {\r\n          // const currColor = eventAttachment.fontStyle.color;\r\n          eventAttachment.fontStyle.color = info.oldColor;\r\n          this.$emit(\r\n            "recover-font-bg-color",\r\n            this.cloneNodes(eventAttachment),\r\n            info.oldColor\r\n          );\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @description 复制节点对象(主要用于事件对外输出节点对象)\r\n     * @param {NormalNode|CustomizedNode} node 节点对象\r\n     * @param {boolean} hasChangeNodeIdMethod 节点对象的id是否可被修改\r\n     */\r\n    cloneNode(node, hasChangeNodeIdMethod = false) {\r\n      const { parentId, isReadonly, extra } = node;\r\n      const _changeNodeId = this.changeNodeId;\r\n\r\n      const _node = {\r\n        parentId,\r\n        isReadonly,\r\n        extra,\r\n      };\r\n\r\n      if (node instanceof NormalNode) {\r\n        _node.isCustomized = false;\r\n        _node.title = node.title;\r\n      } else if (node instanceof CustomizedNode) {\r\n        _node.isCustomized = true;\r\n        _node.width = node.width;\r\n        _node.height = node.height;\r\n      } else {\r\n        throw new Error("node 的类型出错");\r\n      }\r\n\r\n      if (hasChangeNodeIdMethod) {\r\n        return {\r\n          ..._node,\r\n          get id() {\r\n            return node.id;\r\n          },\r\n          // set id(v) {\r\n          //   _changeNodeId(node.id, v);\r\n          // },\r\n          setId(v) {\r\n            _changeNodeId(node.id, v);\r\n          },\r\n        };\r\n      } else {\r\n        return {\r\n          ..._node,\r\n          id: node.id,\r\n        };\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @description 批量复制节点对象(主要用于事件对外输出节点对象)\r\n     * @param {Array.<NormalNode|CustomizedNode>} nodes 节点对象集合\r\n     * @param {boolean} hasChangeNodeIdMethod 节点对象的id是否可被修改\r\n     */\r\n    cloneNodes(nodes, hasChangeNodeIdMethod = false) {\r\n      return nodes.map((n) => this.cloneNode(n, hasChangeNodeIdMethod));\r\n    },\r\n\r\n    changeNodeId(oldNodeId, newNodeId) {\r\n      const n = this.nodes.find((n) => n.id === oldNodeId);\r\n      n.id = newNodeId;\r\n      const t = Matrix.findNodeFromTree(oldNodeId, this.tree);\r\n      t.id = newNodeId;\r\n      // this.currActiveNodeId = newNodeId;\r\n    },\r\n\r\n    // 复制资源对象(主要用于事件对外输出资源对象)\r\n    cloneResource(resource, nodeId, hasChangeRsIdMethod = false) {\r\n      // const { id, type, url } = resource;\r\n      const _resource = new Resource(resource);\r\n      const _changeResourceId = this.changeResourceId;\r\n\r\n      // const _resource = {\r\n      //   type,\r\n      //   url,\r\n      //   nodeId,\r\n      // };\r\n\r\n      if (hasChangeRsIdMethod) {\r\n        return {\r\n          ..._resource,\r\n          get id() {\r\n            return _resource.id;\r\n          },\r\n          setId(v) {\r\n            _changeResourceId(nodeId, _resource.id, v);\r\n          },\r\n        };\r\n      } else {\r\n        return {\r\n          ..._resource,\r\n          id: _resource.id,\r\n        };\r\n      }\r\n    },\r\n\r\n    cloneFontStyle(fontStyle, nodeId) {\r\n      const { bold, italic, underline, color } = fontStyle;\r\n      return {\r\n        nodeId,\r\n        bold,\r\n        italic,\r\n        underline,\r\n        color,\r\n      };\r\n    },\r\n\r\n    changeResourceId(nodeId, oldResourceId, newResourceId) {\r\n      const n = this.nodes.find((n) => n.id === nodeId);\r\n      const rs = n.resources.find((rs) => rs.id === oldResourceId);\r\n      rs.id = newResourceId;\r\n    },\r\n\r\n    // 把元素前移一位\r\n    moveForward(arr, index) {\r\n      if (index > 0) arr[index] = arr.splice(index - 1, 1, arr[index])[0];\r\n    },\r\n\r\n    // 把元素后移一位\r\n    moveBackward(arr, index) {\r\n      if (index < arr.length - 1)\r\n        arr[index] = arr.splice(index + 1, 1, arr[index])[0];\r\n    },\r\n\r\n    toMapStyles() {\r\n      return {\r\n        width: this.mapSize.width,\r\n        height: this.mapSize.height,\r\n        scale: this.scaleValue,\r\n        top: this.mindmapMoveY,\r\n        left: this.mindmapMoveX,\r\n      };\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n<style lang="scss" scoped>\r\n@import "../scss/_variables.scss";\r\n@import "../scss/scrollbar.scss";\r\n\r\n.mind-map {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  box-sizing: border-box;\r\n  overflow: hidden;\r\n  background-color: #fff;\r\n\r\n  // $bottom-bar-height: 32px;\r\n\r\n  .main {\r\n    width: 100%;\r\n    // height: calc(100% - #{$bottom-bar-height});\r\n    box-sizing: border-box;\r\n    position: relative;\r\n\r\n    .scroll-frame {\r\n      width: 100%;\r\n      height: 100%;\r\n      position: relative;\r\n      box-sizing: border-box;\r\n      overflow: clip; // https://developer.mozilla.org/zh-CN/docs/Web/CSS/overflow#%E5%80%BC\r\n      // overflow: hidden;\r\n\r\n      display: flex;\r\n\r\n      .selection-frame-mask {\r\n        position: absolute;\r\n        z-index: 2000;\r\n        // width: 100%;\r\n        // height: 100%;\r\n      }\r\n\r\n      // &.horizontal {\r\n      //   justify-content: flex-start;\r\n      //   align-items: center;\r\n      // }\r\n\r\n      // &.vertical {\r\n      //   justify-content: center;\r\n      //   align-items: flex-start;\r\n      // }\r\n\r\n      .map-move-mask {\r\n        // width: 100%;\r\n        // height: 100%;\r\n        position: absolute;\r\n        top: 0px;\r\n        left: 0px;\r\n        // background-color: #ff00006b;\r\n\r\n        &.moving-mode {\r\n          cursor: grab;\r\n        }\r\n      }\r\n\r\n      .map {\r\n        transform-origin: left top;\r\n        box-sizing: border-box;\r\n        position: relative;\r\n\r\n        .container {\r\n          transform-origin: left top;\r\n          box-sizing: border-box;\r\n          position: absolute;\r\n          z-index: 0;\r\n\r\n          .cursor {\r\n            pointer-events: none; // 使节点的hover事件生效\r\n            position: absolute;\r\n            top: 0px;\r\n            left: 0px;\r\n            border-radius: 8px;\r\n            background-color: #034f928a;\r\n            cursor: grab;\r\n            z-index: 1200;\r\n          }\r\n\r\n          // .cursor-move-mask {\r\n          //   position: absolute;\r\n          //   background-color: #ff00006b;\r\n          //   z-index: 200;\r\n          // }\r\n\r\n          .cursor-move-mask {\r\n            transform-origin: left top;\r\n            position: absolute;\r\n            box-sizing: border-box;\r\n            width: 0px;\r\n            height: 0px;\r\n            top: 0px;\r\n            left: 0px;\r\n            // background-color: #ff00006b;\r\n            // z-index: 200;\r\n            .drop-zone-area {\r\n              width: 0px;\r\n              height: 0px;\r\n              position: absolute;\r\n              // top: 0px;\r\n              // left: 0px;\r\n              .offspring-drop-zone {\r\n                position: absolute;\r\n                // background-color: #ffff0080;\r\n                z-index: 1000;\r\n                &.enter {\r\n                  // background-color: #ff00006b;\r\n                  z-index: 900;\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          .mind-map-node {\r\n            // z-index: 1100;\r\n          }\r\n        }\r\n\r\n        .canvas {\r\n          transform-origin: left top;\r\n          position: absolute;\r\n          z-index: -100;\r\n          &.canvas-offspring-temp-line {\r\n            // background-color: #ff00006b;\r\n            z-index: 1100;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .bottom {\r\n    // height: $bottom-bar-height;\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  .map-operation {\r\n    position: absolute;\r\n    top: 8px;\r\n    left: 8px;\r\n  }\r\n\r\n  .scope-frame {\r\n    position: absolute;\r\n  }\r\n}\r\n\r\n.mind-map {\r\n  &.debugging {\r\n    .cursor-move-mask {\r\n      background-color: #ff00006b;\r\n    }\r\n    .offspring-drop-zone {\r\n      background-color: #ffff0080;\r\n    }\r\n  }\r\n}\r\n</style>']},media:void 0})}),Ye,"data-v-127bc0d8",!1,void 0,!1,T,void 0,void 0);function je(n){je.installed||(je.installed=!0,n.component("MindMap",Ge),n.component("BtnWrapper",ie))}var Xe={install:je},Qe=null;"undefined"!=typeof window?Qe=window.Vue:"undefined"!=typeof global&&(Qe=global.Vue),Qe&&Qe.use(Xe)}}]);