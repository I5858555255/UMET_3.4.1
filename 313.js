(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[313],{70313:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"商品列表(ODM)",isShowBottomBorder:""},slot:"title"}),t("template",{slot:"content"},[t("ai-search-bar",{scopedSlots:e._u([{key:"left",fn:function(){return[t("div",{staticClass:"search-item"},[t("label",[e._v("可售天数小于：")]),t("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入SKC ID"},model:{value:e.search.ableSaleDays,callback:function(t){e.$set(e.search,"ableSaleDays",t)},expression:"search.ableSaleDays"}})],1)]},proxy:!0},{key:"right",fn:function(){},proxy:!0}])}),t("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"商品列表"},scopedSlots:e._u([{key:"right",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:e.exportToExcel}},[e._v("导出")])]},proxy:!0}])},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:e.filteredData,"col-configs":e.colConfigs,height:"600"},on:{getList:()=>{}}},[t("el-table-column",{attrs:{slot:"goodsThumb",width:"120px",label:"商品图片",fixed:"left"},slot:"goodsThumb",scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",[t("el-image",{staticClass:"image",staticStyle:{width:"40px",height:"40px"},attrs:{src:e.row.goodsThumb,"preview-src-list":[e.row.goodsThumb]}})],1)]}}])})],1)],1)],1)],2)},n=[],s=(o(44114),o(98992),o(54520),o(81454),o(14603),o(47566),o(98721),o(73236)),i=o(31052),l=o(3959),r=o(4213),c={name:"ProductListOdm",data(){return{isLoading:!1,list:[],mallId:"",colConfigs:[{slot:"goodsThumb",label:"商品图片",align:"left"},{prop:"skc",label:"SKC ID",align:"left"},{prop:"supplierCode",label:"SKC货号",align:"left"},{prop:"sku",label:"SKU ID",align:"left"},{prop:"suffixZh",label:"属性集",align:"left"},{prop:"num",label:"建议备货数量",align:"left",sortable:!0,"sort-method":(e,t)=>Number(e.num)-Number(t.num)},{prop:"warningDaysNew",label:"备货预警天数",align:"left"},{prop:"ableSaleDays",label:"可售天数",align:"left",sortable:!0,"sort-method":(e,t)=>e.ableSaleDays-t.ableSaleDays},{prop:"saleInfoWeek",label:"近7天销量",align:"left",sortable:!0,"sort-method":(e,t)=>e.saleInfoWeek-t.saleInfoWeek},{prop:"saleInfoMonth",label:"本月销量",align:"left",sortable:!0,"sort-method":(e,t)=>e.saleInfoMonth-t.saleInfoMonth},{prop:"saleInfoPreMonth",label:"上月销量",align:"left",sortable:!0,"sort-method":(e,t)=>e.saleInfoPreMonth-t.saleInfoPreMonth}],search:{unSet:!1,skc:"",sku:"",skcCode:""},tableData:[],currentPage:1}},computed:{filteredData(){const e=this.list.filter((e=>{let t=!0;return this.search.ableSaleDays&&(""==e.ableSaleDays||Number(e.ableSaleDays)>Number(this.search.ableSaleDays))&&(t=!1),t}));return e}},mounted(){this.$http.post("/api/malluser/info").then((e=>{if(0==e.code){if(this.$store.commit("setUserInfo",e.data),1!=e.data.flag)return i.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0);this.getUserInfo(),this.isLoading=!0,this.getList()}}))},methods:{async getUserInfo(){let e=await(0,s.Rh)({url:"sso-prefix/auth/getUser?uuid="+Date.now(),method:"GET"});"0"==e.code&&"OK"==e.msg?this.mallId=e.info.merchantCode:100004!=e.code&&20302!=e.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},async getList(){let e=await(0,s.Rh)({url:"gmpj/goods/goods/list",method:"POST",data:{mallStatusList:[1],page:this.currentPage,perPage:100}});if("0"==e.code){for(let t=0;t<e.info.list.length;t++){let o=e.info.list[t],a={goodsThumb:o.goodsThumb,skc:o.skc,supplierCode:o.supplierCode};for(let e=0;e<o.sizes.length;e++){let t=o.sizes[e];a={...a,sku:t.skuCode,suffixZh:t.suffixZh,ableSaleDays:t.ableSaleDays,saleInfoWeek:t.saleInfoWeek,saleInfoMonth:t.saleInfoMonth,warningDaysNew:o.warningDaysNew,saleInfoPreMonth:t.saleInfoPreMonth},o.warningDaysNew>0&&(a.num=((o.warningDaysNew-Number(t.ableSaleDays))*(t.saleInfoWeek/7)).toFixed(2),a.num<0&&(a.num=0)),this.list.push(a)}}100==e.info.list.length&&e.info.count>100*this.currentPage?(this.currentPage++,await this.sleepSync(200),await this.getList()):this.isLoading=!1}else 100004!=e.code&&20302!=e.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},sleepSync(e){return new Promise((t=>setTimeout(t,e)))},exportToExcel(){const e=[["商品图片","SKC","SKC货号","SKU","属性集","建议备货数量"," 备货预警天数","可售天数","近7天销量","本月销量","上月销量"]];this.filteredData.map((t=>{e.push([t.goodsThumb,t.skc,t.supplierCode,t.sku,t.suffixZh,t.num,t.warningDaysNew,t.ableSaleDays,t.saleInfoWeek,t.saleInfoMonth,t.saleInfoPreMonth])}));const t=l.Wp.aoa_to_sheet(e),o=l.Wp.book_new();l.Wp.book_append_sheet(o,t,"Sheet1");const a=l.M9(o,{bookType:"xlsx",type:"array"}),n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),s=window.URL.createObjectURL(n);(0,r.saveAs)(n,"商品列表.xlsx"),window.URL.revokeObjectURL(s)}}},d=c,u=(o(50147),o(81656)),f=(0,u.A)(d,a,n,!1,null,"11c710c5",null),p=f.exports},3713:function(e,t,o){"use strict";o.r(t);var a=o(31601),n=o.n(a),s=o(76314),i=o.n(s),l=i()(n());l.push([e.id,".list .title-right[data-v-11c710c5]{display:flex;align-items:center}.list .title-right>div[data-v-11c710c5]:first-child{margin-right:20px}.list[data-v-11c710c5].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),t["default"]=l},4213:function(e,t,o){var a,n,s;(function(o,i){n=[],a=i,s="function"===typeof a?a.apply(t,n):a,void 0===s||(e.exports=s)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function a(e,t,o){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){r(a.response,t,o)},a.onerror=function(){console.error("could not download file")},a.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,o){var l=i.URL||i.webkitURL,r=document.createElement("a");t=t||e.name||"download",r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin===location.origin?s(r):n(r.href)?a(e,t,o):s(r,r.target="_blank")):(r.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(r.href)}),4e4),setTimeout((function(){s(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,i){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),o);else if(n(e))a(e,o,i);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){s(l)}))}}:function(e,t,o,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return a(e,t,o);var s="application/octet-stream"===e.type,r=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&r||l)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var u=i.URL||i.webkitURL,f=u.createObjectURL(e);n?n.location=f:location.href=f,n=null,setTimeout((function(){u.revokeObjectURL(f)}),4e4)}});i.saveAs=r.saveAs=r,e.exports=r}))},50147:function(e,t,o){var a=o(3713);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var n=o(99548).A;n("727d3279",a,!0,{sourceMap:!1,shadowMode:!1})}}]);