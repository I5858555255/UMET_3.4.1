(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[3428],{93428:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var i=function(){var e=this,t=e._self._c;return t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"发货订单",isShowBottomBorder:""},slot:"title",scopedSlots:e._u([{key:"rightBtn",fn:function(){return[t("div",{staticClass:"title-right"},[t("div",[t("label",[e._v("订单状态：")]),t("el-select",{attrs:{multiple:"",placeholder:"请选择",size:"small"},model:{value:e.reqData.status,callback:function(t){e.$set(e.reqData,"status",t)},expression:"reqData.status"}},e._l(e.statusList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",[t("label",{staticStyle:{width:"90px"}},[e._v("下单时间：")]),t("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:e.toSearch}},[e._v("查询")])],1)]},proxy:!0}])}),t("template",{slot:"content"},[t("ai-search-bar",{scopedSlots:e._u([{key:"left",fn:function(){return[t("el-radio-group",{on:{change:e.changeTab},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[t("el-radio-button",{attrs:{label:"urgent"}},[e._v("急采")]),t("el-radio-button",{attrs:{label:"normal"}},[e._v("备货")])],1)]},proxy:!0},{key:"right",fn:function(){},proxy:!0}])}),t("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"urgent"==e.type?"急采订单列表":"备货订单列表"},scopedSlots:e._u([{key:"right",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:e.exportToExcel}},[e._v("导出")])]},proxy:!0}])},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:e.tableData,"col-configs":e.colConfigs,height:"700"},on:{getList:()=>{}}})],1)],1)],2)},o=[],n=(a(44114),a(81454),a(14603),a(47566),a(98721),a(73236)),r=a(31052),s=a(3959),l=a(4213),d={name:"OrderListShein",data(){return{isLoading:!1,storeCode:"",type:"urgent",colConfigs:[{prop:"orderNo",label:"订单号",align:"left"},{prop:"skc",label:"SKC ID",align:"left"},{prop:"skuCode",label:"SKU ID",align:"left"},{prop:"supplierCode",label:"货号",align:"left"},{prop:"supplierSku",label:"SKU货号",align:"left"},{prop:"suffixZh",label:"属性集"},{prop:"price",label:"申报价格"},{prop:"costPrice",label:"成本价格"},{prop:"orderQuantity",label:"下单数量",align:"left"},{prop:"needQuantity",label:"需求数量",align:"left"},{prop:"deliveryQuantity",label:"送货数量",align:"left"},{prop:"groundingQuantity",label:"正品数量",align:"left"},{prop:"defectiveQuantity",label:"次品数量",align:"left"},{prop:"addTime",label:"下单时间",align:"left"}],tableData:[],dateRange:[],reqData:{page:1,allocateTimeEnd:null,allocateTimeStart:null,deliveryNo:null,deliveryNos:[],deliveryTimeEnd:"",deliveryTimeStart:"",finishTimeEnd:"",finishTimeStart:"",ids:[],inspectionTimeEnd:"",inspectionTimeStart:"",launchTimeEnd:"",launchTimeStart:"",mode:"",orderColumn:"",orderType:1,overdueTypes:[],prepareTypes:[],requestDeliveryTimeEnd:"",requestDeliveryTimeStart:"",requestTakeParcelTimeEnd:"",requestTakeParcelTimeStart:"",reserveDeliveryTimeEnd:"",reserveDeliveryTimeStart:"",sellerOrderNo:null,sellerOrderNos:[],skcName:null,skcNames:[],sourceOrderNoArray:[],status:[2,5],suffixZh:"",supplierCode:null,supplierCodes:[],supplierSkuList:[],supplierSku:null,skuCodeList:[],skuCode:null,perPage:200},statusList:[{id:2,name:"待发货"},{id:3,name:"已送货"},{id:4,name:"已收货"},{id:5,name:"已退货"},{id:6,name:"已完成"},{id:7,name:"已上架"},{id:8,name:"已作废"}],currentPage:1,productList:[]}},mounted(){this.getStoreCode()},methods:{toSearch(){this.dateRange?(this.reqData.allocateTimeStart=this.dateRange[0],this.reqData.allocateTimeEnd=this.dateRange[1],this.$http.post("/api/malluser/info").then((e=>{if(0==e.code){if(this.$store.commit("setUserInfo",e.data),1!=e.data.flag)return r.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0);this.getList()}}))):r.Message.error("请选择时间范围")},changeTab(){this.tableData=[]},async getList(){this.isLoading=!0,this.reqData.page=1,this.tableData=[],"urgent"==this.type?this.reqData.orderType="1":this.reqData.orderType="2",await this.getOrderList(),this.isLoading=!1},async getOrderList(){let e=await(0,n.Rh)({url:"pfmp/order/list",method:"POST",data:this.reqData});if("0"==e.code){for(let t=0;t<e.info.data.length;t++){let a=e.info.data[t],i={orderNo:a.sellerOrderNo,supplierCode:a.goods.supplierCode,statusName:a.statusName,skc:a.goods.skcName,imgPath:a.goods.imgPath,addTime:a.addTime};for(let e=0;e<a.detail.length;e++)i={...i,skuCode:a.detail[e].skuCode,price:a.detail[e].supplyPrice,orderQuantity:a.detail[e].orderQuantity,needQuantity:a.detail[e].needQuantity,deliveryQuantity:a.detail[e].deliveryQuantity,groundingQuantity:a.detail[e].groundingQuantity,defectiveQuantity:a.detail[e].defectiveQuantity,costPrice:null,supplierSku:a.detail[e].supplierSku,suffixZh:a.detail[e].suffixZh},this.tableData.push(i)}200==e.info.data.length&&e.info.meta.count>200*this.currentPage?(this.reqData.page++,await this.$sleepSync(200),await this.getOrderList()):this.tableData.map((e=>{e.costPrice=this.getCost(e.skuCode)}))}else 100004!=e.code&&20302!=e.code||this.$store.commit("setSheinAlertShow",!0)},async getStoreCode(){let e=await(0,n.Rh)({url:"sso-prefix/auth/getUser?uuid="+Date.now(),method:"GET"});"0"==e.code&&"OK"==e.msg?(this.storeCode=e.info.merchantCode,this.getPorductList()):100004!=e.code&&20302!=e.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},getCost(e){for(let t=0;t<this.productList.length;t++)if(e==this.productList[t].sku)return this.productList[t].costPrice;return 0},getPorductList(){this.$http.post("/api/skuCost/listAll",null,{params:{mallId:this.storeCode}}).then((e=>{0==e.code&&(this.productList=e.data)}))},exportToExcel(){const e=[["订单号","SKC ID","SKU ID","图片地址","货号","SKU货号","属性集","申报价格","成本价格","下单数量","需求数量","送货数量","正品数量","次品数量","下单时间"]];this.tableData.map((t=>{e.push([t.orderNo,t.skc,t.skuCode,t.imgPath,t.supplierCode,t.supplierSku,t.suffixZh,t.price,t.costPrice,t.orderQuantity,t.needQuantity,t.deliveryQuantity,t.groundingQuantity,t.defectiveQuantity,t.addTime])}));const t=s.Wp.aoa_to_sheet(e),a=s.Wp.book_new();s.Wp.book_append_sheet(a,t,"Sheet1");const i=s.M9(a,{bookType:"xlsx",type:"array"}),o=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),n=window.URL.createObjectURL(o);(0,l.saveAs)(o,"订单列表.xlsx"),window.URL.revokeObjectURL(n)}}},u=d,c=(a(30737),a(81656)),p=(0,c.A)(u,i,o,!1,null,"561fb926",null),f=p.exports},26403:function(e,t,a){"use strict";a.r(t);var i=a(31601),o=a.n(i),n=a(76314),r=a.n(n),s=r()(o());s.push([e.id,".list .title-right[data-v-561fb926]{display:flex;align-items:center}.list .title-right>div[data-v-561fb926]:first-child{margin-right:20px}.list[data-v-561fb926].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),t["default"]=s},4213:function(e,t,a){var i,o,n;(function(a,r){o=[],i=r,n="function"===typeof i?i.apply(t,o):i,void 0===n||(e.exports=n)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,a){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){l(i.response,t,a)},i.onerror=function(){console.error("could not download file")},i.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,a){var s=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?n(l):o(l.href)?i(e,t,a):n(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){n(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,r){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),a);else if(o(e))i(e,a,r);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){n(s)}))}}:function(e,t,a,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,a);var n="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||n&&l||s)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var c=r.URL||r.webkitURL,p=c.createObjectURL(e);o?o.location=p:location.href=p,o=null,setTimeout((function(){c.revokeObjectURL(p)}),4e4)}});r.saveAs=l.saveAs=l,e.exports=l}))},30737:function(e,t,a){var i=a(26403);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var o=a(99548).A;o("87bfd06e",i,!0,{sourceMap:!1,shadowMode:!1})}}]);