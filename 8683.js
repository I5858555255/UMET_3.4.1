(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[8683],{48683:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"创建备货单",tips:"请先在当前浏览器登录“拼多多跨境卖家中心”，期间保持登录状态",isShowBottomBorder:""},slot:"title"}),e("template",{slot:"content"},[e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("el-dropdown",{on:{command:t.handleClick}},[e("el-button",{attrs:{type:"primary",disabled:t.isBegin}},[t._v("添加待创建备货单")]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"byStore"}},[t._v("按店铺添加")]),e("el-dropdown-item",{attrs:{command:"loadAll"}},[t._v("一键添加所有")])],1)],1),e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:t.beginCreate}},[t._v("开始创建")])]},proxy:!0}])}),e("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:t.choosedList,"col-configs":t.robColConfigs,total:t.total,height:"500",isShowPagination:!1}},[e("el-table-column",{attrs:{slot:"productName",width:"480px",label:"基本信息",align:"center"},slot:"productName",scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"product"},[e("img",{attrs:{src:a.row.productSkcPicture}}),e("div",{staticClass:"right"},[e("div",[t._v("备货母单号: "+t._s(a.row.subPurchaseOrderSn))]),e("div",[t._v("SKC: "+t._s(a.row.productSkcId))]),e("div",[t._v("货号: "+t._s(a.row.productSn))])])])]}}])}),e("el-table-column",{attrs:{slot:"purchaseTime",width:"180px",label:"下单时间",align:"center"},slot:"purchaseTime",scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatTime(e.row.purchaseTime))+" ")]}}])}),e("el-table-column",{attrs:{slot:"className",label:"SKU信息",width:"440px","show-overflow-tooltip":"",align:"center"},slot:"className",scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.skuQuantityDetailList,(function(a,s){return e("div",{key:s,staticClass:"order-manage_skuInfo__FW-Nd"},[e("div",[e("div",{staticClass:"outerWrapper-1-3-1 outerWrapper-d18-1-3-20 index-module__image-preview___2fiZX",attrs:{"data-testid":"beast-core-box"}},[e("div",{staticClass:"index-module__img___p3B1N",style:t.getStyle(a.thumbUrlList[0])})])]),e("div",{staticClass:"order-manage_contentInfo__1Cjd6"},[e("div",[t._v("属性集："+t._s(a.extCode))]),e("div",[t._v("待发货数："+t._s(a.purchaseQuantity))]),e("div",[t._v("SKU ID： "+t._s(a.productSkuId))])])])}))}}])}),t.isBegin?t._e():e("el-table-column",{attrs:{slot:"options",label:"操作",width:"80px","show-overflow-tooltip":"",align:"center",fixed:"right"},slot:"options",scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("div",{staticClass:"table-options"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.remove(a.subPurchaseOrderSn)}}},[t._v("移除")])],1)]}}],null,!1,3324113772)})],1),e("AiDialog",{attrs:{title:"添加备货单",visible:t.isShow,"close-on-click-modal":!1,customFooter:"",width:"1290px"},on:{"update:visible":function(e){t.isShow=e},confirm:t.onConfirm}},[e("label",{staticStyle:{width:"90px"}},[t._v("店铺：")]),e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.mallChange},model:{value:t.mallId,callback:function(e){t.mallId=e},expression:"mallId"}},t._l(t.mallList,(function(a){return e("el-option",{key:a.mallId,attrs:{label:a.mallName,value:a.mallId}},[t._v(" "+t._s(a.mallName)+" ")])})),1),e("ai-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isDlgLoading,expression:"isDlgLoading"}],staticStyle:{"margin-top":"8px"},attrs:{tableData:t.tableData,"col-configs":t.colConfigs,total:t.total,isShowPagination:!1},on:{"selection-change":t.onChooseChange}},[e("el-table-column",{attrs:{slot:"productName",width:"480px",label:"基本信息",align:"center"},slot:"productName",scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"product"},[e("img",{attrs:{src:a.row.productSkcPicture}}),e("div",{staticClass:"right"},[e("div",[t._v("备货母单号: "+t._s(a.row.subPurchaseOrderSn))]),e("div",[t._v("SKC: "+t._s(a.row.productSkcId))]),e("div",[t._v("货号: "+t._s(a.row.productSn))])])])]}}])}),e("el-table-column",{attrs:{slot:"purchaseTime",width:"180px",label:"下单时间",align:"center"},slot:"purchaseTime",scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatTime(e.row.purchaseTime))+" ")]}}])}),e("el-table-column",{attrs:{slot:"className",label:"SKU信息",width:"440px","show-overflow-tooltip":"",align:"center"},slot:"className",scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.skuQuantityDetailList,(function(a,s){return e("div",{key:s,staticClass:"order-manage_skuInfo__FW-Nd"},[e("div",[e("div",{staticClass:"outerWrapper-1-3-1 outerWrapper-d18-1-3-20 index-module__image-preview___2fiZX",attrs:{"data-testid":"beast-core-box"}},[e("div",{staticClass:"index-module__img___p3B1N",style:t.getStyle(a.thumbUrlList[0])})])]),e("div",{staticClass:"order-manage_contentInfo__1Cjd6"},[e("div",[t._v("SKU货号："+t._s(a.extCode))]),e("div",[t._v("待发货数："+t._s(a.purchaseQuantity))]),e("div",[t._v("SKU ID： "+t._s(a.productSkuId))])])])}))}}])})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isShow=!1}}},[t._v("关 闭")]),e("el-button",{attrs:{type:"primary"},on:{click:t.onConfirm}},[t._v("添加")])],1)],1)],1)],2)],1)},i=[],l=(a(44114),a(98992),a(54520),a(81454),a(95353)),o=a(73236),r=a(31052),n=a(31981),d={name:"ShippingDesk",data(){return{isShow:!1,colConfigs:[{type:"selection",width:"70px",align:"left"},{slot:"productName"},{slot:"subWarehouseName"},{prop:"mallName",label:"店铺来源",align:"center"},{slot:"className"},{slot:"purchaseTime"}],robColConfigs:[{slot:"productName"},{slot:"subWarehouseName"},{prop:"mallName",label:"店铺来源",align:"center"},{slot:"className"},{slot:"purchaseTime"}],mallId:"",mallName:"",tableData:[],total:0,isBegin:!1,choosedList:[],choosedSnMallList:[],arr:[],createTotal:0,pageSize:100,currentPage:1,loadMallIndex:0,loadMode:0,isLoading:!1,isDlgLoading:!1,addressList:[]}},computed:{...(0,l.aH)(["mallList"])},created(){},methods:{onChooseChange(t){this.arr=t},mallChange(){this.$userCheck(this.mallId).then((()=>{let t=this.mallList.filter((t=>t.mallId==this.mallId));this.mallName=t[0].mallName,this.loadMode=0,this.tableData=[],this.currentPage=1,this.isDlgLoading=!0,this.getList(this.tableData,this.mallId,this.mallName,1)})).catch((t=>{this.mallId="",console.log(t)}))},onConfirm(){0!=this.arr.length?(this.arr.map((t=>{let e=this.choosedList.filter((e=>e.subPurchaseOrderSn==t.subPurchaseOrderSn));0==e.length&&this.choosedList.push(t)})),r.Message.success("添加成功，可继续添加")):r.Message.error("请选择待创建备货单")},loadAll(){this.$userCheck().then((()=>{this.choosedList=[],this.currentPage=1,this.isLoading=!0,3==this.$store.state.userInfo.type?(this.loadMode=0,this.getList(this.choosedList,this.$store.state.mallId,this.$store.state.mallName,1)):(this.loadMallIndex=0,this.loadMode=1,this.getList(this.choosedList,this.mallList[this.loadMallIndex].mallId,this.mallList[this.loadMallIndex].mallName,1))}))},handleClick(t){"byStore"===t?this.isShow=!0:"loadAll"===t&&this.loadAll()},beforeBegin(){this.choosedList.length<=0?r.Message.error("请先添加备货单"):this.beginCreate()},async getList(t,e,a,s){let i=await(0,o.w4)({url:"oms/bg/venom/api/supplier/purchase/manager/querySubOrderList",needMallId:!0,anti:!0,mallId:e,data:{pageNo:s,pageSize:100,urgencyType:0,isCustomGoods:!1,statusList:[0],oneDimensionSort:{firstOrderByParam:"expectLatestDeliverTime",firstOrderByDesc:0}}});1e6==i.errorCode?(i.result.subOrderForSupplierList.map((s=>{t.push({...s,mallId:e,mallName:a})})),this.pageSize==i.result.subOrderForSupplierList.length?(s++,this.getList(t,e,a,s)):1==this.loadMode?(this.loadMallIndex++,this.loadMallIndex<this.mallList.length?(await this.$sleepSync(500),await this.getList(t,this.mallList[this.loadMallIndex].mallId,this.mallList[this.loadMallIndex].mallName,1)):(this.isLoading=!1,this.isDlgLoading=!1,r.Message.success("所有店铺待创建备货单已加载完成"))):(this.isLoading=!1,this.isDlgLoading=!1)):this.getList(t,e,a,s)},remove(t){for(let e=0;e<this.choosedList.length;e++)if(this.choosedList[e].subPurchaseOrderSn==t){this.choosedList.splice(e,1);break}},getStyle(t){return"background-image: url("+t+"); width: 72px; height: 72px; cursor: pointer; border-radius: 6px; border: 1px solid rgba(0, 0, 0, 0.14);"},async beginCreate(){let t=[];for(let e=0;e<this.mallList.length;e++){let a=[];this.choosedList.map((t=>{t.mallId==this.mallList[e].mallId&&a.push(t.subPurchaseOrderSn)})),a.length>0&&t.push({mallId:this.mallList[e].mallId,subPurchaseOrderSnList:a})}for(let e=0;e<t.length;e++){let a=await(0,o.w4)({url:"oms/bg/venom/api/supplier/purchase/manager/batchAcceptSubPurchaseOrder",needMallId:!0,anti:!0,mallId:t[e].mallId,data:{subPurchaseOrderSnList:t[e].subPurchaseOrderSnList,confirmFulfilment:!1}});if(a.success&&1e6==a.errorCode&&a.result.isSuccess)for(let s=0;s<t[e].subPurchaseOrderSnList.length;s++)this.remove(t[e].subPurchaseOrderSnList[s])}},formatTime(t){return(0,n.z)(t)}}},c=d,u=(a(62629),a(81656)),h=(0,u.A)(c,s,i,!1,null,"b21ff6a8",null),p=h.exports},80947:function(t,e,a){"use strict";a.r(e);var s=a(31601),i=a.n(s),l=a(76314),o=a.n(l),r=o()(i());r.push([t.id,".product[data-v-b21ff6a8]{display:flex;align-items:center;justify-content:center}.product .right[data-v-b21ff6a8]{flex:1;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.product img[data-v-b21ff6a8]{width:60px;margin-right:10px}.tips[data-v-b21ff6a8]{position:relative;width:40px;height:40px;border-radius:50%;background:rgba(243,8,8,.4)}@keyframes warn-b21ff6a8{0%{transform:translate(-50%,-50%) scale(0);opacity:1}to{transform:translate(-50%,-50%) scale(1.1);opacity:0}}.tips div[data-v-b21ff6a8]{position:absolute;left:50%;top:50%;z-index:11;width:100px;height:100px;border-radius:50%;animation:warn-b21ff6a8 .9s ease-out;animation-iteration-count:infinite;box-shadow:1px 1px 30px #ef2d02;transform:translate(-50%,-50%) scale(.2);transition:all .6s ease-in-out;background:rgba(243,8,8,.6)}.order-manage_productInfo__1pD83>img[data-v-b21ff6a8]{width:60px;margin-right:10px}.order-manage_productInfo__1pD83[data-v-b21ff6a8]{min-height:60px;padding-left:70px;position:relative}.order-manage_productInfo__1pD83>div[data-v-b21ff6a8]:nth-child(2){color:rgba(0,0,0,.8)}.outerWrapper[data-v-b21ff6a8]{margin:4px 4px 0 0}.dot-module__dot___M-RuH .dot-module__circle___2l2UV[data-v-b21ff6a8]{flex-shrink:0;width:8px;height:8px;border-radius:50%;margin-right:8px}.dot-module__dot___M-RuH[data-v-b21ff6a8]{display:inline-flex;align-items:center}.index-module__image-preview___2fiZX .index-module__img___p3B1N[data-v-b21ff6a8]{width:60px;height:60px;margin-right:10px;background-repeat:no-repeat;background-size:cover;background-color:#f5f5f5;font-size:12px;display:flex;justify-content:center;align-items:center;color:var(--bc-Table-emptyTextColor);position:relative}.textoverflow[data-v-b21ff6a8]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer}.order-manage_skuInfo__FW-Nd[data-v-b21ff6a8]{display:flex;align-items:center;justify-content:center;margin-bottom:10px}.order-manage_skuInfo__FW-Nd[data-v-b21ff6a8]:last-child{margin-bottom:0}.order-manage_skuInfo__FW-Nd .order-manage_contentInfo__1Cjd6[data-v-b21ff6a8]{display:flex;flex-direction:column;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:240px}.order-manage_skuInfo__FW-Nd .order-manage_contentInfo__1Cjd6 .order-manage_title__1VTO5[data-v-b21ff6a8]{flex-wrap:wrap;color:rgba(0,0,0,.8)}",""]),e["default"]=r},62629:function(t,e,a){var s=a(80947);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);var i=a(99548).A;i("431f158f",s,!0,{sourceMap:!1,shadowMode:!1})}}]);