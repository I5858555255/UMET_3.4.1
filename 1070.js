(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[1070],{11070:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",[t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"发货(芯仓)",tips:"请先在当前浏览器登录“拼多多跨境卖家中心”，期间保持登录状态",isShowBottomBorder:""},slot:"title"}),t("template",{slot:"content"},[t("ai-search-bar",{scopedSlots:e._u([{key:"left",fn:function(){return[t("el-radio-group",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[t("el-radio-button",{attrs:{label:"0"}},[e._v("数据同步")]),t("el-radio-button",{attrs:{label:"1"}},[e._v("发货")])],1)]},proxy:!0},{key:"right",fn:function(){},proxy:!0}])}),"0"==e.type?t("ai-card",{key:0,staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:e._u([{key:"right",fn:function(){return[t("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(t){e.isShow=!0}}},[e._v("添加待发货订单")]),t("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:e.beginCreate}},[e._v("订单同步")])]},proxy:!0}],null,!1,2584698212)},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:e.choosedList,"col-configs":e.robColConfigs,total:e.total,height:"500",isShowPagination:!1}},[t("el-table-column",{attrs:{slot:"productName",width:"480px",label:"订单信息",align:"center"},slot:"productName",scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"product"},[t("img",{attrs:{src:a.row.productSkcPicture}}),t("div",{staticClass:"right"},[t("div",[e._v(e._s(a.row.parentOrderMap.parentOrderSn))]),t("div",[e._v("站点名: "+e._s(a.row.parentOrderMap.siteName))]),t("div",[e._v("国家/地区: "+e._s(a.row.parentOrderMap.regionName1))])])])]}}],null,!1,1186287124)}),t("el-table-column",{attrs:{slot:"purchaseTime",width:"180px",label:"订单创建时间",align:"center"},slot:"purchaseTime",scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.parentOrderMap.parentOrderTimeStr)+" ")]}}],null,!1,2321116495)}),t("el-table-column",{attrs:{slot:"className",label:"子订单信息",width:"440px","show-overflow-tooltip":"",align:"center"},slot:"className",scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row.orderList,(function(a,r){return t("div",{key:r,staticClass:"order-manage_skuInfo__FW-Nd"},[t("div",[t("div",{staticClass:"outerWrapper-1-3-1 outerWrapper-d18-1-3-20 index-module__image-preview___2fiZX",attrs:{"data-testid":"beast-core-box"}},[t("div",{staticClass:"index-module__img___p3B1N",style:e.getStyle(a.thumbUrl)})])]),t("div",{staticClass:"order-manage_contentInfo__1Cjd6"},[t("div",[e._v("子订单号："+e._s(a.orderSn))]),t("div",[e._v("SKU ID："+e._s(a.productInfoList[0].productSkuId))]),t("div",[e._v("SKC ID："+e._s(a.productInfoList[0].productSkcId))]),t("div",[e._v("SKU 货号： "+e._s(a.extCodeList[0]))]),t("div",[e._v("属性： "+e._s(a.spec))]),t("div",[e._v("库存扣减仓库： "+e._s(a.warehouseName))])])])}))}}],null,!1,1911610231)}),e.isBegin?e._e():t("el-table-column",{attrs:{slot:"options",label:"操作",width:"80px","show-overflow-tooltip":"",align:"center",fixed:"right"},slot:"options",scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("div",{staticClass:"table-options"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.remove(a.parentOrderMap.parentOrderSn)}}},[e._v("移除")])],1)]}}],null,!1,2658769983)})],1)],1):e._e(),"1"==e.type?t("ai-card",{key:1,staticStyle:{"padding-bottom":"40px"},attrs:{title:"待发货列表"},scopedSlots:e._u([{key:"right",fn:function(){return[t("ai-search-bar",{scopedSlots:e._u([{key:"right",fn:function(){return[t("div",[t("div",{staticClass:"search-item",staticStyle:{"margin-top":"20px"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择店铺",size:"small"},on:{change:e.getOrderList},model:{value:e.form.mallId,callback:function(t){e.$set(e.form,"mallId",t)},expression:"form.mallId"}},e._l(e.mallList,(function(e){return t("el-option",{key:e.mallId,attrs:{label:e.mallName,value:e.mallId}})})),1)],1)])]},proxy:!0}],null,!1,344928562)})]},proxy:!0}],null,!1,2370990103)},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:e.orderDataList,"col-configs":e.orderByDateColConfig,height:"700",size:100,current:e.form.current,size:e.form.size,total:e.orderTotal},on:{"update:current":function(t){return e.$set(e.form,"current",t)},"update:size":function(t){return e.$set(e.form,"size",t)},getList:e.getOrderList}},[t("el-table-column",{attrs:{slot:"expand",type:"expand"},slot:"expand",scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-table",{attrs:{data:a.row.details}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-table",{attrs:{data:a.row.details}},[t("el-table-column",{attrs:{prop:"sku",label:"SKU"}}),t("el-table-column",{attrs:{prop:"warehouseId",label:"海外仓"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e.$dict.getLabel("semi_warehouse",a.row.warehouseId)))])]}}],null,!0)}),t("el-table-column",{attrs:{prop:"warehouseCode",label:"海外仓子仓"}}),t("el-table-column",{attrs:{prop:"productTitle",label:"商品名称(中文)"}}),t("el-table-column",{attrs:{prop:"productTitleEn",label:"商品名称(英文)"}}),t("el-table-column",{attrs:{prop:"num",label:"数量"}}),t("el-table-column",{attrs:{prop:"logisticId",label:"物流单号"}}),t("el-table-column",{attrs:{prop:"expressCompany",label:"物流方式"}}),t("el-table-column",{attrs:{prop:"expressId",label:"物流公司"}})],1)]}}],null,!0)}),t("el-table-column",{attrs:{prop:"mallName",label:"店铺名称"}}),t("el-table-column",{attrs:{prop:"orderId",label:"订单号"}}),t("el-table-column",{attrs:{prop:"receiveName",label:"收货人"}}),t("el-table-column",{attrs:{prop:"receivePhone",label:"收货人手机号"}}),t("el-table-column",{attrs:{prop:"createTime",label:"下单时间"}})],1)]}}],null,!1,2243625683)}),t("el-table-column",{attrs:{slot:"options",label:"操作",align:"center",width:"500px"},slot:"options",scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("div",{staticClass:"table-options"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.sendGoods(a.details)}}},[e._v("发货(线上)")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.toDownloadExcel(a.details)}}},[e._v("下载Excel")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.copyOrderIds(a.details)}}},[e._v("复制当前PO单号")])],1)]}}],null,!1,532361105)})],1)],1):e._e(),t("AiDialog",{attrs:{title:"添加待发货订单",visible:e.isShow,"close-on-click-modal":!1,customFooter:"",width:"1290px"},on:{"update:visible":function(t){e.isShow=t},confirm:e.onConfirm}},[t("label",{staticStyle:{width:"90px"}},[e._v("店铺：")]),t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.mallChange},model:{value:e.mallId,callback:function(t){e.mallId=t},expression:"mallId"}},e._l(e.mallList,(function(a){return t("el-option",{key:a.mallId,attrs:{label:a.mallName,value:a.mallId}},[e._v(" "+e._s(a.mallName)+" ")])})),1),t("label",{staticStyle:{width:"90px"}},[e._v("地区：")]),t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.regionChange},model:{value:e.regionId,callback:function(t){e.regionId=t},expression:"regionId"}},e._l(e.regionList,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1),t("ai-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isDlgLoading,expression:"isDlgLoading"}],staticStyle:{"margin-top":"8px"},attrs:{tableData:e.tableData,"col-configs":e.colConfigs,total:e.total,isShowPagination:!1},on:{"selection-change":e.onChooseChange}},[t("el-table-column",{attrs:{slot:"productName",width:"320px",label:"订单信息",align:"center"},slot:"productName",scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"product"},[t("img",{attrs:{src:a.row.productSkcPicture}}),t("div",{staticClass:"right"},[t("div",[e._v(e._s(a.row.parentOrderMap.parentOrderSn))]),t("div",[e._v("站点名: "+e._s(a.row.parentOrderMap.siteName))]),t("div",[e._v("国家/地区: "+e._s(a.row.parentOrderMap.regionName1))])])])]}}])}),t("el-table-column",{attrs:{slot:"purchaseTime",width:"180px",label:"订单创建时间",align:"center"},slot:"purchaseTime",scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.parentOrderMap.parentOrderTimeStr)+" ")]}}])}),t("el-table-column",{attrs:{slot:"className",label:"子订单信息",width:"440px","show-overflow-tooltip":"",align:"center"},slot:"className",scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row.orderList,(function(a,r){return t("div",{key:r,staticClass:"order-manage_skuInfo__FW-Nd"},[t("div",[t("div",{staticClass:"outerWrapper-1-3-1 outerWrapper-d18-1-3-20 index-module__image-preview___2fiZX",attrs:{"data-testid":"beast-core-box"}},[t("div",{staticClass:"index-module__img___p3B1N",style:e.getStyle(a.thumbUrl)})])]),t("div",{staticClass:"order-manage_contentInfo__1Cjd6"},[t("div",[e._v("子订单号："+e._s(a.orderSn))]),t("div",[e._v("SKU ID："+e._s(a.productInfoList[0].productSkuId))]),t("div",[e._v("SKC ID："+e._s(a.productInfoList[0].productSkcId))]),t("div",[e._v("SKU 货号： "+e._s(a.extCodeList[0]))]),t("div",[e._v("属性： "+e._s(a.spec))]),t("div",[e._v("库存扣减仓库： "+e._s(a.warehouseName))])])])}))}}])})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.isShow=!1}}},[e._v("关 闭")]),t("el-button",{attrs:{type:"primary"},on:{click:e.onConfirm}},[e._v("添加")])],1)],1)],1)],2)],1)},i=[],o=(a(44114),a(98992),a(54520),a(81454),a(14603),a(47566),a(98721),a(73236)),s=a(31052),l=a(3959),n=a(4213),d=a(59569);async function c(e){let t=e.details.map((e=>e.warehouseCode));t.includes("USCA91710")||t.includes("USNJ08010")?(await p(e,"USCA91710"),await p(e,"USNJ08010")):(t.includes("UAXC002")||t.includes("USCA001"))&&(await p(e,"UAXC002"),await p(e,"USCA001"))}async function p(e,t){let a=e.details.filter((e=>e.warehouseCode==t));if(0==a.length)return[];let r={warehouse_code:t,name:e.receiveName,company:"",address1:e.receiveAddress1,email:e.receiveEmail,address2:e.receiveAddress2,phone:e.receivePhone,address3:"",consignee_phone_extension:"",city:e.receiveCity,phone2:"",province:e.receiveProvince,doorplate:"",district:"",license:"",zipcode:e.receiveZipcode,country:"US",consignee_tax_type:"",consignee_eori:"",platform:"",order_cod_price:"",order_cod_currency:"",shop:"",refrence_no:e.orderId,courier:"PICKUP",calculation:1,is_discount:1,ignore_address:0,default_insurance_type:1,filter_sta_shipping:1,shipping_method_no:"",is_insurance:"",insurance_value:"",insurance_value_currency:"USD",order_sale_amount:"",order_sale_currency:"",channel_code:"",lifting_cabinet:"",order_battery_type:"",vat_tax_code:"",is_platform_ebay:0,ebay_item_id:"",ebay_transaction_id:"",distribution_information:"",IOSS:"",insurance_type:"",multiple_tracking_number:"",is_allow_open:0,insurance_type_goods_value:"",refrence_no_warehouse:"",is_prime:"",order_desc:"",del_order_attached_ids:"",order_type:"sale",order_business_type:"b2c","invoice[product_sku][]":"","invoice[product_title_en][]":"","invoice[product_title][]":"","invoice[product_quantity][]":"","invoice[unit_code][]":"","invoice[product_declared_value][]":"","invoice[product_weight][]":""},i=[];for(let o=0;o<a.length;o++){let e=!1;for(let t=0;t<i.length;t++)a[o].productId==i[t].productId&&(e=!0,i[t].num+=a[o].num);e||i.push(a[o])}for(let o=0;o<i.length;o++)r[`platform_barcode[${i[o].productId}]`]="",r[`product_title_en[${i[o].productId}]`]=i[o].productTitleEn,r[`product_title[${i[o].productId}]`]=i[o].productTitle,r[`declared_value[${i[o].productId}]`]=i[o].declaredValue,r[`op_quantity[${i[o].productId}]`]=i[o].num;let l=o.tA;"USCA91710"==t||"USNJ08010"==t?(r.courier="PICK-UP",l=o.fp):r.courier="PICKUP";let n=await l({url:"order/order/create/operation/0",isFormData:!0,method:"POST",data:r});if(1==n.ask){let t=await l({url:"order/order-list/list/a/a/page/1/pageSize/50",isFormData:!0,method:"POST",data:{warehouse_note:"",is_vip:"",allot_logistics_for_lg:"",order_attachment:"",is_cut_off:"",large_order:"",is_temu_warehouse:"","time-type":"date_create","order-type":"DESC",ORDER_TRIAL_FEE_SHOW:1,type:1,code:e.orderId,SKU:"",channel_code:"",platform_shop:"",account_name:"",deliveryFeeFor:"",deliveryFeeTo:"",serial_number:"",create_type:"",remark:"",is_one_piece:"",platform:"",seller:"",is_shared:"",is_ques:"",country:"",warehouse_id:"",shipping_method:"",is_oda:"",is_cod:"",is_prime:"",process_again:"",ot_id:"",abnormal_type:"",sub_status:"",picking_status:"",order_type:"",longest_aging:"",recipient_type:"buyer_name",recipient_info:"",buyer_type:"buyer_id",buyer_info:"",reference_no:"",is_repeat:"",is_return:"",timeType:"create",DateFrom:"",DateEnd:"",E35:"",insurance_status:"",have_tracking_no:"",keyword:"",status:2,is_more:0}});if(1==t.state){let a=i.map((e=>e.id)),r=await d.A.post("/api/semi/semiOrder/updateStatus",{orderId:e.id,ids:a,thirdOrderId:t.data[0].refrence_no_platform});0!=r.code&&s.Message.error(r.msg)}else{s.Message.error(t.message);let a=await d.A.post("/api/semi/semiOrder/updateStatus",{orderId:e.id,ids:ids});0!=a.code&&s.Message.error(a.msg)}}else s.Message.error(n.message)}var u={name:"SemiSendGoods_XC",data(){return{isShow:!1,orderDataList:[],orderTotal:0,colConfigs:[{type:"selection",width:"70px",align:"left"},{slot:"productName"},{slot:"subWarehouseName"},{prop:"mallName",label:"店铺来源",align:"center"},{slot:"className"},{slot:"purchaseTime"}],robColConfigs:[{slot:"productName"},{slot:"subWarehouseName"},{prop:"mallName",label:"店铺来源",align:"center"},{slot:"className"},{slot:"purchaseTime"}],orderByDateColConfig:[{slot:"expand"},{prop:"sendTime",label:"发货日期",align:"left"},{prop:"num",label:"订单数量",width:"220px",align:"left"}],form:{warehouseId:"XinCang",mallId:"",status:"",current:1,size:100},regionId:"11",regionList:[{id:"11",name:"美国"},{id:"22",name:"欧区"},{id:"33",name:"全球(除美国,欧区)"}],mallId:"",mallName:"",tableData:[],total:0,isBegin:!1,choosedList:[],choosedSnMallList:[],arr:[],createTotal:0,pageSize:100,currentPage:1,type:0,loadMallIndex:0,loadMode:0,isLoading:!1,isDlgLoading:!1,loadingText:"拼命加载中"}},computed:{mallList(){const e=this.$store.state.mallList.filter((e=>e.isSemiManagedMall));return e}},created(){this.$dict.load("order_info_status","semi_warehouse")},methods:{onChooseChange(e){this.arr=e},mallChange(){this.regionId?this.toGetList():s.Message.error("请选择地区")},regionChange(){this.mallId?this.toGetList():s.Message.error("请选择店铺")},toGetList(){this.$userCheck(this.mallId).then((()=>{let e=this.mallList.filter((e=>e.mallId==this.mallId));this.mallName=e[0].mallName,this.loadMode=0,this.tableData=[],this.currentPage=1,this.isDlgLoading=!0,this.getList(this.tableData,this.mallId,this.mallName,1)})).catch((e=>{this.mallId="",console.log(e)}))},onConfirm(){0!=this.arr.length?(this.arr.map((e=>{let t=this.choosedList.filter((t=>t.parentOrderMap.parentOrderSn==e.parentOrderMap.parentOrderSn));0==t.length&&this.choosedList.push(e)})),s.Message.success("添加成功，可继续添加")):s.Message.error("请选择待创建备货单")},loadAll(){this.$userCheck().then((()=>{this.choosedList=[],this.currentPage=1,this.isLoading=!0,this.loadingText="拼命加载中……",3==this.$store.state.userInfo.type?(this.loadMode=0,this.getList(this.choosedList,this.$store.state.mallId,this.$store.state.mallName,1)):(this.loadMallIndex=0,this.loadMode=1,this.getList(this.choosedList,this.mallList[this.loadMallIndex].mallId,this.mallList[this.loadMallIndex].mallName,1))}))},getOrderList(){this.orderDataList=[],this.$http.post("/api/semi/semiOrder/pageByDate",null,{params:{...this.form}}).then((e=>{this.orderDataList=e.data.records,this.orderTotal=e.data.total}))},deleteOrder(e){this.$confirm("确定要删除该条数据？","温馨提示",{type:"warning"}).then((()=>{this.$http.post(`/api/semi/semiOrder/del?id=${e.id}`).then((e=>{this.getOrderList()}))}))},beforeBegin(){this.choosedList.length<=0?s.Message.error("请先添加待发货订单"):this.beginCreate()},async getList(e,t,a,r){let i=await(0,o.jz)({url:"kirogi/bg/mms/recentOrderList",needMallId:!0,region:this.regionId,mallId:t,data:{fulfillmentMode:0,pageNumber:this.currentPage,pageSize:this.pageSize,queryType:2,sortType:1,timeZone:"UTC+8",parentAfterSalesTag:0,needBuySignService:0,sellerNoteLabelList:[]}});0==i.errorCode?(i.result.pageItems.map((r=>{e.push({...r,mallId:t,mallName:a})})),this.pageSize==i.result.pageItems.length?(r++,await this.getList(e,t,a,r)):1==this.loadMode?(this.loadMallIndex++,this.loadMallIndex<this.mallList.length?(await this.$sleepSync(500),await this.getList(e,this.mallList[this.loadMallIndex].mallId,this.mallList[this.loadMallIndex].mallName,1)):(this.isLoading=!1,this.isDlgLoading=!1,s.Message.success("所有店铺待发货订单已加载完成"))):(this.isLoading=!1,this.isDlgLoading=!1)):await this.getList(e,t,a,r)},remove(e){for(let t=0;t<this.choosedList.length;t++)if(this.choosedList[t].parentOrderMap.parentOrderSn==e){this.choosedList.splice(t,1);break}},getStyle(e){return"background-image: url("+e+"); width: 72px; height: 72px; cursor: pointer; border-radius: 6px; border: 1px solid rgba(0, 0, 0, 0.14);"},async beginCreate(){let e=[];this.choosedList.map((t=>{"日本站"!=t.parentOrderMap.siteName&&e.push(t.parentOrderMap.parentOrderSn)}));for(let t=0;t<e.length;t++){let a=this.choosedList.filter((a=>a.parentOrderMap.parentOrderSn==e[t])),r=await(0,o.jz)({url:"mms/orchid/address/snapshot/order_shipping_address_query",needMallId:!0,region:this.regionId,mallId:a[0].mallId,data:{parent_order_sn:a[0].parentOrderMap.parentOrderSn}});if(1e6==r.error_code&&r.success){let e={source:0,receiveName:r.result.receipt_name+(r.result.receipt_additional_name?"（"+r.result.receipt_additional_name+"）":""),receiveAddress1:r.result.address_line1,receiveAddress2:r.result.address_line2,receivePhone:r.result.mobile,receiveEmail:r.result.mail,receiveCity:r.result.region_name3,receiveProvince:r.result.region_name2,receiveZipcode:r.result.post_code,mallId:a[0].mallId,mallName:a[0].mallName,orderId:a[0].parentOrderMap.parentOrderSn,status:0,type:1,originDetails:[],createTime:a[0].parentOrderMap.parentOrderTimeStr};for(let r=0;r<a[0].orderList.length;r++)"2"==a[0].orderList[r].orderStatus&&e.originDetails.push({temuWarehouseId:a[0].orderList[r].warehouseId,sku:a[0].orderList[r].productInfoList[0].productSkuId,num:a[0].orderList[r].quantity,skuCode:a[0].orderList[r].extCodeList.join(","),createTime:a[0].parentOrderMap.parentOrderTimeStr});let t=await this.$http.post("/api/semi/semiOrder/addXc",e);0==t?.code&&this.remove(a[0].parentOrderMap.parentOrderSn)}}},async sendGoods(e){this.isLoading=!0;for(let t=0;t<e.length;t++)this.loadingText="正在处理第 "+(t+1)+"/"+e.length+" 个订单",e[t].details.length>0&&(await c(e[t]),await this.$sleepSync(200));this.isLoading=!1,this.getOrderList()},async copyOrderIds(e){let t=e.map((e=>e.orderId));await navigator.clipboard.writeText(t.join(" ")),s.Message.success("复制成功")},async toDownloadExcel(e){this.isLoading=!0,this.loadingText="正在拼命加载中……";let t=e.map((e=>e.orderId));const a=new Date;a.setHours(23,59,59,0);let r=await(0,o.jz)({url:"mms/eagle/package/main_batch_query",needMallId:!0,mallId:this.form.mallId,region:"11",data:{page_number:1,page_size:100,sort_type:1,po_sn_list:t,call_begin_time:a.getTime()/1e3-2592e3,call_end_time:a.getTime()/1e3}});const i=[["运单号","物流运单号","交付物流渠道","仓库代码","备注","老系统仓库记得写好：UAXC002 美西USCA91710"]];if(1e6==r.error_code){for(let l=0;l<r.result.package_info_result_list.length;l++){let e=r.result.package_info_result_list[l];i.push([e.order_send_info_list[0].parent_order_sn,e.tracking_number,e.shipping_company_name,e.warehouse_name])}const e=l.Wp.aoa_to_sheet(i),t=l.Wp.book_new();l.Wp.book_append_sheet(t,e,"Sheet1");const a=l.M9(t,{bookType:"xlsx",type:"array"}),o=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),s=window.URL.createObjectURL(o);(0,n.saveAs)(o,this.form.mallId+"_系统单号对应物流单号.xlsx"),window.URL.revokeObjectURL(s),this.isLoading=!1}},async getLogisticInfo(){for(let e=0;e<this.orderDataList.length;e++){if(this.orderDataList[e].productCount>1)continue;let t={warehouse_note:"",is_vip:"",allot_logistics_for_lg:"",order_attachment:"",is_cut_off:"",large_order:"",is_temu_warehouse:"","time-type":"date_create","order-type":"DESC",ORDER_TRIAL_FEE_SHOW:1,type:1,code:this.orderDataList[e].orderId,SKU:"",channel_code:"",platform_shop:"",account_name:"",deliveryFeeFor:"",deliveryFeeTo:"",serial_number:"",create_type:"",remark:"",is_one_piece:"",platform:"",seller:"",is_shared:"",is_ques:"",country:"",warehouse_id:"",shipping_method:"",is_oda:"",is_cod:"",is_prime:"",process_again:"",ot_id:"",abnormal_type:"",sub_status:0,picking_status:"",order_type:"",longest_aging:"",recipient_type:"buyer_name",recipient_info:"",buyer_type:"buyer_id",buyer_info:"",reference_no:"",is_repeat:"",is_return:"",timeType:"create",DateFrom:"",DateEnd:"",E35:"",insurance_status:"",have_tracking_no:"",keyword:"",status:"",is_more:0},a=o.tA;"USCA91710"!=this.orderDataList[e].details[0].warehouseCode&&"USNJ08010"!=this.orderDataList[e].details[0].warehouseCode||(a=o.fp);let r=await a({url:"order/order-list/list/a/a/page/1/pageSize/50",isFormData:!0,method:"POST",data:t});if(1==r.state){if(!r.data[0].shipping_method_no){s.Message.error(`【${this.orderDataList[e].orderId}】订单取号失败`);continue}let t=await this.$http.post("/api/semi/semiOrder/updateLogistic",null,{params:{orderId:this.orderDataList[e].orderId,logisticId:r.data[0].shipping_method_no,expressCompany:r.data[0].shipping_method,expressId:r.data[0].carrier_name}});0!=t?.code&&s.Message.error(`【${this.orderDataList[e].orderId}】订单取号失败`)}await this.$sleepSync(200)}this.getOrderList()},async writeBack(){if(this.form.mallId){this.isLoading=!0,this.loadingText="拼命加载中……";for(let e=0;e<this.orderDataList.length;e++){let t=await(0,o.jz)({url:"kirogi/bg/mms/recentOrderList",needMallId:!0,mallId:this.orderDataList[e].mallId,data:{fulfillmentMode:0,pageNumber:1,pageSize:20,queryType:2,sortType:1,parentOrderSnList:[this.orderDataList[e].orderId],timeZone:"UTC+8",parentAfterSalesTag:0,needBuySignService:0,sellerNoteLabelList:[]}});if(0==t.errorCode){if(1!=t.result.totalItemNum)continue;if(!this.orderDataList[e].details[0].expressId)continue;let a=null;if(this.orderDataList[e].details[0].expressId.includes("USPS"))a=960246690;else{if(!this.orderDataList[e].details[0].expressId.includes("FedEx"))continue;a=699272611}let r=await(0,o.jz)({url:"mms/eagle/package/batch_send",needMallId:!0,mallId:this.orderDataList[e].mallId,data:{send_type:0,send_request_list:[{ship_company_id:a,tracking_number:this.orderDataList[e].details[0].logisticId,send_sub_package_list:[],outer_order_id:"",order_send_info_list:[{order_sn:t.result.pageItems[0].orderList[0].orderSn,parent_order_sn:t.result.pageItems[0].parentOrderMap.parentOrderSn,goods_id:t.result.pageItems[0].orderList[0].goodsId,sku_id:t.result.pageItems[0].orderList[0].skuId,quantity:t.result.pageItems[0].orderList[0].quantity}]}],intelligent_assistant_agreement_signed:!0}});if(1e6==r.error_code||r.success){await this.$http.post("/api/semi/semiOrder/updateStatus",null,{params:{id:this.orderDataList[e].id,status:3}})}else s.Message.error(`【${this.orderDataList[e].orderId}】回填失败`)}}this.isLoading=!1,this.getOrderList()}else s.Message.error("请选择店铺！")}}},_=u,m=(a(59594),a(81656)),h=(0,m.A)(_,r,i,!1,null,"453813bf",null),g=h.exports},27220:function(e,t,a){"use strict";a.r(t);var r=a(31601),i=a.n(r),o=a(76314),s=a.n(o),l=s()(i());l.push([e.id,".list .title-right[data-v-453813bf]{display:flex;align-items:center}.list .title-right>div[data-v-453813bf]:first-child{margin-right:20px}.list[data-v-453813bf].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}.product[data-v-453813bf]{display:flex;align-items:center;justify-content:center}.product .right[data-v-453813bf]{flex:1;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.product img[data-v-453813bf]{width:60px;margin-right:10px}.tips[data-v-453813bf]{position:relative;width:40px;height:40px;border-radius:50%;background:rgba(243,8,8,.4)}@keyframes warn-453813bf{0%{transform:translate(-50%,-50%) scale(0);opacity:1}to{transform:translate(-50%,-50%) scale(1.1);opacity:0}}.tips div[data-v-453813bf]{position:absolute;left:50%;top:50%;z-index:11;width:100px;height:100px;border-radius:50%;animation:warn-453813bf .9s ease-out;animation-iteration-count:infinite;box-shadow:1px 1px 30px #ef2d02;transform:translate(-50%,-50%) scale(.2);transition:all .6s ease-in-out;background:rgba(243,8,8,.6)}.order-manage_productInfo__1pD83>img[data-v-453813bf]{width:60px;margin-right:10px}.order-manage_productInfo__1pD83[data-v-453813bf]{min-height:60px;padding-left:70px;position:relative}.order-manage_productInfo__1pD83>div[data-v-453813bf]:nth-child(2){color:rgba(0,0,0,.8)}.outerWrapper[data-v-453813bf]{margin:4px 4px 0 0}.dot-module__dot___M-RuH .dot-module__circle___2l2UV[data-v-453813bf]{flex-shrink:0;width:8px;height:8px;border-radius:50%;margin-right:8px}.dot-module__dot___M-RuH[data-v-453813bf]{display:inline-flex;align-items:center}.index-module__image-preview___2fiZX .index-module__img___p3B1N[data-v-453813bf]{width:60px;height:60px;margin-right:10px;background-repeat:no-repeat;background-size:cover;background-color:#f5f5f5;font-size:12px;display:flex;justify-content:center;align-items:center;color:var(--bc-Table-emptyTextColor);position:relative}.textoverflow[data-v-453813bf]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer}.order-manage_skuInfo__FW-Nd[data-v-453813bf]{display:flex;align-items:center;justify-content:center;margin-bottom:10px}.order-manage_skuInfo__FW-Nd[data-v-453813bf]:last-child{margin-bottom:0}.order-manage_skuInfo__FW-Nd .order-manage_contentInfo__1Cjd6[data-v-453813bf]{display:flex;flex-direction:column;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:240px}.order-manage_skuInfo__FW-Nd .order-manage_contentInfo__1Cjd6 .order-manage_title__1VTO5[data-v-453813bf]{flex-wrap:wrap;color:rgba(0,0,0,.8)}",""]),t["default"]=l},4213:function(e,t,a){var r,i,o;(function(a,s){i=[],r=s,o="function"===typeof r?r.apply(t,i):r,void 0===o||(e.exports=o)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,a){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){n(r.response,t,a)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,a){var l=s.URL||s.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin===location.origin?o(n):i(n.href)?r(e,t,a):o(n,n.target="_blank")):(n.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(n.href)}),4e4),setTimeout((function(){o(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,s){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),a);else if(i(e))r(e,a,s);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){o(l)}))}}:function(e,t,a,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,a);var o="application/octet-stream"===e.type,n=/constructor/i.test(s.HTMLElement)||s.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||o&&n||l)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var p=s.URL||s.webkitURL,u=p.createObjectURL(e);i?i.location=u:location.href=u,i=null,setTimeout((function(){p.revokeObjectURL(u)}),4e4)}});s.saveAs=n.saveAs=n,e.exports=n}))},59594:function(e,t,a){var r=a(27220);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var i=a(99548).A;i("52c7354f",r,!0,{sourceMap:!1,shadowMode:!1})}}]);