(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[5345,6671,7726],{36671:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=function(){var e=this,t=e._self._c;return t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"待收货发货单列表",isShowBottomBorder:""},slot:"title",scopedSlots:e._u([{key:"rightBtn",fn:function(){return[t("div",{staticClass:"title-right"},[t("div",[t("label",{staticStyle:{width:"90px"}},[e._v("店铺：")]),t("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:e.beforeGetList},model:{value:e.mallId,callback:function(t){e.mallId=t},expression:"mallId"}},e._l(e.$store.state.mallList,(function(e){return t("el-option",{key:e.mallId,attrs:{label:e.mallName,value:e.mallId}})})),1)],1)])]},proxy:!0}])}),t("template",{slot:"content"},[t("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:e._u([{key:"right",fn:function(){return[t("json-excel",{attrs:{data:e.list,fields:e.jsonFields,"before-generate":e.startDownload,name:"待收货发货单明细.xls",worksheet:"待收货发货单明细"}},[t("el-button",{attrs:{type:"primary"}},[e._v("导出数据")])],1)]},proxy:!0}])},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:e.list,"col-configs":e.colConfigs,total:e.list.length,height:"500"},on:{getList:()=>{}}})],1)],1)],2)},n=[],r=(a(44114),a(81454),a(14603),a(47566),a(98721),a(73236)),i=a(39325),s=a(31981),l=a(31052),d=a(3959),c=a(4213),p={name:"WaitShippingList",data(){return{isLoading:!1,list:[],mallId:"",colConfigs:[{prop:"subPurchaseOrderSn",label:"备货单号",align:"left"},{prop:"productName",label:"商品名称",align:"left"},{prop:"skcExtCode",label:"货号",align:"left"},{prop:"productSkcId",label:"SKC ID",align:"left"},{prop:"productSkuId",label:"SKU ID",align:"left"},{prop:"specName",label:"商品属性",align:"left"},{prop:"skuNum",label:"发货件数",align:"left"},{prop:"expressCompany",label:"物流公司",align:"left"},{prop:"expressDeliverySn",label:"物流单号",align:"left"},{prop:"deliveryOrderSn",label:"发货单号",align:"left"},{prop:"subWarehouseName",label:"收货仓库",align:"left"},{prop:"deliverTime",label:"发货时间",align:"left"},{prop:"expectPickUpGoodsTime",label:"预约取货时间",align:"left"}],jsonFields:{"备货单号":"subPurchaseOrderSn","商品名称":"productName","货号":"skcExtCode","SKC ID":"productSkcId","SKU ID":"productSkuId","商品属性":"specName","发货件数":"skuNum","物流公司":"expressCompany","物流单号":"expressDeliverySn","发货单号":"deliveryOrderSn","收货仓库":"subWarehouseName","发货时间":"deliverTime","预约取货时间":"expectPickUpGoodsTime"},currentPage:1,packageNumber:0}},computed:{},components:{JsonExcel:i.A},created(){},methods:{changeDataType(){},beforeGetList(){this.mallId?(this.currentPage=1,this.list=[],this.$userCheck(this.mallId).then((()=>{this.isLoading=!0,this.getList()})).catch((e=>{this.mallId="",this.isLoading=!1}))):l.Message.error("请先选择店铺")},async getList(){let e=await(0,r.w4)({url:"bgSongbird-api/supplier/deliverGoods/management/pageQueryDeliveryBatch",needMallId:!0,mallId:this.mallId,data:{pageNo:this.currentPage,pageSize:100,status:1}});if(1e6==e.errorCode){for(let t=0;t<e.result.list.length;t++){let a=e.result.list[t],o={};o.expressCompany=a.expressCompany,o.expressDeliverySn=a.expressDeliverySn,o.subWarehouseName=a.subWarehouseName,o.expectPickUpGoodsTime=(0,s.z)(a.expectPickUpGoodsTime);for(let e=0;e<a.deliveryOrderList.length;e++){let t=a.deliveryOrderList[e];o={...o,subPurchaseOrderSn:t.subPurchaseOrderSn,deliveryOrderSn:t.deliveryOrderSn,productName:t.subPurchaseOrderBasicVO.productName,skcExtCode:t.subPurchaseOrderBasicVO.skcExtCode,deliverTime:(0,s.z)(t.deliverTime),productSkcId:t.productSkcId};for(let e=0;e<t.packageDetailList.length;e++)o={...o,productSkuId:t.packageDetailList[e].productSkuId,specName:"",skuNum:t.packageDetailList[e].skuNum},this.list.push(o);await this.$sleepSync(100),await this.getSkuDetailList(t.deliveryOrderSn)}}100==e.result.list.length?(this.currentPage++,await this.$sleepSync(1e3),await this.getList()):this.isLoading=!1}else await this.$sleepSync(200),await this.getList()},async getSkuDetailList(e){let t=await(0,r.w4)({url:"bgSongbird-api/supplier/deliverGoods/management/queryDeliveryOrderPackageDetailInfo",needMallId:!0,mallId:this.mallId,anti:!0,data:{deliveryOrderSn:e}});if(1e6==t.errorCode)for(let a=0;a<t.result.deliveryOrderDetails.length;a++){let e=t.result.deliveryOrderDetails[a];if(e.secondarySpecVOList){let t=e.secondarySpecVOList.map((e=>e.specName)),a=t.join(",");for(let o=0;o<this.list.length;o++)this.list[o].productSkuId==e.productSkuId&&(this.list[o].specName=a)}}else await this.getSkuDetailList(e)},startDownload(){this.$http.post("/api/malluser/info").then((e=>{if(0==e.code&&(this.$store.commit("setUserInfo",e.data),1!=e.data.flag))return l.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0)}))},async downloadLabelData(){let e=[];this.list.map((t=>{e.push(t.productSkuId)}));let t=[];for(let d=0;d<e.length;d++)if(t.push(e[d]),100==t.length){let e=await(0,r.w4)({url:"bg-visage-mms/labelcode/pageQuery",needMallId:!0,mallId:this.mallId,anti:!0,data:{page:1,pageSize:100,productSkuIdList:t}});if(1e6==e.errorCode)for(let t=0;t<e.result.pageItems.length;t++){let a=e.result.pageItems[t];for(let e=0;e<this.list.length;e++)if(this.list[e].productSkuId==a.labelCodeVO.productSkuId){this.list[e].labelCode=a.labelCodeVO.labelCode,this.list[e].skuExtCode=a.labelCodeVO.skuExtCode;let t=a.productSkuSpecList.map((e=>e.specName));this.list[e].skuSpecName=t.join(",")}}t=[]}const a=[["备货单号","商品名称","货号","SKC ID","SKU ID","商品属性","发货件数","物流公司","物流单号","发货单号","收货仓库","发货时间","预约取货时间","条码编码","SKU货号","次销售属性"]];this.list.map((e=>{a.push([e.subPurchaseOrderSn,e.productName,e.skcExtCode,e.productSkcId,e.productSkuId,e.specName,e.skuNum,e.expressCompany,e.expressDeliverySn,e.deliveryOrderSn,e.subWarehouseName,e.deliverTime,e.expectPickUpGoodsTime,e.labelCode,e.skuExtCode,e.skuSpecName])}));const o=d.Wp.aoa_to_sheet(a),n=d.Wp.book_new();d.Wp.book_append_sheet(n,o,"Sheet1");const i=d.M9(n,{bookType:"xlsx",type:"array"}),s=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),l=window.URL.createObjectURL(s);(0,c.saveAs)(s,"待收货发货单带标签数据.xlsx"),window.URL.revokeObjectURL(l)}}},u=p,f=(a(59984),a(81656)),h=(0,f.A)(u,o,n,!1,null,"171f0c16",null),m=h.exports},29434:function(e,t,a){"use strict";a.r(t);var o=a(31601),n=a.n(o),r=a(76314),i=a.n(r),s=i()(n());s.push([e.id,".list .title-right[data-v-171f0c16]{display:flex;align-items:center}.list .title-right>div[data-v-171f0c16]:first-child{margin-right:20px}.list[data-v-171f0c16].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),t["default"]=s},4213:function(e,t,a){var o,n,r;(function(a,i){n=[],o=i,r="function"===typeof o?o.apply(t,n):o,void 0===r||(e.exports=r)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function o(e,t,a){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){l(o.response,t,a)},o.onerror=function(){console.error("could not download file")},o.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,s=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,a){var s=i.URL||i.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?r(l):n(l.href)?o(e,t,a):r(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,i){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),a);else if(n(e))o(e,a,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){r(s)}))}}:function(e,t,a,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return o(e,t,a);var r="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||r&&l||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},c.readAsDataURL(e)}else{var p=i.URL||i.webkitURL,u=p.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout((function(){p.revokeObjectURL(u)}),4e4)}});i.saveAs=l.saveAs=l,e.exports=l}))},39325:function(e,t,a){"use strict";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof a.g?a.g:"undefined"!==typeof self&&self;function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}var n=o((function(e,t){(function(t,a){e.exports=a()})(0,(function(){return function e(t,a,o){var n,r,i=window,s="application/octet-stream",l=o||s,d=t,c=!a&&!o&&d,p=document.createElement("a"),u=function(e){return String(e)},f=i.Blob||i.MozBlob||i.WebKitBlob||u,h=a||"download";if(f=f.call?f.bind(i):Blob,"true"===String(this)&&(d=[d,l],l=d[0],d=d[1]),c&&c.length<2048&&(h=c.split("/").pop().split("?")[0],p.href=c,-1!==p.href.indexOf(c))){var m=new XMLHttpRequest;return m.open("GET",c,!0),m.responseType="blob",m.onload=function(t){e(t.target.response,h,s)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d)){if(!(d.length>2096103.424&&f!==u))return navigator.msSaveBlob?navigator.msSaveBlob(v(d),h):w(d);d=v(d),l=d.type||s}else if(/([\x80-\xff])/.test(d)){var g=0,b=new Uint8Array(d.length),y=b.length;for(g;g<y;++g)b[g]=d.charCodeAt(g);d=new f([b],{type:l})}function v(e){var t=e.split(/[:;,]/),a=t[1],o="base64"==t[2]?atob:decodeURIComponent,n=o(t.pop()),r=n.length,i=0,s=new Uint8Array(r);for(i;i<r;++i)s[i]=n.charCodeAt(i);return new f([s],{type:a})}function w(e,t){if("download"in p)return p.href=e,p.setAttribute("download",h),p.className="download-js-link",p.innerHTML="downloading...",p.style.display="none",document.body.appendChild(p),setTimeout((function(){p.click(),document.body.removeChild(p),!0===t&&setTimeout((function(){i.URL.revokeObjectURL(p.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var a=document.createElement("iframe");document.body.appendChild(a),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),a.src=e,setTimeout((function(){document.body.removeChild(a)}),333)}if(n=d instanceof f?d:new f([d],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(n,h);if(i.URL)w(i.URL.createObjectURL(n),!0);else{if("string"===typeof n||n.constructor===u)try{return w("data:"+l+";base64,"+i.btoa(n))}catch(x){return w("data:"+l+","+encodeURIComponent(n))}r=new FileReader,r.onload=function(e){w(this.result)},r.readAsDataURL(n)}return!0}}))})),r={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:()=>null},exportFields:{type:Object,default:()=>null},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},computed:{idName(){var e=(new Date).getTime();return"export_"+e},downloadFields(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let e=this.data;if("function"!==typeof this.fetch&&e||(e=await this.fetch()),!e||!e.length)return;let t=this.getProcessedJson(e,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(t),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(t),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(t),this.name,"application/vnd.ms-excel")},export:async function(e,t,a){let o=this.base64ToBlob(e,a);"function"===typeof this.beforeFinish&&await this.beforeFinish(),n(o,t,a)},jsonToXLS(e){let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',a="<thead>";const o=Object.keys(e[0]).length;let n=this;const r=this.header||this.$attrs.title;r&&(a+=this.parseExtraData(r,'<tr><th colspan="'+o+'">${data}</th></tr>')),a+="<tr>";for(let i in e[0])a+="<th>"+i+"</th>";return a+="</tr>",a+="</thead>",a+="<tbody>",e.map((function(e,t){a+="<tr>";for(let o in e)a+="<td>"+n.preprocessLongNum(n.valueReformattedForMultilines(e[o]))+"</td>";a+="</tr>"})),a+="</tbody>",null!=this.footer&&(a+="<tfoot>",a+=this.parseExtraData(this.footer,'<tr><td colspan="'+o+'">${data}</td></tr>'),a+="</tfoot>"),t.replace("${table}",a).replace("${worksheet}",this.worksheet)},jsonToCSV(e){let t=this;var a=[];const o=this.header||this.$attrs.title;o&&a.push(this.parseExtraData(o,"${data}\r\n"));for(let n in e[0])a.push(n),a.push(",");return a.pop(),a.push("\r\n"),e.map((function(e){for(let o in e){let n=e[o]+"";t.escapeCsv&&(n='="'+n+'"',n.match(/[,"\n]/)&&(n='"'+n.replace(/\"/g,'""')+'"')),a.push(n),a.push(",")}a.pop(),a.push("\r\n")})),null!=this.footer&&a.push(this.parseExtraData(this.footer,"${data}\r\n")),a.join("")},getProcessedJson(e,t){let a=this.getKeys(e,t),o=[],n=this;return e.map((function(e,t){let r={};for(let o in a){let t=a[o];r[o]=n.getValue(t,e)}o.push(r)})),o},getKeys(e,t){if(t)return t;let a={};for(let o in e[0])a[o]=o;return a},parseExtraData(e,t){let a="";if(Array.isArray(e))for(var o=0;o<e.length;o++)e[o]&&(a+=t.replace("${data}",e[o]));else a+=t.replace("${data}",e);return a},getValue(e,t){const a="object"!==typeof e?e:e.field;let o="string"!==typeof a?[]:a.split("."),n=this.defaultValue;return n=a?o.length>1?this.getValueFromNestedItem(t,o):this.parseValue(t[a]):t,e.hasOwnProperty("callback")&&(n=this.getValueFromCallback(n,e.callback)),n},valueReformattedForMultilines(e){return"string"==typeof e?e.replace(/\n/gi,"<br/>"):e},preprocessLongNum(e){if(this.stringifyLongNum){if(String(e).startsWith("0x"))return e;if(!isNaN(e)&&""!=e&&(e>99999999999||e<1e-13))return'="'+e+'"'}return e},getValueFromNestedItem(e,t){let a=e;for(let o of t)a&&(a=a[o]);return this.parseValue(a)},getValueFromCallback(e,t){if("function"!==typeof t)return this.defaultValue;const a=t(e);return this.parseValue(a)},parseValue(e){return e||0===e||"boolean"===typeof e?e:this.defaultValue},base64ToBlob(e,t){let a=window.btoa(window.unescape(encodeURIComponent(e))),o=atob(a),n=o.length,r=new Uint8ClampedArray(n);while(n--)r[n]=o.charCodeAt(n);return new Blob([r],{type:t})}}};function i(e,t,a,o,n,r,i,s,l,d){"boolean"!==typeof i&&(l=s,s=i,i=!1);var c,p="function"===typeof a?a.options:a;if(e&&e.render&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0,n&&(p.functional=!0)),o&&(p._scopeId=o),r?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)},p._ssrRegister=c):t&&(c=i?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),c)if(p.functional){var u=p.render;p.render=function(e,t){return c.call(t),u(e,t)}}else{var f=p.beforeCreate;p.beforeCreate=f?[].concat(f,c):[c]}return a}var s=i;const l=r;var d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:e.idName},on:{click:e.generate}},[e._t("default",[e._v(" Download "+e._s(e.name)+" ")])],2)},c=[];d._withStripped=!0;const p=void 0,u=void 0,f=void 0,h=!1;var m=s({render:d,staticRenderFns:c},p,l,u,h,f,void 0,void 0);t.A=m},59984:function(e,t,a){var o=a(29434);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=a(99548).A;n("640ae336",o,!0,{sourceMap:!1,shadowMode:!1})}}]);