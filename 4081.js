(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[4081],{34081:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return m}});var s=function(){var t=this,e=t._self._c;return e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"商家账单统计",isShowBottomBorder:""},slot:"title",scopedSlots:t._u([{key:"rightBtn",fn:function(){return[e("div",{staticClass:"title-right"},[e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("时间范围：")]),e("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:t.beginStat}},[t._v("开始统计")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadPicture}},[t._v("下载图片")]),e("json-excel",{attrs:{data:t.skcList,fields:t.skcJsonFields,name:"SKC账单数据.xls",worksheet:"SKC账单数据"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-download"}},[t._v("下载SKC统计")])],1),e("json-excel",{attrs:{data:t.skuList,fields:t.skuJsonFields,name:"SKU账单数据.xls",worksheet:"SKU账单数据"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-download"}},[t._v("下载SKU统计")])],1)],1)]},proxy:!0}])}),e("template",{slot:"content"},[e("div",{attrs:{id:"app-content"}},[e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据概览"}},[e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{title:"销售额",value:t.saleAmount}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{title:"单数",value:t.saleCount}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.deductionAmount,title:"扣款"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.costAmount,title:"成本"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.profitAmount,title:"利润"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.profitPercent,title:"利润率"}},[e("template",{slot:"suffix"},[t._v("%")])],2)],1)])],1)],1)]),e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"趋势分析"}},[e("div",[e("div",{attrs:{id:"chart1"}})])]),e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC销售额TOP10排行"}},[e("ai-table",{ref:"table0",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleAmountSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC利润TOP10排行"}},[e("ai-table",{ref:"table1",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleProfitSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC利润率TOP10排行"}},[e("ai-table",{ref:"table2",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topProfitPercentSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU销售额TOP10排行"}},[e("ai-table",{ref:"table3",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleAmountSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU利润TOP10排行"}},[e("ai-table",{ref:"table4",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleProfitSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU利润率TOP10排行"}},[e("ai-table",{ref:"table5",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topProfitPercentSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"amount",label:"销售额"},slot:"amount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.amount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",[t._v(t._s(o.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitPercent",label:"利润率"},slot:"profitPercent",scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(o.row.profitPercent+"%"))])]}}])})],1)],1)],1)],1)],1)],1)])],2)},i=[],a=(o(44114),o(73236)),n=o(39325),r=o(31052),l=o(20354),c=o.n(l),u=o(53751),d={name:"ExportSaleStatShein",data(){return{storeCode:"",productList:[],dateRange:[],page:1,perPage:100,orderList:[],saleAmount:0,saleCount:0,costAmount:0,profitAmount:0,profitPercent:0,deductionAmount:0,skcList:[],skuList:[],leftChartData:[],rightChartData:[],isLoading:!1,skcColConfigs:[{prop:"skcCode",label:"货号",width:"250px"},{slot:"amount",label:"销售额",align:"center"},{prop:"quantity",label:"单数",align:"center"},{prop:"cost",label:"成本",align:"center"},{slot:"profitAmount",label:"利润",align:"center"},{slot:"profitPercent",label:"利润率",align:"center"}],skcJsonFields:{SKC:"skc","货号":"skcCode","销售额":"amount","单数":"quantity","成本":"cost","利润":"profitAmount","利润率":"profitPercent"},skuColConfigs:[{prop:"skuCode",label:"属性集",width:"250px"},{slot:"amount",label:"销售额",align:"center"},{prop:"quantity",label:"单数",align:"center"},{prop:"cost",label:"成本",align:"center"},{slot:"profitAmount",label:"利润",align:"center"},{slot:"profitPercent",label:"利润率",align:"center"}],skuJsonFields:{SKC:"skc",SKU:"sku","属性集":"skuCode","销售额":"amount","单数":"quantity","成本":"cost","利润":"profitAmount","利润率":"profitPercent"},chartObj:null}},computed:{topSaleAmountSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.amount-t.amount)),t.slice(0,10)},topSaleProfitSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.profitAmount-t.profitAmount)),t.slice(0,10)},topProfitPercentSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.profitPercent-t.profitPercent)),t.slice(0,10)},topSaleAmountSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.amount-t.amount)),t.slice(0,10)},topSaleProfitSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.profitAmount-t.profitAmount)),t.slice(0,10)},topProfitPercentSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.profitPercent-t.profitPercent)),t.slice(0,10)}},components:{JsonExcel:n.A},mounted(){this.$nextTick((()=>{this.initChart1()}))},created(){this.$http.post("/api/malluser/info").then((t=>{if(0==t.code){if(this.$store.commit("setUserInfo",t.data),1!=t.data.flag)return r.Message.error("您的账号未激活或已失效，请激活后使用"),void this.$store.commit("setActiveDlgShow",!0);this.getStoreCode()}}))},methods:{initChart1(){this.chartObj=new u.Im("chart1",{data:[this.leftChartData,this.rightChartData],xField:"day",yField:["value","value1"],yAxis:{value:{title:{text:"金额"},label:{formatter:t=>`${t}元`}},value1:{max:100,title:{text:"利润率"},label:{formatter:t=>`${t}%`}}},geometryOptions:[{geometry:"line",color:["#FF9A49","#7A8AA1","#1EEB73","#C947AE"],isGroup:!0,smooth:!0,seriesField:"type"},{geometry:"line",color:["red"],lineStyle:{fill:"red",fillOpacity:.5,stroke:"red",lineWidth:4,strokeOpacity:.7,shadowColor:"black",shadowBlur:10,shadowOffsetX:5,shadowOffsetY:5,cursor:"pointer"},isStack:!0,smooth:!0,seriesField:"type"}]}),this.chartObj.render()},async beginStat(){this.dateRange?(this.page=1,this.isLoading=!0,this.saleAmount=0,this.saleCount=0,this.costAmount=0,this.profitAmount=0,this.profitPercent=0,this.deductionAmount=0,this.orderList=[],this.skcList=[],this.skuList=[],this.leftChartData=[],this.rightChartData=[],this.chartObj.changeData([this.leftChartData,this.rightChartData]),this.getOrderList()):r.Message.error("请选择统计时间范围")},async getStoreCode(){let t=await(0,a.Rh)({url:"sso-prefix/auth/getUser?uuid="+Date.now(),method:"GET"});"0"==t.code&&"OK"==t.msg?(this.storeCode=t.info.merchantCode,this.getPorductList()):100004!=t.code&&20302!=t.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},getPorductList(){this.$http.post("/api/skuCost/listAll",null,{params:{mallId:this.storeCode}}).then((t=>{0==t.code&&(this.productList=t.data)}))},async getOrderList(){let t=await(0,a.Rh)({url:"gsfs/finance/reportOrder/dualMode/reportOrderList",method:"POST",data:{page:this.page,perPage:this.perPage,addTimeStart:this.dateRange[0],addTimeEnd:this.dateRange[1]}});if("0"==t.code&&"OK"==t.msg){for(let e=0;e<t.info.data.length;e++)this.orderList.push(t.info.data[e]);if(t.info.data.length==this.perPage&&t.info.meta.count>this.perPage*this.page)this.page++,await this.sleepSync(200),await this.getOrderList();else{this.page=1,await this.getDetail();for(let e=0;e<this.skcList.length;e++)this.skcList[e].amount=Math.round(100*this.skcList[e].amount)/100,this.skcList[e].cost=Math.round(100*this.skcList[e].cost)/100,this.skcList[e].profitAmount=Math.round(100*(this.skcList[e].amount-this.skcList[e].cost))/100,this.skcList[e].profitPercent=Math.round(this.skcList[e].profitAmount/this.skcList[e].amount*1e4)/100,this.saleAmount+=this.skcList[e].amount,this.costAmount+=this.skcList[e].cost,this.saleCount+=this.skcList[e].quantity;this.saleAmount=Math.round(100*this.saleAmount)/100,this.profitAmount=this.saleAmount-this.costAmount;for(let e=0;e<this.orderList.length;e++){let t=this.orderList[e],o=0;for(let e=0;e<t.details.length;e++)this.deductionAmount+=t.details[e].deduction.funds?t.details[e].deduction.funds:0,o+=t.details[e].income;this.leftChartData.push({day:t.addTime,value:Math.round(100*o)/100,type:"销售额"})}this.profitPercent=Math.round(this.profitAmount/this.saleAmount*1e4)/100;for(let e=0;e<this.skuList.length;e++)this.skuList[e].amount=Math.round(100*this.skuList[e].amount)/100,this.skuList[e].cost=Math.round(100*this.skuList[e].cost)/100,this.skuList[e].profitAmount=Math.round(100*(this.skuList[e].amount-this.skuList[e].cost))/100,this.skuList[e].profitPercent=Math.round(this.skuList[e].profitAmount/this.skuList[e].amount*1e4)/100;const t=Object.assign([],this.leftChartData);for(let e=0;e<this.orderList.length;e++)for(let o=0;o<t.length;o++)if("销售额"==t[o].type&&t[o].day==this.orderList[e].addTime)for(let s=0;s<t.length;s++)"成本"==t[s].type&&t[s].day==this.orderList[e].addTime&&(this.leftChartData.push({day:this.orderList[e].addTime,value:Math.round(100*(t[o].value-t[s].value))/100,type:"利润"}),this.rightChartData.push({day:this.orderList[e].addTime,value1:Math.round((t[o].value-t[s].value)/t[o].value*1e4)/100,type:"利润率"}));this.chartObj.changeData([this.leftChartData,this.rightChartData]),this.isLoading=!1}}else 100004!=t.code&&20302!=t.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))},async getDetail(){for(let t=0;t<this.orderList.length;t++){let e=this.orderList[t];for(let t=0;t<e.details.length;t++)if("GSFS"==e.details[t].sourceSystem){let o=1;while(1){await this.sleepSync(200);let s=await(0,a.Rh)({url:"gsfs/finance/reportOrder/dualMode/checkOrderList/item",method:"POST",data:{page:o,perPage:this.perPage,reportOrderNo:e.details[t].reportOrderNo,secondOrderTypes:[1,2,41,42]}});if("0"==s.code&&"OK"==s.msg){if(this.calculate(s.info.data,e.addTime),!(s.info.data.length==this.perPage&&s.info.meta.count>this.perPage*o))break;o++}else 100004!=s.code&&20302!=s.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))}}else if("PMS"==e.details[t].sourceSystem){let o=1;while(1){await this.sleepSync(200);let s=await(0,a.Rh)({url:"gmpj/finance/incomeAndExpensesDetail",isWWW:!0,method:"POST",data:{page:o,perPage:this.perPage,reportOrderNo:e.details[t].reportOrderNo}});if("0"==s.code&&"OK"==s.msg){if(this.calculate(s.info.checkDetailList,e.addTime),!(s.info.checkDetailList.length==this.perPage&&s.info.count>this.perPage*o))break;o++}else 100004!=s.code&&20302!=s.code||(this.isLoading=!1,this.$store.commit("setSheinAlertShow",!0))}}}},calculate(t,e){for(let o=0;o<t.length;o++){let s=!1,i=this.getCost(t[o].skuCode)*(t[o].goodsCount||t[o].quantity);for(let e=0;e<this.skcList.length;e++)if(this.skcList[e].skc==(t[o].skc||t[o].skcName)){s=!0,"支出"==t[o].incomeAndExpensesTypeName||"支出"==t[o].inAndOutName?this.skcList[e].amount-=t[o].amount||t[o].income:"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||(this.skcList[e].quantity+=t[o].goodsCount||t[o].quantity,this.skcList[e].amount+=t[o].amount||t[o].income,this.skcList[e].cost+=i);break}s||("支出"==t[o].incomeAndExpensesTypeName||"支出"==t[o].inAndOutName?this.skcList.push({skc:t[o].skc||t[o].skcName,skcCode:t[o].goodsSn||t[o].supplierCode,amount:-(t[o].amount||t[o].income),quantity:0,cost:0,profitPercent:0,profitAmount:0}):"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||this.skcList.push({skc:t[o].skc||t[o].skcName,skcCode:t[o].goodsSn||t[o].supplierCode,amount:t[o].amount||t[o].income,quantity:t[o].goodsCount||t[o].quantity,cost:i,profitPercent:0,profitAmount:0})),s=!1;for(let e=0;e<this.skuList.length;e++)if(this.skuList[e].sku==t[o].skuCode){s=!0,"支出"==t[o].incomeAndExpensesTypeName||"支出"==t[o].inAndOutName?this.skuList[e].amount-=t[o].amount||t[o].income:"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||(this.skuList[e].quantity+=t[o].goodsCount||t[o].quantity,this.skuList[e].amount+=t[o].amount||t[o].income,this.skuList[e].cost+=i);break}s||("支出"==t[o].incomeAndExpensesTypeName||"支出"==t[o].inAndOutName?this.skuList.push({skc:t[o].skc||t[o].skcName,sku:t[o].skuCode,skuCode:(t[o].goodsSn||t[o].supplierCode)+"/"+(t[o].suffix||t[o].suffixZh),amount:-(t[o].amount||t[o].income),quantity:0,cost:0,profitPercent:0,profitAmount:0}):"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||this.skuList.push({skc:t[o].skc||t[o].skcName,sku:t[o].skuCode,skuCode:(t[o].goodsSn||t[o].supplierCode)+"/"+(t[o].suffix||t[o].suffixZh),amount:t[o].amount||t[o].income,quantity:t[o].goodsCount||t[o].quantity,cost:i,profitPercent:0,profitAmount:0})),s=!1;for(let a=0;a<this.leftChartData.length;a++)if(this.leftChartData[a].day==e&&"成本"==this.leftChartData[a].type){s=!0,"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||(this.leftChartData[a].value=Math.round(100*(this.leftChartData[a].value+i))/100);break}s||"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||this.leftChartData.push({day:e,type:"成本",value:i}),s=!1;for(let a=0;a<this.leftChartData.length;a++)if(this.leftChartData[a].day==e&&"单数"==this.leftChartData[a].type){s=!0,"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||(this.leftChartData[a].value+=t[o].goodsCount||t[o].quantity);break}s||"收入"!=t[o].incomeAndExpensesTypeName&&"收入"!=t[o].inAndOutName||this.leftChartData.push({day:e,type:"单数",value:t[o].goodsCount||t[o].quantity})}},getCost(t){for(let e=0;e<this.productList.length;e++)if(t==this.productList[e].sku)return this.productList[e].costPrice;return 0},sleepSync(t){return new Promise((e=>setTimeout(e,t)))},async downloadPicture(){try{const t=document.getElementById("app-content"),e=await c()(t),o=new Image;o.src=e.toDataURL("image/png"),document.body.appendChild(o);const s=document.createElement("a");s.style.display="none",s.href=o.src,s.download="账单统计(希音).png",s.click(),document.body.removeChild(o)}catch(t){console.error("Error saving image:",t)}}}},p=d,h=(o(86230),o(81656)),f=(0,h.A)(p,s,i,!1,null,"42302e47",null),m=f.exports},52208:function(t,e,o){"use strict";o.r(e);var s=o(31601),i=o.n(s),a=o(76314),n=o.n(a),r=n()(i());r.push([t.id,".list .title-right[data-v-42302e47]{display:flex;align-items:center}.list .title-right>div[data-v-42302e47]:first-child{margin-right:20px}.list[data-v-42302e47].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}.list .top[data-v-42302e47]{display:flex;justify-content:space-between;margin-bottom:24px}.list .top .item[data-v-42302e47]{flex:1;margin-right:20px;padding:16px 24px;background:#fff;box-shadow:0 4px 6px -2px rgba(15,15,21,.15);border-radius:4px}.list .top .item[data-v-42302e47]:last-child{margin-right:0}.list .top .item[data-v-42302e47]:first-of-type{color:#26f}.list .top .item[data-v-42302e47]:nth-of-type(2){color:#f8b426}.list .top .item[data-v-42302e47]:nth-of-type(3){color:#21aa99}.list .top .item[data-v-42302e47]:nth-of-type(4){color:#f46}.list .top .item[data-v-42302e47]:nth-of-type(5){color:#11a265}.list .top .item h2[data-v-42302e47]{margin-bottom:30px;font-size:16px;color:#999}.list .top .item p[data-v-42302e47]{font-weight:600;font-size:28px}.like[data-v-42302e47]{cursor:pointer;font-size:25px;display:inline-block}",""]),e["default"]=r},39325:function(t,e,o){"use strict";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof o.g?o.g:"undefined"!==typeof self&&self;function s(t,e){return e={exports:{}},t(e,e.exports),e.exports}var i=s((function(t,e){(function(e,o){t.exports=o()})(0,(function(){return function t(e,o,s){var i,a,n=window,r="application/octet-stream",l=s||r,c=e,u=!o&&!s&&c,d=document.createElement("a"),p=function(t){return String(t)},h=n.Blob||n.MozBlob||n.WebKitBlob||p,f=o||"download";if(h=h.call?h.bind(n):Blob,"true"===String(this)&&(c=[c,l],l=c[0],c=c[1]),u&&u.length<2048&&(f=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,f,r)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&h!==p))return navigator.msSaveBlob?navigator.msSaveBlob(b(c),f):v(c);c=b(c),l=c.type||r}else if(/([\x80-\xff])/.test(c)){var g=0,y=new Uint8Array(c.length),k=y.length;for(g;g<k;++g)y[g]=c.charCodeAt(g);c=new h([y],{type:l})}function b(t){var e=t.split(/[:;,]/),o=e[1],s="base64"==e[2]?atob:decodeURIComponent,i=s(e.pop()),a=i.length,n=0,r=new Uint8Array(a);for(n;n<a;++n)r[n]=i.charCodeAt(n);return new h([r],{type:o})}function v(t,e){if("download"in d)return d.href=t,d.setAttribute("download",f),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){n.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,r)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var o=document.createElement("iframe");document.body.appendChild(o),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,r)),o.src=t,setTimeout((function(){document.body.removeChild(o)}),333)}if(i=c instanceof h?c:new h([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(i,f);if(n.URL)v(n.URL.createObjectURL(i),!0);else{if("string"===typeof i||i.constructor===p)try{return v("data:"+l+";base64,"+n.btoa(i))}catch(S){return v("data:"+l+","+encodeURIComponent(i))}a=new FileReader,a.onload=function(t){v(this.result)},a.readAsDataURL(i)}return!0}}))})),a={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:()=>null},exportFields:{type:Object,default:()=>null},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},computed:{idName(){var t=(new Date).getTime();return"export_"+t},downloadFields(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let t=this.data;if("function"!==typeof this.fetch&&t||(t=await this.fetch()),!t||!t.length)return;let e=this.getProcessedJson(t,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(e),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(e),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(e),this.name,"application/vnd.ms-excel")},export:async function(t,e,o){let s=this.base64ToBlob(t,o);"function"===typeof this.beforeFinish&&await this.beforeFinish(),i(s,e,o)},jsonToXLS(t){let e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',o="<thead>";const s=Object.keys(t[0]).length;let i=this;const a=this.header||this.$attrs.title;a&&(o+=this.parseExtraData(a,'<tr><th colspan="'+s+'">${data}</th></tr>')),o+="<tr>";for(let n in t[0])o+="<th>"+n+"</th>";return o+="</tr>",o+="</thead>",o+="<tbody>",t.map((function(t,e){o+="<tr>";for(let s in t)o+="<td>"+i.preprocessLongNum(i.valueReformattedForMultilines(t[s]))+"</td>";o+="</tr>"})),o+="</tbody>",null!=this.footer&&(o+="<tfoot>",o+=this.parseExtraData(this.footer,'<tr><td colspan="'+s+'">${data}</td></tr>'),o+="</tfoot>"),e.replace("${table}",o).replace("${worksheet}",this.worksheet)},jsonToCSV(t){let e=this;var o=[];const s=this.header||this.$attrs.title;s&&o.push(this.parseExtraData(s,"${data}\r\n"));for(let i in t[0])o.push(i),o.push(",");return o.pop(),o.push("\r\n"),t.map((function(t){for(let s in t){let i=t[s]+"";e.escapeCsv&&(i='="'+i+'"',i.match(/[,"\n]/)&&(i='"'+i.replace(/\"/g,'""')+'"')),o.push(i),o.push(",")}o.pop(),o.push("\r\n")})),null!=this.footer&&o.push(this.parseExtraData(this.footer,"${data}\r\n")),o.join("")},getProcessedJson(t,e){let o=this.getKeys(t,e),s=[],i=this;return t.map((function(t,e){let a={};for(let s in o){let e=o[s];a[s]=i.getValue(e,t)}s.push(a)})),s},getKeys(t,e){if(e)return e;let o={};for(let s in t[0])o[s]=s;return o},parseExtraData(t,e){let o="";if(Array.isArray(t))for(var s=0;s<t.length;s++)t[s]&&(o+=e.replace("${data}",t[s]));else o+=e.replace("${data}",t);return o},getValue(t,e){const o="object"!==typeof t?t:t.field;let s="string"!==typeof o?[]:o.split("."),i=this.defaultValue;return i=o?s.length>1?this.getValueFromNestedItem(e,s):this.parseValue(e[o]):e,t.hasOwnProperty("callback")&&(i=this.getValueFromCallback(i,t.callback)),i},valueReformattedForMultilines(t){return"string"==typeof t?t.replace(/\n/gi,"<br/>"):t},preprocessLongNum(t){if(this.stringifyLongNum){if(String(t).startsWith("0x"))return t;if(!isNaN(t)&&""!=t&&(t>99999999999||t<1e-13))return'="'+t+'"'}return t},getValueFromNestedItem(t,e){let o=t;for(let s of e)o&&(o=o[s]);return this.parseValue(o)},getValueFromCallback(t,e){if("function"!==typeof e)return this.defaultValue;const o=e(t);return this.parseValue(o)},parseValue(t){return t||0===t||"boolean"===typeof t?t:this.defaultValue},base64ToBlob(t,e){let o=window.btoa(window.unescape(encodeURIComponent(t))),s=atob(o),i=s.length,a=new Uint8ClampedArray(i);while(i--)a[i]=s.charCodeAt(i);return new Blob([a],{type:e})}}};function n(t,e,o,s,i,a,n,r,l,c){"boolean"!==typeof n&&(l=r,r=n,n=!1);var u,d="function"===typeof o?o.options:o;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,i&&(d.functional=!0)),s&&(d._scopeId=s),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},d._ssrRegister=u):e&&(u=n?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),u)if(d.functional){var p=d.render;d.render=function(t,e){return u.call(e),p(t,e)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,u):[u]}return o}var r=n;const l=a;var c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.idName},on:{click:t.generate}},[t._t("default",[t._v(" Download "+t._s(t.name)+" ")])],2)},u=[];c._withStripped=!0;const d=void 0,p=void 0,h=void 0,f=!1;var m=r({render:c,staticRenderFns:u},d,l,p,f,h,void 0,void 0);e.A=m},86230:function(t,e,o){var s=o(52208);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);var i=o(99548).A;i("8d8118d6",s,!0,{sourceMap:!1,shadowMode:!1})}}]);