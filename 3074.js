(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[3074],{53074:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return h}});var i=function(){var t=this,e=t._self._c;return e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"账务明细统计",tips:"数据来源于“账户资金->对账中心->账务明细”",isShowBottomBorder:""},slot:"title",scopedSlots:t._u([{key:"rightBtn",fn:function(){return[e("div",{staticClass:"title-right"},[e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("时间选择：")]),e("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("店铺：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.mallId,callback:function(e){t.mallId=e},expression:"mallId"}},t._l(t.$store.state.mallList,(function(t){return e("el-option",{key:t.mallId,attrs:{label:t.mallName,value:t.mallId}})})),1)],1),e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:t.toBeginStat}},[t._v("开始统计")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadPicture}},[t._v("下载图片")])],1)]},proxy:!0}])}),e("template",{slot:"content"},[e("div",{attrs:{id:"app-content"}},[e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据概览"}},[e("el-divider",{attrs:{"content-position":"center"}},[t._v("收入概览")]),e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,"value-style":{color:"red"},value:t.transIncome+t.nonSllerDuty,title:"总收入"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.transIncome,title:"交易收入"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",value:t.nonSllerDuty,precision:2,title:"非商责平台售后补贴金额"}})],1)],1)])],1)],1),e("el-divider",{attrs:{"content-position":"center"}},[t._v("支出概览")]),e("div",[e("el-row",[e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,"value-style":{color:"red"},value:t.logisticAmount+t.customerOutcome+t.afterSaleAmount+t.eprAmount+t.withdrawAmount,title:"总支出"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.logisticAmount,title:"仓储综合服务费"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.customerOutcome,title:"消费者退款金额"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.afterSaleAmount,title:"消费者及履约保障-售后问题"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.eprAmount,title:"合规EPR物流包装环保费"}})],1)],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-card",{staticClass:"amountItem",attrs:{shadow:"always"}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.withdrawAmount,title:"提现"}})],1)],1)])],1)],1)],1)],1),e("ai-dialog",{attrs:{title:"提示",visible:t.isTipDlgShow,"close-on-click-modal":!1,width:"790px",customFooter:""},on:{"update:visible":function(e){t.isTipDlgShow=e},close:function(e){t.isDlgShow=!1}}},[e("div",{staticStyle:{display:"block",height:"30px"}},[t._v("卖家中心出现图形验证码，请前往卖家中心“账户资金->对账中心->账务明细”，随机选择一条数据，点击“查看详情”，处理验证码")]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isTipDlgShow=!1}}},[t._v("取消")]),e("el-button",{staticStyle:{width:"180px"},on:{click:t.toGoon}},[t._v("已验证，继续统计")]),e("el-button",{attrs:{type:"primary"},on:{click:t.gotoValid}},[t._v("前往验证")])],1)])],1)],2)},s=[],l=a(73236),o=a(31052),r=a(20354),n=a.n(r),c={name:"ExportBillStatTemu",data(){return{mallId:null,dateRange:null,transIncome:0,customerOutcome:0,nonSllerDuty:0,afterSaleAmount:0,logisticAmount:0,eprAmount:0,withdrawAmount:0,currentPage:1,pageSize:100,flowList:[],currentIndex:0,isTipDlgShow:!1,isLoading:!1}},mounted(){},methods:{toBeginStat(){this.dateRange?this.mallId?this.$userCheck(this.mallId).then((async()=>{this.currentPage=1,this.flowList=[],this.isLoading=!0,this.transIncome=0,this.customerOutcome=0,this.nonSllerDuty=0,this.afterSaleAmount=0,this.logisticAmount=0,this.eprAmount=0,this.withdrawAmount=0,this.currentIndex=0,await this.beginStat(),this.nonSllerDuty=Math.round(100*this.nonSllerDuty)/100,this.isLoading=!1})).catch((t=>{this.mallId="",this.isLoading=!1})):o.Message.error("请选择店铺"):o.Message.error("请选择统计时间范围")},async beginStat(){let t=await(0,l.w4)({url:"api/merchant/fund/detail/pageSearch",needMallId:!0,mallId:this.mallId,data:{moneyChangeTypeList:[],fundType:[],beginTime:this.dateRange[0].getTime(),endTime:this.dateRange[1].getTime()+864e5-1,pageSize:this.pageSize,pageNum:this.currentPage}});1e6==t.errorCode&&(this.flowList=this.flowList.concat(t.result.resultList),t.result.resultList.length==this.pageSize?(this.currentPage++,await this.beginStat()):(this.currentIndex=0,await this.stat()))},async stat(){for(;this.currentIndex<this.flowList.length;this.currentIndex++){if(this.isTipDlgShow){this.currentIndex--;break}100==this.flowList[this.currentIndex].fundType?(await this.$sleepSync(300),await this.querySattement(this.flowList[this.currentIndex])):200==this.flowList[this.currentIndex].fundType?this.withdrawAmount+=this.flowList[this.currentIndex].originAmount/100:400==this.flowList[this.currentIndex].fundType&&"deduct_risk_punish"==this.flowList[this.currentIndex].bizType?this.afterSaleAmount+=Number(this.flowList[this.currentIndex].amount.replace("¥","")):400==this.flowList[this.currentIndex].fundType&&"deduct_storage_service_fee"==this.flowList[this.currentIndex].bizType?this.logisticAmount+=Number(this.flowList[this.currentIndex].amount.replace("¥","")):400==this.flowList[this.currentIndex].fundType&&"deduct_epr"==this.flowList[this.currentIndex].bizType&&(this.eprAmount+=Number(this.flowList[this.currentIndex].amount.replace("¥","")))}},async toGoon(){this.isTipDlgShow=!1,this.isLoading=!0,await this.stat()},async querySattement(t){let e=await(0,l.w4)({url:"api/merchant/fund/detail/item",needMallId:!0,mallId:this.mallId,anti:!0,data:{fundType:t.fundType,batchId:t.transSn,createdTime:t.createTime}});if(1e6==e.errorCode)for(let a=0;a<e.result.length;a++)1==e.result[a].fundItemType?this.transIncome+=Number(e.result[a].amount):3==e.result[a].fundItemType?this.customerOutcome+=Number(e.result[a].amount):5==e.result[a].fundItemType&&(this.nonSllerDuty+=Number(e.result[a].amount));else"54001"==e.error_code&&(this.isLoading=!1,this.isTipDlgShow=!0)},async downloadPicture(){try{const t=document.getElementById("app-content"),e=await n()(t),a=new Image;a.src=e.toDataURL("image/png"),document.body.appendChild(a);const i=document.createElement("a");i.style.display="none",i.href=a.src,i.download="账务明细统计.png",i.click(),document.body.removeChild(a)}catch(t){console.error("Error saving image:",t)}},gotoValid(){window.open("https://seller.kuajingmaihuo.com/labor/bill","_blank")}}},d=c,u=(a(75999),a(81656)),p=(0,u.A)(d,i,s,!1,null,"f7ce0384",null),h=p.exports},29149:function(t,e,a){"use strict";a.r(e);var i=a(31601),s=a.n(i),l=a(76314),o=a.n(l),r=o()(s());r.push([t.id,".list .title-right[data-v-f7ce0384]{display:flex;align-items:center}.list .title-right>div[data-v-f7ce0384]:first-child{margin-right:20px}.list[data-v-f7ce0384].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}.list .top[data-v-f7ce0384]{display:flex;justify-content:space-between;margin-bottom:24px}.list .top .item[data-v-f7ce0384]{flex:1;margin-right:20px;padding:16px 24px;background:#fff;box-shadow:0 4px 6px -2px rgba(15,15,21,.15);border-radius:4px}.list .top .item[data-v-f7ce0384]:last-child{margin-right:0}.list .top .item[data-v-f7ce0384]:first-of-type{color:#26f}.list .top .item[data-v-f7ce0384]:nth-of-type(2){color:#f8b426}.list .top .item[data-v-f7ce0384]:nth-of-type(3){color:#21aa99}.list .top .item[data-v-f7ce0384]:nth-of-type(4){color:#f46}.list .top .item[data-v-f7ce0384]:nth-of-type(5){color:#11a265}.list .top .item h2[data-v-f7ce0384]{margin-bottom:30px;font-size:16px;color:#999}.list .top .item p[data-v-f7ce0384]{font-weight:600;font-size:28px}.like[data-v-f7ce0384]{cursor:pointer;font-size:25px;display:inline-block}.amountItem[data-v-f7ce0384]{margin:10px}",""]),e["default"]=r},75999:function(t,e,a){var i=a(29149);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);var s=a(99548).A;s("f9bf4488",i,!0,{sourceMap:!1,shadowMode:!1})}}]);