(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[31],{90031:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return _}});var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[e("keep-alive",{attrs:{include:["List"]}},[e(t.component,{ref:"component",tag:"component",attrs:{params:t.params},on:{change:t.onChange}})],1)],1)],1)},s=[],r=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"正在采集中……","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"我的分组",isShowBottomBorder:""},slot:"title"}),e("template",{slot:"content"},[e("div",{staticClass:"content"},[e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:function(e){return t.addStore()}}},[t._v("添加分组")])]},proxy:!0}])}),e("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{tableData:t.tableData,"col-configs":t.colConfigs,total:t.total,current:t.search.current,size:t.search.size},on:{"update:current":function(e){return t.$set(t.search,"current",e)},"update:size":function(e){return t.$set(t.search,"size",e)},getList:t.getList}},[e("el-table-column",{attrs:{slot:"options",label:"操作",width:"240px","show-overflow-tooltip":"",align:"center",fixed:"right"},slot:"options",scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("div",{staticClass:"table-options"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.deleteGroup(a.id)}}},[t._v("删除")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.toUpdateGroup(a)}}},[t._v("修改")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.toDetail(a.id)}}},[t._v("详情")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.toBegin(a)}}},[t._v("采集数据")])],1)]}}])})],1)],1)])],2),e("ai-dialog",{attrs:{title:"添加分组",visible:t.isDlgShow,"close-on-click-modal":!1,width:"790px",customFooter:""},on:{"update:visible":function(e){t.isDlgShow=e},close:function(e){t.isDlgShow=!1}}},[e("el-form",{ref:"form",staticClass:"ai-form",staticStyle:{"margin-top":"20px"},attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{prop:"name",label:"分组名称",rules:[{required:!0,message:"请输入分组名称",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"请输入分组名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{prop:"remark",label:"备注",rules:[{required:!0,message:"请输入备注",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isDlgShow=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveStore}},[t._v("确定")])],1)],1),e("ai-dialog",{attrs:{title:"修改分组",visible:t.isUpdateDlgShow,"close-on-click-modal":!1,width:"790px",customFooter:""},on:{"update:visible":function(e){t.isUpdateDlgShow=e},close:function(e){t.isDlgShow=!1}}},[e("el-form",{ref:"updateForm",staticClass:"ai-form",attrs:{model:t.updateForm,"label-width":"120px"}},[e("el-form-item",{attrs:{prop:"name",label:"分组名称",rules:[{required:!0,message:"请输入分组名称",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"请输入分组名称"},model:{value:t.updateForm.name,callback:function(e){t.$set(t.updateForm,"name",e)},expression:"updateForm.name"}})],1),e("el-form-item",{attrs:{prop:"remark",label:"备注",rules:[{required:!0,message:"请输入备注",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"请输入备注"},model:{value:t.updateForm.remark,callback:function(e){t.$set(t.updateForm,"remark",e)},expression:"updateForm.remark"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isUpdateDlgShow=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定")])],1)],1),e("ai-dialog",{attrs:{title:"提示",visible:t.isTipDlgShow,"close-on-click-modal":!1,width:"790px",customFooter:""},on:{"update:visible":function(e){t.isTipDlgShow=e},close:function(e){t.isDlgShow=!1}}},[e("div",{staticStyle:{display:"block",height:"30px"}},[t._v("商品链接可能出现图形验证码，导致采集失败，是否前往验证？")]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isTipDlgShow=!1}}},[t._v("取消")]),e("el-button",{staticStyle:{width:"180px"},on:{click:function(e){t.isTipDlgShow=!1,t.isLoading=!0,t.beginCollect()}}},[t._v("已验证，继续采集")]),e("el-button",{attrs:{type:"primary"},on:{click:t.gotoValid}},[t._v("前往验证")])],1)])],1)},o=[],l=a(73236),n=a(31052),c={name:"List",data(){return{search:{current:1,size:10},colConfigs:[{prop:"name",label:"分组名称",align:"left"},{prop:"remark",label:"备注",align:"left"},{prop:"lastUpdateTime",label:"最后一次更新时间",align:"left"},{prop:"createTime",label:"添加时间",width:"180px",fixed:"right"}],tableData:[],total:0,form:{name:"",remark:""},updateObj:{},isUpdateDlgShow:!1,updateForm:{id:"",name:"",remark:""},isDlgShow:!1,detailsVo:{},pageNo:1,pageSize:120,isLoading:!1,currentRow:{},goodsList:[],currentIndex:0,isTipDlgShow:!1}},created(){this.$dict.load("monitor_status"),this.getList()},methods:{getList(){this.$http.post("/api/newProductGroup/myPage",null,{params:{...this.search}}).then((t=>{this.tableData=t.data.records,this.total=t.data.total}))},onChooseChange(t){this.selectRows=t},saveStore(){this.$refs.form.validate((t=>{t&&this.$http.post("/api/newProductGroup/add",{name:this.form.name,remark:this.form.remark}).then((t=>{0==t.code&&(this.$message.success("添加成功！"),this.$store.dispatch("getUserInfo"),this.getList(),this.isDlgShow=!1)}))}))},toUpdateGroup(t){this.updateObj=t,this.updateForm.name=t.name,this.updateForm.remark=t.remark,this.isUpdateDlgShow=!0},updateGroup(){this.$refs.updateForm.validate((t=>{t&&this.$http.post("/api/newProductGroup/update",{id:this.updateObj.id,name:this.updateForm.name,remark:this.updateForm.remark}).then((t=>{0==t.code&&(this.$message.success("修改成功！"),this.getList(),this.isUpdateDlgShow=!1)}))}))},renew(t){this.$confirm("确定要续费？","温馨提示",{type:"warning"}).then((()=>{this.$http.post("/api/newProductGroup/renew",null,{params:{id:t}}).then((t=>{0==t.code&&(this.$message.success("续费成功！"),this.$store.dispatch("getUserInfo"),this.getList())}))}))},deleteGroup(t){this.$confirm("确定要删除？","温馨提示",{type:"warning"}).then((()=>{this.$http.post("/api/newProductGroup/del",null,{params:{id:t}}).then((t=>{0==t.code&&(this.$message.success("删除成功！"),this.getList())}))}))},toDetail(t){this.$emit("change",{type:"Detail",params:{id:t||""}})},addStore(){this.form.name="",this.form.remark="",this.isDlgShow=!0},toBegin(t){this.currentRow=t,this.isLoading=!0,this.$http.post("/api/newProductGroupDetail/getGoodsList",null,{params:{groupId:t.id}}).then((t=>{this.goodsList=t.data,this.currentIndex=0,this.beginCollect()}))},async beginCollect(){if(this.currentIndex>=this.goodsList.length)return n.Message.success("采集成功"),this.isLoading=!1,void this.getList();let t=await(0,l.s6)({type:"temu",url:"https://www.temu.com/goods.html?goods_id="+this.goodsList[this.currentIndex].goodsId});if(-1==t.indexOf("window.rawData"))return this.isLoading=!1,this.errorUrl="https://www.temu.com/goods.html?goods_id="+this.goodsList[this.currentIndex].goodsId,void(this.isTipDlgShow=!0);let e=t.substring(t.indexOf("window.rawData"));e=e.substring(0,e.indexOf("<\/script>")),e=e.substring(e.indexOf("{")),e=e.substring(0,e.lastIndexOf("}")),e+="}";let a=JSON.parse(e),i=a.store.sku[0];await this.$http.post("/api/newProductDetail/addDetail",null,{params:{groupId:this.goodsList[this.currentIndex].groupId,goodsId:this.goodsList[this.currentIndex].goodsId,price:i.normalPrice/100,saleTotal:a.store.goods.soldQuantity||0}}),this.currentIndex++,this.beginCollect()},gotoValid(){window.open(this.errorUrl,"_blank")}}},d=c,p=a(81656),u=(0,p.A)(d,r,o,!1,null,"12ef59ec",null),h=u.exports,g=function(){var t=this,e=t._self._c;return e("div",[e("ai-list",{staticClass:"list"},[e("ai-title",{attrs:{slot:"title",title:"分组商品列表",isShowBottomBorder:"",isShowBack:""},on:{onBackClick:function(e){return t.cancel(!1)}},slot:"title"}),e("template",{slot:"content"},[e("ai-search-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("label",{staticStyle:{width:"80px"}},[t._v("排序方式：")]),e("el-select",{attrs:{clearable:!0,placeholder:"请选择排序方式",size:"small"},on:{change:function(e){t.search.current=1,t.getList()}},model:{value:t.search.orderBy,callback:function(e){t.$set(t.search,"orderBy",e)},expression:"search.orderBy"}},t._l(t.orderBys,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("label",{staticStyle:{width:"80px"}},[t._v("价格区间：")]),e("el-input",{staticStyle:{width:"80px"},attrs:{clearable:!0,size:"small"},model:{value:t.search.priceBegin,callback:function(e){t.$set(t.search,"priceBegin",e)},expression:"search.priceBegin"}}),t._v(" ~ "),e("el-input",{staticStyle:{width:"80px"},attrs:{clearable:!0,size:"small"},model:{value:t.search.priceEnd,callback:function(e){t.$set(t.search,"priceEnd",e)},expression:"search.priceEnd"}}),e("label",{staticStyle:{width:"80px"}},[t._v("销量区间：")]),e("el-input",{staticStyle:{width:"80px"},attrs:{clearable:!0,size:"small"},model:{value:t.search.saleBegin,callback:function(e){t.$set(t.search,"saleBegin",e)},expression:"search.saleBegin"}}),t._v(" ~ "),e("el-input",{staticStyle:{width:"80px"},attrs:{clearable:!0,size:"small"},model:{value:t.search.saleEnd,callback:function(e){t.$set(t.search,"saleEnd",e)},expression:"search.saleEnd"}})]},proxy:!0},{key:"right",fn:function(){return[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.search.current=1,t.getList()}}},[t._v("查询")])]},proxy:!0}])}),e("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr 1fr 1fr 1fr 1fr",gap:"16px"}},[t._l(t.tableData,(function(a){return e("el-card",{key:a.id,attrs:{"body-style":{padding:"0px",margin:"5px"}}},[e("span",{staticClass:"nav-label labelBadge"},[e("el-image",{staticClass:"image",attrs:{src:a.imgUrl,"preview-src-list":[a.imgUrl]}})],1),e("div",{staticStyle:{padding:"14px"}},[e("div",{staticClass:"bottom clearfix"},[e("div",{staticStyle:{"margin-bottom":"5px"}},[e("div",{staticStyle:{display:"inline","margin-left":"5px"}},[t._v("$"+t._s(a.price)),e("sub",{staticStyle:{"margin-left":"2px"},domProps:{innerHTML:t._s(t.getPricePercent(a.priceChange))}})]),e("div",{staticStyle:{display:"inline","margin-right":"5px",float:"right"}},[t._v(t._s(a.saleTotal)),e("sub",{staticStyle:{"margin-left":"2px"},domProps:{innerHTML:t._s(t.getSalePercent(a.saleChange))}})])]),e("div",[e("div",{staticStyle:{display:"inline"}},[t._v("日均销量: "),e("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v(t._s(a.averageSale))])]),e("ai-product-drop-down",{staticStyle:{float:"right"},attrs:{params:a,isShowDetail:!0,isShowAddFavorite:!1,isShowDelFavorite:!1},on:{onGoDetail:function(e){return t.goDetail(a.goodsId)}}})],1)])])])})),e("el-pagination",{staticStyle:{position:"absolute",bottom:"0px",right:"40px"},attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.search.size,"current-page":t.search.current},on:{"update:pageSize":function(e){return t.$set(t.search,"size",e)},"update:page-size":function(e){return t.$set(t.search,"size",e)},"update:currentPage":function(e){return t.$set(t.search,"current",e)},"update:current-page":function(e){return t.$set(t.search,"current",e)},"current-change":t.getList}})],2)],1)],2),e("div",{staticClass:"productDetail"},[e("el-dialog",{attrs:{title:"商品详情",visible:t.isShowDetailDlg,"close-on-click-modal":!1,width:"80%","before-close":t.handleClose}},[t.isShowDetailDlg?e("ai-product-detail",{attrs:{params:t.detailParams,url:"/api/newProductDetail/queryDetail"}}):t._e()],1)],1)],1)},m=[],f=a(12411),v=a(8418),b={name:"DetailPage",props:["params"],components:{AiProductDetail:f["default"],AiProductDropDown:v["default"]},data(){return{groupId:"",search:{current:1,type:"1",size:120,orderBy:"",priceBegin:"",priceEnd:"",saleBegin:"",saleEnd:""},orderBys:[{value:"0",label:"按销量涨辐排序"},{value:"1",label:"按价格涨辐排序"},{value:"2",label:"按销量排序"},{value:"3",label:"按价格排序"},{value:"4",label:"按日均销量排序"}],tableData:[],total:0,isShowDetailDlg:!1,detailParams:{}}},created(){this.groupId=this.params.id,this.getList()},methods:{getList(){this.$http.post("/api/newProductGroupDetail/myPage",null,{params:{groupId:this.groupId,...this.search}}).then((t=>{this.tableData=t.data.records,this.total=t.data.total}))},cancel(t){this.$emit("change",{type:"List",isRefresh:!!t})},getPricePercent(t){return t<0?'<div style="display: inline; color: green">↓'+t+"%</div>":t>0?'<div style="display: inline; color: red">↑'+t+"%</div>":""},getSalePercent(t){return t<0?'<div style="display: inline; color: green">↓'+t+"%</div>":t>0?'<div style="display: inline; color: red">↑'+t+"%</div>":""},handleClose(){this.isShowDetailDlg=!1},goDetail(t){this.detailParams={goodsId:t},this.isShowDetailDlg=!0}}},w=b,y=(a(42980),(0,p.A)(w,g,m,!1,null,"36516302",null)),x=y.exports,S={name:"NewProductGroup",label:"我的分组",components:{List:h,Detail:x},data(){return{component:"List",params:{}}},methods:{onChange(t){"Detail"===t.type&&(this.component="Detail",this.params=t.params),"List"===t.type&&(this.component="List",this.params=t.params,this.$nextTick((()=>{t.isRefresh&&setTimeout((()=>{this.$refs.component.getList()}),600)})))}}},k=S,D=(0,p.A)(k,i,s,!1,null,"8773c284",null),_=D.exports},19790:function(t,e,a){"use strict";a.r(e);var i=a(31601),s=a.n(i),r=a(76314),o=a.n(r),l=o()(s());l.push([t.id,'.productDetail[data-v-36516302] .el-dialog{height:78vh;overflow:auto}.time[data-v-36516302]{font-size:13px;color:#999}.bottom[data-v-36516302]{margin-top:13px;line-height:12px}.button[data-v-36516302]{padding:0;float:right}.image[data-v-36516302]{width:100%;display:block}.clearfix[data-v-36516302]:after,.clearfix[data-v-36516302]:before{display:table;content:""}.clearfix[data-v-36516302]:after{clear:both}.el-dropdown-link[data-v-36516302]{cursor:pointer;color:#409eff}.el-icon-arrow-down[data-v-36516302]{font-size:12px}.labelBadge[data-v-36516302]{position:relative}.ii[data-v-36516302]{background:red;border-radius:50%;width:20px;height:20px;top:-3px;right:-5px;position:absolute;text-align:center;color:#fff;z-index:999;font-size:14px}',""]),e["default"]=l},42980:function(t,e,a){var i=a(19790);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);var s=a(99548).A;s("16caa1da",i,!0,{sourceMap:!1,shadowMode:!1})}}]);