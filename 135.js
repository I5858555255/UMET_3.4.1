(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[135],{30135:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=function(){var e=this,t=e._self._c;return t("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("ai-title",{attrs:{slot:"title",title:"商品条码管理",tips:"每页为100条商品数据",isShowBottomBorder:""},slot:"title",scopedSlots:e._u([{key:"rightBtn",fn:function(){return[t("div",{staticClass:"title-right"},[t("div",[t("label",{staticStyle:{width:"90px"}},[e._v("店铺：")]),t("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.form.mallId,callback:function(t){e.$set(e.form,"mallId",t)},expression:"form.mallId"}},e._l(e.$store.state.mallList,(function(e){return t("el-option",{key:e.mallId,attrs:{label:e.mallName,value:e.mallId}})})),1)],1)])]},proxy:!0}])}),t("template",{slot:"content"},[t("div",{staticClass:"content"},[t("ai-search-bar",{scopedSlots:e._u([{key:"left",fn:function(){return[t("div",{staticClass:"search-item"},[t("label",[e._v("起始页：")]),t("el-input",{attrs:{size:"small",placeholder:"请输入起始页",type:"number"},model:{value:e.startPage,callback:function(t){e.startPage=t},expression:"startPage"}})],1),t("div",{staticClass:"search-item"},[t("label",[e._v("结束页：")]),t("el-input",{attrs:{size:"small",placeholder:"请输入起始页",type:"number"},model:{value:e.endPage,callback:function(t){e.endPage=t},expression:"endPage"}})],1),t("div",{staticClass:"search-item"},[t("label",[e._v("SKC：")]),t("el-input",{attrs:{size:"small",placeholder:"请输入SKC，多个用逗号隔开"},model:{value:e.skcs,callback:function(t){e.skcs=t},expression:"skcs"}})],1)]},proxy:!0},{key:"right",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:e.toLoad}},[e._v("加载")])]},proxy:!0}])}),t("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据明细"},scopedSlots:e._u([{key:"right",fn:function(){return[t("el-button",{attrs:{type:"primary",disabled:0==e.tableData.length},on:{click:e.exportWaitUploadToExcel}},[e._v("导出当前")]),t("el-button",{attrs:{type:"primary"},on:{click:e.exportAllToExcel}},[e._v("导出所有店铺")])]},proxy:!0}])},[t("ai-table",{staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:e.tableData,"col-configs":e.colConfigs,total:e.tableData.length,height:"700"},on:{getList:()=>{}}},[t("el-table-column",{attrs:{slot:"productName",width:"300px","show-overflow-tooltip":!0,label:"商品名称",fixed:"left"},slot:"productName",scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[t("el-image",{staticClass:"image",staticStyle:{width:"40px",height:"40px"},attrs:{src:a.row.mainImageUrl,"preview-src-list":[a.row.mainImageUrl]}}),e._v(" "+e._s(a.row.productName)+" ")],1)]}}])})],1)],1)],1)])],2)},l=[],s=(a(44114),a(81454),a(14603),a(47566),a(98721),a(31052)),i=a(73236),r=a(3959),n=a(4213),d={name:"ProductLabel",data(){return{form:{mallId:""},startPage:1,endPage:10,skcs:null,reqData:{page:1,pageSize:100},colConfigs:[{slot:"productName",label:"商品名称",width:"300px",align:"left",fixed:"left"},{prop:"category",label:"分类",width:"140px",align:"left",fixed:"left"},{prop:"labelCode",label:"条码编码",align:"left"},{prop:"productSkcId",label:"SKC",align:"left"},{prop:"productSkuId",label:"SKU",align:"left"},{prop:"extCode",label:"SKC货号",align:"left"},{prop:"skuExtCode",label:"SKU货号",align:"left"},{prop:"skcSpecName",label:"主销售属性",align:"left"},{prop:"skuSpecName",label:"次销售属性",width:"100px",align:"left"}],isLoading:!1,tableData:[],currentIndex:0}},created(){},methods:{beforeGetList(){this.$userCheck(this.form.mallId).then((()=>{this.toLoad()})).catch((e=>{this.form.mallId=""}))},toLoad(){this.form.mallId?!this.startPage||this.startPage<1?s.Message.error("起始页不能为空，且不能小于1"):!this.endPage||this.startPage<1?s.Message.error("结束页不能为空"):this.startPage>this.endPage?s.Message.error("起始页不能大于结束页"):(this.skcs&&(this.reqData.productSkcIdList=this.skcs.split(",")),this.$userCheck(this.form.mallId).then((()=>{this.reqData.page=this.startPage,this.tableData=[],this.currentIndex=0,this.isLoading=!0,this.load()})).catch((e=>{this.form.mallId=""}))):s.Message.error("请选择店铺")},load(){(0,i.w4)({url:"bg-visage-mms/labelcode/pageQuery",needMallId:!0,mallId:this.form.mallId,data:this.reqData}).then((e=>{if(1e6==e.errorCode){for(let t=0;t<e.result.pageItems.length;t++){let a=e.result.pageItems[t],o={};o.productName=a.productName,o.mainImageUrl=a.displayImage,o.productSkcId=a.labelCodeVO.productSkcId,o.productSkuId=a.labelCodeVO.productSkuId,o.labelCode=a.labelCodeVO.labelCode,o.extCode=a.labelCodeVO.skcExtCode,o.skuExtCode=a.labelCodeVO.skuExtCode,o.category=a.leafCat.catName;let l=a.productSkcSpecList.map((e=>e.specName));o.skcSpecName=l.join(","),l=a.productSkuSpecList.map((e=>e.specName)),o.skuSpecName=l.join(","),this.tableData.push(o)}e.result.pageItems.length==this.reqData.pageSize&&this.reqData.page<this.endPage?(this.reqData.page++,this.load()):this.isLoading=!1}}))},async exportAllToExcel(){this.isLoading=!0;let e=[];for(let r=0;r<this.$store.state.mallList.length;r++){let t=1;while(1){let a=await(0,i.w4)({url:"bg-visage-mms/labelcode/pageQuery",needMallId:!0,mallId:this.$store.state.mallList[r].mallId,anti:!0,data:{page:t,pageSize:100}});if(1e6==a.errorCode){for(let t=0;t<a.result.pageItems.length;t++){let o=a.result.pageItems[t],l={};l.productName=o.productName,l.mainImageUrl=o.displayImage,l.productSkcId=o.labelCodeVO.productSkcId,l.productSkuId=o.labelCodeVO.productSkuId,l.labelCode=o.labelCodeVO.labelCode,l.extCode=o.labelCodeVO.skcExtCode,l.skuExtCode=o.labelCodeVO.skuExtCode,l.category=o.leafCat.catName,l.displayImage=o.displayImage,l.mallName=this.$store.state.mallList[r].mallName;let s=o.productSkcSpecList.map((e=>e.specName));l.skcSpecName=s.join(","),s=o.productSkuSpecList.map((e=>e.specName)),l.skuSpecName=s.join(","),e.push(l)}if(100!=a.result.pageItems.length)break;t++}await this.$sleepSync(200)}}const t=[["商品名称","分类","条码编码","SKC","SKU","SKC货号","SKU货号","主销售属性","次销售属性","模板名称","店铺名称","图片"]];e.map((e=>{t.push([e.productName,e.category,e.labelCode,e.productSkcId,e.productSkuId,e.extCode,e.skuExtCode,e.skcSpecName,e.skuSpecName,"",e.mallName,e.displayImage])}));const a=r.Wp.aoa_to_sheet(t),o=r.Wp.book_new();r.Wp.book_append_sheet(o,a,"Sheet1");const l=r.M9(o,{bookType:"xlsx",type:"array"}),s=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),d=window.URL.createObjectURL(s);(0,n.saveAs)(s,"商品条码列表.xlsx"),window.URL.revokeObjectURL(d),this.isLoading=!1},exportWaitUploadToExcel(){const e=[["商品名称","分类","条码编码","SKC","SKU","SKC货号","SKU货号","主销售属性","次销售属性"]];this.tableData.map((t=>{e.push([t.productName,t.category,t.labelCode,t.productSkcId,t.productSkuId,t.extCode,t.skuExtCode,t.skcSpecName,t.skuSpecName])}));const t=r.Wp.aoa_to_sheet(e),a=r.Wp.book_new();r.Wp.book_append_sheet(a,t,"Sheet1");const o=r.M9(a,{bookType:"xlsx",type:"array"}),l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),s=window.URL.createObjectURL(l);(0,n.saveAs)(l,"商品条码列表.xlsx"),window.URL.revokeObjectURL(s)}}},c=d,p=(a(59457),a(81656)),u=(0,p.A)(c,o,l,!1,null,"820d5d16",null),m=u.exports},98103:function(e,t,a){"use strict";a.r(t);var o=a(31601),l=a.n(o),s=a(76314),i=a.n(s),r=i()(l());r.push([e.id,".list .title-right[data-v-820d5d16]{display:flex;align-items:center}.list .title-right>div[data-v-820d5d16]:first-child{margin-right:20px}.list[data-v-820d5d16].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}",""]),t["default"]=r},4213:function(e,t,a){var o,l,s;(function(a,i){l=[],o=i,s="function"===typeof o?o.apply(t,l):o,void 0===s||(e.exports=s)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function o(e,t,a){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){n(o.response,t,a)},o.onerror=function(){console.error("could not download file")},o.send()}function l(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,r=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,t,a){var r=i.URL||i.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin===location.origin?s(n):l(n.href)?o(e,t,a):s(n,n.target="_blank")):(n.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(n.href)}),4e4),setTimeout((function(){s(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,i){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),a);else if(l(e))o(e,a,i);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){s(r)}))}}:function(e,t,a,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return o(e,t,a);var s="application/octet-stream"===e.type,n=/constructor/i.test(i.HTMLElement)||i.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||s&&n||r)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},c.readAsDataURL(e)}else{var p=i.URL||i.webkitURL,u=p.createObjectURL(e);l?l.location=u:location.href=u,l=null,setTimeout((function(){p.revokeObjectURL(u)}),4e4)}});i.saveAs=n.saveAs=n,e.exports=n}))},59457:function(e,t,a){var o=a(98103);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(99548).A;l("25801285",o,!0,{sourceMap:!1,shadowMode:!1})}}]);