(self["webpackChunkpdd"]=self["webpackChunkpdd"]||[]).push([[7205],{47205:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return m}});var a=function(){var t=this,e=t._self._c;return e("ai-list",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[e("ai-title",{attrs:{slot:"title",title:"销售统计",tips:"最多只能统计近60天的销售数据",isShowBottomBorder:""},slot:"title",scopedSlots:t._u([{key:"rightBtn",fn:function(){return[e("div",{staticClass:"title-right"},[e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("时间范围：")]),e("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",[e("label",{staticStyle:{width:"90px"}},[t._v("店铺：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.mallId,callback:function(e){t.mallId=e},expression:"mallId"}},t._l(t.$store.state.mallList,(function(t){return e("el-option",{key:t.mallId,attrs:{label:t.mallName,value:t.mallId}})})),1)],1),e("el-button",{class:"el-button el-button--primary",attrs:{type:"button"},on:{click:t.toBeginStat}},[t._v("开始统计")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadPicture}},[t._v("下载图片")]),e("json-excel",{attrs:{data:t.skcList,fields:t.skcJsonFields,name:"SKC销售统计.xls",worksheet:"SKC销售统计"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-download"}},[t._v("下载SKC统计")])],1),e("json-excel",{attrs:{data:t.skuList,fields:t.skuJsonFields,name:"SKU销售统计.xls",worksheet:"SKU销售统计"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-download"}},[t._v("下载SKU统计")])],1)],1)]},proxy:!0}])}),e("template",{slot:"content"},[e("div",{attrs:{id:"app-content"}},[e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"数据概览"}},[e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:5}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.saleAmount,title:"销售额"}})],1)]),e("el-col",{attrs:{span:5}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",value:t.saleCount,title:"单量"}})],1)]),e("el-col",{attrs:{span:5}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.costAmount,title:"成本"}})],1)]),e("el-col",{attrs:{span:5}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.profitAmount,title:"利润"}})],1)]),e("el-col",{attrs:{span:4}},[e("div",[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.profitPercent,title:"利润率"}},[e("template",{slot:"suffix"},[t._v("%")])],2)],1)])],1)],1)]),e("ai-card",{staticStyle:{"padding-bottom":"40px"},attrs:{title:"趋势分析"}},[e("div",[e("div",{attrs:{id:"chart1"}})])]),e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC销售额TOP10排行"}},[e("ai-table",{ref:"table0",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleAmountSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC利润TOP10排行"}},[e("ai-table",{ref:"table1",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleProfitSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKC单量TOP10排行"}},[e("ai-table",{ref:"table2",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleCountSkcList,"col-configs":t.skcColConfigs}},[e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU销售额TOP10排行"}},[e("ai-table",{ref:"table3",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleAmountSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"skuExtCode",label:"SKC属性/SKU属性",width:"250px","show-overflow-tooltip":!0},slot:"skuExtCode",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.skcExtCode+"/"+s.row.skuExtCode))])]}}])}),e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU利润TOP10排行"}},[e("ai-table",{ref:"table4",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleProfitSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"skuExtCode",label:"SKC属性/SKU属性",width:"250px","show-overflow-tooltip":!0},slot:"skuExtCode",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.skcExtCode+"/"+s.row.skuExtCode))])]}}])}),e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("ai-card",{attrs:{title:"SKU单量TOP10排行"}},[e("ai-table",{ref:"table5",staticStyle:{"margin-top":"8px"},attrs:{isShowPagination:!1,tableData:t.topSaleCountSkuList,"col-configs":t.skuColConfigs}},[e("el-table-column",{attrs:{slot:"skuExtCode",label:"SKC属性/SKU属性",width:"250px","show-overflow-tooltip":!0},slot:"skuExtCode",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.skcExtCode+"/"+s.row.skuExtCode))])]}}])}),e("el-table-column",{attrs:{slot:"saleAmount",label:"销售额"},slot:"saleAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.saleAmount))])]}}])}),e("el-table-column",{attrs:{slot:"profitAmount",label:"利润"},slot:"profitAmount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v(t._s(s.row.profitAmount))])]}}])}),e("el-table-column",{attrs:{slot:"saleCount",label:"单量"},slot:"saleCount",scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{color:"red"}},[t._v(t._s(s.row.saleCount))])]}}])})],1)],1)],1)],1)],1)],1)])],2)},o=[],l=(s(44114),s(98992),s(54520),s(81454),s(73236)),i=s(39325),r=s(31052),n=s(20354),u=s.n(n),c=s(53751),d={name:"ExportSaleStatTemu",data(){return{mallId:null,storeCode:"",dateRange:null,currentPage:1,pageSize:50,productList:[],productCostList:[],saleAmount:0,saleCount:0,costAmount:0,profitAmount:0,profitPercent:0,deductionAmount:0,skcList:[],skuList:[],leftChartData:[],rightChartData:[],isLoading:!1,skcColConfigs:[{prop:"skcExtCode",label:"SKC货号",width:"250px"},{slot:"saleAmount",label:"销售额",align:"center"},{slot:"saleCount",label:"单量",align:"center"},{prop:"costAmount",label:"成本",align:"center"},{slot:"profitAmount",label:"利润",align:"center"}],skcJsonFields:{SKC:"productSkcId","SKC货号":"skcExtCode","销售额":"saleAmount","单量":"saleCount","成本":"costAmount","利润":"profitAmount"},skuColConfigs:[{slot:"skuExtCode",label:"SKC货号/SKU货号"},{slot:"saleAmount",label:"销售额",align:"center"},{slot:"saleCount",label:"单量",align:"center"},{prop:"costAmount",label:"成本",align:"center"},{slot:"profitAmount",label:"利润",align:"center"}],skuJsonFields:{SKC:"productSkcId",SKU:"productSkuId","SKC货号":"skcExtCode","SKU货号":"skuExtCode","销售额":"saleAmount","单量":"saleCount","成本":"costAmount","利润":"profitAmount"},chartObj:null}},computed:{topSaleAmountSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.saleAmount-t.saleAmount)),t.slice(0,10)},topSaleProfitSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.profitAmount-t.profitAmount)),t.slice(0,10)},topSaleCountSkcList(){const t=Object.assign([],this.skcList);return t.sort(((t,e)=>e.saleCount-t.saleCount)),t.slice(0,10)},topSaleAmountSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.saleAmount-t.saleAmount)),t.slice(0,10)},topSaleProfitSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.profitAmount-t.profitAmount)),t.slice(0,10)},topSaleCountSkuList(){const t=Object.assign([],this.skuList);return t.sort(((t,e)=>e.saleCount-t.saleCount)),t.slice(0,10)}},components:{JsonExcel:i.A},mounted(){this.initChart1()},methods:{initChart1(){this.chartObj=new c.Im("chart1",{data:[this.leftChartData,this.rightChartData],xField:"day",yField:["value","value1"],yAxis:{value:{title:{text:"金额"},label:{formatter:t=>`${t}元`}},value1:{max:100,title:{text:"利润率"},label:{formatter:t=>`${t}%`}}},geometryOptions:[{geometry:"line",color:["#FF9A49","#7A8AA1","#1EEB73","#C947AE"],isGroup:!0,smooth:!0,seriesField:"type"},{geometry:"line",color:["red"],lineStyle:{fill:"red",fillOpacity:.5,stroke:"red",lineWidth:4,strokeOpacity:.7,shadowColor:"black",shadowBlur:10,shadowOffsetX:5,shadowOffsetY:5,cursor:"pointer"},isStack:!0,smooth:!0,seriesField:"type"}]}),this.chartObj.render()},toBeginStat(){this.dateRange?this.mallId?this.$userCheck(this.mallId).then((()=>{this.beginStat()})).catch((t=>{this.mallId="",this.isLoading=!1})):r.Message.error("请选择店铺"):r.Message.error("请选择统计时间范围")},async beginStat(){this.currentPage=1,this.isLoading=!0,this.saleAmount=0,this.saleCount=0,this.costAmount=0,this.profitAmount=0,this.profitPercent=0,this.productList=[],this.productCostList=[],this.skcList=[],this.skuList=[],this.leftChartData=[],this.rightChartData=[],this.chartObj.changeData([this.leftChartData,this.rightChartData]),await this.getProductList(),await this.getSkuCostList(),await this.getSkuSaleNumber(0),this.leftChartData.sort(((t,e)=>{let s=new Date(t.day),a=new Date(e.day);return s.getTime()-a.getTime()})),this.leftChartData.map((t=>{"销售额"!=t.type&&"成本"!=t.type&&"利润"!=t.type||(t.value=Math.round(100*t.value)/100),"销售额"==t.type&&this.leftChartData.map((e=>{"成本"==e.type&&e.day==t.day&&this.rightChartData.push({day:e.day,value1:Math.round((t.value-e.value)/t.value*1e4)/100,type:"利润率"})}))})),this.rightChartData.sort(((t,e)=>{let s=new Date(t.day),a=new Date(e.day);return s.getTime()-a.getTime()})),this.skuList=this.skuList.filter((t=>t.saleCount>0)),this.skuList.map((t=>{t.saleAmount=Math.round(100*t.saleAmount)/100,t.costAmount=Math.round(100*t.costAmount)/100,t.profitAmount=Math.round(100*t.profitAmount)/100})),this.skuList.map((t=>{let e=!1;for(let s=0;s<this.skcList.length;s++)if(t.productSkcId==this.skcList[s].productSkcId){this.skcList[s].saleAmount=this.skcList[s].saleAmount+t.saleAmount,this.skcList[s].costAmount=this.skcList[s].costAmount+t.costAmount,this.skcList[s].saleCount=this.skcList[s].saleCount+t.saleCount,this.skcList[s].profitAmount=this.skcList[s].profitAmount+t.profitAmount,e=!0;break}e||this.skcList.push({productSkcId:t.productSkcId,skcExtCode:t.skcExtCode,saleAmount:t.saleAmount,saleCount:t.saleCount,costAmount:t.costAmount,profitAmount:t.profitAmount,profitPercent:t.profitPercent})})),this.skcList.map((t=>{t.saleAmount=Math.round(100*t.saleAmount)/100,t.costAmount=Math.round(100*t.costAmount)/100,t.profitAmount=Math.round(100*t.profitAmount)/100})),this.leftChartData.map((t=>{"销售额"==t.type&&(this.saleAmount=this.saleAmount+t.value),"成本"==t.type&&(this.costAmount=this.costAmount+t.value),"利润"==t.type&&(this.profitAmount=this.profitAmount+t.value),"单量"==t.type&&(this.saleCount=this.saleCount+t.value)})),this.saleAmount=Math.round(100*this.saleAmount)/100,this.costAmount=Math.round(100*this.costAmount)/100,this.profitAmount=Math.round(100*this.profitAmount)/100,this.profitPercent=Math.round((this.saleAmount-this.costAmount)/this.saleAmount*1e4)/100,this.chartObj.changeData([this.leftChartData,this.rightChartData]),this.isLoading=!1},getPorductList(){this.$http.post("/api/skuCost/listAll",null,{params:{mallId:this.storeCode}}).then((t=>{0==t.code&&(this.productList=t.data)}))},async getProductList(){let t=await(0,l.w4)({url:"marvel-mms/cn/api/kiana/venom/sales/management/listWarehouse",needMallId:!0,mallId:this.mallId,data:{pageNo:this.currentPage,pageSize:this.pageSize,isLack:0,priceAdjustRecentDays:7}});if(1e6==t.errorCode){for(let e=0;e<t.result.subOrderList.length;e++){let s=t.result.subOrderList[e],a={};a.productName=s.productName,a.productId=s.productId,a.productSkcId=s.productSkcId,a.skcExtCode=s.skcExtCode;for(let t=0;t<s.skuQuantityDetailList.length;t++)a={...a,skuExtCode:s.skuQuantityDetailList[t].skuExtCode,supplierPrice:s.skuQuantityDetailList[t].supplierPrice/100,productSkuId:s.skuQuantityDetailList[t].productSkuId,className:s.skuQuantityDetailList[t].className},this.productList.push(a)}this.currentPage*this.pageSize<t.result.total&&(this.currentPage++,await this.getProductList())}else await this.getProductList()},async getSkuSaleNumber(t){let e=[],s=100*t,a=0;for(;s<this.productList.length;s++)if(e.push(this.productList[s].productSkuId),a++,100==a)break;if(0==e.length)return;let o=await(0,l.w4)({url:"oms/bg/venom/api/supplier/sales/management/querySkuSalesNumber",needMallId:!0,mallId:this.mallId,data:{productSkuIds:e,startDate:this.dateRange[0],endDate:this.dateRange[1]}});if(1e6==o.errorCode){for(let t=0;t<o.result.length;t++){let e=this.getCost(o.result[t].prodSkuId),s=!1,a=0;for(let l=0;l<this.productList.length;l++)if(this.productList[l].productSkuId==o.result[t].prodSkuId){a=this.productList[l];break}for(let l=0;l<this.leftChartData.length;l++)if("销售额"==this.leftChartData[l].type&&this.leftChartData[l].day==o.result[t].date){this.leftChartData[l].value=this.leftChartData[l].value+a.supplierPrice*o.result[t].salesNumber,s=!0;break}s||this.leftChartData.push({type:"销售额",value:a.supplierPrice*o.result[t].salesNumber,day:o.result[t].date}),s=!1;for(let l=0;l<this.leftChartData.length;l++)if("单量"==this.leftChartData[l].type&&this.leftChartData[l].day==o.result[t].date){this.leftChartData[l].value=this.leftChartData[l].value+o.result[t].salesNumber,s=!0;break}s||this.leftChartData.push({type:"单量",value:o.result[t].salesNumber,day:o.result[t].date}),s=!1;for(let l=0;l<this.leftChartData.length;l++)if("成本"==this.leftChartData[l].type&&this.leftChartData[l].day==o.result[t].date){this.leftChartData[l].value=this.leftChartData[l].value+e*o.result[t].salesNumber,s=!0;break}s||this.leftChartData.push({type:"成本",value:e*o.result[t].salesNumber,day:o.result[t].date}),s=!1;for(let l=0;l<this.leftChartData.length;l++)if("利润"==this.leftChartData[l].type&&this.leftChartData[l].day==o.result[t].date){this.leftChartData[l].value=this.leftChartData[l].value+(a.supplierPrice-e)*o.result[t].salesNumber,s=!0;break}s||this.leftChartData.push({type:"利润",value:(a.supplierPrice-e)*o.result[t].salesNumber,day:o.result[t].date}),s=!1;for(let l=0;l<this.skuList.length;l++)if(this.skuList[l].productSkuId==o.result[t].prodSkuId){this.skuList[l].saleAmount=this.skuList[l].saleAmount+a.supplierPrice*o.result[t].salesNumber,this.skuList[l].costAmount=this.skuList[l].costAmount+e*o.result[t].salesNumber,this.skuList[l].saleCount=this.skuList[l].saleCount+o.result[t].salesNumber,this.skuList[l].profitAmount=this.skuList[l].profitAmount+(a.supplierPrice-e)*o.result[t].salesNumber,s=!0;break}s||this.skuList.push({productSkcId:a.productSkcId,productSkuId:a.productSkuId,skcExtCode:a.skcExtCode,skuExtCode:a.skuExtCode,saleAmount:a.supplierPrice*o.result[t].salesNumber,costAmount:e*o.result[t].salesNumber,profitAmount:(a.supplierPrice-e)*o.result[t].salesNumber,saleCount:o.result[t].salesNumber,profitPercent:Math.round((a.supplierPrice-e)/a.supplierPrice*1e4)/100})}await this.getSkuSaleNumber(t+1)}else await this.getSkuSaleNumber(t)},async getSkuCostList(){let t=await this.$http.post("/api/skuCost/listAll",null,{params:{mallId:this.mallId}});0==t.code&&(this.productCostList=t.data)},getCost(t){for(let e=0;e<this.productCostList.length;e++)if(t==this.productCostList[e].sku)return this.productCostList[e].costPrice;return 0},sleepSync(t){return new Promise((e=>setTimeout(e,t)))},async downloadPicture(){try{const t=document.getElementById("app-content"),e=await u()(t),s=new Image;s.src=e.toDataURL("image/png"),document.body.appendChild(s);const a=document.createElement("a");a.style.display="none",a.href=s.src,a.download="销售统计.png",a.click(),document.body.removeChild(s)}catch(t){console.error("Error saving image:",t)}}}},p=d,h=(s(34091),s(81656)),f=(0,h.A)(p,a,o,!1,null,"0c76c28c",null),m=f.exports},98081:function(t,e,s){"use strict";s.r(e);var a=s(31601),o=s.n(a),l=s(76314),i=s.n(l),r=i()(o());r.push([t.id,".list .title-right[data-v-0c76c28c]{display:flex;align-items:center}.list .title-right>div[data-v-0c76c28c]:first-child{margin-right:20px}.list[data-v-0c76c28c].ai-list .ai-list__content--right-wrapper{background:transparent;box-shadow:none;padding:0!important}.list .top[data-v-0c76c28c]{display:flex;justify-content:space-between;margin-bottom:24px}.list .top .item[data-v-0c76c28c]{flex:1;margin-right:20px;padding:16px 24px;background:#fff;box-shadow:0 4px 6px -2px rgba(15,15,21,.15);border-radius:4px}.list .top .item[data-v-0c76c28c]:last-child{margin-right:0}.list .top .item[data-v-0c76c28c]:first-of-type{color:#26f}.list .top .item[data-v-0c76c28c]:nth-of-type(2){color:#f8b426}.list .top .item[data-v-0c76c28c]:nth-of-type(3){color:#21aa99}.list .top .item[data-v-0c76c28c]:nth-of-type(4){color:#f46}.list .top .item[data-v-0c76c28c]:nth-of-type(5){color:#11a265}.list .top .item h2[data-v-0c76c28c]{margin-bottom:30px;font-size:16px;color:#999}.list .top .item p[data-v-0c76c28c]{font-weight:600;font-size:28px}.like[data-v-0c76c28c]{cursor:pointer;font-size:25px;display:inline-block}",""]),e["default"]=r},39325:function(t,e,s){"use strict";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof s.g?s.g:"undefined"!==typeof self&&self;function a(t,e){return e={exports:{}},t(e,e.exports),e.exports}var o=a((function(t,e){(function(e,s){t.exports=s()})(0,(function(){return function t(e,s,a){var o,l,i=window,r="application/octet-stream",n=a||r,u=e,c=!s&&!a&&u,d=document.createElement("a"),p=function(t){return String(t)},h=i.Blob||i.MozBlob||i.WebKitBlob||p,f=s||"download";if(h=h.call?h.bind(i):Blob,"true"===String(this)&&(u=[u,n],n=u[0],u=u[1]),c&&c.length<2048&&(f=c.split("/").pop().split("?")[0],d.href=c,-1!==d.href.indexOf(c))){var m=new XMLHttpRequest;return m.open("GET",c,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,f,r)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u)){if(!(u.length>2096103.424&&h!==p))return navigator.msSaveBlob?navigator.msSaveBlob(y(u),f):C(u);u=y(u),n=u.type||r}else if(/([\x80-\xff])/.test(u)){var g=0,b=new Uint8Array(u.length),k=b.length;for(g;g<k;++g)b[g]=u.charCodeAt(g);u=new h([b],{type:n})}function y(t){var e=t.split(/[:;,]/),s=e[1],a="base64"==e[2]?atob:decodeURIComponent,o=a(e.pop()),l=o.length,i=0,r=new Uint8Array(l);for(i;i<l;++i)r[i]=o.charCodeAt(i);return new h([r],{type:s})}function C(t,e){if("download"in d)return d.href=t,d.setAttribute("download",f),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){i.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,r)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var s=document.createElement("iframe");document.body.appendChild(s),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,r)),s.src=t,setTimeout((function(){document.body.removeChild(s)}),333)}if(o=u instanceof h?u:new h([u],{type:n}),navigator.msSaveBlob)return navigator.msSaveBlob(o,f);if(i.URL)C(i.URL.createObjectURL(o),!0);else{if("string"===typeof o||o.constructor===p)try{return C("data:"+n+";base64,"+i.btoa(o))}catch(v){return C("data:"+n+","+encodeURIComponent(o))}l=new FileReader,l.onload=function(t){C(this.result)},l.readAsDataURL(o)}return!0}}))})),l={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:()=>null},exportFields:{type:Object,default:()=>null},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},computed:{idName(){var t=(new Date).getTime();return"export_"+t},downloadFields(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let t=this.data;if("function"!==typeof this.fetch&&t||(t=await this.fetch()),!t||!t.length)return;let e=this.getProcessedJson(t,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(e),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(e),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(e),this.name,"application/vnd.ms-excel")},export:async function(t,e,s){let a=this.base64ToBlob(t,s);"function"===typeof this.beforeFinish&&await this.beforeFinish(),o(a,e,s)},jsonToXLS(t){let e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',s="<thead>";const a=Object.keys(t[0]).length;let o=this;const l=this.header||this.$attrs.title;l&&(s+=this.parseExtraData(l,'<tr><th colspan="'+a+'">${data}</th></tr>')),s+="<tr>";for(let i in t[0])s+="<th>"+i+"</th>";return s+="</tr>",s+="</thead>",s+="<tbody>",t.map((function(t,e){s+="<tr>";for(let a in t)s+="<td>"+o.preprocessLongNum(o.valueReformattedForMultilines(t[a]))+"</td>";s+="</tr>"})),s+="</tbody>",null!=this.footer&&(s+="<tfoot>",s+=this.parseExtraData(this.footer,'<tr><td colspan="'+a+'">${data}</td></tr>'),s+="</tfoot>"),e.replace("${table}",s).replace("${worksheet}",this.worksheet)},jsonToCSV(t){let e=this;var s=[];const a=this.header||this.$attrs.title;a&&s.push(this.parseExtraData(a,"${data}\r\n"));for(let o in t[0])s.push(o),s.push(",");return s.pop(),s.push("\r\n"),t.map((function(t){for(let a in t){let o=t[a]+"";e.escapeCsv&&(o='="'+o+'"',o.match(/[,"\n]/)&&(o='"'+o.replace(/\"/g,'""')+'"')),s.push(o),s.push(",")}s.pop(),s.push("\r\n")})),null!=this.footer&&s.push(this.parseExtraData(this.footer,"${data}\r\n")),s.join("")},getProcessedJson(t,e){let s=this.getKeys(t,e),a=[],o=this;return t.map((function(t,e){let l={};for(let a in s){let e=s[a];l[a]=o.getValue(e,t)}a.push(l)})),a},getKeys(t,e){if(e)return e;let s={};for(let a in t[0])s[a]=a;return s},parseExtraData(t,e){let s="";if(Array.isArray(t))for(var a=0;a<t.length;a++)t[a]&&(s+=e.replace("${data}",t[a]));else s+=e.replace("${data}",t);return s},getValue(t,e){const s="object"!==typeof t?t:t.field;let a="string"!==typeof s?[]:s.split("."),o=this.defaultValue;return o=s?a.length>1?this.getValueFromNestedItem(e,a):this.parseValue(e[s]):e,t.hasOwnProperty("callback")&&(o=this.getValueFromCallback(o,t.callback)),o},valueReformattedForMultilines(t){return"string"==typeof t?t.replace(/\n/gi,"<br/>"):t},preprocessLongNum(t){if(this.stringifyLongNum){if(String(t).startsWith("0x"))return t;if(!isNaN(t)&&""!=t&&(t>99999999999||t<1e-13))return'="'+t+'"'}return t},getValueFromNestedItem(t,e){let s=t;for(let a of e)s&&(s=s[a]);return this.parseValue(s)},getValueFromCallback(t,e){if("function"!==typeof e)return this.defaultValue;const s=e(t);return this.parseValue(s)},parseValue(t){return t||0===t||"boolean"===typeof t?t:this.defaultValue},base64ToBlob(t,e){let s=window.btoa(window.unescape(encodeURIComponent(t))),a=atob(s),o=a.length,l=new Uint8ClampedArray(o);while(o--)l[o]=a.charCodeAt(o);return new Blob([l],{type:e})}}};function i(t,e,s,a,o,l,i,r,n,u){"boolean"!==typeof i&&(n=r,r=i,i=!1);var c,d="function"===typeof s?s.options:s;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),a&&(d._scopeId=a),l?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,n(t)),t&&t._registeredComponents&&t._registeredComponents.add(l)},d._ssrRegister=c):e&&(c=i?function(){e.call(this,u(this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),c)if(d.functional){var p=d.render;d.render=function(t,e){return c.call(e),p(t,e)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,c):[c]}return s}var r=i;const n=l;var u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:t.idName},on:{click:t.generate}},[t._t("default",[t._v(" Download "+t._s(t.name)+" ")])],2)},c=[];u._withStripped=!0;const d=void 0,p=void 0,h=void 0,f=!1;var m=r({render:u,staticRenderFns:c},d,n,p,f,h,void 0,void 0);e.A=m},34091:function(t,e,s){var a=s(98081);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=s(99548).A;o("4780ac94",a,!0,{sourceMap:!1,shadowMode:!1})}}]);